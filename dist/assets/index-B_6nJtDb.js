function $1(t,e){for(var s=0;s<e.length;s++){const r=e[s];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();function B1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var mw={exports:{}},rh={},fw={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yc=Symbol.for("react.element"),z1=Symbol.for("react.portal"),q1=Symbol.for("react.fragment"),H1=Symbol.for("react.strict_mode"),W1=Symbol.for("react.profiler"),K1=Symbol.for("react.provider"),G1=Symbol.for("react.context"),Q1=Symbol.for("react.forward_ref"),X1=Symbol.for("react.suspense"),Y1=Symbol.for("react.memo"),J1=Symbol.for("react.lazy"),h0=Symbol.iterator;function Z1(t){return t===null||typeof t!="object"?null:(t=h0&&t[h0]||t["@@iterator"],typeof t=="function"?t:null)}var pw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gw=Object.assign,xw={};function yo(t,e,s){this.props=t,this.context=e,this.refs=xw,this.updater=s||pw}yo.prototype.isReactComponent={};yo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};yo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function yw(){}yw.prototype=yo.prototype;function Mp(t,e,s){this.props=t,this.context=e,this.refs=xw,this.updater=s||pw}var Vp=Mp.prototype=new yw;Vp.constructor=Mp;gw(Vp,yo.prototype);Vp.isPureReactComponent=!0;var m0=Array.isArray,vw=Object.prototype.hasOwnProperty,Fp={current:null},ww={key:!0,ref:!0,__self:!0,__source:!0};function bw(t,e,s){var r,i={},a=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)vw.call(e,r)&&!ww.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=s;else if(1<l){for(var d=Array(l),u=0;u<l;u++)d[u]=arguments[u+2];i.children=d}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:yc,type:t,key:a,ref:o,props:i,_owner:Fp.current}}function e2(t,e){return{$$typeof:yc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Up(t){return typeof t=="object"&&t!==null&&t.$$typeof===yc}function t2(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return e[s]})}var f0=/\/+/g;function fm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?t2(""+t.key):e.toString(36)}function Ud(t,e,s,r,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case yc:case z1:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+fm(o,0):r,m0(i)?(s="",t!=null&&(s=t.replace(f0,"$&/")+"/"),Ud(i,e,s,"",function(u){return u})):i!=null&&(Up(i)&&(i=e2(i,s+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(f0,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",m0(t))for(var l=0;l<t.length;l++){a=t[l];var d=r+fm(a,l);o+=Ud(a,e,s,d,i)}else if(d=Z1(t),typeof d=="function")for(t=d.call(t),l=0;!(a=t.next()).done;)a=a.value,d=r+fm(a,l++),o+=Ud(a,e,s,d,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function cd(t,e,s){if(t==null)return t;var r=[],i=0;return Ud(t,r,"","",function(a){return e.call(s,a,i++)}),r}function s2(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var gs={current:null},$d={transition:null},n2={ReactCurrentDispatcher:gs,ReactCurrentBatchConfig:$d,ReactCurrentOwner:Fp};function Nw(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:cd,forEach:function(t,e,s){cd(t,function(){e.apply(this,arguments)},s)},count:function(t){var e=0;return cd(t,function(){e++}),e},toArray:function(t){return cd(t,function(e){return e})||[]},only:function(t){if(!Up(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ke.Component=yo;ke.Fragment=q1;ke.Profiler=W1;ke.PureComponent=Mp;ke.StrictMode=H1;ke.Suspense=X1;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=n2;ke.act=Nw;ke.cloneElement=function(t,e,s){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=gw({},t.props),i=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=Fp.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(d in e)vw.call(e,d)&&!ww.hasOwnProperty(d)&&(r[d]=e[d]===void 0&&l!==void 0?l[d]:e[d])}var d=arguments.length-2;if(d===1)r.children=s;else if(1<d){l=Array(d);for(var u=0;u<d;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:yc,type:t.type,key:i,ref:a,props:r,_owner:o}};ke.createContext=function(t){return t={$$typeof:G1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:K1,_context:t},t.Consumer=t};ke.createElement=bw;ke.createFactory=function(t){var e=bw.bind(null,t);return e.type=t,e};ke.createRef=function(){return{current:null}};ke.forwardRef=function(t){return{$$typeof:Q1,render:t}};ke.isValidElement=Up;ke.lazy=function(t){return{$$typeof:J1,_payload:{_status:-1,_result:t},_init:s2}};ke.memo=function(t,e){return{$$typeof:Y1,type:t,compare:e===void 0?null:e}};ke.startTransition=function(t){var e=$d.transition;$d.transition={};try{t()}finally{$d.transition=e}};ke.unstable_act=Nw;ke.useCallback=function(t,e){return gs.current.useCallback(t,e)};ke.useContext=function(t){return gs.current.useContext(t)};ke.useDebugValue=function(){};ke.useDeferredValue=function(t){return gs.current.useDeferredValue(t)};ke.useEffect=function(t,e){return gs.current.useEffect(t,e)};ke.useId=function(){return gs.current.useId()};ke.useImperativeHandle=function(t,e,s){return gs.current.useImperativeHandle(t,e,s)};ke.useInsertionEffect=function(t,e){return gs.current.useInsertionEffect(t,e)};ke.useLayoutEffect=function(t,e){return gs.current.useLayoutEffect(t,e)};ke.useMemo=function(t,e){return gs.current.useMemo(t,e)};ke.useReducer=function(t,e,s){return gs.current.useReducer(t,e,s)};ke.useRef=function(t){return gs.current.useRef(t)};ke.useState=function(t){return gs.current.useState(t)};ke.useSyncExternalStore=function(t,e,s){return gs.current.useSyncExternalStore(t,e,s)};ke.useTransition=function(){return gs.current.useTransition()};ke.version="18.3.1";fw.exports=ke;var _=fw.exports;const jw=B1(_),r2=$1({__proto__:null,default:jw},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i2=_,a2=Symbol.for("react.element"),o2=Symbol.for("react.fragment"),l2=Object.prototype.hasOwnProperty,c2=i2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d2={key:!0,ref:!0,__self:!0,__source:!0};function _w(t,e,s){var r,i={},a=null,o=null;s!==void 0&&(a=""+s),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)l2.call(e,r)&&!d2.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:a2,type:t,key:a,ref:o,props:i,_owner:c2.current}}rh.Fragment=o2;rh.jsx=_w;rh.jsxs=_w;mw.exports=rh;var n=mw.exports,hf={},kw={exports:{}},Bs={},Ew={exports:{}},Iw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,$){var M=L.length;L.push($);e:for(;0<M;){var G=M-1>>>1,Y=L[G];if(0<i(Y,$))L[G]=$,L[M]=Y,M=G;else break e}}function s(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var $=L[0],M=L.pop();if(M!==$){L[0]=M;e:for(var G=0,Y=L.length,ie=Y>>>1;G<ie;){var le=2*(G+1)-1,pe=L[le],Ae=le+1,De=L[Ae];if(0>i(pe,M))Ae<Y&&0>i(De,pe)?(L[G]=De,L[Ae]=M,G=Ae):(L[G]=pe,L[le]=M,G=le);else if(Ae<Y&&0>i(De,M))L[G]=De,L[Ae]=M,G=Ae;else break e}}return $}function i(L,$){var M=L.sortIndex-$.sortIndex;return M!==0?M:L.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var d=[],u=[],h=1,p=null,g=3,y=!1,w=!1,C=!1,E=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(L){for(var $=s(u);$!==null;){if($.callback===null)r(u);else if($.startTime<=L)r(u),$.sortIndex=$.expirationTime,e(d,$);else break;$=s(u)}}function P(L){if(C=!1,k(L),!w)if(s(d)!==null)w=!0,V(O);else{var $=s(u);$!==null&&z(P,$.startTime-L)}}function O(L,$){w=!1,C&&(C=!1,N(m),m=-1),y=!0;var M=g;try{for(k($),p=s(d);p!==null&&(!(p.expirationTime>$)||L&&!T());){var G=p.callback;if(typeof G=="function"){p.callback=null,g=p.priorityLevel;var Y=G(p.expirationTime<=$);$=t.unstable_now(),typeof Y=="function"?p.callback=Y:p===s(d)&&r(d),k($)}else r(d);p=s(d)}if(p!==null)var ie=!0;else{var le=s(u);le!==null&&z(P,le.startTime-$),ie=!1}return ie}finally{p=null,g=M,y=!1}}var U=!1,b=null,m=-1,j=5,I=-1;function T(){return!(t.unstable_now()-I<j)}function D(){if(b!==null){var L=t.unstable_now();I=L;var $=!0;try{$=b(!0,L)}finally{$?S():(U=!1,b=null)}}else U=!1}var S;if(typeof v=="function")S=function(){v(D)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,F=W.port2;W.port1.onmessage=D,S=function(){F.postMessage(null)}}else S=function(){E(D,0)};function V(L){b=L,U||(U=!0,S())}function z(L,$){m=E(function(){L(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){w||y||(w=!0,V(O))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return s(d)},t.unstable_next=function(L){switch(g){case 1:case 2:case 3:var $=3;break;default:$=g}var M=g;g=$;try{return L()}finally{g=M}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,$){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var M=g;g=L;try{return $()}finally{g=M}},t.unstable_scheduleCallback=function(L,$,M){var G=t.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?G+M:G):M=G,L){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=M+Y,L={id:h++,callback:$,priorityLevel:L,startTime:M,expirationTime:Y,sortIndex:-1},M>G?(L.sortIndex=M,e(u,L),s(d)===null&&L===s(u)&&(C?(N(m),m=-1):C=!0,z(P,M-G))):(L.sortIndex=Y,e(d,L),w||y||(w=!0,V(O))),L},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(L){var $=g;return function(){var M=g;g=$;try{return L.apply(this,arguments)}finally{g=M}}}})(Iw);Ew.exports=Iw;var u2=Ew.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h2=_,$s=u2;function ee(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)e+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Sw=new Set,Dl={};function oa(t,e){to(t,e),to(t+"Capture",e)}function to(t,e){for(Dl[t]=e,t=0;t<e.length;t++)Sw.add(e[t])}var mr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mf=Object.prototype.hasOwnProperty,m2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p0={},g0={};function f2(t){return mf.call(g0,t)?!0:mf.call(p0,t)?!1:m2.test(t)?g0[t]=!0:(p0[t]=!0,!1)}function p2(t,e,s,r){if(s!==null&&s.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function g2(t,e,s,r){if(e===null||typeof e>"u"||p2(t,e,s,r))return!0;if(r)return!1;if(s!==null)switch(s.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xs(t,e,s,r,i,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=s,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var Yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Yt[t]=new xs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Yt[e]=new xs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Yt[t]=new xs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Yt[t]=new xs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Yt[t]=new xs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Yt[t]=new xs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Yt[t]=new xs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Yt[t]=new xs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Yt[t]=new xs(t,5,!1,t.toLowerCase(),null,!1,!1)});var $p=/[\-:]([a-z])/g;function Bp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace($p,Bp);Yt[e]=new xs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace($p,Bp);Yt[e]=new xs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace($p,Bp);Yt[e]=new xs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Yt[t]=new xs(t,1,!1,t.toLowerCase(),null,!1,!1)});Yt.xlinkHref=new xs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Yt[t]=new xs(t,1,!1,t.toLowerCase(),null,!0,!0)});function zp(t,e,s,r){var i=Yt.hasOwnProperty(e)?Yt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(g2(e,s,i,r)&&(s=null),r||i===null?f2(e)&&(s===null?t.removeAttribute(e):t.setAttribute(e,""+s)):i.mustUseProperty?t[i.propertyName]=s===null?i.type===3?!1:"":s:(e=i.attributeName,r=i.attributeNamespace,s===null?t.removeAttribute(e):(i=i.type,s=i===3||i===4&&s===!0?"":""+s,r?t.setAttributeNS(r,e,s):t.setAttribute(e,s))))}var kr=h2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dd=Symbol.for("react.element"),Aa=Symbol.for("react.portal"),Ra=Symbol.for("react.fragment"),qp=Symbol.for("react.strict_mode"),ff=Symbol.for("react.profiler"),Tw=Symbol.for("react.provider"),Cw=Symbol.for("react.context"),Hp=Symbol.for("react.forward_ref"),pf=Symbol.for("react.suspense"),gf=Symbol.for("react.suspense_list"),Wp=Symbol.for("react.memo"),Fr=Symbol.for("react.lazy"),Aw=Symbol.for("react.offscreen"),x0=Symbol.iterator;function Ko(t){return t===null||typeof t!="object"?null:(t=x0&&t[x0]||t["@@iterator"],typeof t=="function"?t:null)}var dt=Object.assign,pm;function rl(t){if(pm===void 0)try{throw Error()}catch(s){var e=s.stack.trim().match(/\n( *(at )?)/);pm=e&&e[1]||""}return`
`+pm+t}var gm=!1;function xm(t,e){if(!t||gm)return"";gm=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var d=`
`+i[o].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=o&&0<=l);break}}}finally{gm=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?rl(t):""}function x2(t){switch(t.tag){case 5:return rl(t.type);case 16:return rl("Lazy");case 13:return rl("Suspense");case 19:return rl("SuspenseList");case 0:case 2:case 15:return t=xm(t.type,!1),t;case 11:return t=xm(t.type.render,!1),t;case 1:return t=xm(t.type,!0),t;default:return""}}function xf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ra:return"Fragment";case Aa:return"Portal";case ff:return"Profiler";case qp:return"StrictMode";case pf:return"Suspense";case gf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Cw:return(t.displayName||"Context")+".Consumer";case Tw:return(t._context.displayName||"Context")+".Provider";case Hp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Wp:return e=t.displayName||null,e!==null?e:xf(t.type)||"Memo";case Fr:e=t._payload,t=t._init;try{return xf(t(e))}catch{}}return null}function y2(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xf(e);case 8:return e===qp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function di(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Rw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function v2(t){var e=Rw(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var i=s.get,a=s.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:s.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ud(t){t._valueTracker||(t._valueTracker=v2(t))}function Pw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var s=e.getValue(),r="";return t&&(r=Rw(t)?t.checked?"true":"false":t.value),t=r,t!==s?(e.setValue(t),!0):!1}function lu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function yf(t,e){var s=e.checked;return dt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??t._wrapperState.initialChecked})}function y0(t,e){var s=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;s=di(e.value!=null?e.value:s),t._wrapperState={initialChecked:r,initialValue:s,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Dw(t,e){e=e.checked,e!=null&&zp(t,"checked",e,!1)}function vf(t,e){Dw(t,e);var s=di(e.value),r=e.type;if(s!=null)r==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?wf(t,e.type,s):e.hasOwnProperty("defaultValue")&&wf(t,e.type,di(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function v0(t,e,s){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,s||e===t.value||(t.value=e),t.defaultValue=e}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function wf(t,e,s){(e!=="number"||lu(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var il=Array.isArray;function Ha(t,e,s,r){if(t=t.options,e){e={};for(var i=0;i<s.length;i++)e["$"+s[i]]=!0;for(s=0;s<t.length;s++)i=e.hasOwnProperty("$"+t[s].value),t[s].selected!==i&&(t[s].selected=i),i&&r&&(t[s].defaultSelected=!0)}else{for(s=""+di(s),e=null,i=0;i<t.length;i++){if(t[i].value===s){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function bf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ee(91));return dt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function w0(t,e){var s=e.value;if(s==null){if(s=e.children,e=e.defaultValue,s!=null){if(e!=null)throw Error(ee(92));if(il(s)){if(1<s.length)throw Error(ee(93));s=s[0]}e=s}e==null&&(e=""),s=e}t._wrapperState={initialValue:di(s)}}function Ow(t,e){var s=di(e.value),r=di(e.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),e.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),r!=null&&(t.defaultValue=""+r)}function b0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Lw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Lw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var hd,Mw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,s,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,s,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(hd=hd||document.createElement("div"),hd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=hd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ol(t,e){if(e){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=e;return}}t.textContent=e}var fl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w2=["Webkit","ms","Moz","O"];Object.keys(fl).forEach(function(t){w2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),fl[e]=fl[t]})});function Vw(t,e,s){return e==null||typeof e=="boolean"||e===""?"":s||typeof e!="number"||e===0||fl.hasOwnProperty(t)&&fl[t]?(""+e).trim():e+"px"}function Fw(t,e){t=t.style;for(var s in e)if(e.hasOwnProperty(s)){var r=s.indexOf("--")===0,i=Vw(s,e[s],r);s==="float"&&(s="cssFloat"),r?t.setProperty(s,i):t[s]=i}}var b2=dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jf(t,e){if(e){if(b2[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ee(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ee(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ee(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ee(62))}}function _f(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kf=null;function Kp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ef=null,Wa=null,Ka=null;function N0(t){if(t=bc(t)){if(typeof Ef!="function")throw Error(ee(280));var e=t.stateNode;e&&(e=ch(e),Ef(t.stateNode,t.type,e))}}function Uw(t){Wa?Ka?Ka.push(t):Ka=[t]:Wa=t}function $w(){if(Wa){var t=Wa,e=Ka;if(Ka=Wa=null,N0(t),e)for(t=0;t<e.length;t++)N0(e[t])}}function Bw(t,e){return t(e)}function zw(){}var ym=!1;function qw(t,e,s){if(ym)return t(e,s);ym=!0;try{return Bw(t,e,s)}finally{ym=!1,(Wa!==null||Ka!==null)&&(zw(),$w())}}function Ll(t,e){var s=t.stateNode;if(s===null)return null;var r=ch(s);if(r===null)return null;s=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(ee(231,e,typeof s));return s}var If=!1;if(mr)try{var Go={};Object.defineProperty(Go,"passive",{get:function(){If=!0}}),window.addEventListener("test",Go,Go),window.removeEventListener("test",Go,Go)}catch{If=!1}function N2(t,e,s,r,i,a,o,l,d){var u=Array.prototype.slice.call(arguments,3);try{e.apply(s,u)}catch(h){this.onError(h)}}var pl=!1,cu=null,du=!1,Sf=null,j2={onError:function(t){pl=!0,cu=t}};function _2(t,e,s,r,i,a,o,l,d){pl=!1,cu=null,N2.apply(j2,arguments)}function k2(t,e,s,r,i,a,o,l,d){if(_2.apply(this,arguments),pl){if(pl){var u=cu;pl=!1,cu=null}else throw Error(ee(198));du||(du=!0,Sf=u)}}function la(t){var e=t,s=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(s=e.return),t=e.return;while(t)}return e.tag===3?s:null}function Hw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function j0(t){if(la(t)!==t)throw Error(ee(188))}function E2(t){var e=t.alternate;if(!e){if(e=la(t),e===null)throw Error(ee(188));return e!==t?null:t}for(var s=t,r=e;;){var i=s.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){s=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===s)return j0(i),t;if(a===r)return j0(i),e;a=a.sibling}throw Error(ee(188))}if(s.return!==r.return)s=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===s){o=!0,s=i,r=a;break}if(l===r){o=!0,r=i,s=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===s){o=!0,s=a,r=i;break}if(l===r){o=!0,r=a,s=i;break}l=l.sibling}if(!o)throw Error(ee(189))}}if(s.alternate!==r)throw Error(ee(190))}if(s.tag!==3)throw Error(ee(188));return s.stateNode.current===s?t:e}function Ww(t){return t=E2(t),t!==null?Kw(t):null}function Kw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Kw(t);if(e!==null)return e;t=t.sibling}return null}var Gw=$s.unstable_scheduleCallback,_0=$s.unstable_cancelCallback,I2=$s.unstable_shouldYield,S2=$s.unstable_requestPaint,vt=$s.unstable_now,T2=$s.unstable_getCurrentPriorityLevel,Gp=$s.unstable_ImmediatePriority,Qw=$s.unstable_UserBlockingPriority,uu=$s.unstable_NormalPriority,C2=$s.unstable_LowPriority,Xw=$s.unstable_IdlePriority,ih=null,On=null;function A2(t){if(On&&typeof On.onCommitFiberRoot=="function")try{On.onCommitFiberRoot(ih,t,void 0,(t.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:D2,R2=Math.log,P2=Math.LN2;function D2(t){return t>>>=0,t===0?32:31-(R2(t)/P2|0)|0}var md=64,fd=4194304;function al(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function hu(t,e){var s=t.pendingLanes;if(s===0)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,o=s&268435455;if(o!==0){var l=o&~i;l!==0?r=al(l):(a&=o,a!==0&&(r=al(a)))}else o=s&~i,o!==0?r=al(o):a!==0&&(r=al(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(r&4&&(r|=s&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)s=31-wn(e),i=1<<s,r|=t[s],e&=~i;return r}function O2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function L2(t,e){for(var s=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-wn(a),l=1<<o,d=i[o];d===-1?(!(l&s)||l&r)&&(i[o]=O2(l,e)):d<=e&&(t.expiredLanes|=l),a&=~l}}function Tf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Yw(){var t=md;return md<<=1,!(md&4194240)&&(md=64),t}function vm(t){for(var e=[],s=0;31>s;s++)e.push(t);return e}function vc(t,e,s){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-wn(e),t[e]=s}function M2(t,e){var s=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<s;){var i=31-wn(s),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,s&=~a}}function Qp(t,e){var s=t.entangledLanes|=e;for(t=t.entanglements;s;){var r=31-wn(s),i=1<<r;i&e|t[r]&e&&(t[r]|=e),s&=~i}}var Ve=0;function Jw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Zw,Xp,eb,tb,sb,Cf=!1,pd=[],Yr=null,Jr=null,Zr=null,Ml=new Map,Vl=new Map,$r=[],V2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function k0(t,e){switch(t){case"focusin":case"focusout":Yr=null;break;case"dragenter":case"dragleave":Jr=null;break;case"mouseover":case"mouseout":Zr=null;break;case"pointerover":case"pointerout":Ml.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vl.delete(e.pointerId)}}function Qo(t,e,s,r,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:s,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},e!==null&&(e=bc(e),e!==null&&Xp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function F2(t,e,s,r,i){switch(e){case"focusin":return Yr=Qo(Yr,t,e,s,r,i),!0;case"dragenter":return Jr=Qo(Jr,t,e,s,r,i),!0;case"mouseover":return Zr=Qo(Zr,t,e,s,r,i),!0;case"pointerover":var a=i.pointerId;return Ml.set(a,Qo(Ml.get(a)||null,t,e,s,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Vl.set(a,Qo(Vl.get(a)||null,t,e,s,r,i)),!0}return!1}function nb(t){var e=Mi(t.target);if(e!==null){var s=la(e);if(s!==null){if(e=s.tag,e===13){if(e=Hw(s),e!==null){t.blockedOn=e,sb(t.priority,function(){eb(s)});return}}else if(e===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Bd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var s=Af(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var r=new s.constructor(s.type,s);kf=r,s.target.dispatchEvent(r),kf=null}else return e=bc(s),e!==null&&Xp(e),t.blockedOn=s,!1;e.shift()}return!0}function E0(t,e,s){Bd(t)&&s.delete(e)}function U2(){Cf=!1,Yr!==null&&Bd(Yr)&&(Yr=null),Jr!==null&&Bd(Jr)&&(Jr=null),Zr!==null&&Bd(Zr)&&(Zr=null),Ml.forEach(E0),Vl.forEach(E0)}function Xo(t,e){t.blockedOn===e&&(t.blockedOn=null,Cf||(Cf=!0,$s.unstable_scheduleCallback($s.unstable_NormalPriority,U2)))}function Fl(t){function e(i){return Xo(i,t)}if(0<pd.length){Xo(pd[0],t);for(var s=1;s<pd.length;s++){var r=pd[s];r.blockedOn===t&&(r.blockedOn=null)}}for(Yr!==null&&Xo(Yr,t),Jr!==null&&Xo(Jr,t),Zr!==null&&Xo(Zr,t),Ml.forEach(e),Vl.forEach(e),s=0;s<$r.length;s++)r=$r[s],r.blockedOn===t&&(r.blockedOn=null);for(;0<$r.length&&(s=$r[0],s.blockedOn===null);)nb(s),s.blockedOn===null&&$r.shift()}var Ga=kr.ReactCurrentBatchConfig,mu=!0;function $2(t,e,s,r){var i=Ve,a=Ga.transition;Ga.transition=null;try{Ve=1,Yp(t,e,s,r)}finally{Ve=i,Ga.transition=a}}function B2(t,e,s,r){var i=Ve,a=Ga.transition;Ga.transition=null;try{Ve=4,Yp(t,e,s,r)}finally{Ve=i,Ga.transition=a}}function Yp(t,e,s,r){if(mu){var i=Af(t,e,s,r);if(i===null)Tm(t,e,r,fu,s),k0(t,r);else if(F2(i,t,e,s,r))r.stopPropagation();else if(k0(t,r),e&4&&-1<V2.indexOf(t)){for(;i!==null;){var a=bc(i);if(a!==null&&Zw(a),a=Af(t,e,s,r),a===null&&Tm(t,e,r,fu,s),a===i)break;i=a}i!==null&&r.stopPropagation()}else Tm(t,e,r,null,s)}}var fu=null;function Af(t,e,s,r){if(fu=null,t=Kp(r),t=Mi(t),t!==null)if(e=la(t),e===null)t=null;else if(s=e.tag,s===13){if(t=Hw(e),t!==null)return t;t=null}else if(s===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return fu=t,null}function rb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(T2()){case Gp:return 1;case Qw:return 4;case uu:case C2:return 16;case Xw:return 536870912;default:return 16}default:return 16}}var Kr=null,Jp=null,zd=null;function ib(){if(zd)return zd;var t,e=Jp,s=e.length,r,i="value"in Kr?Kr.value:Kr.textContent,a=i.length;for(t=0;t<s&&e[t]===i[t];t++);var o=s-t;for(r=1;r<=o&&e[s-r]===i[a-r];r++);return zd=i.slice(t,1<r?1-r:void 0)}function qd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function gd(){return!0}function I0(){return!1}function zs(t){function e(s,r,i,a,o){this._reactName=s,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(s=t[l],this[l]=s?s(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?gd:I0,this.isPropagationStopped=I0,this}return dt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=gd)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=gd)},persist:function(){},isPersistent:gd}),e}var vo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zp=zs(vo),wc=dt({},vo,{view:0,detail:0}),z2=zs(wc),wm,bm,Yo,ah=dt({},wc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Yo&&(Yo&&t.type==="mousemove"?(wm=t.screenX-Yo.screenX,bm=t.screenY-Yo.screenY):bm=wm=0,Yo=t),wm)},movementY:function(t){return"movementY"in t?t.movementY:bm}}),S0=zs(ah),q2=dt({},ah,{dataTransfer:0}),H2=zs(q2),W2=dt({},wc,{relatedTarget:0}),Nm=zs(W2),K2=dt({},vo,{animationName:0,elapsedTime:0,pseudoElement:0}),G2=zs(K2),Q2=dt({},vo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),X2=zs(Q2),Y2=dt({},vo,{data:0}),T0=zs(Y2),J2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Z2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ek={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ek[t])?!!e[t]:!1}function eg(){return tk}var sk=dt({},wc,{key:function(t){if(t.key){var e=J2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=qd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Z2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eg,charCode:function(t){return t.type==="keypress"?qd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?qd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),nk=zs(sk),rk=dt({},ah,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),C0=zs(rk),ik=dt({},wc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eg}),ak=zs(ik),ok=dt({},vo,{propertyName:0,elapsedTime:0,pseudoElement:0}),lk=zs(ok),ck=dt({},ah,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dk=zs(ck),uk=[9,13,27,32],tg=mr&&"CompositionEvent"in window,gl=null;mr&&"documentMode"in document&&(gl=document.documentMode);var hk=mr&&"TextEvent"in window&&!gl,ab=mr&&(!tg||gl&&8<gl&&11>=gl),A0=" ",R0=!1;function ob(t,e){switch(t){case"keyup":return uk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pa=!1;function mk(t,e){switch(t){case"compositionend":return lb(e);case"keypress":return e.which!==32?null:(R0=!0,A0);case"textInput":return t=e.data,t===A0&&R0?null:t;default:return null}}function fk(t,e){if(Pa)return t==="compositionend"||!tg&&ob(t,e)?(t=ib(),zd=Jp=Kr=null,Pa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ab&&e.locale!=="ko"?null:e.data;default:return null}}var pk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function P0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!pk[t.type]:e==="textarea"}function cb(t,e,s,r){Uw(r),e=pu(e,"onChange"),0<e.length&&(s=new Zp("onChange","change",null,s,r),t.push({event:s,listeners:e}))}var xl=null,Ul=null;function gk(t){wb(t,0)}function oh(t){var e=La(t);if(Pw(e))return t}function xk(t,e){if(t==="change")return e}var db=!1;if(mr){var jm;if(mr){var _m="oninput"in document;if(!_m){var D0=document.createElement("div");D0.setAttribute("oninput","return;"),_m=typeof D0.oninput=="function"}jm=_m}else jm=!1;db=jm&&(!document.documentMode||9<document.documentMode)}function O0(){xl&&(xl.detachEvent("onpropertychange",ub),Ul=xl=null)}function ub(t){if(t.propertyName==="value"&&oh(Ul)){var e=[];cb(e,Ul,t,Kp(t)),qw(gk,e)}}function yk(t,e,s){t==="focusin"?(O0(),xl=e,Ul=s,xl.attachEvent("onpropertychange",ub)):t==="focusout"&&O0()}function vk(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return oh(Ul)}function wk(t,e){if(t==="click")return oh(e)}function bk(t,e){if(t==="input"||t==="change")return oh(e)}function Nk(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Nn=typeof Object.is=="function"?Object.is:Nk;function $l(t,e){if(Nn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var s=Object.keys(t),r=Object.keys(e);if(s.length!==r.length)return!1;for(r=0;r<s.length;r++){var i=s[r];if(!mf.call(e,i)||!Nn(t[i],e[i]))return!1}return!0}function L0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function M0(t,e){var s=L0(t);t=0;for(var r;s;){if(s.nodeType===3){if(r=t+s.textContent.length,t<=e&&r>=e)return{node:s,offset:e-t};t=r}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=L0(s)}}function hb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?hb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mb(){for(var t=window,e=lu();e instanceof t.HTMLIFrameElement;){try{var s=typeof e.contentWindow.location.href=="string"}catch{s=!1}if(s)t=e.contentWindow;else break;e=lu(t.document)}return e}function sg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function jk(t){var e=mb(),s=t.focusedElem,r=t.selectionRange;if(e!==s&&s&&s.ownerDocument&&hb(s.ownerDocument.documentElement,s)){if(r!==null&&sg(s)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in s)s.selectionStart=e,s.selectionEnd=Math.min(t,s.value.length);else if(t=(e=s.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=s.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=M0(s,a);var o=M0(s,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=s;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<e.length;s++)t=e[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var _k=mr&&"documentMode"in document&&11>=document.documentMode,Da=null,Rf=null,yl=null,Pf=!1;function V0(t,e,s){var r=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Pf||Da==null||Da!==lu(r)||(r=Da,"selectionStart"in r&&sg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),yl&&$l(yl,r)||(yl=r,r=pu(Rf,"onSelect"),0<r.length&&(e=new Zp("onSelect","select",null,e,s),t.push({event:e,listeners:r}),e.target=Da)))}function xd(t,e){var s={};return s[t.toLowerCase()]=e.toLowerCase(),s["Webkit"+t]="webkit"+e,s["Moz"+t]="moz"+e,s}var Oa={animationend:xd("Animation","AnimationEnd"),animationiteration:xd("Animation","AnimationIteration"),animationstart:xd("Animation","AnimationStart"),transitionend:xd("Transition","TransitionEnd")},km={},fb={};mr&&(fb=document.createElement("div").style,"AnimationEvent"in window||(delete Oa.animationend.animation,delete Oa.animationiteration.animation,delete Oa.animationstart.animation),"TransitionEvent"in window||delete Oa.transitionend.transition);function lh(t){if(km[t])return km[t];if(!Oa[t])return t;var e=Oa[t],s;for(s in e)if(e.hasOwnProperty(s)&&s in fb)return km[t]=e[s];return t}var pb=lh("animationend"),gb=lh("animationiteration"),xb=lh("animationstart"),yb=lh("transitionend"),vb=new Map,F0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gi(t,e){vb.set(t,e),oa(e,[t])}for(var Em=0;Em<F0.length;Em++){var Im=F0[Em],kk=Im.toLowerCase(),Ek=Im[0].toUpperCase()+Im.slice(1);gi(kk,"on"+Ek)}gi(pb,"onAnimationEnd");gi(gb,"onAnimationIteration");gi(xb,"onAnimationStart");gi("dblclick","onDoubleClick");gi("focusin","onFocus");gi("focusout","onBlur");gi(yb,"onTransitionEnd");to("onMouseEnter",["mouseout","mouseover"]);to("onMouseLeave",["mouseout","mouseover"]);to("onPointerEnter",["pointerout","pointerover"]);to("onPointerLeave",["pointerout","pointerover"]);oa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));oa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));oa("onBeforeInput",["compositionend","keypress","textInput","paste"]);oa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));oa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));oa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ik=new Set("cancel close invalid load scroll toggle".split(" ").concat(ol));function U0(t,e,s){var r=t.type||"unknown-event";t.currentTarget=s,k2(r,e,void 0,t),t.currentTarget=null}function wb(t,e){e=(e&4)!==0;for(var s=0;s<t.length;s++){var r=t[s],i=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],d=l.instance,u=l.currentTarget;if(l=l.listener,d!==a&&i.isPropagationStopped())break e;U0(i,l,u),a=d}else for(o=0;o<r.length;o++){if(l=r[o],d=l.instance,u=l.currentTarget,l=l.listener,d!==a&&i.isPropagationStopped())break e;U0(i,l,u),a=d}}}if(du)throw t=Sf,du=!1,Sf=null,t}function Ze(t,e){var s=e[Vf];s===void 0&&(s=e[Vf]=new Set);var r=t+"__bubble";s.has(r)||(bb(e,t,2,!1),s.add(r))}function Sm(t,e,s){var r=0;e&&(r|=4),bb(s,t,r,e)}var yd="_reactListening"+Math.random().toString(36).slice(2);function Bl(t){if(!t[yd]){t[yd]=!0,Sw.forEach(function(s){s!=="selectionchange"&&(Ik.has(s)||Sm(s,!1,t),Sm(s,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[yd]||(e[yd]=!0,Sm("selectionchange",!1,e))}}function bb(t,e,s,r){switch(rb(e)){case 1:var i=$2;break;case 4:i=B2;break;default:i=Yp}s=i.bind(null,e,s,t),i=void 0,!If||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,s,{capture:!0,passive:i}):t.addEventListener(e,s,!0):i!==void 0?t.addEventListener(e,s,{passive:i}):t.addEventListener(e,s,!1)}function Tm(t,e,s,r,i){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var d=o.tag;if((d===3||d===4)&&(d=o.stateNode.containerInfo,d===i||d.nodeType===8&&d.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Mi(l),o===null)return;if(d=o.tag,d===5||d===6){r=a=o;continue e}l=l.parentNode}}r=r.return}qw(function(){var u=a,h=Kp(s),p=[];e:{var g=vb.get(t);if(g!==void 0){var y=Zp,w=t;switch(t){case"keypress":if(qd(s)===0)break e;case"keydown":case"keyup":y=nk;break;case"focusin":w="focus",y=Nm;break;case"focusout":w="blur",y=Nm;break;case"beforeblur":case"afterblur":y=Nm;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=S0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=H2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=ak;break;case pb:case gb:case xb:y=G2;break;case yb:y=lk;break;case"scroll":y=z2;break;case"wheel":y=dk;break;case"copy":case"cut":case"paste":y=X2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=C0}var C=(e&4)!==0,E=!C&&t==="scroll",N=C?g!==null?g+"Capture":null:g;C=[];for(var v=u,k;v!==null;){k=v;var P=k.stateNode;if(k.tag===5&&P!==null&&(k=P,N!==null&&(P=Ll(v,N),P!=null&&C.push(zl(v,P,k)))),E)break;v=v.return}0<C.length&&(g=new y(g,w,null,s,h),p.push({event:g,listeners:C}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",g&&s!==kf&&(w=s.relatedTarget||s.fromElement)&&(Mi(w)||w[fr]))break e;if((y||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,y?(w=s.relatedTarget||s.toElement,y=u,w=w?Mi(w):null,w!==null&&(E=la(w),w!==E||w.tag!==5&&w.tag!==6)&&(w=null)):(y=null,w=u),y!==w)){if(C=S0,P="onMouseLeave",N="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(C=C0,P="onPointerLeave",N="onPointerEnter",v="pointer"),E=y==null?g:La(y),k=w==null?g:La(w),g=new C(P,v+"leave",y,s,h),g.target=E,g.relatedTarget=k,P=null,Mi(h)===u&&(C=new C(N,v+"enter",w,s,h),C.target=k,C.relatedTarget=E,P=C),E=P,y&&w)t:{for(C=y,N=w,v=0,k=C;k;k=Ea(k))v++;for(k=0,P=N;P;P=Ea(P))k++;for(;0<v-k;)C=Ea(C),v--;for(;0<k-v;)N=Ea(N),k--;for(;v--;){if(C===N||N!==null&&C===N.alternate)break t;C=Ea(C),N=Ea(N)}C=null}else C=null;y!==null&&$0(p,g,y,C,!1),w!==null&&E!==null&&$0(p,E,w,C,!0)}}e:{if(g=u?La(u):window,y=g.nodeName&&g.nodeName.toLowerCase(),y==="select"||y==="input"&&g.type==="file")var O=xk;else if(P0(g))if(db)O=bk;else{O=vk;var U=yk}else(y=g.nodeName)&&y.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(O=wk);if(O&&(O=O(t,u))){cb(p,O,s,h);break e}U&&U(t,g,u),t==="focusout"&&(U=g._wrapperState)&&U.controlled&&g.type==="number"&&wf(g,"number",g.value)}switch(U=u?La(u):window,t){case"focusin":(P0(U)||U.contentEditable==="true")&&(Da=U,Rf=u,yl=null);break;case"focusout":yl=Rf=Da=null;break;case"mousedown":Pf=!0;break;case"contextmenu":case"mouseup":case"dragend":Pf=!1,V0(p,s,h);break;case"selectionchange":if(_k)break;case"keydown":case"keyup":V0(p,s,h)}var b;if(tg)e:{switch(t){case"compositionstart":var m="onCompositionStart";break e;case"compositionend":m="onCompositionEnd";break e;case"compositionupdate":m="onCompositionUpdate";break e}m=void 0}else Pa?ob(t,s)&&(m="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(m="onCompositionStart");m&&(ab&&s.locale!=="ko"&&(Pa||m!=="onCompositionStart"?m==="onCompositionEnd"&&Pa&&(b=ib()):(Kr=h,Jp="value"in Kr?Kr.value:Kr.textContent,Pa=!0)),U=pu(u,m),0<U.length&&(m=new T0(m,t,null,s,h),p.push({event:m,listeners:U}),b?m.data=b:(b=lb(s),b!==null&&(m.data=b)))),(b=hk?mk(t,s):fk(t,s))&&(u=pu(u,"onBeforeInput"),0<u.length&&(h=new T0("onBeforeInput","beforeinput",null,s,h),p.push({event:h,listeners:u}),h.data=b))}wb(p,e)})}function zl(t,e,s){return{instance:t,listener:e,currentTarget:s}}function pu(t,e){for(var s=e+"Capture",r=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Ll(t,s),a!=null&&r.unshift(zl(t,a,i)),a=Ll(t,e),a!=null&&r.push(zl(t,a,i))),t=t.return}return r}function Ea(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $0(t,e,s,r,i){for(var a=e._reactName,o=[];s!==null&&s!==r;){var l=s,d=l.alternate,u=l.stateNode;if(d!==null&&d===r)break;l.tag===5&&u!==null&&(l=u,i?(d=Ll(s,a),d!=null&&o.unshift(zl(s,d,l))):i||(d=Ll(s,a),d!=null&&o.push(zl(s,d,l)))),s=s.return}o.length!==0&&t.push({event:e,listeners:o})}var Sk=/\r\n?/g,Tk=/\u0000|\uFFFD/g;function B0(t){return(typeof t=="string"?t:""+t).replace(Sk,`
`).replace(Tk,"")}function vd(t,e,s){if(e=B0(e),B0(t)!==e&&s)throw Error(ee(425))}function gu(){}var Df=null,Of=null;function Lf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Mf=typeof setTimeout=="function"?setTimeout:void 0,Ck=typeof clearTimeout=="function"?clearTimeout:void 0,z0=typeof Promise=="function"?Promise:void 0,Ak=typeof queueMicrotask=="function"?queueMicrotask:typeof z0<"u"?function(t){return z0.resolve(null).then(t).catch(Rk)}:Mf;function Rk(t){setTimeout(function(){throw t})}function Cm(t,e){var s=e,r=0;do{var i=s.nextSibling;if(t.removeChild(s),i&&i.nodeType===8)if(s=i.data,s==="/$"){if(r===0){t.removeChild(i),Fl(e);return}r--}else s!=="$"&&s!=="$?"&&s!=="$!"||r++;s=i}while(s);Fl(e)}function ei(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function q0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(e===0)return t;e--}else s==="/$"&&e++}t=t.previousSibling}return null}var wo=Math.random().toString(36).slice(2),An="__reactFiber$"+wo,ql="__reactProps$"+wo,fr="__reactContainer$"+wo,Vf="__reactEvents$"+wo,Pk="__reactListeners$"+wo,Dk="__reactHandles$"+wo;function Mi(t){var e=t[An];if(e)return e;for(var s=t.parentNode;s;){if(e=s[fr]||s[An]){if(s=e.alternate,e.child!==null||s!==null&&s.child!==null)for(t=q0(t);t!==null;){if(s=t[An])return s;t=q0(t)}return e}t=s,s=t.parentNode}return null}function bc(t){return t=t[An]||t[fr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function La(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ee(33))}function ch(t){return t[ql]||null}var Ff=[],Ma=-1;function xi(t){return{current:t}}function st(t){0>Ma||(t.current=Ff[Ma],Ff[Ma]=null,Ma--)}function Qe(t,e){Ma++,Ff[Ma]=t.current,t.current=e}var ui={},ls=xi(ui),ks=xi(!1),Wi=ui;function so(t,e){var s=t.type.contextTypes;if(!s)return ui;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in s)i[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Es(t){return t=t.childContextTypes,t!=null}function xu(){st(ks),st(ls)}function H0(t,e,s){if(ls.current!==ui)throw Error(ee(168));Qe(ls,e),Qe(ks,s)}function Nb(t,e,s){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return s;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ee(108,y2(t)||"Unknown",i));return dt({},s,r)}function yu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ui,Wi=ls.current,Qe(ls,t),Qe(ks,ks.current),!0}function W0(t,e,s){var r=t.stateNode;if(!r)throw Error(ee(169));s?(t=Nb(t,e,Wi),r.__reactInternalMemoizedMergedChildContext=t,st(ks),st(ls),Qe(ls,t)):st(ks),Qe(ks,s)}var tr=null,dh=!1,Am=!1;function jb(t){tr===null?tr=[t]:tr.push(t)}function Ok(t){dh=!0,jb(t)}function yi(){if(!Am&&tr!==null){Am=!0;var t=0,e=Ve;try{var s=tr;for(Ve=1;t<s.length;t++){var r=s[t];do r=r(!0);while(r!==null)}tr=null,dh=!1}catch(i){throw tr!==null&&(tr=tr.slice(t+1)),Gw(Gp,yi),i}finally{Ve=e,Am=!1}}return null}var Va=[],Fa=0,vu=null,wu=0,Js=[],Zs=0,Ki=null,nr=1,rr="";function Pi(t,e){Va[Fa++]=wu,Va[Fa++]=vu,vu=t,wu=e}function _b(t,e,s){Js[Zs++]=nr,Js[Zs++]=rr,Js[Zs++]=Ki,Ki=t;var r=nr;t=rr;var i=32-wn(r)-1;r&=~(1<<i),s+=1;var a=32-wn(e)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,nr=1<<32-wn(e)+i|s<<i|r,rr=a+t}else nr=1<<a|s<<i|r,rr=t}function ng(t){t.return!==null&&(Pi(t,1),_b(t,1,0))}function rg(t){for(;t===vu;)vu=Va[--Fa],Va[Fa]=null,wu=Va[--Fa],Va[Fa]=null;for(;t===Ki;)Ki=Js[--Zs],Js[Zs]=null,rr=Js[--Zs],Js[Zs]=null,nr=Js[--Zs],Js[Zs]=null}var Ms=null,Ds=null,at=!1,yn=null;function kb(t,e){var s=tn(5,null,null,0);s.elementType="DELETED",s.stateNode=e,s.return=t,e=t.deletions,e===null?(t.deletions=[s],t.flags|=16):e.push(s)}function K0(t,e){switch(t.tag){case 5:var s=t.type;return e=e.nodeType!==1||s.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ms=t,Ds=ei(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ms=t,Ds=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(s=Ki!==null?{id:nr,overflow:rr}:null,t.memoizedState={dehydrated:e,treeContext:s,retryLane:1073741824},s=tn(18,null,null,0),s.stateNode=e,s.return=t,t.child=s,Ms=t,Ds=null,!0):!1;default:return!1}}function Uf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function $f(t){if(at){var e=Ds;if(e){var s=e;if(!K0(t,e)){if(Uf(t))throw Error(ee(418));e=ei(s.nextSibling);var r=Ms;e&&K0(t,e)?kb(r,s):(t.flags=t.flags&-4097|2,at=!1,Ms=t)}}else{if(Uf(t))throw Error(ee(418));t.flags=t.flags&-4097|2,at=!1,Ms=t}}}function G0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ms=t}function wd(t){if(t!==Ms)return!1;if(!at)return G0(t),at=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Lf(t.type,t.memoizedProps)),e&&(e=Ds)){if(Uf(t))throw Eb(),Error(ee(418));for(;e;)kb(t,e),e=ei(e.nextSibling)}if(G0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ee(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(e===0){Ds=ei(t.nextSibling);break e}e--}else s!=="$"&&s!=="$!"&&s!=="$?"||e++}t=t.nextSibling}Ds=null}}else Ds=Ms?ei(t.stateNode.nextSibling):null;return!0}function Eb(){for(var t=Ds;t;)t=ei(t.nextSibling)}function no(){Ds=Ms=null,at=!1}function ig(t){yn===null?yn=[t]:yn.push(t)}var Lk=kr.ReactCurrentBatchConfig;function Jo(t,e,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(ee(309));var r=s.stateNode}if(!r)throw Error(ee(147,t));var i=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(ee(284));if(!s._owner)throw Error(ee(290,t))}return t}function bd(t,e){throw t=Object.prototype.toString.call(e),Error(ee(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Q0(t){var e=t._init;return e(t._payload)}function Ib(t){function e(N,v){if(t){var k=N.deletions;k===null?(N.deletions=[v],N.flags|=16):k.push(v)}}function s(N,v){if(!t)return null;for(;v!==null;)e(N,v),v=v.sibling;return null}function r(N,v){for(N=new Map;v!==null;)v.key!==null?N.set(v.key,v):N.set(v.index,v),v=v.sibling;return N}function i(N,v){return N=ri(N,v),N.index=0,N.sibling=null,N}function a(N,v,k){return N.index=k,t?(k=N.alternate,k!==null?(k=k.index,k<v?(N.flags|=2,v):k):(N.flags|=2,v)):(N.flags|=1048576,v)}function o(N){return t&&N.alternate===null&&(N.flags|=2),N}function l(N,v,k,P){return v===null||v.tag!==6?(v=Vm(k,N.mode,P),v.return=N,v):(v=i(v,k),v.return=N,v)}function d(N,v,k,P){var O=k.type;return O===Ra?h(N,v,k.props.children,P,k.key):v!==null&&(v.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Fr&&Q0(O)===v.type)?(P=i(v,k.props),P.ref=Jo(N,v,k),P.return=N,P):(P=Yd(k.type,k.key,k.props,null,N.mode,P),P.ref=Jo(N,v,k),P.return=N,P)}function u(N,v,k,P){return v===null||v.tag!==4||v.stateNode.containerInfo!==k.containerInfo||v.stateNode.implementation!==k.implementation?(v=Fm(k,N.mode,P),v.return=N,v):(v=i(v,k.children||[]),v.return=N,v)}function h(N,v,k,P,O){return v===null||v.tag!==7?(v=Bi(k,N.mode,P,O),v.return=N,v):(v=i(v,k),v.return=N,v)}function p(N,v,k){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Vm(""+v,N.mode,k),v.return=N,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case dd:return k=Yd(v.type,v.key,v.props,null,N.mode,k),k.ref=Jo(N,null,v),k.return=N,k;case Aa:return v=Fm(v,N.mode,k),v.return=N,v;case Fr:var P=v._init;return p(N,P(v._payload),k)}if(il(v)||Ko(v))return v=Bi(v,N.mode,k,null),v.return=N,v;bd(N,v)}return null}function g(N,v,k,P){var O=v!==null?v.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return O!==null?null:l(N,v,""+k,P);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case dd:return k.key===O?d(N,v,k,P):null;case Aa:return k.key===O?u(N,v,k,P):null;case Fr:return O=k._init,g(N,v,O(k._payload),P)}if(il(k)||Ko(k))return O!==null?null:h(N,v,k,P,null);bd(N,k)}return null}function y(N,v,k,P,O){if(typeof P=="string"&&P!==""||typeof P=="number")return N=N.get(k)||null,l(v,N,""+P,O);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case dd:return N=N.get(P.key===null?k:P.key)||null,d(v,N,P,O);case Aa:return N=N.get(P.key===null?k:P.key)||null,u(v,N,P,O);case Fr:var U=P._init;return y(N,v,k,U(P._payload),O)}if(il(P)||Ko(P))return N=N.get(k)||null,h(v,N,P,O,null);bd(v,P)}return null}function w(N,v,k,P){for(var O=null,U=null,b=v,m=v=0,j=null;b!==null&&m<k.length;m++){b.index>m?(j=b,b=null):j=b.sibling;var I=g(N,b,k[m],P);if(I===null){b===null&&(b=j);break}t&&b&&I.alternate===null&&e(N,b),v=a(I,v,m),U===null?O=I:U.sibling=I,U=I,b=j}if(m===k.length)return s(N,b),at&&Pi(N,m),O;if(b===null){for(;m<k.length;m++)b=p(N,k[m],P),b!==null&&(v=a(b,v,m),U===null?O=b:U.sibling=b,U=b);return at&&Pi(N,m),O}for(b=r(N,b);m<k.length;m++)j=y(b,N,m,k[m],P),j!==null&&(t&&j.alternate!==null&&b.delete(j.key===null?m:j.key),v=a(j,v,m),U===null?O=j:U.sibling=j,U=j);return t&&b.forEach(function(T){return e(N,T)}),at&&Pi(N,m),O}function C(N,v,k,P){var O=Ko(k);if(typeof O!="function")throw Error(ee(150));if(k=O.call(k),k==null)throw Error(ee(151));for(var U=O=null,b=v,m=v=0,j=null,I=k.next();b!==null&&!I.done;m++,I=k.next()){b.index>m?(j=b,b=null):j=b.sibling;var T=g(N,b,I.value,P);if(T===null){b===null&&(b=j);break}t&&b&&T.alternate===null&&e(N,b),v=a(T,v,m),U===null?O=T:U.sibling=T,U=T,b=j}if(I.done)return s(N,b),at&&Pi(N,m),O;if(b===null){for(;!I.done;m++,I=k.next())I=p(N,I.value,P),I!==null&&(v=a(I,v,m),U===null?O=I:U.sibling=I,U=I);return at&&Pi(N,m),O}for(b=r(N,b);!I.done;m++,I=k.next())I=y(b,N,m,I.value,P),I!==null&&(t&&I.alternate!==null&&b.delete(I.key===null?m:I.key),v=a(I,v,m),U===null?O=I:U.sibling=I,U=I);return t&&b.forEach(function(D){return e(N,D)}),at&&Pi(N,m),O}function E(N,v,k,P){if(typeof k=="object"&&k!==null&&k.type===Ra&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case dd:e:{for(var O=k.key,U=v;U!==null;){if(U.key===O){if(O=k.type,O===Ra){if(U.tag===7){s(N,U.sibling),v=i(U,k.props.children),v.return=N,N=v;break e}}else if(U.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Fr&&Q0(O)===U.type){s(N,U.sibling),v=i(U,k.props),v.ref=Jo(N,U,k),v.return=N,N=v;break e}s(N,U);break}else e(N,U);U=U.sibling}k.type===Ra?(v=Bi(k.props.children,N.mode,P,k.key),v.return=N,N=v):(P=Yd(k.type,k.key,k.props,null,N.mode,P),P.ref=Jo(N,v,k),P.return=N,N=P)}return o(N);case Aa:e:{for(U=k.key;v!==null;){if(v.key===U)if(v.tag===4&&v.stateNode.containerInfo===k.containerInfo&&v.stateNode.implementation===k.implementation){s(N,v.sibling),v=i(v,k.children||[]),v.return=N,N=v;break e}else{s(N,v);break}else e(N,v);v=v.sibling}v=Fm(k,N.mode,P),v.return=N,N=v}return o(N);case Fr:return U=k._init,E(N,v,U(k._payload),P)}if(il(k))return w(N,v,k,P);if(Ko(k))return C(N,v,k,P);bd(N,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,v!==null&&v.tag===6?(s(N,v.sibling),v=i(v,k),v.return=N,N=v):(s(N,v),v=Vm(k,N.mode,P),v.return=N,N=v),o(N)):s(N,v)}return E}var ro=Ib(!0),Sb=Ib(!1),bu=xi(null),Nu=null,Ua=null,ag=null;function og(){ag=Ua=Nu=null}function lg(t){var e=bu.current;st(bu),t._currentValue=e}function Bf(t,e,s){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===s)break;t=t.return}}function Qa(t,e){Nu=t,ag=Ua=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(js=!0),t.firstContext=null)}function an(t){var e=t._currentValue;if(ag!==t)if(t={context:t,memoizedValue:e,next:null},Ua===null){if(Nu===null)throw Error(ee(308));Ua=t,Nu.dependencies={lanes:0,firstContext:t}}else Ua=Ua.next=t;return e}var Vi=null;function cg(t){Vi===null?Vi=[t]:Vi.push(t)}function Tb(t,e,s,r){var i=e.interleaved;return i===null?(s.next=s,cg(e)):(s.next=i.next,i.next=s),e.interleaved=s,pr(t,r)}function pr(t,e){t.lanes|=e;var s=t.alternate;for(s!==null&&(s.lanes|=e),s=t,t=t.return;t!==null;)t.childLanes|=e,s=t.alternate,s!==null&&(s.childLanes|=e),s=t,t=t.return;return s.tag===3?s.stateNode:null}var Ur=!1;function dg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cb(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function lr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ti(t,e,s){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Pe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,pr(t,s)}return i=r.interleaved,i===null?(e.next=e,cg(r)):(e.next=i.next,i.next=e),r.interleaved=e,pr(t,s)}function Hd(t,e,s){if(e=e.updateQueue,e!==null&&(e=e.shared,(s&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,s|=r,e.lanes=s,Qp(t,s)}}function X0(t,e){var s=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,s===r)){var i=null,a=null;if(s=s.firstBaseUpdate,s!==null){do{var o={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};a===null?i=a=o:a=a.next=o,s=s.next}while(s!==null);a===null?i=a=e:a=a.next=e}else i=a=e;s={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=e:t.next=e,s.lastBaseUpdate=e}function ju(t,e,s,r){var i=t.updateQueue;Ur=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var d=l,u=d.next;d.next=null,o===null?a=u:o.next=u,o=d;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=d))}if(a!==null){var p=i.baseState;o=0,h=u=d=null,l=a;do{var g=l.lane,y=l.eventTime;if((r&g)===g){h!==null&&(h=h.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var w=t,C=l;switch(g=e,y=s,C.tag){case 1:if(w=C.payload,typeof w=="function"){p=w.call(y,p,g);break e}p=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=C.payload,g=typeof w=="function"?w.call(y,p,g):w,g==null)break e;p=dt({},p,g);break e;case 2:Ur=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[l]:g.push(l))}else y={eventTime:y,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=y,d=p):h=h.next=y,o|=g;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;g=l,l=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(h===null&&(d=p),i.baseState=d,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);Qi|=o,t.lanes=o,t.memoizedState=p}}function Y0(t,e,s){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=s,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var Nc={},Ln=xi(Nc),Hl=xi(Nc),Wl=xi(Nc);function Fi(t){if(t===Nc)throw Error(ee(174));return t}function ug(t,e){switch(Qe(Wl,e),Qe(Hl,t),Qe(Ln,Nc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Nf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Nf(e,t)}st(Ln),Qe(Ln,e)}function io(){st(Ln),st(Hl),st(Wl)}function Ab(t){Fi(Wl.current);var e=Fi(Ln.current),s=Nf(e,t.type);e!==s&&(Qe(Hl,t),Qe(Ln,s))}function hg(t){Hl.current===t&&(st(Ln),st(Hl))}var ot=xi(0);function _u(t){for(var e=t;e!==null;){if(e.tag===13){var s=e.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rm=[];function mg(){for(var t=0;t<Rm.length;t++)Rm[t]._workInProgressVersionPrimary=null;Rm.length=0}var Wd=kr.ReactCurrentDispatcher,Pm=kr.ReactCurrentBatchConfig,Gi=0,ct=null,Ct=null,Mt=null,ku=!1,vl=!1,Kl=0,Mk=0;function ts(){throw Error(ee(321))}function fg(t,e){if(e===null)return!1;for(var s=0;s<e.length&&s<t.length;s++)if(!Nn(t[s],e[s]))return!1;return!0}function pg(t,e,s,r,i,a){if(Gi=a,ct=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Wd.current=t===null||t.memoizedState===null?$k:Bk,t=s(r,i),vl){a=0;do{if(vl=!1,Kl=0,25<=a)throw Error(ee(301));a+=1,Mt=Ct=null,e.updateQueue=null,Wd.current=zk,t=s(r,i)}while(vl)}if(Wd.current=Eu,e=Ct!==null&&Ct.next!==null,Gi=0,Mt=Ct=ct=null,ku=!1,e)throw Error(ee(300));return t}function gg(){var t=Kl!==0;return Kl=0,t}function Cn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?ct.memoizedState=Mt=t:Mt=Mt.next=t,Mt}function on(){if(Ct===null){var t=ct.alternate;t=t!==null?t.memoizedState:null}else t=Ct.next;var e=Mt===null?ct.memoizedState:Mt.next;if(e!==null)Mt=e,Ct=t;else{if(t===null)throw Error(ee(310));Ct=t,t={memoizedState:Ct.memoizedState,baseState:Ct.baseState,baseQueue:Ct.baseQueue,queue:Ct.queue,next:null},Mt===null?ct.memoizedState=Mt=t:Mt=Mt.next=t}return Mt}function Gl(t,e){return typeof e=="function"?e(t):e}function Dm(t){var e=on(),s=e.queue;if(s===null)throw Error(ee(311));s.lastRenderedReducer=t;var r=Ct,i=r.baseQueue,a=s.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,s.pending=null}if(i!==null){a=i.next,r=r.baseState;var l=o=null,d=null,u=a;do{var h=u.lane;if((Gi&h)===h)d!==null&&(d=d.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var p={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};d===null?(l=d=p,o=r):d=d.next=p,ct.lanes|=h,Qi|=h}u=u.next}while(u!==null&&u!==a);d===null?o=r:d.next=l,Nn(r,e.memoizedState)||(js=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=d,s.lastRenderedState=r}if(t=s.interleaved,t!==null){i=t;do a=i.lane,ct.lanes|=a,Qi|=a,i=i.next;while(i!==t)}else i===null&&(s.lanes=0);return[e.memoizedState,s.dispatch]}function Om(t){var e=on(),s=e.queue;if(s===null)throw Error(ee(311));s.lastRenderedReducer=t;var r=s.dispatch,i=s.pending,a=e.memoizedState;if(i!==null){s.pending=null;var o=i=i.next;do a=t(a,o.action),o=o.next;while(o!==i);Nn(a,e.memoizedState)||(js=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),s.lastRenderedState=a}return[a,r]}function Rb(){}function Pb(t,e){var s=ct,r=on(),i=e(),a=!Nn(r.memoizedState,i);if(a&&(r.memoizedState=i,js=!0),r=r.queue,xg(Lb.bind(null,s,r,t),[t]),r.getSnapshot!==e||a||Mt!==null&&Mt.memoizedState.tag&1){if(s.flags|=2048,Ql(9,Ob.bind(null,s,r,i,e),void 0,null),$t===null)throw Error(ee(349));Gi&30||Db(s,e,i)}return i}function Db(t,e,s){t.flags|=16384,t={getSnapshot:e,value:s},e=ct.updateQueue,e===null?(e={lastEffect:null,stores:null},ct.updateQueue=e,e.stores=[t]):(s=e.stores,s===null?e.stores=[t]:s.push(t))}function Ob(t,e,s,r){e.value=s,e.getSnapshot=r,Mb(e)&&Vb(t)}function Lb(t,e,s){return s(function(){Mb(e)&&Vb(t)})}function Mb(t){var e=t.getSnapshot;t=t.value;try{var s=e();return!Nn(t,s)}catch{return!0}}function Vb(t){var e=pr(t,1);e!==null&&bn(e,t,1,-1)}function J0(t){var e=Cn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gl,lastRenderedState:t},e.queue=t,t=t.dispatch=Uk.bind(null,ct,t),[e.memoizedState,t]}function Ql(t,e,s,r){return t={tag:t,create:e,destroy:s,deps:r,next:null},e=ct.updateQueue,e===null?(e={lastEffect:null,stores:null},ct.updateQueue=e,e.lastEffect=t.next=t):(s=e.lastEffect,s===null?e.lastEffect=t.next=t:(r=s.next,s.next=t,t.next=r,e.lastEffect=t)),t}function Fb(){return on().memoizedState}function Kd(t,e,s,r){var i=Cn();ct.flags|=t,i.memoizedState=Ql(1|e,s,void 0,r===void 0?null:r)}function uh(t,e,s,r){var i=on();r=r===void 0?null:r;var a=void 0;if(Ct!==null){var o=Ct.memoizedState;if(a=o.destroy,r!==null&&fg(r,o.deps)){i.memoizedState=Ql(e,s,a,r);return}}ct.flags|=t,i.memoizedState=Ql(1|e,s,a,r)}function Z0(t,e){return Kd(8390656,8,t,e)}function xg(t,e){return uh(2048,8,t,e)}function Ub(t,e){return uh(4,2,t,e)}function $b(t,e){return uh(4,4,t,e)}function Bb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function zb(t,e,s){return s=s!=null?s.concat([t]):null,uh(4,4,Bb.bind(null,e,t),s)}function yg(){}function qb(t,e){var s=on();e=e===void 0?null:e;var r=s.memoizedState;return r!==null&&e!==null&&fg(e,r[1])?r[0]:(s.memoizedState=[t,e],t)}function Hb(t,e){var s=on();e=e===void 0?null:e;var r=s.memoizedState;return r!==null&&e!==null&&fg(e,r[1])?r[0]:(t=t(),s.memoizedState=[t,e],t)}function Wb(t,e,s){return Gi&21?(Nn(s,e)||(s=Yw(),ct.lanes|=s,Qi|=s,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,js=!0),t.memoizedState=s)}function Vk(t,e){var s=Ve;Ve=s!==0&&4>s?s:4,t(!0);var r=Pm.transition;Pm.transition={};try{t(!1),e()}finally{Ve=s,Pm.transition=r}}function Kb(){return on().memoizedState}function Fk(t,e,s){var r=ni(t);if(s={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null},Gb(t))Qb(e,s);else if(s=Tb(t,e,s,r),s!==null){var i=fs();bn(s,t,r,i),Xb(s,e,r)}}function Uk(t,e,s){var r=ni(t),i={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null};if(Gb(t))Qb(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,l=a(o,s);if(i.hasEagerState=!0,i.eagerState=l,Nn(l,o)){var d=e.interleaved;d===null?(i.next=i,cg(e)):(i.next=d.next,d.next=i),e.interleaved=i;return}}catch{}finally{}s=Tb(t,e,i,r),s!==null&&(i=fs(),bn(s,t,r,i),Xb(s,e,r))}}function Gb(t){var e=t.alternate;return t===ct||e!==null&&e===ct}function Qb(t,e){vl=ku=!0;var s=t.pending;s===null?e.next=e:(e.next=s.next,s.next=e),t.pending=e}function Xb(t,e,s){if(s&4194240){var r=e.lanes;r&=t.pendingLanes,s|=r,e.lanes=s,Qp(t,s)}}var Eu={readContext:an,useCallback:ts,useContext:ts,useEffect:ts,useImperativeHandle:ts,useInsertionEffect:ts,useLayoutEffect:ts,useMemo:ts,useReducer:ts,useRef:ts,useState:ts,useDebugValue:ts,useDeferredValue:ts,useTransition:ts,useMutableSource:ts,useSyncExternalStore:ts,useId:ts,unstable_isNewReconciler:!1},$k={readContext:an,useCallback:function(t,e){return Cn().memoizedState=[t,e===void 0?null:e],t},useContext:an,useEffect:Z0,useImperativeHandle:function(t,e,s){return s=s!=null?s.concat([t]):null,Kd(4194308,4,Bb.bind(null,e,t),s)},useLayoutEffect:function(t,e){return Kd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Kd(4,2,t,e)},useMemo:function(t,e){var s=Cn();return e=e===void 0?null:e,t=t(),s.memoizedState=[t,e],t},useReducer:function(t,e,s){var r=Cn();return e=s!==void 0?s(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Fk.bind(null,ct,t),[r.memoizedState,t]},useRef:function(t){var e=Cn();return t={current:t},e.memoizedState=t},useState:J0,useDebugValue:yg,useDeferredValue:function(t){return Cn().memoizedState=t},useTransition:function(){var t=J0(!1),e=t[0];return t=Vk.bind(null,t[1]),Cn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,s){var r=ct,i=Cn();if(at){if(s===void 0)throw Error(ee(407));s=s()}else{if(s=e(),$t===null)throw Error(ee(349));Gi&30||Db(r,e,s)}i.memoizedState=s;var a={value:s,getSnapshot:e};return i.queue=a,Z0(Lb.bind(null,r,a,t),[t]),r.flags|=2048,Ql(9,Ob.bind(null,r,a,s,e),void 0,null),s},useId:function(){var t=Cn(),e=$t.identifierPrefix;if(at){var s=rr,r=nr;s=(r&~(1<<32-wn(r)-1)).toString(32)+s,e=":"+e+"R"+s,s=Kl++,0<s&&(e+="H"+s.toString(32)),e+=":"}else s=Mk++,e=":"+e+"r"+s.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Bk={readContext:an,useCallback:qb,useContext:an,useEffect:xg,useImperativeHandle:zb,useInsertionEffect:Ub,useLayoutEffect:$b,useMemo:Hb,useReducer:Dm,useRef:Fb,useState:function(){return Dm(Gl)},useDebugValue:yg,useDeferredValue:function(t){var e=on();return Wb(e,Ct.memoizedState,t)},useTransition:function(){var t=Dm(Gl)[0],e=on().memoizedState;return[t,e]},useMutableSource:Rb,useSyncExternalStore:Pb,useId:Kb,unstable_isNewReconciler:!1},zk={readContext:an,useCallback:qb,useContext:an,useEffect:xg,useImperativeHandle:zb,useInsertionEffect:Ub,useLayoutEffect:$b,useMemo:Hb,useReducer:Om,useRef:Fb,useState:function(){return Om(Gl)},useDebugValue:yg,useDeferredValue:function(t){var e=on();return Ct===null?e.memoizedState=t:Wb(e,Ct.memoizedState,t)},useTransition:function(){var t=Om(Gl)[0],e=on().memoizedState;return[t,e]},useMutableSource:Rb,useSyncExternalStore:Pb,useId:Kb,unstable_isNewReconciler:!1};function gn(t,e){if(t&&t.defaultProps){e=dt({},e),t=t.defaultProps;for(var s in t)e[s]===void 0&&(e[s]=t[s]);return e}return e}function zf(t,e,s,r){e=t.memoizedState,s=s(r,e),s=s==null?e:dt({},e,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var hh={isMounted:function(t){return(t=t._reactInternals)?la(t)===t:!1},enqueueSetState:function(t,e,s){t=t._reactInternals;var r=fs(),i=ni(t),a=lr(r,i);a.payload=e,s!=null&&(a.callback=s),e=ti(t,a,i),e!==null&&(bn(e,t,i,r),Hd(e,t,i))},enqueueReplaceState:function(t,e,s){t=t._reactInternals;var r=fs(),i=ni(t),a=lr(r,i);a.tag=1,a.payload=e,s!=null&&(a.callback=s),e=ti(t,a,i),e!==null&&(bn(e,t,i,r),Hd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var s=fs(),r=ni(t),i=lr(s,r);i.tag=2,e!=null&&(i.callback=e),e=ti(t,i,r),e!==null&&(bn(e,t,r,s),Hd(e,t,r))}};function ey(t,e,s,r,i,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,o):e.prototype&&e.prototype.isPureReactComponent?!$l(s,r)||!$l(i,a):!0}function Yb(t,e,s){var r=!1,i=ui,a=e.contextType;return typeof a=="object"&&a!==null?a=an(a):(i=Es(e)?Wi:ls.current,r=e.contextTypes,a=(r=r!=null)?so(t,i):ui),e=new e(s,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=hh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function ty(t,e,s,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(s,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(s,r),e.state!==t&&hh.enqueueReplaceState(e,e.state,null)}function qf(t,e,s,r){var i=t.stateNode;i.props=s,i.state=t.memoizedState,i.refs={},dg(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=an(a):(a=Es(e)?Wi:ls.current,i.context=so(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(zf(t,e,a,s),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&hh.enqueueReplaceState(i,i.state,null),ju(t,s,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ao(t,e){try{var s="",r=e;do s+=x2(r),r=r.return;while(r);var i=s}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function Lm(t,e,s){return{value:t,source:null,stack:s??null,digest:e??null}}function Hf(t,e){try{console.error(e.value)}catch(s){setTimeout(function(){throw s})}}var qk=typeof WeakMap=="function"?WeakMap:Map;function Jb(t,e,s){s=lr(-1,s),s.tag=3,s.payload={element:null};var r=e.value;return s.callback=function(){Su||(Su=!0,tp=r),Hf(t,e)},s}function Zb(t,e,s){s=lr(-1,s),s.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;s.payload=function(){return r(i)},s.callback=function(){Hf(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(s.callback=function(){Hf(t,e),typeof r!="function"&&(si===null?si=new Set([this]):si.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),s}function sy(t,e,s){var r=t.pingCache;if(r===null){r=t.pingCache=new qk;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(s)||(i.add(s),t=rE.bind(null,t,e,s),e.then(t,t))}function ny(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ry(t,e,s,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(e=lr(-1,1),e.tag=2,ti(s,e,1))),s.lanes|=1),t)}var Hk=kr.ReactCurrentOwner,js=!1;function hs(t,e,s,r){e.child=t===null?Sb(e,null,s,r):ro(e,t.child,s,r)}function iy(t,e,s,r,i){s=s.render;var a=e.ref;return Qa(e,i),r=pg(t,e,s,r,a,i),s=gg(),t!==null&&!js?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,gr(t,e,i)):(at&&s&&ng(e),e.flags|=1,hs(t,e,r,i),e.child)}function ay(t,e,s,r,i){if(t===null){var a=s.type;return typeof a=="function"&&!Eg(a)&&a.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(e.tag=15,e.type=a,eN(t,e,a,r,i)):(t=Yd(s.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var o=a.memoizedProps;if(s=s.compare,s=s!==null?s:$l,s(o,r)&&t.ref===e.ref)return gr(t,e,i)}return e.flags|=1,t=ri(a,r),t.ref=e.ref,t.return=e,e.child=t}function eN(t,e,s,r,i){if(t!==null){var a=t.memoizedProps;if($l(a,r)&&t.ref===e.ref)if(js=!1,e.pendingProps=r=a,(t.lanes&i)!==0)t.flags&131072&&(js=!0);else return e.lanes=t.lanes,gr(t,e,i)}return Wf(t,e,s,r,i)}function tN(t,e,s){var r=e.pendingProps,i=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(Ba,Rs),Rs|=s;else{if(!(s&1073741824))return t=a!==null?a.baseLanes|s:s,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Qe(Ba,Rs),Rs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:s,Qe(Ba,Rs),Rs|=r}else a!==null?(r=a.baseLanes|s,e.memoizedState=null):r=s,Qe(Ba,Rs),Rs|=r;return hs(t,e,i,s),e.child}function sN(t,e){var s=e.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(e.flags|=512,e.flags|=2097152)}function Wf(t,e,s,r,i){var a=Es(s)?Wi:ls.current;return a=so(e,a),Qa(e,i),s=pg(t,e,s,r,a,i),r=gg(),t!==null&&!js?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,gr(t,e,i)):(at&&r&&ng(e),e.flags|=1,hs(t,e,s,i),e.child)}function oy(t,e,s,r,i){if(Es(s)){var a=!0;yu(e)}else a=!1;if(Qa(e,i),e.stateNode===null)Gd(t,e),Yb(e,s,r),qf(e,s,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var d=o.context,u=s.contextType;typeof u=="object"&&u!==null?u=an(u):(u=Es(s)?Wi:ls.current,u=so(e,u));var h=s.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||d!==u)&&ty(e,o,r,u),Ur=!1;var g=e.memoizedState;o.state=g,ju(e,r,o,i),d=e.memoizedState,l!==r||g!==d||ks.current||Ur?(typeof h=="function"&&(zf(e,s,h,r),d=e.memoizedState),(l=Ur||ey(e,s,l,r,g,d,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=d),o.props=r,o.state=d,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Cb(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:gn(e.type,l),o.props=u,p=e.pendingProps,g=o.context,d=s.contextType,typeof d=="object"&&d!==null?d=an(d):(d=Es(s)?Wi:ls.current,d=so(e,d));var y=s.getDerivedStateFromProps;(h=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||g!==d)&&ty(e,o,r,d),Ur=!1,g=e.memoizedState,o.state=g,ju(e,r,o,i);var w=e.memoizedState;l!==p||g!==w||ks.current||Ur?(typeof y=="function"&&(zf(e,s,y,r),w=e.memoizedState),(u=Ur||ey(e,s,u,r,g,w,d)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,w,d),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,w,d)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=w),o.props=r,o.state=w,o.context=d,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Kf(t,e,s,r,a,i)}function Kf(t,e,s,r,i,a){sN(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&W0(e,s,!1),gr(t,e,a);r=e.stateNode,Hk.current=e;var l=o&&typeof s.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ro(e,t.child,null,a),e.child=ro(e,null,l,a)):hs(t,e,l,a),e.memoizedState=r.state,i&&W0(e,s,!0),e.child}function nN(t){var e=t.stateNode;e.pendingContext?H0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&H0(t,e.context,!1),ug(t,e.containerInfo)}function ly(t,e,s,r,i){return no(),ig(i),e.flags|=256,hs(t,e,s,r),e.child}var Gf={dehydrated:null,treeContext:null,retryLane:0};function Qf(t){return{baseLanes:t,cachePool:null,transitions:null}}function rN(t,e,s){var r=e.pendingProps,i=ot.current,a=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Qe(ot,i&1),t===null)return $f(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,a?(r=e.mode,a=e.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=ph(o,r,0,null),t=Bi(t,r,s,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Qf(s),e.memoizedState=Gf,t):vg(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return Wk(t,e,o,r,l,i,s);if(a){a=r.fallback,o=e.mode,i=t.child,l=i.sibling;var d={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=d,e.deletions=null):(r=ri(i,d),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=ri(l,a):(a=Bi(a,o,s,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,o=t.child.memoizedState,o=o===null?Qf(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~s,e.memoizedState=Gf,r}return a=t.child,t=a.sibling,r=ri(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=s),r.return=e,r.sibling=null,t!==null&&(s=e.deletions,s===null?(e.deletions=[t],e.flags|=16):s.push(t)),e.child=r,e.memoizedState=null,r}function vg(t,e){return e=ph({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Nd(t,e,s,r){return r!==null&&ig(r),ro(e,t.child,null,s),t=vg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Wk(t,e,s,r,i,a,o){if(s)return e.flags&256?(e.flags&=-257,r=Lm(Error(ee(422))),Nd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=ph({mode:"visible",children:r.children},i,0,null),a=Bi(a,i,o,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&ro(e,t.child,null,o),e.child.memoizedState=Qf(o),e.memoizedState=Gf,a);if(!(e.mode&1))return Nd(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(ee(419)),r=Lm(a,r,void 0),Nd(t,e,o,r)}if(l=(o&t.childLanes)!==0,js||l){if(r=$t,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,pr(t,i),bn(r,t,i,-1))}return kg(),r=Lm(Error(ee(421))),Nd(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=iE.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,Ds=ei(i.nextSibling),Ms=e,at=!0,yn=null,t!==null&&(Js[Zs++]=nr,Js[Zs++]=rr,Js[Zs++]=Ki,nr=t.id,rr=t.overflow,Ki=e),e=vg(e,r.children),e.flags|=4096,e)}function cy(t,e,s){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Bf(t.return,e,s)}function Mm(t,e,s,r,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:s,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=s,a.tailMode=i)}function iN(t,e,s){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(hs(t,e,r.children,s),r=ot.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cy(t,s,e);else if(t.tag===19)cy(t,s,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Qe(ot,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(s=e.child,i=null;s!==null;)t=s.alternate,t!==null&&_u(t)===null&&(i=s),s=s.sibling;s=i,s===null?(i=e.child,e.child=null):(i=s.sibling,s.sibling=null),Mm(e,!1,i,s,a);break;case"backwards":for(s=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&_u(t)===null){e.child=i;break}t=i.sibling,i.sibling=s,s=i,i=t}Mm(e,!0,s,null,a);break;case"together":Mm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Gd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function gr(t,e,s){if(t!==null&&(e.dependencies=t.dependencies),Qi|=e.lanes,!(s&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ee(153));if(e.child!==null){for(t=e.child,s=ri(t,t.pendingProps),e.child=s,s.return=e;t.sibling!==null;)t=t.sibling,s=s.sibling=ri(t,t.pendingProps),s.return=e;s.sibling=null}return e.child}function Kk(t,e,s){switch(e.tag){case 3:nN(e),no();break;case 5:Ab(e);break;case 1:Es(e.type)&&yu(e);break;case 4:ug(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Qe(bu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Qe(ot,ot.current&1),e.flags|=128,null):s&e.child.childLanes?rN(t,e,s):(Qe(ot,ot.current&1),t=gr(t,e,s),t!==null?t.sibling:null);Qe(ot,ot.current&1);break;case 19:if(r=(s&e.childLanes)!==0,t.flags&128){if(r)return iN(t,e,s);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Qe(ot,ot.current),r)break;return null;case 22:case 23:return e.lanes=0,tN(t,e,s)}return gr(t,e,s)}var aN,Xf,oN,lN;aN=function(t,e){for(var s=e.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Xf=function(){};oN=function(t,e,s,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Fi(Ln.current);var a=null;switch(s){case"input":i=yf(t,i),r=yf(t,r),a=[];break;case"select":i=dt({},i,{value:void 0}),r=dt({},r,{value:void 0}),a=[];break;case"textarea":i=bf(t,i),r=bf(t,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=gu)}jf(s,r);var o;s=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(s||(s={}),s[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Dl.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var d=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&d!==l&&(d!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||d&&d.hasOwnProperty(o)||(s||(s={}),s[o]="");for(o in d)d.hasOwnProperty(o)&&l[o]!==d[o]&&(s||(s={}),s[o]=d[o])}else s||(a||(a=[]),a.push(u,s)),s=d;else u==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,l=l?l.__html:void 0,d!=null&&l!==d&&(a=a||[]).push(u,d)):u==="children"?typeof d!="string"&&typeof d!="number"||(a=a||[]).push(u,""+d):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Dl.hasOwnProperty(u)?(d!=null&&u==="onScroll"&&Ze("scroll",t),a||l===d||(a=[])):(a=a||[]).push(u,d))}s&&(a=a||[]).push("style",s);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};lN=function(t,e,s,r){s!==r&&(e.flags|=4)};function Zo(t,e){if(!at)switch(t.tailMode){case"hidden":e=t.tail;for(var s=null;e!==null;)e.alternate!==null&&(s=e),e=e.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ss(t){var e=t.alternate!==null&&t.alternate.child===t.child,s=0,r=0;if(e)for(var i=t.child;i!==null;)s|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)s|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=s,e}function Gk(t,e,s){var r=e.pendingProps;switch(rg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ss(e),null;case 1:return Es(e.type)&&xu(),ss(e),null;case 3:return r=e.stateNode,io(),st(ks),st(ls),mg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(wd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,yn!==null&&(rp(yn),yn=null))),Xf(t,e),ss(e),null;case 5:hg(e);var i=Fi(Wl.current);if(s=e.type,t!==null&&e.stateNode!=null)oN(t,e,s,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ee(166));return ss(e),null}if(t=Fi(Ln.current),wd(e)){r=e.stateNode,s=e.type;var a=e.memoizedProps;switch(r[An]=e,r[ql]=a,t=(e.mode&1)!==0,s){case"dialog":Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":case"embed":Ze("load",r);break;case"video":case"audio":for(i=0;i<ol.length;i++)Ze(ol[i],r);break;case"source":Ze("error",r);break;case"img":case"image":case"link":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"input":y0(r,a),Ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ze("invalid",r);break;case"textarea":w0(r,a),Ze("invalid",r)}jf(s,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&vd(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&vd(r.textContent,l,t),i=["children",""+l]):Dl.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ze("scroll",r)}switch(s){case"input":ud(r),v0(r,a,!0);break;case"textarea":ud(r),b0(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=gu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Lw(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(s,{is:r.is}):(t=o.createElement(s),s==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,s),t[An]=e,t[ql]=r,aN(t,e,!1,!1),e.stateNode=t;e:{switch(o=_f(s,r),s){case"dialog":Ze("cancel",t),Ze("close",t),i=r;break;case"iframe":case"object":case"embed":Ze("load",t),i=r;break;case"video":case"audio":for(i=0;i<ol.length;i++)Ze(ol[i],t);i=r;break;case"source":Ze("error",t),i=r;break;case"img":case"image":case"link":Ze("error",t),Ze("load",t),i=r;break;case"details":Ze("toggle",t),i=r;break;case"input":y0(t,r),i=yf(t,r),Ze("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=dt({},r,{value:void 0}),Ze("invalid",t);break;case"textarea":w0(t,r),i=bf(t,r),Ze("invalid",t);break;default:i=r}jf(s,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var d=l[a];a==="style"?Fw(t,d):a==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&Mw(t,d)):a==="children"?typeof d=="string"?(s!=="textarea"||d!=="")&&Ol(t,d):typeof d=="number"&&Ol(t,""+d):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Dl.hasOwnProperty(a)?d!=null&&a==="onScroll"&&Ze("scroll",t):d!=null&&zp(t,a,d,o))}switch(s){case"input":ud(t),v0(t,r,!1);break;case"textarea":ud(t),b0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+di(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?Ha(t,!!r.multiple,a,!1):r.defaultValue!=null&&Ha(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=gu)}switch(s){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ss(e),null;case 6:if(t&&e.stateNode!=null)lN(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ee(166));if(s=Fi(Wl.current),Fi(Ln.current),wd(e)){if(r=e.stateNode,s=e.memoizedProps,r[An]=e,(a=r.nodeValue!==s)&&(t=Ms,t!==null))switch(t.tag){case 3:vd(r.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&vd(r.nodeValue,s,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(s.nodeType===9?s:s.ownerDocument).createTextNode(r),r[An]=e,e.stateNode=r}return ss(e),null;case 13:if(st(ot),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(at&&Ds!==null&&e.mode&1&&!(e.flags&128))Eb(),no(),e.flags|=98560,a=!1;else if(a=wd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(ee(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ee(317));a[An]=e}else no(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ss(e),a=!1}else yn!==null&&(rp(yn),yn=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=s,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ot.current&1?At===0&&(At=3):kg())),e.updateQueue!==null&&(e.flags|=4),ss(e),null);case 4:return io(),Xf(t,e),t===null&&Bl(e.stateNode.containerInfo),ss(e),null;case 10:return lg(e.type._context),ss(e),null;case 17:return Es(e.type)&&xu(),ss(e),null;case 19:if(st(ot),a=e.memoizedState,a===null)return ss(e),null;if(r=(e.flags&128)!==0,o=a.rendering,o===null)if(r)Zo(a,!1);else{if(At!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=_u(t),o!==null){for(e.flags|=128,Zo(a,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=s,s=e.child;s!==null;)a=s,t=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return Qe(ot,ot.current&1|2),e.child}t=t.sibling}a.tail!==null&&vt()>oo&&(e.flags|=128,r=!0,Zo(a,!1),e.lanes=4194304)}else{if(!r)if(t=_u(o),t!==null){if(e.flags|=128,r=!0,s=t.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),Zo(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!at)return ss(e),null}else 2*vt()-a.renderingStartTime>oo&&s!==1073741824&&(e.flags|=128,r=!0,Zo(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(s=a.last,s!==null?s.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=vt(),e.sibling=null,s=ot.current,Qe(ot,r?s&1|2:s&1),e):(ss(e),null);case 22:case 23:return _g(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Rs&1073741824&&(ss(e),e.subtreeFlags&6&&(e.flags|=8192)):ss(e),null;case 24:return null;case 25:return null}throw Error(ee(156,e.tag))}function Qk(t,e){switch(rg(e),e.tag){case 1:return Es(e.type)&&xu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return io(),st(ks),st(ls),mg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return hg(e),null;case 13:if(st(ot),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ee(340));no()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return st(ot),null;case 4:return io(),null;case 10:return lg(e.type._context),null;case 22:case 23:return _g(),null;case 24:return null;default:return null}}var jd=!1,is=!1,Xk=typeof WeakSet=="function"?WeakSet:Set,oe=null;function $a(t,e){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(r){pt(t,e,r)}else s.current=null}function Yf(t,e,s){try{s()}catch(r){pt(t,e,r)}}var dy=!1;function Yk(t,e){if(Df=mu,t=mb(),sg(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var r=s.getSelection&&s.getSelection();if(r&&r.rangeCount!==0){s=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{s.nodeType,a.nodeType}catch{s=null;break e}var o=0,l=-1,d=-1,u=0,h=0,p=t,g=null;t:for(;;){for(var y;p!==s||i!==0&&p.nodeType!==3||(l=o+i),p!==a||r!==0&&p.nodeType!==3||(d=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(y=p.firstChild)!==null;)g=p,p=y;for(;;){if(p===t)break t;if(g===s&&++u===i&&(l=o),g===a&&++h===r&&(d=o),(y=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=y}s=l===-1||d===-1?null:{start:l,end:d}}else s=null}s=s||{start:0,end:0}}else s=null;for(Of={focusedElem:t,selectionRange:s},mu=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var C=w.memoizedProps,E=w.memoizedState,N=e.stateNode,v=N.getSnapshotBeforeUpdate(e.elementType===e.type?C:gn(e.type,C),E);N.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(P){pt(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return w=dy,dy=!1,w}function wl(t,e,s){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&Yf(e,s,a)}i=i.next}while(i!==r)}}function mh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var s=e=e.next;do{if((s.tag&t)===t){var r=s.create;s.destroy=r()}s=s.next}while(s!==e)}}function Jf(t){var e=t.ref;if(e!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof e=="function"?e(t):e.current=t}}function cN(t){var e=t.alternate;e!==null&&(t.alternate=null,cN(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[An],delete e[ql],delete e[Vf],delete e[Pk],delete e[Dk])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function dN(t){return t.tag===5||t.tag===3||t.tag===4}function uy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||dN(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Zf(t,e,s){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?s.nodeType===8?s.parentNode.insertBefore(t,e):s.insertBefore(t,e):(s.nodeType===8?(e=s.parentNode,e.insertBefore(t,s)):(e=s,e.appendChild(t)),s=s._reactRootContainer,s!=null||e.onclick!==null||(e.onclick=gu));else if(r!==4&&(t=t.child,t!==null))for(Zf(t,e,s),t=t.sibling;t!==null;)Zf(t,e,s),t=t.sibling}function ep(t,e,s){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?s.insertBefore(t,e):s.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ep(t,e,s),t=t.sibling;t!==null;)ep(t,e,s),t=t.sibling}var Wt=null,xn=!1;function Mr(t,e,s){for(s=s.child;s!==null;)uN(t,e,s),s=s.sibling}function uN(t,e,s){if(On&&typeof On.onCommitFiberUnmount=="function")try{On.onCommitFiberUnmount(ih,s)}catch{}switch(s.tag){case 5:is||$a(s,e);case 6:var r=Wt,i=xn;Wt=null,Mr(t,e,s),Wt=r,xn=i,Wt!==null&&(xn?(t=Wt,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):Wt.removeChild(s.stateNode));break;case 18:Wt!==null&&(xn?(t=Wt,s=s.stateNode,t.nodeType===8?Cm(t.parentNode,s):t.nodeType===1&&Cm(t,s),Fl(t)):Cm(Wt,s.stateNode));break;case 4:r=Wt,i=xn,Wt=s.stateNode.containerInfo,xn=!0,Mr(t,e,s),Wt=r,xn=i;break;case 0:case 11:case 14:case 15:if(!is&&(r=s.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Yf(s,e,o),i=i.next}while(i!==r)}Mr(t,e,s);break;case 1:if(!is&&($a(s,e),r=s.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=s.memoizedProps,r.state=s.memoizedState,r.componentWillUnmount()}catch(l){pt(s,e,l)}Mr(t,e,s);break;case 21:Mr(t,e,s);break;case 22:s.mode&1?(is=(r=is)||s.memoizedState!==null,Mr(t,e,s),is=r):Mr(t,e,s);break;default:Mr(t,e,s)}}function hy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new Xk),e.forEach(function(r){var i=aE.bind(null,t,r);s.has(r)||(s.add(r),r.then(i,i))})}}function pn(t,e){var s=e.deletions;if(s!==null)for(var r=0;r<s.length;r++){var i=s[r];try{var a=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Wt=l.stateNode,xn=!1;break e;case 3:Wt=l.stateNode.containerInfo,xn=!0;break e;case 4:Wt=l.stateNode.containerInfo,xn=!0;break e}l=l.return}if(Wt===null)throw Error(ee(160));uN(a,o,i),Wt=null,xn=!1;var d=i.alternate;d!==null&&(d.return=null),i.return=null}catch(u){pt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)hN(e,t),e=e.sibling}function hN(t,e){var s=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(pn(e,t),Tn(t),r&4){try{wl(3,t,t.return),mh(3,t)}catch(C){pt(t,t.return,C)}try{wl(5,t,t.return)}catch(C){pt(t,t.return,C)}}break;case 1:pn(e,t),Tn(t),r&512&&s!==null&&$a(s,s.return);break;case 5:if(pn(e,t),Tn(t),r&512&&s!==null&&$a(s,s.return),t.flags&32){var i=t.stateNode;try{Ol(i,"")}catch(C){pt(t,t.return,C)}}if(r&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,o=s!==null?s.memoizedProps:a,l=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&Dw(i,a),_f(l,o);var u=_f(l,a);for(o=0;o<d.length;o+=2){var h=d[o],p=d[o+1];h==="style"?Fw(i,p):h==="dangerouslySetInnerHTML"?Mw(i,p):h==="children"?Ol(i,p):zp(i,h,p,u)}switch(l){case"input":vf(i,a);break;case"textarea":Ow(i,a);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var y=a.value;y!=null?Ha(i,!!a.multiple,y,!1):g!==!!a.multiple&&(a.defaultValue!=null?Ha(i,!!a.multiple,a.defaultValue,!0):Ha(i,!!a.multiple,a.multiple?[]:"",!1))}i[ql]=a}catch(C){pt(t,t.return,C)}}break;case 6:if(pn(e,t),Tn(t),r&4){if(t.stateNode===null)throw Error(ee(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(C){pt(t,t.return,C)}}break;case 3:if(pn(e,t),Tn(t),r&4&&s!==null&&s.memoizedState.isDehydrated)try{Fl(e.containerInfo)}catch(C){pt(t,t.return,C)}break;case 4:pn(e,t),Tn(t);break;case 13:pn(e,t),Tn(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Ng=vt())),r&4&&hy(t);break;case 22:if(h=s!==null&&s.memoizedState!==null,t.mode&1?(is=(u=is)||h,pn(e,t),is=u):pn(e,t),Tn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(oe=t,h=t.child;h!==null;){for(p=oe=h;oe!==null;){switch(g=oe,y=g.child,g.tag){case 0:case 11:case 14:case 15:wl(4,g,g.return);break;case 1:$a(g,g.return);var w=g.stateNode;if(typeof w.componentWillUnmount=="function"){r=g,s=g.return;try{e=r,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(C){pt(r,s,C)}}break;case 5:$a(g,g.return);break;case 22:if(g.memoizedState!==null){fy(p);continue}}y!==null?(y.return=g,oe=y):fy(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{i=p.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=p.stateNode,d=p.memoizedProps.style,o=d!=null&&d.hasOwnProperty("display")?d.display:null,l.style.display=Vw("display",o))}catch(C){pt(t,t.return,C)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(C){pt(t,t.return,C)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:pn(e,t),Tn(t),r&4&&hy(t);break;case 21:break;default:pn(e,t),Tn(t)}}function Tn(t){var e=t.flags;if(e&2){try{e:{for(var s=t.return;s!==null;){if(dN(s)){var r=s;break e}s=s.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ol(i,""),r.flags&=-33);var a=uy(t);ep(t,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=uy(t);Zf(t,l,o);break;default:throw Error(ee(161))}}catch(d){pt(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Jk(t,e,s){oe=t,mN(t)}function mN(t,e,s){for(var r=(t.mode&1)!==0;oe!==null;){var i=oe,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||jd;if(!o){var l=i.alternate,d=l!==null&&l.memoizedState!==null||is;l=jd;var u=is;if(jd=o,(is=d)&&!u)for(oe=i;oe!==null;)o=oe,d=o.child,o.tag===22&&o.memoizedState!==null?py(i):d!==null?(d.return=o,oe=d):py(i);for(;a!==null;)oe=a,mN(a),a=a.sibling;oe=i,jd=l,is=u}my(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,oe=a):my(t)}}function my(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var s=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:is||mh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!is)if(s===null)r.componentDidMount();else{var i=e.elementType===e.type?s.memoizedProps:gn(e.type,s.memoizedProps);r.componentDidUpdate(i,s.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&Y0(e,a,r);break;case 3:var o=e.updateQueue;if(o!==null){if(s=null,e.child!==null)switch(e.child.tag){case 5:s=e.child.stateNode;break;case 1:s=e.child.stateNode}Y0(e,o,s)}break;case 5:var l=e.stateNode;if(s===null&&e.flags&4){s=l;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&s.focus();break;case"img":d.src&&(s.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&Fl(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}is||e.flags&512&&Jf(e)}catch(g){pt(e,e.return,g)}}if(e===t){oe=null;break}if(s=e.sibling,s!==null){s.return=e.return,oe=s;break}oe=e.return}}function fy(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var s=e.sibling;if(s!==null){s.return=e.return,oe=s;break}oe=e.return}}function py(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var s=e.return;try{mh(4,e)}catch(d){pt(e,s,d)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(d){pt(e,i,d)}}var a=e.return;try{Jf(e)}catch(d){pt(e,a,d)}break;case 5:var o=e.return;try{Jf(e)}catch(d){pt(e,o,d)}}}catch(d){pt(e,e.return,d)}if(e===t){oe=null;break}var l=e.sibling;if(l!==null){l.return=e.return,oe=l;break}oe=e.return}}var Zk=Math.ceil,Iu=kr.ReactCurrentDispatcher,wg=kr.ReactCurrentOwner,nn=kr.ReactCurrentBatchConfig,Pe=0,$t=null,Et=null,Gt=0,Rs=0,Ba=xi(0),At=0,Xl=null,Qi=0,fh=0,bg=0,bl=null,bs=null,Ng=0,oo=1/0,er=null,Su=!1,tp=null,si=null,_d=!1,Gr=null,Tu=0,Nl=0,sp=null,Qd=-1,Xd=0;function fs(){return Pe&6?vt():Qd!==-1?Qd:Qd=vt()}function ni(t){return t.mode&1?Pe&2&&Gt!==0?Gt&-Gt:Lk.transition!==null?(Xd===0&&(Xd=Yw()),Xd):(t=Ve,t!==0||(t=window.event,t=t===void 0?16:rb(t.type)),t):1}function bn(t,e,s,r){if(50<Nl)throw Nl=0,sp=null,Error(ee(185));vc(t,s,r),(!(Pe&2)||t!==$t)&&(t===$t&&(!(Pe&2)&&(fh|=s),At===4&&Br(t,Gt)),Is(t,r),s===1&&Pe===0&&!(e.mode&1)&&(oo=vt()+500,dh&&yi()))}function Is(t,e){var s=t.callbackNode;L2(t,e);var r=hu(t,t===$t?Gt:0);if(r===0)s!==null&&_0(s),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(s!=null&&_0(s),e===1)t.tag===0?Ok(gy.bind(null,t)):jb(gy.bind(null,t)),Ak(function(){!(Pe&6)&&yi()}),s=null;else{switch(Jw(r)){case 1:s=Gp;break;case 4:s=Qw;break;case 16:s=uu;break;case 536870912:s=Xw;break;default:s=uu}s=bN(s,fN.bind(null,t))}t.callbackPriority=e,t.callbackNode=s}}function fN(t,e){if(Qd=-1,Xd=0,Pe&6)throw Error(ee(327));var s=t.callbackNode;if(Xa()&&t.callbackNode!==s)return null;var r=hu(t,t===$t?Gt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Cu(t,r);else{e=r;var i=Pe;Pe|=2;var a=gN();($t!==t||Gt!==e)&&(er=null,oo=vt()+500,$i(t,e));do try{sE();break}catch(l){pN(t,l)}while(!0);og(),Iu.current=a,Pe=i,Et!==null?e=0:($t=null,Gt=0,e=At)}if(e!==0){if(e===2&&(i=Tf(t),i!==0&&(r=i,e=np(t,i))),e===1)throw s=Xl,$i(t,0),Br(t,r),Is(t,vt()),s;if(e===6)Br(t,r);else{if(i=t.current.alternate,!(r&30)&&!eE(i)&&(e=Cu(t,r),e===2&&(a=Tf(t),a!==0&&(r=a,e=np(t,a))),e===1))throw s=Xl,$i(t,0),Br(t,r),Is(t,vt()),s;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ee(345));case 2:Di(t,bs,er);break;case 3:if(Br(t,r),(r&130023424)===r&&(e=Ng+500-vt(),10<e)){if(hu(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){fs(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Mf(Di.bind(null,t,bs,er),e);break}Di(t,bs,er);break;case 4:if(Br(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-wn(r);a=1<<o,o=e[o],o>i&&(i=o),r&=~a}if(r=i,r=vt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Zk(r/1960))-r,10<r){t.timeoutHandle=Mf(Di.bind(null,t,bs,er),r);break}Di(t,bs,er);break;case 5:Di(t,bs,er);break;default:throw Error(ee(329))}}}return Is(t,vt()),t.callbackNode===s?fN.bind(null,t):null}function np(t,e){var s=bl;return t.current.memoizedState.isDehydrated&&($i(t,e).flags|=256),t=Cu(t,e),t!==2&&(e=bs,bs=s,e!==null&&rp(e)),t}function rp(t){bs===null?bs=t:bs.push.apply(bs,t)}function eE(t){for(var e=t;;){if(e.flags&16384){var s=e.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var r=0;r<s.length;r++){var i=s[r],a=i.getSnapshot;i=i.value;try{if(!Nn(a(),i))return!1}catch{return!1}}}if(s=e.child,e.subtreeFlags&16384&&s!==null)s.return=e,e=s;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Br(t,e){for(e&=~bg,e&=~fh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var s=31-wn(e),r=1<<s;t[s]=-1,e&=~r}}function gy(t){if(Pe&6)throw Error(ee(327));Xa();var e=hu(t,0);if(!(e&1))return Is(t,vt()),null;var s=Cu(t,e);if(t.tag!==0&&s===2){var r=Tf(t);r!==0&&(e=r,s=np(t,r))}if(s===1)throw s=Xl,$i(t,0),Br(t,e),Is(t,vt()),s;if(s===6)throw Error(ee(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Di(t,bs,er),Is(t,vt()),null}function jg(t,e){var s=Pe;Pe|=1;try{return t(e)}finally{Pe=s,Pe===0&&(oo=vt()+500,dh&&yi())}}function Xi(t){Gr!==null&&Gr.tag===0&&!(Pe&6)&&Xa();var e=Pe;Pe|=1;var s=nn.transition,r=Ve;try{if(nn.transition=null,Ve=1,t)return t()}finally{Ve=r,nn.transition=s,Pe=e,!(Pe&6)&&yi()}}function _g(){Rs=Ba.current,st(Ba)}function $i(t,e){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,Ck(s)),Et!==null)for(s=Et.return;s!==null;){var r=s;switch(rg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&xu();break;case 3:io(),st(ks),st(ls),mg();break;case 5:hg(r);break;case 4:io();break;case 13:st(ot);break;case 19:st(ot);break;case 10:lg(r.type._context);break;case 22:case 23:_g()}s=s.return}if($t=t,Et=t=ri(t.current,null),Gt=Rs=e,At=0,Xl=null,bg=fh=Qi=0,bs=bl=null,Vi!==null){for(e=0;e<Vi.length;e++)if(s=Vi[e],r=s.interleaved,r!==null){s.interleaved=null;var i=r.next,a=s.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}s.pending=r}Vi=null}return t}function pN(t,e){do{var s=Et;try{if(og(),Wd.current=Eu,ku){for(var r=ct.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ku=!1}if(Gi=0,Mt=Ct=ct=null,vl=!1,Kl=0,wg.current=null,s===null||s.return===null){At=1,Xl=e,Et=null;break}e:{var a=t,o=s.return,l=s,d=e;if(e=Gt,l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var u=d,h=l,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var y=ny(o);if(y!==null){y.flags&=-257,ry(y,o,l,a,e),y.mode&1&&sy(a,u,e),e=y,d=u;var w=e.updateQueue;if(w===null){var C=new Set;C.add(d),e.updateQueue=C}else w.add(d);break e}else{if(!(e&1)){sy(a,u,e),kg();break e}d=Error(ee(426))}}else if(at&&l.mode&1){var E=ny(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),ry(E,o,l,a,e),ig(ao(d,l));break e}}a=d=ao(d,l),At!==4&&(At=2),bl===null?bl=[a]:bl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var N=Jb(a,d,e);X0(a,N);break e;case 1:l=d;var v=a.type,k=a.stateNode;if(!(a.flags&128)&&(typeof v.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(si===null||!si.has(k)))){a.flags|=65536,e&=-e,a.lanes|=e;var P=Zb(a,l,e);X0(a,P);break e}}a=a.return}while(a!==null)}yN(s)}catch(O){e=O,Et===s&&s!==null&&(Et=s=s.return);continue}break}while(!0)}function gN(){var t=Iu.current;return Iu.current=Eu,t===null?Eu:t}function kg(){(At===0||At===3||At===2)&&(At=4),$t===null||!(Qi&268435455)&&!(fh&268435455)||Br($t,Gt)}function Cu(t,e){var s=Pe;Pe|=2;var r=gN();($t!==t||Gt!==e)&&(er=null,$i(t,e));do try{tE();break}catch(i){pN(t,i)}while(!0);if(og(),Pe=s,Iu.current=r,Et!==null)throw Error(ee(261));return $t=null,Gt=0,At}function tE(){for(;Et!==null;)xN(Et)}function sE(){for(;Et!==null&&!I2();)xN(Et)}function xN(t){var e=wN(t.alternate,t,Rs);t.memoizedProps=t.pendingProps,e===null?yN(t):Et=e,wg.current=null}function yN(t){var e=t;do{var s=e.alternate;if(t=e.return,e.flags&32768){if(s=Qk(s,e),s!==null){s.flags&=32767,Et=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{At=6,Et=null;return}}else if(s=Gk(s,e,Rs),s!==null){Et=s;return}if(e=e.sibling,e!==null){Et=e;return}Et=e=t}while(e!==null);At===0&&(At=5)}function Di(t,e,s){var r=Ve,i=nn.transition;try{nn.transition=null,Ve=1,nE(t,e,s,r)}finally{nn.transition=i,Ve=r}return null}function nE(t,e,s,r){do Xa();while(Gr!==null);if(Pe&6)throw Error(ee(327));s=t.finishedWork;var i=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(ee(177));t.callbackNode=null,t.callbackPriority=0;var a=s.lanes|s.childLanes;if(M2(t,a),t===$t&&(Et=$t=null,Gt=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||_d||(_d=!0,bN(uu,function(){return Xa(),null})),a=(s.flags&15990)!==0,s.subtreeFlags&15990||a){a=nn.transition,nn.transition=null;var o=Ve;Ve=1;var l=Pe;Pe|=4,wg.current=null,Yk(t,s),hN(s,t),jk(Of),mu=!!Df,Of=Df=null,t.current=s,Jk(s),S2(),Pe=l,Ve=o,nn.transition=a}else t.current=s;if(_d&&(_d=!1,Gr=t,Tu=i),a=t.pendingLanes,a===0&&(si=null),A2(s.stateNode),Is(t,vt()),e!==null)for(r=t.onRecoverableError,s=0;s<e.length;s++)i=e[s],r(i.value,{componentStack:i.stack,digest:i.digest});if(Su)throw Su=!1,t=tp,tp=null,t;return Tu&1&&t.tag!==0&&Xa(),a=t.pendingLanes,a&1?t===sp?Nl++:(Nl=0,sp=t):Nl=0,yi(),null}function Xa(){if(Gr!==null){var t=Jw(Tu),e=nn.transition,s=Ve;try{if(nn.transition=null,Ve=16>t?16:t,Gr===null)var r=!1;else{if(t=Gr,Gr=null,Tu=0,Pe&6)throw Error(ee(331));var i=Pe;for(Pe|=4,oe=t.current;oe!==null;){var a=oe,o=a.child;if(oe.flags&16){var l=a.deletions;if(l!==null){for(var d=0;d<l.length;d++){var u=l[d];for(oe=u;oe!==null;){var h=oe;switch(h.tag){case 0:case 11:case 15:wl(8,h,a)}var p=h.child;if(p!==null)p.return=h,oe=p;else for(;oe!==null;){h=oe;var g=h.sibling,y=h.return;if(cN(h),h===u){oe=null;break}if(g!==null){g.return=y,oe=g;break}oe=y}}}var w=a.alternate;if(w!==null){var C=w.child;if(C!==null){w.child=null;do{var E=C.sibling;C.sibling=null,C=E}while(C!==null)}}oe=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,oe=o;else e:for(;oe!==null;){if(a=oe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:wl(9,a,a.return)}var N=a.sibling;if(N!==null){N.return=a.return,oe=N;break e}oe=a.return}}var v=t.current;for(oe=v;oe!==null;){o=oe;var k=o.child;if(o.subtreeFlags&2064&&k!==null)k.return=o,oe=k;else e:for(o=v;oe!==null;){if(l=oe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:mh(9,l)}}catch(O){pt(l,l.return,O)}if(l===o){oe=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,oe=P;break e}oe=l.return}}if(Pe=i,yi(),On&&typeof On.onPostCommitFiberRoot=="function")try{On.onPostCommitFiberRoot(ih,t)}catch{}r=!0}return r}finally{Ve=s,nn.transition=e}}return!1}function xy(t,e,s){e=ao(s,e),e=Jb(t,e,1),t=ti(t,e,1),e=fs(),t!==null&&(vc(t,1,e),Is(t,e))}function pt(t,e,s){if(t.tag===3)xy(t,t,s);else for(;e!==null;){if(e.tag===3){xy(e,t,s);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(si===null||!si.has(r))){t=ao(s,t),t=Zb(e,t,1),e=ti(e,t,1),t=fs(),e!==null&&(vc(e,1,t),Is(e,t));break}}e=e.return}}function rE(t,e,s){var r=t.pingCache;r!==null&&r.delete(e),e=fs(),t.pingedLanes|=t.suspendedLanes&s,$t===t&&(Gt&s)===s&&(At===4||At===3&&(Gt&130023424)===Gt&&500>vt()-Ng?$i(t,0):bg|=s),Is(t,e)}function vN(t,e){e===0&&(t.mode&1?(e=fd,fd<<=1,!(fd&130023424)&&(fd=4194304)):e=1);var s=fs();t=pr(t,e),t!==null&&(vc(t,e,s),Is(t,s))}function iE(t){var e=t.memoizedState,s=0;e!==null&&(s=e.retryLane),vN(t,s)}function aE(t,e){var s=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(s=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(e),vN(t,s)}var wN;wN=function(t,e,s){if(t!==null)if(t.memoizedProps!==e.pendingProps||ks.current)js=!0;else{if(!(t.lanes&s)&&!(e.flags&128))return js=!1,Kk(t,e,s);js=!!(t.flags&131072)}else js=!1,at&&e.flags&1048576&&_b(e,wu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Gd(t,e),t=e.pendingProps;var i=so(e,ls.current);Qa(e,s),i=pg(null,e,r,t,i,s);var a=gg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Es(r)?(a=!0,yu(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,dg(e),i.updater=hh,e.stateNode=i,i._reactInternals=e,qf(e,r,t,s),e=Kf(null,e,r,!0,a,s)):(e.tag=0,at&&a&&ng(e),hs(null,e,i,s),e=e.child),e;case 16:r=e.elementType;e:{switch(Gd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=lE(r),t=gn(r,t),i){case 0:e=Wf(null,e,r,t,s);break e;case 1:e=oy(null,e,r,t,s);break e;case 11:e=iy(null,e,r,t,s);break e;case 14:e=ay(null,e,r,gn(r.type,t),s);break e}throw Error(ee(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:gn(r,i),Wf(t,e,r,i,s);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:gn(r,i),oy(t,e,r,i,s);case 3:e:{if(nN(e),t===null)throw Error(ee(387));r=e.pendingProps,a=e.memoizedState,i=a.element,Cb(t,e),ju(e,r,null,s);var o=e.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=ao(Error(ee(423)),e),e=ly(t,e,r,s,i);break e}else if(r!==i){i=ao(Error(ee(424)),e),e=ly(t,e,r,s,i);break e}else for(Ds=ei(e.stateNode.containerInfo.firstChild),Ms=e,at=!0,yn=null,s=Sb(e,null,r,s),e.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(no(),r===i){e=gr(t,e,s);break e}hs(t,e,r,s)}e=e.child}return e;case 5:return Ab(e),t===null&&$f(e),r=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,o=i.children,Lf(r,i)?o=null:a!==null&&Lf(r,a)&&(e.flags|=32),sN(t,e),hs(t,e,o,s),e.child;case 6:return t===null&&$f(e),null;case 13:return rN(t,e,s);case 4:return ug(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ro(e,null,r,s):hs(t,e,r,s),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:gn(r,i),iy(t,e,r,i,s);case 7:return hs(t,e,e.pendingProps,s),e.child;case 8:return hs(t,e,e.pendingProps.children,s),e.child;case 12:return hs(t,e,e.pendingProps.children,s),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,o=i.value,Qe(bu,r._currentValue),r._currentValue=o,a!==null)if(Nn(a.value,o)){if(a.children===i.children&&!ks.current){e=gr(t,e,s);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var d=l.firstContext;d!==null;){if(d.context===r){if(a.tag===1){d=lr(-1,s&-s),d.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?d.next=d:(d.next=h.next,h.next=d),u.pending=d}}a.lanes|=s,d=a.alternate,d!==null&&(d.lanes|=s),Bf(a.return,s,e),l.lanes|=s;break}d=d.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(ee(341));o.lanes|=s,l=o.alternate,l!==null&&(l.lanes|=s),Bf(o,s,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}hs(t,e,i.children,s),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Qa(e,s),i=an(i),r=r(i),e.flags|=1,hs(t,e,r,s),e.child;case 14:return r=e.type,i=gn(r,e.pendingProps),i=gn(r.type,i),ay(t,e,r,i,s);case 15:return eN(t,e,e.type,e.pendingProps,s);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:gn(r,i),Gd(t,e),e.tag=1,Es(r)?(t=!0,yu(e)):t=!1,Qa(e,s),Yb(e,r,i),qf(e,r,i,s),Kf(null,e,r,!0,t,s);case 19:return iN(t,e,s);case 22:return tN(t,e,s)}throw Error(ee(156,e.tag))};function bN(t,e){return Gw(t,e)}function oE(t,e,s,r){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tn(t,e,s,r){return new oE(t,e,s,r)}function Eg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function lE(t){if(typeof t=="function")return Eg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Hp)return 11;if(t===Wp)return 14}return 2}function ri(t,e){var s=t.alternate;return s===null?(s=tn(t.tag,e,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=e,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,e=t.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function Yd(t,e,s,r,i,a){var o=2;if(r=t,typeof t=="function")Eg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ra:return Bi(s.children,i,a,e);case qp:o=8,i|=8;break;case ff:return t=tn(12,s,e,i|2),t.elementType=ff,t.lanes=a,t;case pf:return t=tn(13,s,e,i),t.elementType=pf,t.lanes=a,t;case gf:return t=tn(19,s,e,i),t.elementType=gf,t.lanes=a,t;case Aw:return ph(s,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Tw:o=10;break e;case Cw:o=9;break e;case Hp:o=11;break e;case Wp:o=14;break e;case Fr:o=16,r=null;break e}throw Error(ee(130,t==null?t:typeof t,""))}return e=tn(o,s,e,i),e.elementType=t,e.type=r,e.lanes=a,e}function Bi(t,e,s,r){return t=tn(7,t,r,e),t.lanes=s,t}function ph(t,e,s,r){return t=tn(22,t,r,e),t.elementType=Aw,t.lanes=s,t.stateNode={isHidden:!1},t}function Vm(t,e,s){return t=tn(6,t,null,e),t.lanes=s,t}function Fm(t,e,s){return e=tn(4,t.children!==null?t.children:[],t.key,e),e.lanes=s,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function cE(t,e,s,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vm(0),this.expirationTimes=vm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vm(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ig(t,e,s,r,i,a,o,l,d){return t=new cE(t,e,s,l,d),e===1?(e=1,a===!0&&(e|=8)):e=0,a=tn(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},dg(a),t}function dE(t,e,s){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Aa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:s}}function NN(t){if(!t)return ui;t=t._reactInternals;e:{if(la(t)!==t||t.tag!==1)throw Error(ee(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Es(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ee(171))}if(t.tag===1){var s=t.type;if(Es(s))return Nb(t,s,e)}return e}function jN(t,e,s,r,i,a,o,l,d){return t=Ig(s,r,!0,t,i,a,o,l,d),t.context=NN(null),s=t.current,r=fs(),i=ni(s),a=lr(r,i),a.callback=e??null,ti(s,a,i),t.current.lanes=i,vc(t,i,r),Is(t,r),t}function gh(t,e,s,r){var i=e.current,a=fs(),o=ni(i);return s=NN(s),e.context===null?e.context=s:e.pendingContext=s,e=lr(a,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ti(i,e,o),t!==null&&(bn(t,i,o,a),Hd(t,i,o)),o}function Au(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function yy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<e?s:e}}function Sg(t,e){yy(t,e),(t=t.alternate)&&yy(t,e)}function uE(){return null}var _N=typeof reportError=="function"?reportError:function(t){console.error(t)};function Tg(t){this._internalRoot=t}xh.prototype.render=Tg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ee(409));gh(t,e,null,null)};xh.prototype.unmount=Tg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Xi(function(){gh(null,t,null,null)}),e[fr]=null}};function xh(t){this._internalRoot=t}xh.prototype.unstable_scheduleHydration=function(t){if(t){var e=tb();t={blockedOn:null,target:t,priority:e};for(var s=0;s<$r.length&&e!==0&&e<$r[s].priority;s++);$r.splice(s,0,t),s===0&&nb(t)}};function Cg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function yh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function vy(){}function hE(t,e,s,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var u=Au(o);a.call(u)}}var o=jN(e,r,t,0,null,!1,!1,"",vy);return t._reactRootContainer=o,t[fr]=o.current,Bl(t.nodeType===8?t.parentNode:t),Xi(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Au(d);l.call(u)}}var d=Ig(t,0,!1,null,null,!1,!1,"",vy);return t._reactRootContainer=d,t[fr]=d.current,Bl(t.nodeType===8?t.parentNode:t),Xi(function(){gh(e,d,s,r)}),d}function vh(t,e,s,r,i){var a=s._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var d=Au(o);l.call(d)}}gh(e,o,t,i)}else o=hE(s,e,t,i,r);return Au(o)}Zw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var s=al(e.pendingLanes);s!==0&&(Qp(e,s|1),Is(e,vt()),!(Pe&6)&&(oo=vt()+500,yi()))}break;case 13:Xi(function(){var r=pr(t,1);if(r!==null){var i=fs();bn(r,t,1,i)}}),Sg(t,1)}};Xp=function(t){if(t.tag===13){var e=pr(t,134217728);if(e!==null){var s=fs();bn(e,t,134217728,s)}Sg(t,134217728)}};eb=function(t){if(t.tag===13){var e=ni(t),s=pr(t,e);if(s!==null){var r=fs();bn(s,t,e,r)}Sg(t,e)}};tb=function(){return Ve};sb=function(t,e){var s=Ve;try{return Ve=t,e()}finally{Ve=s}};Ef=function(t,e,s){switch(e){case"input":if(vf(t,s),e=s.name,s.type==="radio"&&e!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<s.length;e++){var r=s[e];if(r!==t&&r.form===t.form){var i=ch(r);if(!i)throw Error(ee(90));Pw(r),vf(r,i)}}}break;case"textarea":Ow(t,s);break;case"select":e=s.value,e!=null&&Ha(t,!!s.multiple,e,!1)}};Bw=jg;zw=Xi;var mE={usingClientEntryPoint:!1,Events:[bc,La,ch,Uw,$w,jg]},el={findFiberByHostInstance:Mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fE={bundleType:el.bundleType,version:el.version,rendererPackageName:el.rendererPackageName,rendererConfig:el.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:kr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ww(t),t===null?null:t.stateNode},findFiberByHostInstance:el.findFiberByHostInstance||uE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kd.isDisabled&&kd.supportsFiber)try{ih=kd.inject(fE),On=kd}catch{}}Bs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mE;Bs.createPortal=function(t,e){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cg(e))throw Error(ee(200));return dE(t,e,null,s)};Bs.createRoot=function(t,e){if(!Cg(t))throw Error(ee(299));var s=!1,r="",i=_N;return e!=null&&(e.unstable_strictMode===!0&&(s=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Ig(t,1,!1,null,null,s,!1,r,i),t[fr]=e.current,Bl(t.nodeType===8?t.parentNode:t),new Tg(e)};Bs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ee(188)):(t=Object.keys(t).join(","),Error(ee(268,t)));return t=Ww(e),t=t===null?null:t.stateNode,t};Bs.flushSync=function(t){return Xi(t)};Bs.hydrate=function(t,e,s){if(!yh(e))throw Error(ee(200));return vh(null,t,e,!0,s)};Bs.hydrateRoot=function(t,e,s){if(!Cg(t))throw Error(ee(405));var r=s!=null&&s.hydratedSources||null,i=!1,a="",o=_N;if(s!=null&&(s.unstable_strictMode===!0&&(i=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onRecoverableError!==void 0&&(o=s.onRecoverableError)),e=jN(e,null,t,1,s??null,i,!1,a,o),t[fr]=e.current,Bl(t),r)for(t=0;t<r.length;t++)s=r[t],i=s._getVersion,i=i(s._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[s,i]:e.mutableSourceEagerHydrationData.push(s,i);return new xh(e)};Bs.render=function(t,e,s){if(!yh(e))throw Error(ee(200));return vh(null,t,e,!1,s)};Bs.unmountComponentAtNode=function(t){if(!yh(t))throw Error(ee(40));return t._reactRootContainer?(Xi(function(){vh(null,null,t,!1,function(){t._reactRootContainer=null,t[fr]=null})}),!0):!1};Bs.unstable_batchedUpdates=jg;Bs.unstable_renderSubtreeIntoContainer=function(t,e,s,r){if(!yh(s))throw Error(ee(200));if(t==null||t._reactInternals===void 0)throw Error(ee(38));return vh(t,e,s,!1,r)};Bs.version="18.3.1-next-f1338f8080-20240426";function kN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kN)}catch(t){console.error(t)}}kN(),kw.exports=Bs;var pE=kw.exports,wy=pE;hf.createRoot=wy.createRoot,hf.hydrateRoot=wy.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yl(){return Yl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Yl.apply(this,arguments)}var Qr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Qr||(Qr={}));const by="popstate";function gE(t){t===void 0&&(t={});function e(r,i){let{pathname:a,search:o,hash:l}=r.location;return ip("",{pathname:a,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function s(r,i){return typeof i=="string"?i:Ru(i)}return yE(e,s,null,t)}function wt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function EN(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function xE(){return Math.random().toString(36).substr(2,8)}function Ny(t,e){return{usr:t.state,key:t.key,idx:e}}function ip(t,e,s,r){return s===void 0&&(s=null),Yl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?bo(e):e,{state:s,key:e&&e.key||r||xE()})}function Ru(t){let{pathname:e="/",search:s="",hash:r=""}=t;return s&&s!=="?"&&(e+=s.charAt(0)==="?"?s:"?"+s),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function bo(t){let e={};if(t){let s=t.indexOf("#");s>=0&&(e.hash=t.substr(s),t=t.substr(0,s));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function yE(t,e,s,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,l=Qr.Pop,d=null,u=h();u==null&&(u=0,o.replaceState(Yl({},o.state,{idx:u}),""));function h(){return(o.state||{idx:null}).idx}function p(){l=Qr.Pop;let E=h(),N=E==null?null:E-u;u=E,d&&d({action:l,location:C.location,delta:N})}function g(E,N){l=Qr.Push;let v=ip(C.location,E,N);u=h()+1;let k=Ny(v,u),P=C.createHref(v);try{o.pushState(k,"",P)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;i.location.assign(P)}a&&d&&d({action:l,location:C.location,delta:1})}function y(E,N){l=Qr.Replace;let v=ip(C.location,E,N);u=h();let k=Ny(v,u),P=C.createHref(v);o.replaceState(k,"",P),a&&d&&d({action:l,location:C.location,delta:0})}function w(E){let N=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof E=="string"?E:Ru(E);return v=v.replace(/ $/,"%20"),wt(N,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,N)}let C={get action(){return l},get location(){return t(i,o)},listen(E){if(d)throw new Error("A history only accepts one active listener");return i.addEventListener(by,p),d=E,()=>{i.removeEventListener(by,p),d=null}},createHref(E){return e(i,E)},createURL:w,encodeLocation(E){let N=w(E);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:g,replace:y,go(E){return o.go(E)}};return C}var jy;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(jy||(jy={}));function vE(t,e,s){return s===void 0&&(s="/"),wE(t,e,s)}function wE(t,e,s,r){let i=typeof e=="string"?bo(e):e,a=Ag(i.pathname||"/",s);if(a==null)return null;let o=IN(t);bE(o);let l=null;for(let d=0;l==null&&d<o.length;++d){let u=PE(a);l=CE(o[d],u)}return l}function IN(t,e,s,r){e===void 0&&(e=[]),s===void 0&&(s=[]),r===void 0&&(r="");let i=(a,o,l)=>{let d={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};d.relativePath.startsWith("/")&&(wt(d.relativePath.startsWith(r),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(r.length));let u=ii([r,d.relativePath]),h=s.concat(d);a.children&&a.children.length>0&&(wt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),IN(a.children,e,h,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:SE(u,a.index),routesMeta:h})};return t.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))i(a,o);else for(let d of SN(a.path))i(a,o,d)}),e}function SN(t){let e=t.split("/");if(e.length===0)return[];let[s,...r]=e,i=s.endsWith("?"),a=s.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=SN(r.join("/")),l=[];return l.push(...o.map(d=>d===""?a:[a,d].join("/"))),i&&l.push(...o),l.map(d=>t.startsWith("/")&&d===""?"/":d)}function bE(t){t.sort((e,s)=>e.score!==s.score?s.score-e.score:TE(e.routesMeta.map(r=>r.childrenIndex),s.routesMeta.map(r=>r.childrenIndex)))}const NE=/^:[\w-]+$/,jE=3,_E=2,kE=1,EE=10,IE=-2,_y=t=>t==="*";function SE(t,e){let s=t.split("/"),r=s.length;return s.some(_y)&&(r+=IE),e&&(r+=_E),s.filter(i=>!_y(i)).reduce((i,a)=>i+(NE.test(a)?jE:a===""?kE:EE),r)}function TE(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function CE(t,e,s){let{routesMeta:r}=t,i={},a="/",o=[];for(let l=0;l<r.length;++l){let d=r[l],u=l===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=AE({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},h),g=d.route;if(!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:ii([a,p.pathname]),pathnameBase:ME(ii([a,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(a=ii([a,p.pathnameBase]))}return o}function AE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,r]=RE(t.path,t.caseSensitive,t.end),i=e.match(s);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((u,h,p)=>{let{paramName:g,isOptional:y}=h;if(g==="*"){let C=l[p]||"";o=a.slice(0,a.length-C.length).replace(/(.)\/+$/,"$1")}const w=l[p];return y&&!w?u[g]=void 0:u[g]=(w||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:t}}function RE(t,e,s){e===void 0&&(e=!1),s===void 0&&(s=!0),EN(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,d)=>(r.push({paramName:l,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function PE(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return EN(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Ag(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let s=e.endsWith("/")?e.length-1:e.length,r=t.charAt(s);return r&&r!=="/"?null:t.slice(s)||"/"}function DE(t,e){e===void 0&&(e="/");let{pathname:s,search:r="",hash:i=""}=typeof t=="string"?bo(t):t;return{pathname:s?s.startsWith("/")?s:OE(s,e):e,search:VE(r),hash:FE(i)}}function OE(t,e){let s=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?s.length>1&&s.pop():i!=="."&&s.push(i)}),s.length>1?s.join("/"):"/"}function Um(t,e,s,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function LE(t){return t.filter((e,s)=>s===0||e.route.path&&e.route.path.length>0)}function Rg(t,e){let s=LE(t);return e?s.map((r,i)=>i===s.length-1?r.pathname:r.pathnameBase):s.map(r=>r.pathnameBase)}function Pg(t,e,s,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=bo(t):(i=Yl({},t),wt(!i.pathname||!i.pathname.includes("?"),Um("?","pathname","search",i)),wt(!i.pathname||!i.pathname.includes("#"),Um("#","pathname","hash",i)),wt(!i.search||!i.search.includes("#"),Um("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=s;else{let p=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;i.pathname=g.join("/")}l=p>=0?e[p]:"/"}let d=DE(i,l),u=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&s.endsWith("/");return!d.pathname.endsWith("/")&&(u||h)&&(d.pathname+="/"),d}const ii=t=>t.join("/").replace(/\/\/+/g,"/"),ME=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),VE=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,FE=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function UE(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const TN=["post","put","patch","delete"];new Set(TN);const $E=["get",...TN];new Set($E);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jl(){return Jl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Jl.apply(this,arguments)}const Dg=_.createContext(null),BE=_.createContext(null),vi=_.createContext(null),wh=_.createContext(null),wi=_.createContext({outlet:null,matches:[],isDataRoute:!1}),CN=_.createContext(null);function zE(t,e){let{relative:s}=e===void 0?{}:e;No()||wt(!1);let{basename:r,navigator:i}=_.useContext(vi),{hash:a,pathname:o,search:l}=RN(t,{relative:s}),d=o;return r!=="/"&&(d=o==="/"?r:ii([r,o])),i.createHref({pathname:d,search:l,hash:a})}function No(){return _.useContext(wh)!=null}function bi(){return No()||wt(!1),_.useContext(wh).location}function AN(t){_.useContext(vi).static||_.useLayoutEffect(t)}function ys(){let{isDataRoute:t}=_.useContext(wi);return t?sI():qE()}function qE(){No()||wt(!1);let t=_.useContext(Dg),{basename:e,future:s,navigator:r}=_.useContext(vi),{matches:i}=_.useContext(wi),{pathname:a}=bi(),o=JSON.stringify(Rg(i,s.v7_relativeSplatPath)),l=_.useRef(!1);return AN(()=>{l.current=!0}),_.useCallback(function(u,h){if(h===void 0&&(h={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let p=Pg(u,JSON.parse(o),a,h.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:ii([e,p.pathname])),(h.replace?r.replace:r.push)(p,h.state,h)},[e,r,o,a,t])}function RN(t,e){let{relative:s}=e===void 0?{}:e,{future:r}=_.useContext(vi),{matches:i}=_.useContext(wi),{pathname:a}=bi(),o=JSON.stringify(Rg(i,r.v7_relativeSplatPath));return _.useMemo(()=>Pg(t,JSON.parse(o),a,s==="path"),[t,o,a,s])}function HE(t,e){return WE(t,e)}function WE(t,e,s,r){No()||wt(!1);let{navigator:i}=_.useContext(vi),{matches:a}=_.useContext(wi),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let d=o?o.pathnameBase:"/";o&&o.route;let u=bi(),h;if(e){var p;let E=typeof e=="string"?bo(e):e;d==="/"||(p=E.pathname)!=null&&p.startsWith(d)||wt(!1),h=E}else h=u;let g=h.pathname||"/",y=g;if(d!=="/"){let E=d.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(E.length).join("/")}let w=vE(t,{pathname:y}),C=YE(w&&w.map(E=>Object.assign({},E,{params:Object.assign({},l,E.params),pathname:ii([d,i.encodeLocation?i.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?d:ii([d,i.encodeLocation?i.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),a,s,r);return e&&C?_.createElement(wh.Provider,{value:{location:Jl({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Qr.Pop}},C):C}function KE(){let t=tI(),e=UE(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),s?_.createElement("pre",{style:i},s):null,null)}const GE=_.createElement(KE,null);class QE extends _.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,s){return s.location!==e.location||s.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:s.error,location:s.location,revalidation:e.revalidation||s.revalidation}}componentDidCatch(e,s){console.error("React Router caught the following error during render",e,s)}render(){return this.state.error!==void 0?_.createElement(wi.Provider,{value:this.props.routeContext},_.createElement(CN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function XE(t){let{routeContext:e,match:s,children:r}=t,i=_.useContext(Dg);return i&&i.static&&i.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=s.route.id),_.createElement(wi.Provider,{value:e},r)}function YE(t,e,s,r){var i;if(e===void 0&&(e=[]),s===void 0&&(s=null),r===void 0&&(r=null),t==null){var a;if(!s)return null;if(s.errors)t=s.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let o=t,l=(i=s)==null?void 0:i.errors;if(l!=null){let h=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);h>=0||wt(!1),o=o.slice(0,Math.min(o.length,h+1))}let d=!1,u=-1;if(s&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:g,errors:y}=s,w=p.route.loader&&g[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||w){d=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((h,p,g)=>{let y,w=!1,C=null,E=null;s&&(y=l&&p.route.id?l[p.route.id]:void 0,C=p.route.errorElement||GE,d&&(u<0&&g===0?(nI("route-fallback"),w=!0,E=null):u===g&&(w=!0,E=p.route.hydrateFallbackElement||null)));let N=e.concat(o.slice(0,g+1)),v=()=>{let k;return y?k=C:w?k=E:p.route.Component?k=_.createElement(p.route.Component,null):p.route.element?k=p.route.element:k=h,_.createElement(XE,{match:p,routeContext:{outlet:h,matches:N,isDataRoute:s!=null},children:k})};return s&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?_.createElement(QE,{location:s.location,revalidation:s.revalidation,component:C,error:y,children:v(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):v()},null)}var PN=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(PN||{}),DN=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(DN||{});function JE(t){let e=_.useContext(Dg);return e||wt(!1),e}function ZE(t){let e=_.useContext(BE);return e||wt(!1),e}function eI(t){let e=_.useContext(wi);return e||wt(!1),e}function ON(t){let e=eI(),s=e.matches[e.matches.length-1];return s.route.id||wt(!1),s.route.id}function tI(){var t;let e=_.useContext(CN),s=ZE(),r=ON();return e!==void 0?e:(t=s.errors)==null?void 0:t[r]}function sI(){let{router:t}=JE(PN.UseNavigateStable),e=ON(DN.UseNavigateStable),s=_.useRef(!1);return AN(()=>{s.current=!0}),_.useCallback(function(i,a){a===void 0&&(a={}),s.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Jl({fromRouteId:e},a)))},[t,e])}const ky={};function nI(t,e,s){ky[t]||(ky[t]=!0)}function rI(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function bh(t){let{to:e,replace:s,state:r,relative:i}=t;No()||wt(!1);let{future:a,static:o}=_.useContext(vi),{matches:l}=_.useContext(wi),{pathname:d}=bi(),u=ys(),h=Pg(e,Rg(l,a.v7_relativeSplatPath),d,i==="path"),p=JSON.stringify(h);return _.useEffect(()=>u(JSON.parse(p),{replace:s,state:r,relative:i}),[u,p,i,s,r]),null}function Me(t){wt(!1)}function iI(t){let{basename:e="/",children:s=null,location:r,navigationType:i=Qr.Pop,navigator:a,static:o=!1,future:l}=t;No()&&wt(!1);let d=e.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:d,navigator:a,static:o,future:Jl({v7_relativeSplatPath:!1},l)}),[d,l,a,o]);typeof r=="string"&&(r=bo(r));let{pathname:h="/",search:p="",hash:g="",state:y=null,key:w="default"}=r,C=_.useMemo(()=>{let E=Ag(h,d);return E==null?null:{location:{pathname:E,search:p,hash:g,state:y,key:w},navigationType:i}},[d,h,p,g,y,w,i]);return C==null?null:_.createElement(vi.Provider,{value:u},_.createElement(wh.Provider,{children:s,value:C}))}function aI(t){let{children:e,location:s}=t;return HE(ap(e),s)}new Promise(()=>{});function ap(t,e){e===void 0&&(e=[]);let s=[];return _.Children.forEach(t,(r,i)=>{if(!_.isValidElement(r))return;let a=[...e,i];if(r.type===_.Fragment){s.push.apply(s,ap(r.props.children,a));return}r.type!==Me&&wt(!1),!r.props.index||!r.props.children||wt(!1);let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=ap(r.props.children,a)),s.push(o)}),s}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function op(){return op=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},op.apply(this,arguments)}function oI(t,e){if(t==null)return{};var s={},r=Object.keys(t),i,a;for(a=0;a<r.length;a++)i=r[a],!(e.indexOf(i)>=0)&&(s[i]=t[i]);return s}function lI(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function cI(t,e){return t.button===0&&(!e||e==="_self")&&!lI(t)}function lp(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,s)=>{let r=t[s];return e.concat(Array.isArray(r)?r.map(i=>[s,i]):[[s,r]])},[]))}function dI(t,e){let s=lp(t);return e&&e.forEach((r,i)=>{s.has(i)||e.getAll(i).forEach(a=>{s.append(i,a)})}),s}const uI=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],hI="6";try{window.__reactRouterVersion=hI}catch{}const mI="startTransition",Ey=r2[mI];function fI(t){let{basename:e,children:s,future:r,window:i}=t,a=_.useRef();a.current==null&&(a.current=gE({window:i,v5Compat:!0}));let o=a.current,[l,d]=_.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},h=_.useCallback(p=>{u&&Ey?Ey(()=>d(p)):d(p)},[d,u]);return _.useLayoutEffect(()=>o.listen(h),[o,h]),_.useEffect(()=>rI(r),[r]),_.createElement(iI,{basename:e,children:s,location:l.location,navigationType:l.action,navigator:o,future:r})}const pI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",gI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,de=_.forwardRef(function(e,s){let{onClick:r,relative:i,reloadDocument:a,replace:o,state:l,target:d,to:u,preventScrollReset:h,viewTransition:p}=e,g=oI(e,uI),{basename:y}=_.useContext(vi),w,C=!1;if(typeof u=="string"&&gI.test(u)&&(w=u,pI))try{let k=new URL(window.location.href),P=u.startsWith("//")?new URL(k.protocol+u):new URL(u),O=Ag(P.pathname,y);P.origin===k.origin&&O!=null?u=O+P.search+P.hash:C=!0}catch{}let E=zE(u,{relative:i}),N=xI(u,{replace:o,state:l,target:d,preventScrollReset:h,relative:i,viewTransition:p});function v(k){r&&r(k),k.defaultPrevented||N(k)}return _.createElement("a",op({},g,{href:w||E,onClick:C||a?r:v,ref:s,target:d}))});var Iy;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Iy||(Iy={}));var Sy;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Sy||(Sy={}));function xI(t,e){let{target:s,replace:r,state:i,preventScrollReset:a,relative:o,viewTransition:l}=e===void 0?{}:e,d=ys(),u=bi(),h=RN(t,{relative:o});return _.useCallback(p=>{if(cI(p,s)){p.preventDefault();let g=r!==void 0?r:Ru(u)===Ru(h);d(t,{replace:g,state:i,preventScrollReset:a,relative:o,viewTransition:l})}},[u,d,h,r,i,s,t,a,o,l])}function Nh(t){let e=_.useRef(lp(t)),s=_.useRef(!1),r=bi(),i=_.useMemo(()=>dI(r.search,s.current?null:e.current),[r.search]),a=ys(),o=_.useCallback((l,d)=>{const u=lp(typeof l=="function"?l(i):l);s.current=!0,a("?"+u,d)},[a,i]);return[i,o]}var Ty={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN=function(t){const e=[];let s=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[s++]=i:i<2048?(e[s++]=i>>6|192,e[s++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[s++]=i>>18|240,e[s++]=i>>12&63|128,e[s++]=i>>6&63|128,e[s++]=i&63|128):(e[s++]=i>>12|224,e[s++]=i>>6&63|128,e[s++]=i&63|128)}return e},yI=function(t){const e=[];let s=0,r=0;for(;s<t.length;){const i=t[s++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[s++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[s++],o=t[s++],l=t[s++],d=((i&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const a=t[s++],o=t[s++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},MN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,l=o?t[i+1]:0,d=i+2<t.length,u=d?t[i+2]:0,h=a>>2,p=(a&3)<<4|l>>4;let g=(l&15)<<2|u>>6,y=u&63;d||(y=64,o||(g=64)),r.push(s[h],s[p],s[g],s[y])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(LN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):yI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const s=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const a=s[t.charAt(i++)],l=i<t.length?s[t.charAt(i)]:0;++i;const u=i<t.length?s[t.charAt(i)]:64;++i;const p=i<t.length?s[t.charAt(i)]:64;if(++i,a==null||l==null||u==null||p==null)throw new vI;const g=a<<2|l>>4;if(r.push(g),u!==64){const y=l<<4&240|u>>2;if(r.push(y),p!==64){const w=u<<6&192|p;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class vI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wI=function(t){const e=LN(t);return MN.encodeByteArray(e,!0)},Pu=function(t){return wI(t).replace(/\./g,"")},VN=function(t){try{return MN.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI=()=>bI().__FIREBASE_DEFAULTS__,jI=()=>{if(typeof process>"u"||typeof Ty>"u")return;const t=Ty.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},_I=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&VN(t[1]);return e&&JSON.parse(e)},jh=()=>{try{return NI()||jI()||_I()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},FN=t=>{var e,s;return(s=(e=jh())===null||e===void 0?void 0:e.emulatorHosts)===null||s===void 0?void 0:s[t]},UN=t=>{const e=FN(t);if(!e)return;const s=e.lastIndexOf(":");if(s<=0||s+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(s+1),10);return e[0]==="["?[e.substring(1,s-1),r]:[e.substring(0,s),r]},$N=()=>{var t;return(t=jh())===null||t===void 0?void 0:t.config},BN=t=>{var e;return(e=jh())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,s)=>{this.resolve=e,this.reject=s})}wrapCallback(e){return(s,r)=>{s?this.reject(s):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(s):e(s,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zN(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Pu(JSON.stringify(s)),Pu(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function EI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cs())}function II(){var t;const e=(t=jh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function SI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function TI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function CI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function AI(){const t=cs();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function RI(){return!II()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function PI(){try{return typeof indexedDB=="object"}catch{return!1}}function DI(){return new Promise((t,e)=>{try{let s=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),s||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{s=!1},i.onerror=()=>{var a;e(((a=i.error)===null||a===void 0?void 0:a.message)||"")}}catch(s){e(s)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OI="FirebaseError";class Hn extends Error{constructor(e,s,r){super(s),this.code=e,this.customData=r,this.name=OI,Object.setPrototypeOf(this,Hn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jc.prototype.create)}}class jc{constructor(e,s,r){this.service=e,this.serviceName=s,this.errors=r}create(e,...s){const r=s[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?LI(a,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Hn(i,l,r)}}function LI(t,e){return t.replace(MI,(s,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const MI=/\{\$([^}]+)}/g;function VI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Du(t,e){if(t===e)return!0;const s=Object.keys(t),r=Object.keys(e);for(const i of s){if(!r.includes(i))return!1;const a=t[i],o=e[i];if(Cy(a)&&Cy(o)){if(!Du(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!s.includes(i))return!1;return!0}function Cy(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jo(t){const e=[];for(const[s,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(s)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(s)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ll(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function cl(t){const e=t.indexOf("?");if(!e)return"";const s=t.indexOf("#",e);return t.substring(e,s>0?s:void 0)}function FI(t,e){const s=new UI(t,e);return s.subscribe.bind(s)}class UI{constructor(e,s){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=s,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(s=>{s.next(e)})}error(e){this.forEachObserver(s=>{s.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,s,r){let i;if(e===void 0&&s===void 0&&r===void 0)throw new Error("Missing Observer.");$I(e,["next","error","complete"])?i=e:i={next:e,error:s,complete:r},i.next===void 0&&(i.next=$m),i.error===void 0&&(i.error=$m),i.complete===void 0&&(i.complete=$m);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let s=0;s<this.observers.length;s++)this.sendOne(s,e)}sendOne(e,s){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{s(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $I(t,e){if(typeof t!="object"||t===null)return!1;for(const s of e)if(s in t&&typeof t[s]=="function")return!0;return!1}function $m(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(t){return t&&t._delegate?t._delegate:t}class hi{constructor(e,s,r){this.name=e,this.instanceFactory=s,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(e,s){this.name=e,this.container=s,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const s=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(s)){const r=new kI;if(this.instancesDeferred.set(s,r),this.isInitialized(s)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:s});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(s).promise}getImmediate(e){var s;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(s=e==null?void 0:e.optional)!==null&&s!==void 0?s:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qI(e))try{this.getOrInitializeService({instanceIdentifier:Oi})}catch{}for(const[s,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(s);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Oi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...e.filter(s=>"_delete"in s).map(s=>s._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Oi){return this.instances.has(e)}getOptions(e=Oi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:s={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:s});for(const[a,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(a);r===l&&o.resolve(i)}return i}onInit(e,s){var r;const i=this.normalizeInstanceIdentifier(s),a=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;a.add(e),this.onInitCallbacks.set(i,a);const o=this.instances.get(i);return o&&e(o,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,s){const r=this.onInitCallbacks.get(s);if(r)for(const i of r)try{i(e,s)}catch{}}getOrInitializeService({instanceIdentifier:e,options:s={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:zI(e),options:s}),this.instances.set(e,r),this.instancesOptions.set(e,s),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Oi){return this.component?this.component.multipleInstances?e:Oi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zI(t){return t===Oi?void 0:t}function qI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const s=this.getProvider(e.name);if(s.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);s.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const s=new BI(e,this);return this.providers.set(e,s),s}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ie||(Ie={}));const WI={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},KI=Ie.INFO,GI={[Ie.DEBUG]:"log",[Ie.VERBOSE]:"log",[Ie.INFO]:"info",[Ie.WARN]:"warn",[Ie.ERROR]:"error"},QI=(t,e,...s)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=GI[e];if(i)console[i](`[${r}]  ${t.name}:`,...s);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Og{constructor(e){this.name=e,this._logLevel=KI,this._logHandler=QI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?WI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ie.DEBUG,...e),this._logHandler(this,Ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ie.VERBOSE,...e),this._logHandler(this,Ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ie.INFO,...e),this._logHandler(this,Ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ie.WARN,...e),this._logHandler(this,Ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ie.ERROR,...e),this._logHandler(this,Ie.ERROR,...e)}}const XI=(t,e)=>e.some(s=>t instanceof s);let Ay,Ry;function YI(){return Ay||(Ay=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JI(){return Ry||(Ry=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qN=new WeakMap,cp=new WeakMap,HN=new WeakMap,Bm=new WeakMap,Lg=new WeakMap;function ZI(t){const e=new Promise((s,r)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{s(ai(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(s=>{s instanceof IDBCursor&&qN.set(s,t)}).catch(()=>{}),Lg.set(e,t),e}function eS(t){if(cp.has(t))return;const e=new Promise((s,r)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{s(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});cp.set(t,e)}let dp={get(t,e,s){if(t instanceof IDBTransaction){if(e==="done")return cp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||HN.get(t);if(e==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return ai(t[e])},set(t,e,s){return t[e]=s,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tS(t){dp=t(dp)}function sS(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...s){const r=t.call(zm(this),e,...s);return HN.set(r,e.sort?e.sort():[e]),ai(r)}:JI().includes(t)?function(...e){return t.apply(zm(this),e),ai(qN.get(this))}:function(...e){return ai(t.apply(zm(this),e))}}function nS(t){return typeof t=="function"?sS(t):(t instanceof IDBTransaction&&eS(t),XI(t,YI())?new Proxy(t,dp):t)}function ai(t){if(t instanceof IDBRequest)return ZI(t);if(Bm.has(t))return Bm.get(t);const e=nS(t);return e!==t&&(Bm.set(t,e),Lg.set(e,t)),e}const zm=t=>Lg.get(t);function rS(t,e,{blocked:s,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),l=ai(o);return r&&o.addEventListener("upgradeneeded",d=>{r(ai(o.result),d.oldVersion,d.newVersion,ai(o.transaction),d)}),s&&o.addEventListener("blocked",d=>s(d.oldVersion,d.newVersion,d)),l.then(d=>{a&&d.addEventListener("close",()=>a()),i&&d.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const iS=["get","getKey","getAll","getAllKeys","count"],aS=["put","add","delete","clear"],qm=new Map;function Py(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(qm.get(e))return qm.get(e);const s=e.replace(/FromIndex$/,""),r=e!==s,i=aS.includes(s);if(!(s in(r?IDBIndex:IDBObjectStore).prototype)||!(i||iS.includes(s)))return;const a=async function(o,...l){const d=this.transaction(o,i?"readwrite":"readonly");let u=d.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[s](...l),i&&d.done]))[0]};return qm.set(e,a),a}tS(t=>({...t,get:(e,s,r)=>Py(e,s)||t.get(e,s,r),has:(e,s)=>!!Py(e,s)||t.has(e,s)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(s=>{if(lS(s)){const r=s.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(s=>s).join(" ")}}function lS(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const up="@firebase/app",Dy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr=new Og("@firebase/app"),cS="@firebase/app-compat",dS="@firebase/analytics-compat",uS="@firebase/analytics",hS="@firebase/app-check-compat",mS="@firebase/app-check",fS="@firebase/auth",pS="@firebase/auth-compat",gS="@firebase/database",xS="@firebase/data-connect",yS="@firebase/database-compat",vS="@firebase/functions",wS="@firebase/functions-compat",bS="@firebase/installations",NS="@firebase/installations-compat",jS="@firebase/messaging",_S="@firebase/messaging-compat",kS="@firebase/performance",ES="@firebase/performance-compat",IS="@firebase/remote-config",SS="@firebase/remote-config-compat",TS="@firebase/storage",CS="@firebase/storage-compat",AS="@firebase/firestore",RS="@firebase/vertexai-preview",PS="@firebase/firestore-compat",DS="firebase",OS="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hp="[DEFAULT]",LS={[up]:"fire-core",[cS]:"fire-core-compat",[uS]:"fire-analytics",[dS]:"fire-analytics-compat",[mS]:"fire-app-check",[hS]:"fire-app-check-compat",[fS]:"fire-auth",[pS]:"fire-auth-compat",[gS]:"fire-rtdb",[xS]:"fire-data-connect",[yS]:"fire-rtdb-compat",[vS]:"fire-fn",[wS]:"fire-fn-compat",[bS]:"fire-iid",[NS]:"fire-iid-compat",[jS]:"fire-fcm",[_S]:"fire-fcm-compat",[kS]:"fire-perf",[ES]:"fire-perf-compat",[IS]:"fire-rc",[SS]:"fire-rc-compat",[TS]:"fire-gcs",[CS]:"fire-gcs-compat",[AS]:"fire-fst",[PS]:"fire-fst-compat",[RS]:"fire-vertex","fire-js":"fire-js",[DS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl=new Map,MS=new Map,mp=new Map;function Oy(t,e){try{t.container.addComponent(e)}catch(s){xr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,s)}}function Yi(t){const e=t.name;if(mp.has(e))return xr.debug(`There were multiple attempts to register component ${e}.`),!1;mp.set(e,t);for(const s of Zl.values())Oy(s,t);for(const s of MS.values())Oy(s,t);return!0}function _h(t,e){const s=t.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),t.container.getProvider(e)}function vn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},oi=new jc("app","Firebase",VS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e,s,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},s),this._name=s.name,this._automaticDataCollectionEnabled=s.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new hi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw oi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ca=OS;function WN(t,e={}){let s=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:hp,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw oi.create("bad-app-name",{appName:String(i)});if(s||(s=$N()),!s)throw oi.create("no-options");const a=Zl.get(i);if(a){if(Du(s,a.options)&&Du(r,a.config))return a;throw oi.create("duplicate-app",{appName:i})}const o=new HI(i);for(const d of mp.values())o.addComponent(d);const l=new FS(s,r,o);return Zl.set(i,l),l}function kh(t=hp){const e=Zl.get(t);if(!e&&t===hp&&$N())return WN();if(!e)throw oi.create("no-app",{appName:t});return e}function KN(){return Array.from(Zl.values())}function Mn(t,e,s){var r;let i=(r=LS[t])!==null&&r!==void 0?r:t;s&&(i+=`-${s}`);const a=i.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const l=[`Unable to register library "${i}" with version "${e}":`];a&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xr.warn(l.join(" "));return}Yi(new hi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const US="firebase-heartbeat-database",$S=1,ec="firebase-heartbeat-store";let Hm=null;function GN(){return Hm||(Hm=rS(US,$S,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ec)}catch(s){console.warn(s)}}}}).catch(t=>{throw oi.create("idb-open",{originalErrorMessage:t.message})})),Hm}async function BS(t){try{const s=(await GN()).transaction(ec),r=await s.objectStore(ec).get(QN(t));return await s.done,r}catch(e){if(e instanceof Hn)xr.warn(e.message);else{const s=oi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});xr.warn(s.message)}}}async function Ly(t,e){try{const r=(await GN()).transaction(ec,"readwrite");await r.objectStore(ec).put(e,QN(t)),await r.done}catch(s){if(s instanceof Hn)xr.warn(s.message);else{const r=oi.create("idb-set",{originalErrorMessage:s==null?void 0:s.message});xr.warn(r.message)}}}function QN(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS=1024,qS=30*24*60*60*1e3;class HS{constructor(e){this.container=e,this._heartbeatsCache=null;const s=this.container.getProvider("app").getImmediate();this._storage=new KS(s),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,s;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=My();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((s=this._heartbeatsCache)===null||s===void 0?void 0:s.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=qS}),this._storage.overwrite(this._heartbeatsCache))}catch(r){xr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const s=My(),{heartbeatsToSend:r,unsentEntries:i}=WS(this._heartbeatsCache.heartbeats),a=Pu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=s,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(s){return xr.warn(s),""}}}function My(){return new Date().toISOString().substring(0,10)}function WS(t,e=zS){const s=[];let r=t.slice();for(const i of t){const a=s.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),Vy(s)>e){a.dates.pop();break}}else if(s.push({agent:i.agent,dates:[i.date]}),Vy(s)>e){s.pop();break}r=r.slice(1)}return{heartbeatsToSend:s,unsentEntries:r}}class KS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return PI()?DI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const s=await BS(this.app);return s!=null&&s.heartbeats?s:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var s;if(await this._canUseIndexedDBPromise){const i=await this.read();return Ly(this.app,{lastSentHeartbeatDate:(s=e.lastSentHeartbeatDate)!==null&&s!==void 0?s:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var s;if(await this._canUseIndexedDBPromise){const i=await this.read();return Ly(this.app,{lastSentHeartbeatDate:(s=e.lastSentHeartbeatDate)!==null&&s!==void 0?s:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Vy(t){return Pu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(t){Yi(new hi("platform-logger",e=>new oS(e),"PRIVATE")),Yi(new hi("heartbeat",e=>new HS(e),"PRIVATE")),Mn(up,Dy,t),Mn(up,Dy,"esm2017"),Mn("fire-js","")}GS("");function Mg(t,e){var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(s[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(s[r[i]]=t[r[i]]);return s}function XN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QS=XN,YN=new jc("auth","Firebase",XN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ou=new Og("@firebase/auth");function XS(t,...e){Ou.logLevel<=Ie.WARN&&Ou.warn(`Auth (${ca}): ${t}`,...e)}function Jd(t,...e){Ou.logLevel<=Ie.ERROR&&Ou.error(`Auth (${ca}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(t,...e){throw Vg(t,...e)}function Vs(t,...e){return Vg(t,...e)}function JN(t,e,s){const r=Object.assign(Object.assign({},QS()),{[e]:s});return new jc("auth","Firebase",r).create(e,{appName:t.name})}function Vn(t){return JN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Vg(t,...e){if(typeof t!="string"){const s=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(s,...r)}return YN.create(t,...e)}function ce(t,e,...s){if(!t)throw Vg(e,...s)}function ir(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Jd(e),new Error(e)}function yr(t,e){t||ir(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function ZN(){return Fy()==="http:"||Fy()==="https:"}function Fy(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ZN()||TI()||"connection"in navigator)?navigator.onLine:!0}function JS(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e,s){this.shortDelay=e,this.longDelay=s,yr(s>e,"Short delay should be less than long delay!"),this.isMobile=EI()||CI()}get(){return YS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(t,e){yr(t.emulator,"Emulator should always be set here");const{url:s}=t.emulator;return e?`${s}${e.startsWith("/")?e.slice(1):e}`:s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{static initialize(e,s,r){this.fetchImpl=e,s&&(this.headersImpl=s),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ir("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ir("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ir("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT=new _c(3e4,6e4);function vs(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function qs(t,e,s,r,i={}){return tj(t,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const l=jo(Object.assign({key:t.config.apiKey},o)).slice(1),d=await t._getAdditionalHeaders();d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:d},a);return SI()||(u.referrerPolicy="no-referrer"),ej.fetch()(sj(t,t.config.apiHost,s,l),u)})}async function tj(t,e,s){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},ZS),e);try{const i=new sT(t),a=await Promise.race([s(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw dl(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const l=a.ok?o.errorMessage:o.error.message,[d,u]=l.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw dl(t,"credential-already-in-use",o);if(d==="EMAIL_EXISTS")throw dl(t,"email-already-in-use",o);if(d==="USER_DISABLED")throw dl(t,"user-disabled",o);const h=r[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw JN(t,h,u);jn(t,h)}}catch(i){if(i instanceof Hn)throw i;jn(t,"network-request-failed",{message:String(i)})}}async function Ni(t,e,s,r,i={}){const a=await qs(t,e,s,r,i);return"mfaPendingCredential"in a&&jn(t,"multi-factor-auth-required",{_serverResponse:a}),a}function sj(t,e,s,r){const i=`${e}${s}?${r}`;return t.config.emulator?Fg(t.config,i):`${t.config.apiScheme}://${i}`}function tT(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class sT{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((s,r)=>{this.timer=setTimeout(()=>r(Vs(this.auth,"network-request-failed")),eT.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function dl(t,e,s){const r={appName:t.name};s.email&&(r.email=s.email),s.phoneNumber&&(r.phoneNumber=s.phoneNumber);const i=Vs(t,e,r);return i.customData._tokenResponse=s,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uy(t){return t!==void 0&&t.getResponse!==void 0}function $y(t){return t!==void 0&&t.enterprise!==void 0}class nT{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const s of this.recaptchaEnforcementState)if(s.provider&&s.provider===e)return tT(s.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rT(t){return(await qs(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function iT(t,e){return qs(t,"GET","/v2/recaptchaConfig",vs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aT(t,e){return qs(t,"POST","/v1/accounts:delete",e)}async function nj(t,e){return qs(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oT(t,e=!1){const s=Ye(t),r=await s.getIdToken(e),i=Ug(r);ce(i&&i.exp&&i.auth_time&&i.iat,s.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a==null?void 0:a.sign_in_provider;return{claims:i,token:r,authTime:jl(Wm(i.auth_time)),issuedAtTime:jl(Wm(i.iat)),expirationTime:jl(Wm(i.exp)),signInProvider:o||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Wm(t){return Number(t)*1e3}function Ug(t){const[e,s,r]=t.split(".");if(e===void 0||s===void 0||r===void 0)return Jd("JWT malformed, contained fewer than 3 sections"),null;try{const i=VN(s);return i?JSON.parse(i):(Jd("Failed to decode base64 JWT payload"),null)}catch(i){return Jd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function By(t){const e=Ug(t);return ce(e,"internal-error"),ce(typeof e.exp<"u","internal-error"),ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tc(t,e,s=!1){if(s)return e;try{return await e}catch(r){throw r instanceof Hn&&lT(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function lT({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var s;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((s=this.user.stsTokenManager.expirationTime)!==null&&s!==void 0?s:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const s=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},s)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,s){this.createdAt=e,this.lastLoginAt=s,this._initializeTime()}_initializeTime(){this.lastSignInTime=jl(this.lastLoginAt),this.creationTime=jl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lu(t){var e;const s=t.auth,r=await t.getIdToken(),i=await tc(t,nj(s,{idToken:r}));ce(i==null?void 0:i.users.length,s,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const o=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?rj(a.providerUserInfo):[],l=uT(t.providerData,o),d=t.isAnonymous,u=!(t.email&&a.passwordHash)&&!(l!=null&&l.length),h=d?u:!1,p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new pp(a.createdAt,a.lastLoginAt),isAnonymous:h};Object.assign(t,p)}async function dT(t){const e=Ye(t);await Lu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function uT(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function rj(t){return t.map(e=>{var{providerId:s}=e,r=Mg(e,["providerId"]);return{providerId:s,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hT(t,e){const s=await tj(t,{},async()=>{const r=jo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,o=sj(t,i,"/v1/token",`key=${a}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",ej.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:s.access_token,expiresIn:s.expires_in,refreshToken:s.refresh_token}}async function mT(t,e){return qs(t,"POST","/v2/accounts:revokeToken",vs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ce(e.idToken,"internal-error"),ce(typeof e.idToken<"u","internal-error"),ce(typeof e.refreshToken<"u","internal-error");const s="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):By(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,s)}updateFromIdToken(e){ce(e.length!==0,"internal-error");const s=By(e);this.updateTokensAndExpiration(e,null,s)}async getToken(e,s=!1){return!s&&this.accessToken&&!this.isExpired?this.accessToken:(ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,s){const{accessToken:r,refreshToken:i,expiresIn:a}=await hT(e,s);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,s,r){this.refreshToken=s||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,s){const{refreshToken:r,accessToken:i,expirationTime:a}=s,o=new Ya;return r&&(ce(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ce(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(ce(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ya,this.toJSON())}_performRefresh(){return ir("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(t,e){ce(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ar{constructor(e){var{uid:s,auth:r,stsTokenManager:i}=e,a=Mg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new cT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=s,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new pp(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const s=await tc(this,this.stsTokenManager.getToken(this.auth,e));return ce(s,this.auth,"internal-error"),this.accessToken!==s&&(this.accessToken=s,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),s}getIdTokenResult(e){return oT(this,e)}reload(){return dT(this)}_assign(e){this!==e&&(ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(s=>Object.assign({},s)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const s=new ar(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return s.metadata._copy(this.metadata),s}_onReload(e){ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,s=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),s&&await Lu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vn(this.auth.app))return Promise.reject(Vn(this.auth));const e=await this.getIdToken();return await tc(this,aT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,s){var r,i,a,o,l,d,u,h;const p=(r=s.displayName)!==null&&r!==void 0?r:void 0,g=(i=s.email)!==null&&i!==void 0?i:void 0,y=(a=s.phoneNumber)!==null&&a!==void 0?a:void 0,w=(o=s.photoURL)!==null&&o!==void 0?o:void 0,C=(l=s.tenantId)!==null&&l!==void 0?l:void 0,E=(d=s._redirectEventId)!==null&&d!==void 0?d:void 0,N=(u=s.createdAt)!==null&&u!==void 0?u:void 0,v=(h=s.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:k,emailVerified:P,isAnonymous:O,providerData:U,stsTokenManager:b}=s;ce(k&&b,e,"internal-error");const m=Ya.fromJSON(this.name,b);ce(typeof k=="string",e,"internal-error"),Vr(p,e.name),Vr(g,e.name),ce(typeof P=="boolean",e,"internal-error"),ce(typeof O=="boolean",e,"internal-error"),Vr(y,e.name),Vr(w,e.name),Vr(C,e.name),Vr(E,e.name),Vr(N,e.name),Vr(v,e.name);const j=new ar({uid:k,auth:e,email:g,emailVerified:P,displayName:p,isAnonymous:O,photoURL:w,phoneNumber:y,tenantId:C,stsTokenManager:m,createdAt:N,lastLoginAt:v});return U&&Array.isArray(U)&&(j.providerData=U.map(I=>Object.assign({},I))),E&&(j._redirectEventId=E),j}static async _fromIdTokenResponse(e,s,r=!1){const i=new Ya;i.updateFromServerResponse(s);const a=new ar({uid:s.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Lu(a),a}static async _fromGetAccountInfoResponse(e,s,r){const i=s.users[0];ce(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?rj(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(a!=null&&a.length),l=new Ya;l.updateFromIdToken(r);const d=new ar({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new pp(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(a!=null&&a.length)};return Object.assign(d,u),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy=new Map;function or(t){yr(t instanceof Function,"Expected a class definition");let e=zy.get(t);return e?(yr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,zy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,s){this.storage[e]=s}async _get(e){const s=this.storage[e];return s===void 0?null:s}async _remove(e){delete this.storage[e]}_addListener(e,s){}_removeListener(e,s){}}ij.type="NONE";const qy=ij;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zd(t,e,s){return`firebase:${t}:${e}:${s}`}class Ja{constructor(e,s,r){this.persistence=e,this.auth=s,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=Zd(this.userKey,i.apiKey,a),this.fullPersistenceKey=Zd("persistence",i.apiKey,a),this.boundEventHandler=s._onStorageEvent.bind(s),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ar._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const s=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,s)return this.setCurrentUser(s)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,s,r="authUser"){if(!s.length)return new Ja(or(qy),e,r);const i=(await Promise.all(s.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let a=i[0]||or(qy);const o=Zd(r,e.config.apiKey,e.name);let l=null;for(const u of s)try{const h=await u._get(o);if(h){const p=ar._fromJSON(e,h);u!==a&&(l=p),a=u;break}}catch{}const d=i.filter(u=>u._shouldAllowMigration);return!a._shouldAllowMigration||!d.length?new Ja(a,e,r):(a=d[0],l&&await a._set(o,l.toJSON()),await Promise.all(s.map(async u=>{if(u!==a)try{await u._remove(o)}catch{}})),new Ja(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(cj(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(aj(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uj(e))return"Blackberry";if(hj(e))return"Webos";if(oj(e))return"Safari";if((e.includes("chrome/")||lj(e))&&!e.includes("edge/"))return"Chrome";if(dj(e))return"Android";{const s=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(s);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function aj(t=cs()){return/firefox\//i.test(t)}function oj(t=cs()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function lj(t=cs()){return/crios\//i.test(t)}function cj(t=cs()){return/iemobile/i.test(t)}function dj(t=cs()){return/android/i.test(t)}function uj(t=cs()){return/blackberry/i.test(t)}function hj(t=cs()){return/webos/i.test(t)}function $g(t=cs()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function fT(t=cs()){var e;return $g(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function pT(){return AI()&&document.documentMode===10}function mj(t=cs()){return $g(t)||dj(t)||hj(t)||uj(t)||/windows phone/i.test(t)||cj(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fj(t,e=[]){let s;switch(t){case"Browser":s=Hy(cs());break;case"Worker":s=`${Hy(cs())}-${t}`;break;default:s=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${s}/JsCore/${ca}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,s){const r=a=>new Promise((o,l)=>{try{const d=e(a);o(d)}catch(d){l(d)}});r.onAbort=s,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const s=[];try{for(const r of this.queue)await r(e),r.onAbort&&s.push(r.onAbort)}catch(r){s.reverse();for(const i of s)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xT(t,e={}){return qs(t,"GET","/v2/passwordPolicy",vs(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT=6;class vT{constructor(e){var s,r,i,a;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(s=o.minPasswordLength)!==null&&s!==void 0?s:yT,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var s,r,i,a,o,l;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(s=d.meetsMinPasswordLength)!==null&&s!==void 0?s:!0),d.isValid&&(d.isValid=(r=d.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),d.isValid&&(d.isValid=(i=d.containsLowercaseLetter)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(a=d.containsUppercaseLetter)!==null&&a!==void 0?a:!0),d.isValid&&(d.isValid=(o=d.containsNumericCharacter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(l=d.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),d}validatePasswordLengthOptions(e,s){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(s.meetsMinPasswordLength=e.length>=r),i&&(s.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,s){this.updatePasswordCharacterOptionsStatuses(s,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(s,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,s,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=s)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(e,s,r,i){this.app=e,this.heartbeatServiceProvider=s,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Wy(this),this.idTokenSubscription=new Wy(this),this.beforeStateQueue=new gT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=YN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,s){return s&&(this._popupRedirectResolver=or(s)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Ja.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(s),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const s=await nj(this,{idToken:e}),r=await ar._fromGetAccountInfoResponse(this,s,e);await this.directlySetCurrentUser(r)}catch(s){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",s),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(vn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId,l=i==null?void 0:i._redirectEventId,d=await this.tryRedirectSignIn(e);(!o||o===l)&&(d!=null&&d.user)&&(i=d.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let s=null;try{s=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return s}async reloadAndSetCurrentUserOrClear(e){try{await Lu(e)}catch(s){if((s==null?void 0:s.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=JS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vn(this.app))return Promise.reject(Vn(this));const s=e?Ye(e):null;return s&&ce(s.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(s&&s._clone(this))}async _updateCurrentUser(e,s=!1){if(!this._deleted)return e&&ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),s||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vn(this.app)?Promise.reject(Vn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vn(this.app)?Promise.reject(Vn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(or(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const s=this._getPasswordPolicyInternal();return s.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):s.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await xT(this),s=new vT(e);this.tenantId===null?this._projectPasswordPolicy=s:this._tenantPasswordPolicies[this.tenantId]=s}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new jc("auth","Firebase",e())}onAuthStateChanged(e,s,r){return this.registerStateListener(this.authStateSubscription,e,s,r)}beforeAuthStateChanged(e,s){return this.beforeStateQueue.pushCallback(e,s)}onIdTokenChanged(e,s,r){return this.registerStateListener(this.idTokenSubscription,e,s,r)}authStateReady(){return new Promise((e,s)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},s)}})}async revokeAccessToken(e){if(this.currentUser){const s=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:s};this.tenantId!=null&&(r.tenantId=this.tenantId),await mT(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,s){const r=await this.getOrInitRedirectPersistenceManager(s);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const s=e&&or(e)||this._popupRedirectResolver;ce(s,this,"argument-error"),this.redirectPersistenceManager=await Ja.create(this,[or(s._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var s,r;return this._isInitialized&&await this.queue(async()=>{}),((s=this._currentUser)===null||s===void 0?void 0:s._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,s;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(s=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&s!==void 0?s:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,s,r,i){if(this._deleted)return()=>{};const a=typeof s=="function"?s:s.next.bind(s);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ce(l,this,"internal-error"),l.then(()=>{o||a(this.currentUser)}),typeof s=="function"){const d=e.addObserver(s,r,i);return()=>{o=!0,d()}}else{const d=e.addObserver(s);return()=>{o=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fj(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const s={"X-Client-Version":this.clientVersion};this.app.options.appId&&(s["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(s["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(s["X-Firebase-AppCheck"]=i),s}async _getAppCheckToken(){var e;const s=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return s!=null&&s.error&&XS(`Error while retrieving App Check token: ${s.error}`),s==null?void 0:s.token}}function Wn(t){return Ye(t)}class Wy{constructor(e){this.auth=e,this.observer=null,this.addObserver=FI(s=>this.observer=s)}get next(){return ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bT(t){kc=t}function Bg(t){return kc.loadJS(t)}function NT(){return kc.recaptchaV2Script}function jT(){return kc.recaptchaEnterpriseScript}function _T(){return kc.gapiScript}function pj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const kT="recaptcha-enterprise",ET="NO_RECAPTCHA";class IT{constructor(e){this.type=kT,this.auth=Wn(e)}async verify(e="verify",s=!1){async function r(a){if(!s){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,l)=>{iT(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new nT(d);return a.tenantId==null?a._agentRecaptchaConfig=u:a._tenantRecaptchaConfigs[a.tenantId]=u,o(u.siteKey)}}).catch(d=>{l(d)})})}function i(a,o,l){const d=window.grecaptcha;$y(d)?d.enterprise.ready(()=>{d.enterprise.execute(a,{action:e}).then(u=>{o(u)}).catch(()=>{o(ET)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,o)=>{r(this.auth).then(l=>{if(!s&&$y(window.grecaptcha))i(l,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let d=jT();d.length!==0&&(d+=l),Bg(d).then(()=>{i(l,a,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function Ky(t,e,s,r=!1){const i=new IT(t);let a;try{a=await i.verify(s)}catch{a=await i.verify(s,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Mu(t,e,s,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Ky(t,e,s,s==="getOobCode");return r(t,a)}else return r(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${s} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Ky(t,e,s,s==="getOobCode");return r(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gj(t,e){const s=_h(t,"auth");if(s.isInitialized()){const i=s.getImmediate(),a=s.getOptions();if(Du(a,e??{}))return i;jn(i,"already-initialized")}return s.initialize({options:e})}function ST(t,e){const s=(e==null?void 0:e.persistence)||[],r=(Array.isArray(s)?s:[s]).map(or);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function TT(t,e,s){const r=Wn(t);ce(r._canInitEmulator,r,"emulator-config-failed"),ce(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=xj(e),{host:o,port:l}=CT(e),d=l===null?"":`:${l}`;r.config.emulator={url:`${a}//${o}${d}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),AT()}function xj(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function CT(t){const e=xj(t),s=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!s)return{host:"",port:null};const r=s[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:Gy(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:Gy(o)}}}function Gy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function AT(){function t(){const e=document.createElement("p"),s=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",s.position="fixed",s.width="100%",s.backgroundColor="#ffffff",s.border=".1em solid #000000",s.color="#b50000",s.bottom="0px",s.left="0px",s.margin="0px",s.zIndex="10000",s.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,s){this.providerId=e,this.signInMethod=s}toJSON(){return ir("not implemented")}_getIdTokenResponse(e){return ir("not implemented")}_linkToIdToken(e,s){return ir("not implemented")}_getReauthenticationResolver(e){return ir("not implemented")}}async function RT(t,e){return qs(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PT(t,e){return Ni(t,"POST","/v1/accounts:signInWithPassword",vs(t,e))}async function DT(t,e){return qs(t,"POST","/v1/accounts:sendOobCode",vs(t,e))}async function OT(t,e){return DT(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LT(t,e){return Ni(t,"POST","/v1/accounts:signInWithEmailLink",vs(t,e))}async function MT(t,e){return Ni(t,"POST","/v1/accounts:signInWithEmailLink",vs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc extends Eh{constructor(e,s,r,i=null){super("password",r),this._email=e,this._password=s,this._tenantId=i}static _fromEmailAndPassword(e,s){return new sc(e,s,"password")}static _fromEmailAndCode(e,s,r=null){return new sc(e,s,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const s=typeof e=="string"?JSON.parse(e):e;if(s!=null&&s.email&&(s!=null&&s.password)){if(s.signInMethod==="password")return this._fromEmailAndPassword(s.email,s.password);if(s.signInMethod==="emailLink")return this._fromEmailAndCode(s.email,s.password,s.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const s={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Mu(e,s,"signInWithPassword",PT);case"emailLink":return LT(e,{email:this._email,oobCode:this._password});default:jn(e,"internal-error")}}async _linkToIdToken(e,s){switch(this.signInMethod){case"password":const r={idToken:s,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Mu(e,r,"signUpPassword",RT);case"emailLink":return MT(e,{idToken:s,email:this._email,oobCode:this._password});default:jn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Za(t,e){return Ni(t,"POST","/v1/accounts:signInWithIdp",vs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VT="http://localhost";class Ji extends Eh{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const s=new Ji(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(s.idToken=e.idToken),e.accessToken&&(s.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(s.nonce=e.nonce),e.pendingToken&&(s.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(s.accessToken=e.oauthToken,s.secret=e.oauthTokenSecret):jn("argument-error"),s}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const s=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=s,a=Mg(s,["providerId","signInMethod"]);if(!r||!i)return null;const o=new Ji(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const s=this.buildRequest();return Za(e,s)}_linkToIdToken(e,s){const r=this.buildRequest();return r.idToken=s,Za(e,r)}_getReauthenticationResolver(e){const s=this.buildRequest();return s.autoCreate=!1,Za(e,s)}buildRequest(){const e={requestUri:VT,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const s={};this.idToken&&(s.id_token=this.idToken),this.accessToken&&(s.access_token=this.accessToken),this.secret&&(s.oauth_token_secret=this.secret),s.providerId=this.providerId,this.nonce&&!this.pendingToken&&(s.nonce=this.nonce),e.postBody=jo(s)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FT(t,e){return qs(t,"POST","/v1/accounts:sendVerificationCode",vs(t,e))}async function UT(t,e){return Ni(t,"POST","/v1/accounts:signInWithPhoneNumber",vs(t,e))}async function $T(t,e){const s=await Ni(t,"POST","/v1/accounts:signInWithPhoneNumber",vs(t,e));if(s.temporaryProof)throw dl(t,"account-exists-with-different-credential",s);return s}const BT={USER_NOT_FOUND:"user-not-found"};async function zT(t,e){const s=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Ni(t,"POST","/v1/accounts:signInWithPhoneNumber",vs(t,s),BT)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l extends Eh{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,s){return new _l({verificationId:e,verificationCode:s})}static _fromTokenResponse(e,s){return new _l({phoneNumber:e,temporaryProof:s})}_getIdTokenResponse(e){return UT(e,this._makeVerificationRequest())}_linkToIdToken(e,s){return $T(e,Object.assign({idToken:s},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return zT(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:s,verificationId:r,verificationCode:i}=this.params;return e&&s?{temporaryProof:e,phoneNumber:s}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:s,verificationCode:r,phoneNumber:i,temporaryProof:a}=e;return!r&&!s&&!i&&!a?null:new _l({verificationId:s,verificationCode:r,phoneNumber:i,temporaryProof:a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qT(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function HT(t){const e=ll(cl(t)).link,s=e?ll(cl(e)).deep_link_id:null,r=ll(cl(t)).deep_link_id;return(r?ll(cl(r)).link:null)||r||s||e||t}class zg{constructor(e){var s,r,i,a,o,l;const d=ll(cl(e)),u=(s=d.apiKey)!==null&&s!==void 0?s:null,h=(r=d.oobCode)!==null&&r!==void 0?r:null,p=qT((i=d.mode)!==null&&i!==void 0?i:null);ce(u&&h&&p,"argument-error"),this.apiKey=u,this.operation=p,this.code=h,this.continueUrl=(a=d.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(o=d.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=d.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const s=HT(e);try{return new zg(s)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(){this.providerId=_o.PROVIDER_ID}static credential(e,s){return sc._fromEmailAndPassword(e,s)}static credentialWithLink(e,s){const r=zg.parseLink(s);return ce(r,"argument-error"),sc._fromEmailAndCode(e,r.code,r.tenantId)}}_o.PROVIDER_ID="password";_o.EMAIL_PASSWORD_SIGN_IN_METHOD="password";_o.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec extends yj{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr extends Ec{constructor(){super("facebook.com")}static credential(e){return Ji._fromParams({providerId:zr.PROVIDER_ID,signInMethod:zr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zr.credentialFromTaggedObject(e)}static credentialFromError(e){return zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zr.credential(e.oauthAccessToken)}catch{return null}}}zr.FACEBOOK_SIGN_IN_METHOD="facebook.com";zr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr extends Ec{constructor(){super("google.com"),this.addScope("profile")}static credential(e,s){return Ji._fromParams({providerId:qr.PROVIDER_ID,signInMethod:qr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:s})}static credentialFromResult(e){return qr.credentialFromTaggedObject(e)}static credentialFromError(e){return qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:s,oauthAccessToken:r}=e;if(!s&&!r)return null;try{return qr.credential(s,r)}catch{return null}}}qr.GOOGLE_SIGN_IN_METHOD="google.com";qr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr extends Ec{constructor(){super("github.com")}static credential(e){return Ji._fromParams({providerId:Hr.PROVIDER_ID,signInMethod:Hr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hr.credentialFromTaggedObject(e)}static credentialFromError(e){return Hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hr.credential(e.oauthAccessToken)}catch{return null}}}Hr.GITHUB_SIGN_IN_METHOD="github.com";Hr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr extends Ec{constructor(){super("twitter.com")}static credential(e,s){return Ji._fromParams({providerId:Wr.PROVIDER_ID,signInMethod:Wr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:s})}static credentialFromResult(e){return Wr.credentialFromTaggedObject(e)}static credentialFromError(e){return Wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:s,oauthTokenSecret:r}=e;if(!s||!r)return null;try{return Wr.credential(s,r)}catch{return null}}}Wr.TWITTER_SIGN_IN_METHOD="twitter.com";Wr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WT(t,e){return Ni(t,"POST","/v1/accounts:signUp",vs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,s,r,i=!1){const a=await ar._fromIdTokenResponse(e,r,i),o=Qy(r);return new Zi({user:a,providerId:o,_tokenResponse:r,operationType:s})}static async _forOperation(e,s,r){await e._updateTokensIfNecessary(r,!0);const i=Qy(r);return new Zi({user:e,providerId:i,_tokenResponse:r,operationType:s})}}function Qy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu extends Hn{constructor(e,s,r,i){var a;super(s.code,s.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Vu.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:s.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,s,r,i){return new Vu(e,s,r,i)}}function vj(t,e,s,r){return(e==="reauthenticate"?s._getReauthenticationResolver(t):s._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Vu._fromErrorAndOperation(t,a,e,r):a})}async function KT(t,e,s=!1){const r=await tc(t,e._linkToIdToken(t.auth,await t.getIdToken()),s);return Zi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GT(t,e,s=!1){const{auth:r}=t;if(vn(r.app))return Promise.reject(Vn(r));const i="reauthenticate";try{const a=await tc(t,vj(r,i,e,t),s);ce(a.idToken,r,"internal-error");const o=Ug(a.idToken);ce(o,r,"internal-error");const{sub:l}=o;return ce(t.uid===l,r,"user-mismatch"),Zi._forOperation(t,i,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&jn(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wj(t,e,s=!1){if(vn(t.app))return Promise.reject(Vn(t));const r="signIn",i=await vj(t,r,e),a=await Zi._fromIdTokenResponse(t,r,i);return s||await t._updateCurrentUser(a.user),a}async function bj(t,e){return wj(Wn(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nj(t){const e=Wn(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function QT(t,e,s){const r=Wn(t);await Mu(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",OT)}async function kl(t,e,s){if(vn(t.app))return Promise.reject(Vn(t));const r=Wn(t),o=await Mu(r,{returnSecureToken:!0,email:e,password:s,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",WT).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&Nj(t),d}),l=await Zi._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function XT(t,e,s){return vn(t.app)?Promise.reject(Vn(t)):bj(Ye(t),_o.credential(e,s)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Nj(t),r})}function YT(t,e,s,r){return Ye(t).onIdTokenChanged(e,s,r)}function JT(t,e,s){return Ye(t).beforeAuthStateChanged(e,s)}function ZT(t,e,s,r){return Ye(t).onAuthStateChanged(e,s,r)}function e5(t){return Ye(t).signOut()}async function t5(t){return Ye(t).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s5(t,e){return qs(t,"POST","/v2/accounts/mfaEnrollment:start",vs(t,e))}const Fu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj{constructor(e,s){this.storageRetriever=e,this.type=s}_isAvailable(){try{return this.storage?(this.storage.setItem(Fu,"1"),this.storage.removeItem(Fu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,s){return this.storage.setItem(e,JSON.stringify(s)),Promise.resolve()}_get(e){const s=this.storage.getItem(e);return Promise.resolve(s?JSON.parse(s):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n5=1e3,r5=10;class _j extends jj{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,s)=>this.onStorageEvent(e,s),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=mj(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const s of Object.keys(this.listeners)){const r=this.storage.getItem(s),i=this.localCache[s];r!==i&&e(s,i,r)}}onStorageEvent(e,s=!1){if(!e.key){this.forAllChangedKeys((o,l,d)=>{this.notifyListeners(o,d)});return}const r=e.key;s?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!s&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);pT()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,r5):i()}notifyListeners(e,s){this.localCache[e]=s;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(s&&JSON.parse(s))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,s,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:s,newValue:r}),!0)})},n5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,s){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(s)}_removeListener(e,s){this.listeners[e]&&(this.listeners[e].delete(s),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,s){await super._set(e,s),this.localCache[e]=JSON.stringify(s)}async _get(e){const s=await super._get(e);return this.localCache[e]=JSON.stringify(s),s}async _remove(e){await super._remove(e),delete this.localCache[e]}}_j.type="LOCAL";const kj=_j;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej extends jj{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,s){}_removeListener(e,s){}}Ej.type="SESSION";const Ij=Ej;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i5(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(s){return{fulfilled:!1,reason:s}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const s=this.receivers.find(i=>i.isListeningto(e));if(s)return s;const r=new Ih(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const s=e,{eventId:r,eventType:i,data:a}=s.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;s.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async u=>u(s.origin,a)),d=await i5(l);s.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:d})}_subscribe(e,s){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(s)}_unsubscribe(e,s){this.handlersMap[e]&&s&&this.handlersMap[e].delete(s),(!s||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ih.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qg(t="",e=10){let s="";for(let r=0;r<e;r++)s+=Math.floor(Math.random()*10);return t+s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,s,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((l,d)=>{const u=qg("",20);i.port1.start();const h=setTimeout(()=>{d(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),l(g.data.response);break;default:clearTimeout(h),clearTimeout(a),d(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:s},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(){return window}function o5(t){kt().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hg(){return typeof kt().WorkerGlobalScope<"u"&&typeof kt().importScripts=="function"}async function l5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function c5(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function d5(){return Hg()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sj="firebaseLocalStorageDb",u5=1,Uu="firebaseLocalStorage",Tj="fbase_key";class Ic{constructor(e){this.request=e}toPromise(){return new Promise((e,s)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{s(this.request.error)})})}}function Sh(t,e){return t.transaction([Uu],e?"readwrite":"readonly").objectStore(Uu)}function h5(){const t=indexedDB.deleteDatabase(Sj);return new Ic(t).toPromise()}function gp(){const t=indexedDB.open(Sj,u5);return new Promise((e,s)=>{t.addEventListener("error",()=>{s(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Uu,{keyPath:Tj})}catch(i){s(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Uu)?e(r):(r.close(),await h5(),e(await gp()))})})}async function Xy(t,e,s){const r=Sh(t,!0).put({[Tj]:e,value:s});return new Ic(r).toPromise()}async function m5(t,e){const s=Sh(t,!1).get(e),r=await new Ic(s).toPromise();return r===void 0?null:r.value}function Yy(t,e){const s=Sh(t,!0).delete(e);return new Ic(s).toPromise()}const f5=800,p5=3;class Cj{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await gp(),this.db)}async _withRetries(e){let s=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(s++>p5)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Hg()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ih._getInstance(d5()),this.receiver._subscribe("keyChanged",async(e,s)=>({keyProcessed:(await this._poll()).includes(s.key)})),this.receiver._subscribe("ping",async(e,s)=>["keyChanged"])}async initializeSender(){var e,s;if(this.activeServiceWorker=await l5(),!this.activeServiceWorker)return;this.sender=new a5(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((s=r[0])===null||s===void 0)&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||c5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await gp();return await Xy(e,Fu,"1"),await Yy(e,Fu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,s){return this._withPendingWrite(async()=>(await this._withRetries(r=>Xy(r,e,s)),this.localCache[e]=s,this.notifyServiceWorker(e)))}async _get(e){const s=await this._withRetries(r=>m5(r,e));return this.localCache[e]=s,s}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(s=>Yy(s,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Sh(i,!1).getAll();return new Ic(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const s=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),s.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),s.push(i));return s}notifyListeners(e,s){this.localCache[e]=s;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(s)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),f5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,s){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(s)}_removeListener(e,s){this.listeners[e]&&(this.listeners[e].delete(s),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Cj.type="LOCAL";const Aj=Cj;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g5(t,e){return qs(t,"POST","/v2/accounts/mfaSignIn:start",vs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x5=500,y5=6e4,Ed=1e12;class v5{constructor(e){this.auth=e,this.counter=Ed,this._widgets=new Map}render(e,s){const r=this.counter;return this._widgets.set(r,new w5(e,this.auth.name,s||{})),this.counter++,r}reset(e){var s;const r=e||Ed;(s=this._widgets.get(r))===null||s===void 0||s.delete(),this._widgets.delete(r)}getResponse(e){var s;const r=e||Ed;return((s=this._widgets.get(r))===null||s===void 0?void 0:s.getResponse())||""}async execute(e){var s;const r=e||Ed;return(s=this._widgets.get(r))===null||s===void 0||s.execute(),""}}class w5{constructor(e,s,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;ce(i,"argument-error",{appName:s}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=b5(50);const{callback:e,"expired-callback":s}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,s)try{s()}catch{}this.isVisible&&this.execute()},y5)},x5))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function b5(t){const e=[],s="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(s.charAt(Math.floor(Math.random()*s.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km=pj("rcb"),N5=new _c(3e4,6e4);class j5{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=kt().grecaptcha)===null||e===void 0)&&e.render)}load(e,s=""){return ce(_5(s),e,"argument-error"),this.shouldResolveImmediately(s)&&Uy(kt().grecaptcha)?Promise.resolve(kt().grecaptcha):new Promise((r,i)=>{const a=kt().setTimeout(()=>{i(Vs(e,"network-request-failed"))},N5.get());kt()[Km]=()=>{kt().clearTimeout(a),delete kt()[Km];const l=kt().grecaptcha;if(!l||!Uy(l)){i(Vs(e,"internal-error"));return}const d=l.render;l.render=(u,h)=>{const p=d(u,h);return this.counter++,p},this.hostLanguage=s,r(l)};const o=`${NT()}?${jo({onload:Km,render:"explicit",hl:s})}`;Bg(o).catch(()=>{clearTimeout(a),i(Vs(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var s;return!!(!((s=kt().grecaptcha)===null||s===void 0)&&s.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function _5(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class k5{async load(e){return new v5(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj="recaptcha",E5={theme:"light",type:"image"};class Jy{constructor(e,s,r=Object.assign({},E5)){this.parameters=r,this.type=Rj,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Wn(e),this.isInvisible=this.parameters.size==="invisible",ce(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof s=="string"?document.getElementById(s):s;ce(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new k5:new j5,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),s=this.getAssertedRecaptcha(),r=s.getResponse(e);return r||new Promise(i=>{const a=o=>{o&&(this.tokenChangeListeners.delete(a),i(o))};this.tokenChangeListeners.add(a),this.isInvisible&&s.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ce(!this.parameters.sitekey,this.auth,"argument-error"),ce(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ce(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return s=>{if(this.tokenChangeListeners.forEach(r=>r(s)),typeof e=="function")e(s);else if(typeof e=="string"){const r=kt()[e];typeof r=="function"&&r(s)}}}assertNotDestroyed(){ce(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const s=document.createElement("div");e.appendChild(s),e=s}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ce(ZN()&&!Hg(),this.auth,"internal-error"),await I5(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await rT(this.auth);ce(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ce(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function I5(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e,s){this.verificationId=e,this.onConfirmation=s}confirm(e){const s=_l._fromVerification(this.verificationId,e);return this.onConfirmation(s)}}async function T5(t,e,s){if(vn(t.app))return Promise.reject(Vn(t));const r=Wn(t),i=await C5(r,e,Ye(s));return new S5(i,a=>bj(r,a))}async function C5(t,e,s){var r;const i=await s.verify();try{ce(typeof i=="string",t,"argument-error"),ce(s.type===Rj,t,"argument-error");let a;if(typeof e=="string"?a={phoneNumber:e}:a=e,"session"in a){const o=a.session;if("phoneNumber"in a)return ce(o.type==="enroll",t,"internal-error"),(await s5(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{ce(o.type==="signin",t,"internal-error");const l=((r=a.multiFactorHint)===null||r===void 0?void 0:r.uid)||a.multiFactorUid;return ce(l,t,"missing-multi-factor-info"),(await g5(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await FT(t,{phoneNumber:a.phoneNumber,recaptchaToken:i});return o}}finally{s._reset()}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A5(t,e){return e?or(e):(ce(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg extends Eh{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Za(e,this._buildIdpRequest())}_linkToIdToken(e,s){return Za(e,this._buildIdpRequest(s))}_getReauthenticationResolver(e){return Za(e,this._buildIdpRequest())}_buildIdpRequest(e){const s={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(s.idToken=e),s}}function R5(t){return wj(t.auth,new Wg(t),t.bypassAuthState)}function P5(t){const{auth:e,user:s}=t;return ce(s,e,"internal-error"),GT(s,new Wg(t),t.bypassAuthState)}async function D5(t){const{auth:e,user:s}=t;return ce(s,e,"internal-error"),KT(s,new Wg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj{constructor(e,s,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(s)?s:[s]}execute(){return new Promise(async(e,s)=>{this.pendingPromise={resolve:e,reject:s};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:s,sessionId:r,postBody:i,tenantId:a,error:o,type:l}=e;if(o){this.reject(o);return}const d={auth:this.auth,requestUri:s,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(d))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return R5;case"linkViaPopup":case"linkViaRedirect":return D5;case"reauthViaPopup":case"reauthViaRedirect":return P5;default:jn(this.auth,"internal-error")}}resolve(e){yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O5=new _c(2e3,1e4);class za extends Pj{constructor(e,s,r,i,a){super(e,s,i,a),this.provider=r,this.authWindow=null,this.pollId=null,za.currentPopupAction&&za.currentPopupAction.cancel(),za.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ce(e,this.auth,"internal-error"),e}async onExecution(){yr(this.filter.length===1,"Popup operations only handle one event");const e=qg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(s=>{this.reject(s)}),this.resolver._isIframeWebStorageSupported(this.auth,s=>{s||this.reject(Vs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Vs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,za.currentPopupAction=null}pollUserCancellation(){const e=()=>{var s,r;if(!((r=(s=this.authWindow)===null||s===void 0?void 0:s.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Vs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,O5.get())};e()}}za.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L5="pendingRedirect",eu=new Map;class M5 extends Pj{constructor(e,s,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],s,void 0,r),this.eventId=null}async execute(){let e=eu.get(this.auth._key());if(!e){try{const r=await V5(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(s){e=()=>Promise.reject(s)}eu.set(this.auth._key(),e)}return this.bypassAuthState||eu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const s=await this.auth._redirectUserForId(e.eventId);if(s)return this.user=s,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function V5(t,e){const s=$5(e),r=U5(t);if(!await r._isAvailable())return!1;const i=await r._get(s)==="true";return await r._remove(s),i}function F5(t,e){eu.set(t._key(),e)}function U5(t){return or(t._redirectPersistence)}function $5(t){return Zd(L5,t.config.apiKey,t.name)}async function B5(t,e,s=!1){if(vn(t.app))return Promise.reject(Vn(t));const r=Wn(t),i=A5(r,e),o=await new M5(r,i,s).execute();return o&&!s&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z5=10*60*1e3;class q5{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let s=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(s=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!H5(e)||(this.hasHandledPotentialRedirect=!0,s||(this.queuedRedirectEvent=e,s=!0)),s}sendToConsumer(e,s){var r;if(e.error&&!Dj(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";s.onError(Vs(this.auth,i))}else s.onAuthEvent(e)}isEventForConsumer(e,s){const r=s.eventId===null||!!e.eventId&&e.eventId===s.eventId;return s.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=z5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Zy(e))}saveEventToCache(e){this.cachedEventUids.add(Zy(e)),this.lastProcessedEventTime=Date.now()}}function Zy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Dj({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function H5(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Dj(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W5(t,e={}){return qs(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,G5=/^https?/;async function Q5(t){if(t.config.emulator)return;const{authorizedDomains:e}=await W5(t);for(const s of e)try{if(X5(s))return}catch{}jn(t,"unauthorized-domain")}function X5(t){const e=fp(),{protocol:s,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?s==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):s==="chrome-extension:"&&o.hostname===r}if(!G5.test(s))return!1;if(K5.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y5=new _c(3e4,6e4);function ev(){const t=kt().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let s=0;s<t.CP.length;s++)t.CP[s]=null}}function J5(t){return new Promise((e,s)=>{var r,i,a;function o(){ev(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ev(),s(Vs(t,"network-request-failed"))},timeout:Y5.get()})}if(!((i=(r=kt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((a=kt().gapi)===null||a===void 0)&&a.load)o();else{const l=pj("iframefcb");return kt()[l]=()=>{gapi.load?o():s(Vs(t,"network-request-failed"))},Bg(`${_T()}?onload=${l}`).catch(d=>s(d))}}).catch(e=>{throw tu=null,e})}let tu=null;function Z5(t){return tu=tu||J5(t),tu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=new _c(5e3,15e3),t4="__/auth/iframe",s4="emulator/auth/iframe",n4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},r4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function i4(t){const e=t.config;ce(e.authDomain,t,"auth-domain-config-required");const s=e.emulator?Fg(e,s4):`https://${t.config.authDomain}/${t4}`,r={apiKey:e.apiKey,appName:t.name,v:ca},i=r4.get(t.config.apiHost);i&&(r.eid=i);const a=t._getFrameworks();return a.length&&(r.fw=a.join(",")),`${s}?${jo(r).slice(1)}`}async function a4(t){const e=await Z5(t),s=kt().gapi;return ce(s,t,"internal-error"),e.open({where:document.body,url:i4(t),messageHandlersFilter:s.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:n4,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=Vs(t,"network-request-failed"),l=kt().setTimeout(()=>{a(o)},e4.get());function d(){kt().clearTimeout(l),i(r)}r.ping(d).then(d,()=>{a(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},l4=500,c4=600,d4="_blank",u4="http://localhost";class tv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function h4(t,e,s,r=l4,i=c4){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const d=Object.assign(Object.assign({},o4),{width:r.toString(),height:i.toString(),top:a,left:o}),u=cs().toLowerCase();s&&(l=lj(u)?d4:s),aj(u)&&(e=e||u4,d.scrollbars="yes");const h=Object.entries(d).reduce((g,[y,w])=>`${g}${y}=${w},`,"");if(fT(u)&&l!=="_self")return m4(e||"",l),new tv(null);const p=window.open(e||"",l,h);ce(p,t,"popup-blocked");try{p.focus()}catch{}return new tv(p)}function m4(t,e){const s=document.createElement("a");s.href=t,s.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),s.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4="__/auth/handler",p4="emulator/auth/handler",g4=encodeURIComponent("fac");async function sv(t,e,s,r,i,a){ce(t.config.authDomain,t,"auth-domain-config-required"),ce(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:s,redirectUrl:r,v:ca,eventId:i};if(e instanceof yj){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",VI(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof Ec){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const d=await t._getAppCheckToken(),u=d?`#${g4}=${encodeURIComponent(d)}`:"";return`${x4(t)}?${jo(l).slice(1)}${u}`}function x4({config:t}){return t.emulator?Fg(t,p4):`https://${t.authDomain}/${f4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gm="webStorageSupport";class y4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ij,this._completeRedirectFn=B5,this._overrideRedirectResult=F5}async _openPopup(e,s,r,i){var a;yr((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const o=await sv(e,s,r,fp(),i);return h4(e,o,qg())}async _openRedirect(e,s,r,i){await this._originValidation(e);const a=await sv(e,s,r,fp(),i);return o5(a),new Promise(()=>{})}_initialize(e){const s=e._key();if(this.eventManagers[s]){const{manager:i,promise:a}=this.eventManagers[s];return i?Promise.resolve(i):(yr(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[s]={promise:r},r.catch(()=>{delete this.eventManagers[s]}),r}async initAndGetManager(e){const s=await a4(e),r=new q5(e);return s.register("authEvent",i=>(ce(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=s,r}_isIframeWebStorageSupported(e,s){this.iframes[e._key()].send(Gm,{type:Gm},i=>{var a;const o=(a=i==null?void 0:i[0])===null||a===void 0?void 0:a[Gm];o!==void 0&&s(!!o),jn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const s=e._key();return this.originValidationPromises[s]||(this.originValidationPromises[s]=Q5(e)),this.originValidationPromises[s]}get _shouldInitProactively(){return mj()||oj()||$g()}}const v4=y4;var nv="@firebase/auth",rv="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const s=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,s),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const s=this.internalListeners.get(e);s&&(this.internalListeners.delete(e),s(),this.updateProactiveRefresh())}assertAuthConfigured(){ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function N4(t){Yi(new hi("auth",(e,{options:s})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ce(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const d={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fj(t)},u=new wT(r,i,a,d);return ST(u,s),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,s,r)=>{e.getProvider("auth-internal").initialize()})),Yi(new hi("auth-internal",e=>{const s=Wn(e.getProvider("auth").getImmediate());return(r=>new w4(r))(s)},"PRIVATE").setInstantiationMode("EXPLICIT")),Mn(nv,rv,b4(t)),Mn(nv,rv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j4=5*60,_4=BN("authIdTokenMaxAge")||j4;let iv=null;const k4=t=>async e=>{const s=e&&await e.getIdTokenResult(),r=s&&(new Date().getTime()-Date.parse(s.issuedAtTime))/1e3;if(r&&r>_4)return;const i=s==null?void 0:s.token;iv!==i&&(iv=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function E4(t=kh()){const e=_h(t,"auth");if(e.isInitialized())return e.getImmediate();const s=gj(t,{popupRedirectResolver:v4,persistence:[Aj,kj,Ij]}),r=BN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=k4(a.toString());JT(s,o,()=>o(s.currentUser)),YT(s,l=>o(l))}}const i=FN("auth");return i&&TT(s,`http://${i}`),s}function I4(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}bT({loadJS(t){return new Promise((e,s)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const a=Vs("internal-error");a.customData=i,s(a)},r.type="text/javascript",r.charset="UTF-8",I4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});N4("Browser");var S4="firebase",T4="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mn(S4,T4,"app");var av=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zi,Oj;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(b,m){function j(){}j.prototype=m.prototype,b.D=m.prototype,b.prototype=new j,b.prototype.constructor=b,b.C=function(I,T,D){for(var S=Array(arguments.length-2),W=2;W<arguments.length;W++)S[W-2]=arguments[W];return m.prototype[T].apply(I,S)}}function s(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,s),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(b,m,j){j||(j=0);var I=Array(16);if(typeof m=="string")for(var T=0;16>T;++T)I[T]=m.charCodeAt(j++)|m.charCodeAt(j++)<<8|m.charCodeAt(j++)<<16|m.charCodeAt(j++)<<24;else for(T=0;16>T;++T)I[T]=m[j++]|m[j++]<<8|m[j++]<<16|m[j++]<<24;m=b.g[0],j=b.g[1],T=b.g[2];var D=b.g[3],S=m+(D^j&(T^D))+I[0]+3614090360&4294967295;m=j+(S<<7&4294967295|S>>>25),S=D+(T^m&(j^T))+I[1]+3905402710&4294967295,D=m+(S<<12&4294967295|S>>>20),S=T+(j^D&(m^j))+I[2]+606105819&4294967295,T=D+(S<<17&4294967295|S>>>15),S=j+(m^T&(D^m))+I[3]+3250441966&4294967295,j=T+(S<<22&4294967295|S>>>10),S=m+(D^j&(T^D))+I[4]+4118548399&4294967295,m=j+(S<<7&4294967295|S>>>25),S=D+(T^m&(j^T))+I[5]+1200080426&4294967295,D=m+(S<<12&4294967295|S>>>20),S=T+(j^D&(m^j))+I[6]+2821735955&4294967295,T=D+(S<<17&4294967295|S>>>15),S=j+(m^T&(D^m))+I[7]+4249261313&4294967295,j=T+(S<<22&4294967295|S>>>10),S=m+(D^j&(T^D))+I[8]+1770035416&4294967295,m=j+(S<<7&4294967295|S>>>25),S=D+(T^m&(j^T))+I[9]+2336552879&4294967295,D=m+(S<<12&4294967295|S>>>20),S=T+(j^D&(m^j))+I[10]+4294925233&4294967295,T=D+(S<<17&4294967295|S>>>15),S=j+(m^T&(D^m))+I[11]+2304563134&4294967295,j=T+(S<<22&4294967295|S>>>10),S=m+(D^j&(T^D))+I[12]+1804603682&4294967295,m=j+(S<<7&4294967295|S>>>25),S=D+(T^m&(j^T))+I[13]+4254626195&4294967295,D=m+(S<<12&4294967295|S>>>20),S=T+(j^D&(m^j))+I[14]+2792965006&4294967295,T=D+(S<<17&4294967295|S>>>15),S=j+(m^T&(D^m))+I[15]+1236535329&4294967295,j=T+(S<<22&4294967295|S>>>10),S=m+(T^D&(j^T))+I[1]+4129170786&4294967295,m=j+(S<<5&4294967295|S>>>27),S=D+(j^T&(m^j))+I[6]+3225465664&4294967295,D=m+(S<<9&4294967295|S>>>23),S=T+(m^j&(D^m))+I[11]+643717713&4294967295,T=D+(S<<14&4294967295|S>>>18),S=j+(D^m&(T^D))+I[0]+3921069994&4294967295,j=T+(S<<20&4294967295|S>>>12),S=m+(T^D&(j^T))+I[5]+3593408605&4294967295,m=j+(S<<5&4294967295|S>>>27),S=D+(j^T&(m^j))+I[10]+38016083&4294967295,D=m+(S<<9&4294967295|S>>>23),S=T+(m^j&(D^m))+I[15]+3634488961&4294967295,T=D+(S<<14&4294967295|S>>>18),S=j+(D^m&(T^D))+I[4]+3889429448&4294967295,j=T+(S<<20&4294967295|S>>>12),S=m+(T^D&(j^T))+I[9]+568446438&4294967295,m=j+(S<<5&4294967295|S>>>27),S=D+(j^T&(m^j))+I[14]+3275163606&4294967295,D=m+(S<<9&4294967295|S>>>23),S=T+(m^j&(D^m))+I[3]+4107603335&4294967295,T=D+(S<<14&4294967295|S>>>18),S=j+(D^m&(T^D))+I[8]+1163531501&4294967295,j=T+(S<<20&4294967295|S>>>12),S=m+(T^D&(j^T))+I[13]+2850285829&4294967295,m=j+(S<<5&4294967295|S>>>27),S=D+(j^T&(m^j))+I[2]+4243563512&4294967295,D=m+(S<<9&4294967295|S>>>23),S=T+(m^j&(D^m))+I[7]+1735328473&4294967295,T=D+(S<<14&4294967295|S>>>18),S=j+(D^m&(T^D))+I[12]+2368359562&4294967295,j=T+(S<<20&4294967295|S>>>12),S=m+(j^T^D)+I[5]+4294588738&4294967295,m=j+(S<<4&4294967295|S>>>28),S=D+(m^j^T)+I[8]+2272392833&4294967295,D=m+(S<<11&4294967295|S>>>21),S=T+(D^m^j)+I[11]+1839030562&4294967295,T=D+(S<<16&4294967295|S>>>16),S=j+(T^D^m)+I[14]+4259657740&4294967295,j=T+(S<<23&4294967295|S>>>9),S=m+(j^T^D)+I[1]+2763975236&4294967295,m=j+(S<<4&4294967295|S>>>28),S=D+(m^j^T)+I[4]+1272893353&4294967295,D=m+(S<<11&4294967295|S>>>21),S=T+(D^m^j)+I[7]+4139469664&4294967295,T=D+(S<<16&4294967295|S>>>16),S=j+(T^D^m)+I[10]+3200236656&4294967295,j=T+(S<<23&4294967295|S>>>9),S=m+(j^T^D)+I[13]+681279174&4294967295,m=j+(S<<4&4294967295|S>>>28),S=D+(m^j^T)+I[0]+3936430074&4294967295,D=m+(S<<11&4294967295|S>>>21),S=T+(D^m^j)+I[3]+3572445317&4294967295,T=D+(S<<16&4294967295|S>>>16),S=j+(T^D^m)+I[6]+76029189&4294967295,j=T+(S<<23&4294967295|S>>>9),S=m+(j^T^D)+I[9]+3654602809&4294967295,m=j+(S<<4&4294967295|S>>>28),S=D+(m^j^T)+I[12]+3873151461&4294967295,D=m+(S<<11&4294967295|S>>>21),S=T+(D^m^j)+I[15]+530742520&4294967295,T=D+(S<<16&4294967295|S>>>16),S=j+(T^D^m)+I[2]+3299628645&4294967295,j=T+(S<<23&4294967295|S>>>9),S=m+(T^(j|~D))+I[0]+4096336452&4294967295,m=j+(S<<6&4294967295|S>>>26),S=D+(j^(m|~T))+I[7]+1126891415&4294967295,D=m+(S<<10&4294967295|S>>>22),S=T+(m^(D|~j))+I[14]+2878612391&4294967295,T=D+(S<<15&4294967295|S>>>17),S=j+(D^(T|~m))+I[5]+4237533241&4294967295,j=T+(S<<21&4294967295|S>>>11),S=m+(T^(j|~D))+I[12]+1700485571&4294967295,m=j+(S<<6&4294967295|S>>>26),S=D+(j^(m|~T))+I[3]+2399980690&4294967295,D=m+(S<<10&4294967295|S>>>22),S=T+(m^(D|~j))+I[10]+4293915773&4294967295,T=D+(S<<15&4294967295|S>>>17),S=j+(D^(T|~m))+I[1]+2240044497&4294967295,j=T+(S<<21&4294967295|S>>>11),S=m+(T^(j|~D))+I[8]+1873313359&4294967295,m=j+(S<<6&4294967295|S>>>26),S=D+(j^(m|~T))+I[15]+4264355552&4294967295,D=m+(S<<10&4294967295|S>>>22),S=T+(m^(D|~j))+I[6]+2734768916&4294967295,T=D+(S<<15&4294967295|S>>>17),S=j+(D^(T|~m))+I[13]+1309151649&4294967295,j=T+(S<<21&4294967295|S>>>11),S=m+(T^(j|~D))+I[4]+4149444226&4294967295,m=j+(S<<6&4294967295|S>>>26),S=D+(j^(m|~T))+I[11]+3174756917&4294967295,D=m+(S<<10&4294967295|S>>>22),S=T+(m^(D|~j))+I[2]+718787259&4294967295,T=D+(S<<15&4294967295|S>>>17),S=j+(D^(T|~m))+I[9]+3951481745&4294967295,b.g[0]=b.g[0]+m&4294967295,b.g[1]=b.g[1]+(T+(S<<21&4294967295|S>>>11))&4294967295,b.g[2]=b.g[2]+T&4294967295,b.g[3]=b.g[3]+D&4294967295}r.prototype.u=function(b,m){m===void 0&&(m=b.length);for(var j=m-this.blockSize,I=this.B,T=this.h,D=0;D<m;){if(T==0)for(;D<=j;)i(this,b,D),D+=this.blockSize;if(typeof b=="string"){for(;D<m;)if(I[T++]=b.charCodeAt(D++),T==this.blockSize){i(this,I),T=0;break}}else for(;D<m;)if(I[T++]=b[D++],T==this.blockSize){i(this,I),T=0;break}}this.h=T,this.o+=m},r.prototype.v=function(){var b=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);b[0]=128;for(var m=1;m<b.length-8;++m)b[m]=0;var j=8*this.o;for(m=b.length-8;m<b.length;++m)b[m]=j&255,j/=256;for(this.u(b),b=Array(16),m=j=0;4>m;++m)for(var I=0;32>I;I+=8)b[j++]=this.g[m]>>>I&255;return b};function a(b,m){var j=l;return Object.prototype.hasOwnProperty.call(j,b)?j[b]:j[b]=m(b)}function o(b,m){this.h=m;for(var j=[],I=!0,T=b.length-1;0<=T;T--){var D=b[T]|0;I&&D==m||(j[T]=D,I=!1)}this.g=j}var l={};function d(b){return-128<=b&&128>b?a(b,function(m){return new o([m|0],0>m?-1:0)}):new o([b|0],0>b?-1:0)}function u(b){if(isNaN(b)||!isFinite(b))return p;if(0>b)return E(u(-b));for(var m=[],j=1,I=0;b>=j;I++)m[I]=b/j|0,j*=4294967296;return new o(m,0)}function h(b,m){if(b.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(b.charAt(0)=="-")return E(h(b.substring(1),m));if(0<=b.indexOf("-"))throw Error('number format error: interior "-" character');for(var j=u(Math.pow(m,8)),I=p,T=0;T<b.length;T+=8){var D=Math.min(8,b.length-T),S=parseInt(b.substring(T,T+D),m);8>D?(D=u(Math.pow(m,D)),I=I.j(D).add(u(S))):(I=I.j(j),I=I.add(u(S)))}return I}var p=d(0),g=d(1),y=d(16777216);t=o.prototype,t.m=function(){if(C(this))return-E(this).m();for(var b=0,m=1,j=0;j<this.g.length;j++){var I=this.i(j);b+=(0<=I?I:4294967296+I)*m,m*=4294967296}return b},t.toString=function(b){if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(w(this))return"0";if(C(this))return"-"+E(this).toString(b);for(var m=u(Math.pow(b,6)),j=this,I="";;){var T=P(j,m).g;j=N(j,T.j(m));var D=((0<j.g.length?j.g[0]:j.h)>>>0).toString(b);if(j=T,w(j))return D+I;for(;6>D.length;)D="0"+D;I=D+I}},t.i=function(b){return 0>b?0:b<this.g.length?this.g[b]:this.h};function w(b){if(b.h!=0)return!1;for(var m=0;m<b.g.length;m++)if(b.g[m]!=0)return!1;return!0}function C(b){return b.h==-1}t.l=function(b){return b=N(this,b),C(b)?-1:w(b)?0:1};function E(b){for(var m=b.g.length,j=[],I=0;I<m;I++)j[I]=~b.g[I];return new o(j,~b.h).add(g)}t.abs=function(){return C(this)?E(this):this},t.add=function(b){for(var m=Math.max(this.g.length,b.g.length),j=[],I=0,T=0;T<=m;T++){var D=I+(this.i(T)&65535)+(b.i(T)&65535),S=(D>>>16)+(this.i(T)>>>16)+(b.i(T)>>>16);I=S>>>16,D&=65535,S&=65535,j[T]=S<<16|D}return new o(j,j[j.length-1]&-2147483648?-1:0)};function N(b,m){return b.add(E(m))}t.j=function(b){if(w(this)||w(b))return p;if(C(this))return C(b)?E(this).j(E(b)):E(E(this).j(b));if(C(b))return E(this.j(E(b)));if(0>this.l(y)&&0>b.l(y))return u(this.m()*b.m());for(var m=this.g.length+b.g.length,j=[],I=0;I<2*m;I++)j[I]=0;for(I=0;I<this.g.length;I++)for(var T=0;T<b.g.length;T++){var D=this.i(I)>>>16,S=this.i(I)&65535,W=b.i(T)>>>16,F=b.i(T)&65535;j[2*I+2*T]+=S*F,v(j,2*I+2*T),j[2*I+2*T+1]+=D*F,v(j,2*I+2*T+1),j[2*I+2*T+1]+=S*W,v(j,2*I+2*T+1),j[2*I+2*T+2]+=D*W,v(j,2*I+2*T+2)}for(I=0;I<m;I++)j[I]=j[2*I+1]<<16|j[2*I];for(I=m;I<2*m;I++)j[I]=0;return new o(j,0)};function v(b,m){for(;(b[m]&65535)!=b[m];)b[m+1]+=b[m]>>>16,b[m]&=65535,m++}function k(b,m){this.g=b,this.h=m}function P(b,m){if(w(m))throw Error("division by zero");if(w(b))return new k(p,p);if(C(b))return m=P(E(b),m),new k(E(m.g),E(m.h));if(C(m))return m=P(b,E(m)),new k(E(m.g),m.h);if(30<b.g.length){if(C(b)||C(m))throw Error("slowDivide_ only works with positive integers.");for(var j=g,I=m;0>=I.l(b);)j=O(j),I=O(I);var T=U(j,1),D=U(I,1);for(I=U(I,2),j=U(j,2);!w(I);){var S=D.add(I);0>=S.l(b)&&(T=T.add(j),D=S),I=U(I,1),j=U(j,1)}return m=N(b,T.j(m)),new k(T,m)}for(T=p;0<=b.l(m);){for(j=Math.max(1,Math.floor(b.m()/m.m())),I=Math.ceil(Math.log(j)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),D=u(j),S=D.j(m);C(S)||0<S.l(b);)j-=I,D=u(j),S=D.j(m);w(D)&&(D=g),T=T.add(D),b=N(b,S)}return new k(T,b)}t.A=function(b){return P(this,b).h},t.and=function(b){for(var m=Math.max(this.g.length,b.g.length),j=[],I=0;I<m;I++)j[I]=this.i(I)&b.i(I);return new o(j,this.h&b.h)},t.or=function(b){for(var m=Math.max(this.g.length,b.g.length),j=[],I=0;I<m;I++)j[I]=this.i(I)|b.i(I);return new o(j,this.h|b.h)},t.xor=function(b){for(var m=Math.max(this.g.length,b.g.length),j=[],I=0;I<m;I++)j[I]=this.i(I)^b.i(I);return new o(j,this.h^b.h)};function O(b){for(var m=b.g.length+1,j=[],I=0;I<m;I++)j[I]=b.i(I)<<1|b.i(I-1)>>>31;return new o(j,b.h)}function U(b,m){var j=m>>5;m%=32;for(var I=b.g.length-j,T=[],D=0;D<I;D++)T[D]=0<m?b.i(D+j)>>>m|b.i(D+j+1)<<32-m:b.i(D+j);return new o(T,b.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Oj=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,zi=o}).apply(typeof av<"u"?av:typeof self<"u"?self:typeof window<"u"?window:{});var Id=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Lj,ul,Mj,su,xp,Vj,Fj,Uj;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,f,x){return c==Array.prototype||c==Object.prototype||(c[f]=x.value),c};function s(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Id=="object"&&Id];for(var f=0;f<c.length;++f){var x=c[f];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=s(this);function i(c,f){if(f)e:{var x=r;c=c.split(".");for(var R=0;R<c.length-1;R++){var q=c[R];if(!(q in x))break e;x=x[q]}c=c[c.length-1],R=x[c],f=f(R),f!=R&&f!=null&&e(x,c,{configurable:!0,writable:!0,value:f})}}function a(c,f){c instanceof String&&(c+="");var x=0,R=!1,q={next:function(){if(!R&&x<c.length){var H=x++;return{value:f(H,c[H]),done:!1}}return R=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}i("Array.prototype.values",function(c){return c||function(){return a(this,function(f,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function d(c){var f=typeof c;return f=f!="object"?f:c?Array.isArray(c)?"array":f:"null",f=="array"||f=="object"&&typeof c.length=="number"}function u(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function h(c,f,x){return c.call.apply(c.bind,arguments)}function p(c,f,x){if(!c)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,R),c.apply(f,q)}}return function(){return c.apply(f,arguments)}}function g(c,f,x){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,g.apply(null,arguments)}function y(c,f){var x=Array.prototype.slice.call(arguments,1);return function(){var R=x.slice();return R.push.apply(R,arguments),c.apply(this,R)}}function w(c,f){function x(){}x.prototype=f.prototype,c.aa=f.prototype,c.prototype=new x,c.prototype.constructor=c,c.Qb=function(R,q,H){for(var ne=Array(arguments.length-2),He=2;He<arguments.length;He++)ne[He-2]=arguments[He];return f.prototype[q].apply(R,ne)}}function C(c){const f=c.length;if(0<f){const x=Array(f);for(let R=0;R<f;R++)x[R]=c[R];return x}return[]}function E(c,f){for(let x=1;x<arguments.length;x++){const R=arguments[x];if(d(R)){const q=c.length||0,H=R.length||0;c.length=q+H;for(let ne=0;ne<H;ne++)c[q+ne]=R[ne]}else c.push(R)}}class N{constructor(f,x){this.i=f,this.j=x,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function v(c){return/^[\s\xa0]*$/.test(c)}function k(){var c=l.navigator;return c&&(c=c.userAgent)?c:""}function P(c){return P[" "](c),c}P[" "]=function(){};var O=k().indexOf("Gecko")!=-1&&!(k().toLowerCase().indexOf("webkit")!=-1&&k().indexOf("Edge")==-1)&&!(k().indexOf("Trident")!=-1||k().indexOf("MSIE")!=-1)&&k().indexOf("Edge")==-1;function U(c,f,x){for(const R in c)f.call(x,c[R],R,c)}function b(c,f){for(const x in c)f.call(void 0,c[x],x,c)}function m(c){const f={};for(const x in c)f[x]=c[x];return f}const j="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(c,f){let x,R;for(let q=1;q<arguments.length;q++){R=arguments[q];for(x in R)c[x]=R[x];for(let H=0;H<j.length;H++)x=j[H],Object.prototype.hasOwnProperty.call(R,x)&&(c[x]=R[x])}}function T(c){var f=1;c=c.split(":");const x=[];for(;0<f&&c.length;)x.push(c.shift()),f--;return c.length&&x.push(c.join(":")),x}function D(c){l.setTimeout(()=>{throw c},0)}function S(){var c=$;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class W{constructor(){this.h=this.g=null}add(f,x){const R=F.get();R.set(f,x),this.h?this.h.next=R:this.g=R,this.h=R}}var F=new N(()=>new V,c=>c.reset());class V{constructor(){this.next=this.g=this.h=null}set(f,x){this.h=f,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let z,L=!1,$=new W,M=()=>{const c=l.Promise.resolve(void 0);z=()=>{c.then(G)}};var G=()=>{for(var c;c=S();){try{c.h.call(c.g)}catch(x){D(x)}var f=F;f.j(c),100>f.h&&(f.h++,c.next=f.g,f.g=c)}L=!1};function Y(){this.s=this.s,this.C=this.C}Y.prototype.s=!1,Y.prototype.ma=function(){this.s||(this.s=!0,this.N())},Y.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ie(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}ie.prototype.h=function(){this.defaultPrevented=!0};var le=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const x=()=>{};l.addEventListener("test",x,f),l.removeEventListener("test",x,f)}catch{}return c}();function pe(c,f){if(ie.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var x=this.type=c.type,R=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget){if(O){e:{try{P(f.nodeName);var q=!0;break e}catch{}q=!1}q||(f=null)}}else x=="mouseover"?f=c.fromElement:x=="mouseout"&&(f=c.toElement);this.relatedTarget=f,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:Ae[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&pe.aa.h.call(this)}}w(pe,ie);var Ae={2:"touch",3:"pen",4:"mouse"};pe.prototype.h=function(){pe.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var De="closure_listenable_"+(1e6*Math.random()|0),$e=0;function jt(c,f,x,R,q){this.listener=c,this.proxy=null,this.src=f,this.type=x,this.capture=!!R,this.ha=q,this.key=++$e,this.da=this.fa=!1}function Pt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function rt(c){this.src=c,this.g={},this.h=0}rt.prototype.add=function(c,f,x,R,q){var H=c.toString();c=this.g[H],c||(c=this.g[H]=[],this.h++);var ne=Hs(c,f,R,q);return-1<ne?(f=c[ne],x||(f.fa=!1)):(f=new jt(f,this.src,H,!!R,q),f.fa=x,c.push(f)),f};function qt(c,f){var x=f.type;if(x in c.g){var R=c.g[x],q=Array.prototype.indexOf.call(R,f,void 0),H;(H=0<=q)&&Array.prototype.splice.call(R,q,1),H&&(Pt(f),c.g[x].length==0&&(delete c.g[x],c.h--))}}function Hs(c,f,x,R){for(var q=0;q<c.length;++q){var H=c[q];if(!H.da&&H.listener==f&&H.capture==!!x&&H.ha==R)return q}return-1}var kn="closure_lm_"+(1e6*Math.random()|0),Er={};function _i(c,f,x,R,q){if(Array.isArray(f)){for(var H=0;H<f.length;H++)_i(c,f[H],x,R,q);return null}return x=Tr(x),c&&c[De]?c.K(f,x,u(R)?!!R.capture:!1,q):ma(c,f,x,!1,R,q)}function ma(c,f,x,R,q,H){if(!f)throw Error("Invalid event type");var ne=u(q)?!!q.capture:!!q,He=Qn(c);if(He||(c[kn]=He=new rt(c)),x=He.add(f,x,R,ne,H),x.proxy)return x;if(R=ki(),x.proxy=R,R.src=c,R.listener=x,c.addEventListener)le||(q=ne),q===void 0&&(q=!1),c.addEventListener(f.toString(),R,q);else if(c.attachEvent)c.attachEvent(Ir(f.toString()),R);else if(c.addListener&&c.removeListener)c.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return x}function ki(){function c(x){return f.call(c.src,c.listener,x)}const f=Sr;return c}function Gn(c,f,x,R,q){if(Array.isArray(f))for(var H=0;H<f.length;H++)Gn(c,f[H],x,R,q);else R=u(R)?!!R.capture:!!R,x=Tr(x),c&&c[De]?(c=c.i,f=String(f).toString(),f in c.g&&(H=c.g[f],x=Hs(H,x,R,q),-1<x&&(Pt(H[x]),Array.prototype.splice.call(H,x,1),H.length==0&&(delete c.g[f],c.h--)))):c&&(c=Qn(c))&&(f=c.g[f.toString()],c=-1,f&&(c=Hs(f,x,R,q)),(x=-1<c?f[c]:null)&&Ws(x))}function Ws(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[De])qt(f.i,c);else{var x=c.type,R=c.proxy;f.removeEventListener?f.removeEventListener(x,R,c.capture):f.detachEvent?f.detachEvent(Ir(x),R):f.addListener&&f.removeListener&&f.removeListener(R),(x=Qn(f))?(qt(x,c),x.h==0&&(x.src=null,f[kn]=null)):Pt(c)}}}function Ir(c){return c in Er?Er[c]:Er[c]="on"+c}function Sr(c,f){if(c.da)c=!0;else{f=new pe(f,this);var x=c.listener,R=c.ha||c.src;c.fa&&Ws(c),c=x.call(R,f)}return c}function Qn(c){return c=c[kn],c instanceof rt?c:null}var Ks="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tr(c){return typeof c=="function"?c:(c[Ks]||(c[Ks]=function(f){return c.handleEvent(f)}),c[Ks])}function it(){Y.call(this),this.i=new rt(this),this.M=this,this.F=null}w(it,Y),it.prototype[De]=!0,it.prototype.removeEventListener=function(c,f,x,R){Gn(this,c,f,x,R)};function gt(c,f){var x,R=c.F;if(R)for(x=[];R;R=R.F)x.push(R);if(c=c.M,R=f.type||f,typeof f=="string")f=new ie(f,c);else if(f instanceof ie)f.target=f.target||c;else{var q=f;f=new ie(R,c),I(f,q)}if(q=!0,x)for(var H=x.length-1;0<=H;H--){var ne=f.g=x[H];q=dn(ne,R,!0,f)&&q}if(ne=f.g=c,q=dn(ne,R,!0,f)&&q,q=dn(ne,R,!1,f)&&q,x)for(H=0;H<x.length;H++)ne=f.g=x[H],q=dn(ne,R,!1,f)&&q}it.prototype.N=function(){if(it.aa.N.call(this),this.i){var c=this.i,f;for(f in c.g){for(var x=c.g[f],R=0;R<x.length;R++)Pt(x[R]);delete c.g[f],c.h--}}this.F=null},it.prototype.K=function(c,f,x,R){return this.i.add(String(c),f,!1,x,R)},it.prototype.L=function(c,f,x,R){return this.i.add(String(c),f,!0,x,R)};function dn(c,f,x,R){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();for(var q=!0,H=0;H<f.length;++H){var ne=f[H];if(ne&&!ne.da&&ne.capture==x){var He=ne.listener,Ht=ne.ha||ne.src;ne.fa&&qt(c.i,ne),q=He.call(Ht,R)!==!1&&q}}return q&&!R.defaultPrevented}function ue(c,f,x){if(typeof c=="function")x&&(c=g(c,x));else if(c&&typeof c.handleEvent=="function")c=g(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:l.setTimeout(c,f||0)}function _e(c){c.g=ue(()=>{c.g=null,c.i&&(c.i=!1,_e(c))},c.l);const f=c.h;c.h=null,c.m.apply(null,f)}class Ke extends Y{constructor(f,x){super(),this.m=f,this.l=x,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:_e(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Be(c){Y.call(this),this.h=c,this.g={}}w(Be,Y);var Ro=[];function fa(c){U(c.g,function(f,x){this.g.hasOwnProperty(x)&&Ws(f)},c),c.g={}}Be.prototype.N=function(){Be.aa.N.call(this),fa(this)},Be.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pa=l.JSON.stringify,Bc=l.JSON.parse,zc=class{stringify(c){return l.JSON.stringify(c,void 0)}parse(c){return l.JSON.parse(c,void 0)}};function ga(){}ga.prototype.h=null;function Po(c){return c.h||(c.h=c.i())}function En(){}var Cr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ar(){ie.call(this,"d")}w(Ar,ie);function xa(){ie.call(this,"c")}w(xa,ie);var In={},Do=null;function un(){return Do=Do||new it}In.La="serverreachability";function qc(c){ie.call(this,In.La,c)}w(qc,ie);function Ei(c){const f=un();gt(f,new qc(f))}In.STAT_EVENT="statevent";function ya(c,f){ie.call(this,In.STAT_EVENT,c),this.stat=f}w(ya,ie);function St(c){const f=un();gt(f,new ya(f,c))}In.Ma="timingevent";function va(c,f){ie.call(this,In.Ma,c),this.size=f}w(va,ie);function Rr(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){c()},f)}function Xn(){this.g=!0}Xn.prototype.xa=function(){this.g=!1};function wa(c,f,x,R,q,H){c.info(function(){if(c.g)if(H)for(var ne="",He=H.split("&"),Ht=0;Ht<He.length;Ht++){var Oe=He[Ht].split("=");if(1<Oe.length){var Zt=Oe[0];Oe=Oe[1];var es=Zt.split("_");ne=2<=es.length&&es[1]=="type"?ne+(Zt+"="+Oe+"&"):ne+(Zt+"=redacted&")}}else ne=null;else ne=H;return"XMLHTTP REQ ("+R+") [attempt "+q+"]: "+f+`
`+x+`
`+ne})}function Oo(c,f,x,R,q,H,ne){c.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+q+"]: "+f+`
`+x+`
`+H+" "+ne})}function Yn(c,f,x,R){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+Hc(c,x)+(R?" "+R:"")})}function Lo(c,f){c.info(function(){return"TIMEOUT: "+f})}Xn.prototype.info=function(){};function Hc(c,f){if(!c.g)return f;if(!f)return null;try{var x=JSON.parse(f);if(x){for(c=0;c<x.length;c++)if(Array.isArray(x[c])){var R=x[c];if(!(2>R.length)){var q=R[1];if(Array.isArray(q)&&!(1>q.length)){var H=q[0];if(H!="noop"&&H!="stop"&&H!="close")for(var ne=1;ne<q.length;ne++)q[ne]=""}}}}return pa(x)}catch{return f}}var Pr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Mo={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ba;function hn(){}w(hn,ga),hn.prototype.g=function(){return new XMLHttpRequest},hn.prototype.i=function(){return{}},ba=new hn;function Sn(c,f,x,R){this.j=c,this.i=f,this.l=x,this.R=R||1,this.U=new Be(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gs}function Gs(){this.i=null,this.g="",this.h=!1}var Wc={},Kc={};function Gc(c,f,x){c.L=1,c.v=J(Qs(f)),c.m=x,c.P=!0,Zh(c,null)}function Zh(c,f){c.F=Date.now(),Vo(c),c.A=Qs(c.v);var x=c.A,R=c.R;Array.isArray(R)||(R=[String(R)]),Bo(x.i,"t",R),c.C=0,x=c.j.J,c.h=new Gs,c.g=l0(c.j,x?f:null,!c.m),0<c.O&&(c.M=new Ke(g(c.Y,c,c.g),c.O)),f=c.U,x=c.g,R=c.ca;var q="readystatechange";Array.isArray(q)||(q&&(Ro[0]=q.toString()),q=Ro);for(var H=0;H<q.length;H++){var ne=_i(x,q[H],R||f.handleEvent,!1,f.h||f);if(!ne)break;f.g[ne.key]=ne}f=c.H?m(c.H):{},c.m?(c.u||(c.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,f)):(c.u="GET",c.g.ea(c.A,c.u,null,f)),Ei(),wa(c.i,c.u,c.A,c.l,c.R,c.m)}Sn.prototype.ca=function(c){c=c.target;const f=this.M;f&&Zn(c)==3?f.j():this.Y(c)},Sn.prototype.Y=function(c){try{if(c==this.g)e:{const es=Zn(this.g);var f=this.g.Ba();const ka=this.g.Z();if(!(3>es)&&(es!=3||this.g&&(this.h.h||this.g.oa()||Yx(this.g)))){this.J||es!=4||f==7||(f==8||0>=ka?Ei(3):Ei(2)),Qc(this);var x=this.g.Z();this.X=x;t:if(em(this)){var R=Yx(this.g);c="";var q=R.length,H=Zn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Dr(this),Na(this);var ne="";break t}this.h.i=new l.TextDecoder}for(f=0;f<q;f++)this.h.h=!0,c+=this.h.i.decode(R[f],{stream:!(H&&f==q-1)});R.length=0,this.h.g+=c,this.C=0,ne=this.h.g}else ne=this.g.oa();if(this.o=x==200,Oo(this.i,this.u,this.A,this.l,this.R,es,x),this.o){if(this.T&&!this.K){t:{if(this.g){var He,Ht=this.g;if((He=Ht.g?Ht.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(He)){var Oe=He;break t}}Oe=null}if(x=Oe)Yn(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fo(this,x);else{this.o=!1,this.s=3,St(12),Dr(this),Na(this);break e}}if(this.P){x=!0;let fn;for(;!this.J&&this.C<ne.length;)if(fn=qx(this,ne),fn==Kc){es==4&&(this.s=4,St(14),x=!1),Yn(this.i,this.l,null,"[Incomplete Response]");break}else if(fn==Wc){this.s=4,St(15),Yn(this.i,this.l,ne,"[Invalid Chunk]"),x=!1;break}else Yn(this.i,this.l,fn,null),Fo(this,fn);if(em(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),es!=4||ne.length!=0||this.h.h||(this.s=1,St(16),x=!1),this.o=this.o&&x,!x)Yn(this.i,this.l,ne,"[Invalid Chunked Response]"),Dr(this),Na(this);else if(0<ne.length&&!this.W){this.W=!0;var Zt=this.j;Zt.g==this&&Zt.ba&&!Zt.M&&(Zt.j.info("Great, no buffering proxy detected. Bytes received: "+ne.length),hm(Zt),Zt.M=!0,St(11))}}else Yn(this.i,this.l,ne,null),Fo(this,ne);es==4&&Dr(this),this.o&&!this.J&&(es==4?r0(this.j,this):(this.o=!1,Vo(this)))}else F1(this.g),x==400&&0<ne.indexOf("Unknown SID")?(this.s=3,St(12)):(this.s=0,St(13)),Dr(this),Na(this)}}}catch{}finally{}};function em(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function qx(c,f){var x=c.C,R=f.indexOf(`
`,x);return R==-1?Kc:(x=Number(f.substring(x,R)),isNaN(x)?Wc:(R+=1,R+x>f.length?Kc:(f=f.slice(R,R+x),c.C=R+x,f)))}Sn.prototype.cancel=function(){this.J=!0,Dr(this)};function Vo(c){c.S=Date.now()+c.I,tm(c,c.I)}function tm(c,f){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Rr(g(c.ba,c),f)}function Qc(c){c.B&&(l.clearTimeout(c.B),c.B=null)}Sn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(Lo(this.i,this.A),this.L!=2&&(Ei(),St(17)),Dr(this),this.s=2,Na(this)):tm(this,this.S-c)};function Na(c){c.j.G==0||c.J||r0(c.j,c)}function Dr(c){Qc(c);var f=c.M;f&&typeof f.ma=="function"&&f.ma(),c.M=null,fa(c.U),c.g&&(f=c.g,c.g=null,f.abort(),f.ma())}function Fo(c,f){try{var x=c.j;if(x.G!=0&&(x.g==c||Ii(x.h,c))){if(!c.K&&Ii(x.h,c)&&x.G==3){try{var R=x.Da.g.parse(f)}catch{R=null}if(Array.isArray(R)&&R.length==3){var q=R;if(q[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<c.F)ad(x),rd(x);else break e;um(x),St(18)}}else x.za=q[1],0<x.za-x.T&&37500>q[2]&&x.F&&x.v==0&&!x.C&&(x.C=Rr(g(x.Za,x),6e3));if(1>=xt(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else Ci(x,11)}else if((c.K||x.g==c)&&ad(x),!v(f))for(q=x.Da.g.parse(f),f=0;f<q.length;f++){let Oe=q[f];if(x.T=Oe[0],Oe=Oe[1],x.G==2)if(Oe[0]=="c"){x.K=Oe[1],x.ia=Oe[2];const Zt=Oe[3];Zt!=null&&(x.la=Zt,x.j.info("VER="+x.la));const es=Oe[4];es!=null&&(x.Aa=es,x.j.info("SVER="+x.Aa));const ka=Oe[5];ka!=null&&typeof ka=="number"&&0<ka&&(R=1.5*ka,x.L=R,x.j.info("backChannelRequestTimeoutMs_="+R)),R=x;const fn=c.g;if(fn){const ld=fn.g?fn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ld){var H=R.h;H.g||ld.indexOf("spdy")==-1&&ld.indexOf("quic")==-1&&ld.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(Uo(H,H.h),H.h=null))}if(R.D){const mm=fn.g?fn.g.getResponseHeader("X-HTTP-Session-Id"):null;mm&&(R.ya=mm,A(R.I,R.D,mm))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-c.F,x.j.info("Handshake RTT: "+x.R+"ms")),R=x;var ne=c;if(R.qa=o0(R,R.J?R.ia:null,R.W),ne.K){Jc(R.h,ne);var He=ne,Ht=R.L;Ht&&(He.I=Ht),He.B&&(Qc(He),Vo(He)),R.g=ne}else s0(R);0<x.i.length&&id(x)}else Oe[0]!="stop"&&Oe[0]!="close"||Ci(x,7);else x.G==3&&(Oe[0]=="stop"||Oe[0]=="close"?Oe[0]=="stop"?Ci(x,7):dm(x):Oe[0]!="noop"&&x.l&&x.l.ta(Oe),x.v=0)}}Ei(4)}catch{}}var sm=class{constructor(c,f){this.g=c,this.map=f}};function Xc(c){this.l=c||10,l.PerformanceNavigationTiming?(c=l.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Yc(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function xt(c){return c.h?1:c.g?c.g.size:0}function Ii(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function Uo(c,f){c.g?c.g.add(f):c.h=f}function Jc(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}Xc.prototype.cancel=function(){if(this.i=Zc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Zc(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let f=c.i;for(const x of c.g.values())f=f.concat(x.D);return f}return C(c.i)}function nm(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(d(c)){for(var f=[],x=c.length,R=0;R<x;R++)f.push(c[R]);return f}f=[],x=0;for(R in c)f[x++]=c[R];return f}function rm(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(d(c)||typeof c=="string"){var f=[];c=c.length;for(var x=0;x<c;x++)f.push(x);return f}f=[],x=0;for(const R in c)f[x++]=R;return f}}}function ed(c,f){if(c.forEach&&typeof c.forEach=="function")c.forEach(f,void 0);else if(d(c)||typeof c=="string")Array.prototype.forEach.call(c,f,void 0);else for(var x=rm(c),R=nm(c),q=R.length,H=0;H<q;H++)f.call(void 0,R[H],x&&x[H],c)}var td=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function im(c,f){if(c){c=c.split("&");for(var x=0;x<c.length;x++){var R=c[x].indexOf("="),q=null;if(0<=R){var H=c[x].substring(0,R);q=c[x].substring(R+1)}else H=c[x];f(H,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function Jn(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Jn){this.h=c.h,Si(this,c.j),this.o=c.o,this.g=c.g,Ti(this,c.s),this.l=c.l;var f=c.i,x=new mt;x.i=f.i,f.g&&(x.g=new Map(f.g),x.h=f.h),$o(this,x),this.m=c.m}else c&&(f=String(c).match(td))?(this.h=!1,Si(this,f[1]||"",!0),this.o=Q(f[2]||""),this.g=Q(f[3]||"",!0),Ti(this,f[4]),this.l=Q(f[5]||"",!0),$o(this,f[6]||"",!0),this.m=Q(f[7]||"")):(this.h=!1,this.i=new mt(null,this.h))}Jn.prototype.toString=function(){var c=[],f=this.j;f&&c.push(ge(f,ze,!0),":");var x=this.g;return(x||f=="file")&&(c.push("//"),(f=this.o)&&c.push(ge(f,ze,!0),"@"),c.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&c.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&c.push("/"),c.push(ge(x,x.charAt(0)=="/"?ds:Dt,!0))),(x=this.i.toString())&&c.push("?",x),(x=this.m)&&c.push("#",ge(x,qe)),c.join("")};function Qs(c){return new Jn(c)}function Si(c,f,x){c.j=x?Q(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function Ti(c,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);c.s=f}else c.s=null}function $o(c,f,x){f instanceof mt?(c.i=f,am(c.i,c.h)):(x||(f=ge(f,Se)),c.i=new mt(f,c.h))}function A(c,f,x){c.i.set(f,x)}function J(c){return A(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Q(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function ge(c,f,x){return typeof c=="string"?(c=encodeURI(c).replace(f,Re),x&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Re(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var ze=/[#\/\?@]/g,Dt=/[#\?:]/g,ds=/[#\?]/g,Se=/[#\?@]/g,qe=/#/g;function mt(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function Tt(c){c.g||(c.g=new Map,c.h=0,c.i&&im(c.i,function(f,x){c.add(decodeURIComponent(f.replace(/\+/g," ")),x)}))}t=mt.prototype,t.add=function(c,f){Tt(this),this.i=null,c=Or(this,c);var x=this.g.get(c);return x||this.g.set(c,x=[]),x.push(f),this.h+=1,this};function ja(c,f){Tt(c),f=Or(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function sd(c,f){return Tt(c),f=Or(c,f),c.g.has(f)}t.forEach=function(c,f){Tt(this),this.g.forEach(function(x,R){x.forEach(function(q){c.call(f,q,R,this)},this)},this)},t.na=function(){Tt(this);const c=Array.from(this.g.values()),f=Array.from(this.g.keys()),x=[];for(let R=0;R<f.length;R++){const q=c[R];for(let H=0;H<q.length;H++)x.push(f[R])}return x},t.V=function(c){Tt(this);let f=[];if(typeof c=="string")sd(this,c)&&(f=f.concat(this.g.get(Or(this,c))));else{c=Array.from(this.g.values());for(let x=0;x<c.length;x++)f=f.concat(c[x])}return f},t.set=function(c,f){return Tt(this),this.i=null,c=Or(this,c),sd(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},t.get=function(c,f){return c?(c=this.V(c),0<c.length?String(c[0]):f):f};function Bo(c,f,x){ja(c,f),0<x.length&&(c.i=null,c.g.set(Or(c,f),C(x)),c.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],f=Array.from(this.g.keys());for(var x=0;x<f.length;x++){var R=f[x];const H=encodeURIComponent(String(R)),ne=this.V(R);for(R=0;R<ne.length;R++){var q=H;ne[R]!==""&&(q+="="+encodeURIComponent(String(ne[R]))),c.push(q)}}return this.i=c.join("&")};function Or(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function am(c,f){f&&!c.j&&(Tt(c),c.i=null,c.g.forEach(function(x,R){var q=R.toLowerCase();R!=q&&(ja(this,R),Bo(this,q,x))},c)),c.j=f}function om(c,f){const x=new Xn;if(l.Image){const R=new Image;R.onload=y(mn,x,"TestLoadImage: loaded",!0,f,R),R.onerror=y(mn,x,"TestLoadImage: error",!1,f,R),R.onabort=y(mn,x,"TestLoadImage: abort",!1,f,R),R.ontimeout=y(mn,x,"TestLoadImage: timeout",!1,f,R),l.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=c}else f(!1)}function lm(c,f){const x=new Xn,R=new AbortController,q=setTimeout(()=>{R.abort(),mn(x,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:R.signal}).then(H=>{clearTimeout(q),H.ok?mn(x,"TestPingServer: ok",!0,f):mn(x,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(q),mn(x,"TestPingServer: error",!1,f)})}function mn(c,f,x,R,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),R(x)}catch{}}function xe(){this.g=new zc}function Lr(c,f,x){const R=x||"";try{ed(c,function(q,H){let ne=q;u(q)&&(ne=pa(q)),f.push(R+H+"="+encodeURIComponent(ne))})}catch(q){throw f.push(R+"type="+encodeURIComponent("_badmap")),q}}function Cs(c){this.l=c.Ub||null,this.j=c.eb||!1}w(Cs,ga),Cs.prototype.g=function(){return new Xs(this.l,this.j)},Cs.prototype.i=function(c){return function(){return c}}({});function Xs(c,f){it.call(this),this.D=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Xs,it),t=Xs.prototype,t.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=f,this.readyState=1,qo(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(f.body=c),(this.D||l).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,zo(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,qo(this)),this.g&&(this.readyState=3,qo(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Hx(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Hx(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?zo(this):qo(this),this.readyState==3&&Hx(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,zo(this))},t.Qa=function(c){this.g&&(this.response=c,zo(this))},t.ga=function(){this.g&&zo(this)};function zo(c){c.readyState=4,c.l=null,c.j=null,c.v=null,qo(c)}t.setRequestHeader=function(c,f){this.u.append(c,f)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],f=this.h.entries();for(var x=f.next();!x.done;)x=x.value,c.push(x[0]+": "+x[1]),x=f.next();return c.join(`\r
`)};function qo(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Xs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Wx(c){let f="";return U(c,function(x,R){f+=R,f+=":",f+=x,f+=`\r
`}),f}function cm(c,f,x){e:{for(R in x){var R=!1;break e}R=!0}R||(x=Wx(x),typeof c=="string"?x!=null&&encodeURIComponent(String(x)):A(c,f,x))}function ft(c){it.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(ft,it);var M1=/^https?$/i,V1=["POST","PUT"];t=ft.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,f,x,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ba.g(),this.v=this.o?Po(this.o):Po(ba),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(H){Kx(this,H);return}if(c=x||"",x=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var q in R)x.set(q,R[q]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const H of R.keys())x.set(H,R.get(H));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(x.keys()).find(H=>H.toLowerCase()=="content-type"),q=l.FormData&&c instanceof l.FormData,!(0<=Array.prototype.indexOf.call(V1,f,void 0))||R||q||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[H,ne]of x)this.g.setRequestHeader(H,ne);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Xx(this),this.u=!0,this.g.send(c),this.u=!1}catch(H){Kx(this,H)}};function Kx(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.m=5,Gx(c),nd(c)}function Gx(c){c.A||(c.A=!0,gt(c,"complete"),gt(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,gt(this,"complete"),gt(this,"abort"),nd(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),nd(this,!0)),ft.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Qx(this):this.bb())},t.bb=function(){Qx(this)};function Qx(c){if(c.h&&typeof o<"u"&&(!c.v[1]||Zn(c)!=4||c.Z()!=2)){if(c.u&&Zn(c)==4)ue(c.Ea,0,c);else if(gt(c,"readystatechange"),Zn(c)==4){c.h=!1;try{const ne=c.Z();e:switch(ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var x;if(!(x=f)){var R;if(R=ne===0){var q=String(c.D).match(td)[1]||null;!q&&l.self&&l.self.location&&(q=l.self.location.protocol.slice(0,-1)),R=!M1.test(q?q.toLowerCase():"")}x=R}if(x)gt(c,"complete"),gt(c,"success");else{c.m=6;try{var H=2<Zn(c)?c.g.statusText:""}catch{H=""}c.l=H+" ["+c.Z()+"]",Gx(c)}}finally{nd(c)}}}}function nd(c,f){if(c.g){Xx(c);const x=c.g,R=c.v[0]?()=>{}:null;c.g=null,c.v=null,f||gt(c,"ready");try{x.onreadystatechange=R}catch{}}}function Xx(c){c.I&&(l.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function Zn(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<Zn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),Bc(f)}};function Yx(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function F1(c){const f={};c=(c.g&&2<=Zn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<c.length;R++){if(v(c[R]))continue;var x=T(c[R]);const q=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const H=f[q]||[];f[q]=H,H.push(x)}b(f,function(R){return R.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ho(c,f,x){return x&&x.internalChannelParams&&x.internalChannelParams[c]||f}function Jx(c){this.Aa=0,this.i=[],this.j=new Xn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ho("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ho("baseRetryDelayMs",5e3,c),this.cb=Ho("retryDelaySeedMs",1e4,c),this.Wa=Ho("forwardChannelMaxRetries",2,c),this.wa=Ho("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Xc(c&&c.concurrentRequestLimit),this.Da=new xe,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Jx.prototype,t.la=8,t.G=1,t.connect=function(c,f,x,R){St(0),this.W=c,this.H=f||{},x&&R!==void 0&&(this.H.OSID=x,this.H.OAID=R),this.F=this.X,this.I=o0(this,null,this.W),id(this)};function dm(c){if(Zx(c),c.G==3){var f=c.U++,x=Qs(c.I);if(A(x,"SID",c.K),A(x,"RID",f),A(x,"TYPE","terminate"),Wo(c,x),f=new Sn(c,c.j,f),f.L=2,f.v=J(Qs(x)),x=!1,l.navigator&&l.navigator.sendBeacon)try{x=l.navigator.sendBeacon(f.v.toString(),"")}catch{}!x&&l.Image&&(new Image().src=f.v,x=!0),x||(f.g=l0(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Vo(f)}a0(c)}function rd(c){c.g&&(hm(c),c.g.cancel(),c.g=null)}function Zx(c){rd(c),c.u&&(l.clearTimeout(c.u),c.u=null),ad(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&l.clearTimeout(c.s),c.s=null)}function id(c){if(!Yc(c.h)&&!c.s){c.s=!0;var f=c.Ga;z||M(),L||(z(),L=!0),$.add(f,c),c.B=0}}function U1(c,f){return xt(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=f.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Rr(g(c.Ga,c,f),i0(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const q=new Sn(this,this.j,c);let H=this.o;if(this.S&&(H?(H=m(H),I(H,this.S)):H=this.S),this.m!==null||this.O||(q.H=H,H=null),this.P)e:{for(var f=0,x=0;x<this.i.length;x++){t:{var R=this.i[x];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(f+=R,4096<f){f=x;break e}if(f===4096||x===this.i.length-1){f=x+1;break e}}f=1e3}else f=1e3;f=t0(this,q,f),x=Qs(this.I),A(x,"RID",c),A(x,"CVER",22),this.D&&A(x,"X-HTTP-Session-Id",this.D),Wo(this,x),H&&(this.O?f="headers="+encodeURIComponent(String(Wx(H)))+"&"+f:this.m&&cm(x,this.m,H)),Uo(this.h,q),this.Ua&&A(x,"TYPE","init"),this.P?(A(x,"$req",f),A(x,"SID","null"),q.T=!0,Gc(q,x,null)):Gc(q,x,f),this.G=2}}else this.G==3&&(c?e0(this,c):this.i.length==0||Yc(this.h)||e0(this))};function e0(c,f){var x;f?x=f.l:x=c.U++;const R=Qs(c.I);A(R,"SID",c.K),A(R,"RID",x),A(R,"AID",c.T),Wo(c,R),c.m&&c.o&&cm(R,c.m,c.o),x=new Sn(c,c.j,x,c.B+1),c.m===null&&(x.H=c.o),f&&(c.i=f.D.concat(c.i)),f=t0(c,x,1e3),x.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Uo(c.h,x),Gc(x,R,f)}function Wo(c,f){c.H&&U(c.H,function(x,R){A(f,R,x)}),c.l&&ed({},function(x,R){A(f,R,x)})}function t0(c,f,x){x=Math.min(c.i.length,x);var R=c.l?g(c.l.Na,c.l,c):null;e:{var q=c.i;let H=-1;for(;;){const ne=["count="+x];H==-1?0<x?(H=q[0].g,ne.push("ofs="+H)):H=0:ne.push("ofs="+H);let He=!0;for(let Ht=0;Ht<x;Ht++){let Oe=q[Ht].g;const Zt=q[Ht].map;if(Oe-=H,0>Oe)H=Math.max(0,q[Ht].g-100),He=!1;else try{Lr(Zt,ne,"req"+Oe+"_")}catch{R&&R(Zt)}}if(He){R=ne.join("&");break e}}}return c=c.i.splice(0,x),f.D=c,R}function s0(c){if(!c.g&&!c.u){c.Y=1;var f=c.Fa;z||M(),L||(z(),L=!0),$.add(f,c),c.v=0}}function um(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Rr(g(c.Fa,c),i0(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,n0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Rr(g(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,St(10),rd(this),n0(this))};function hm(c){c.A!=null&&(l.clearTimeout(c.A),c.A=null)}function n0(c){c.g=new Sn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var f=Qs(c.qa);A(f,"RID","rpc"),A(f,"SID",c.K),A(f,"AID",c.T),A(f,"CI",c.F?"0":"1"),!c.F&&c.ja&&A(f,"TO",c.ja),A(f,"TYPE","xmlhttp"),Wo(c,f),c.m&&c.o&&cm(f,c.m,c.o),c.L&&(c.g.I=c.L);var x=c.g;c=c.ia,x.L=1,x.v=J(Qs(f)),x.m=null,x.P=!0,Zh(x,c)}t.Za=function(){this.C!=null&&(this.C=null,rd(this),um(this),St(19))};function ad(c){c.C!=null&&(l.clearTimeout(c.C),c.C=null)}function r0(c,f){var x=null;if(c.g==f){ad(c),hm(c),c.g=null;var R=2}else if(Ii(c.h,f))x=f.D,Jc(c.h,f),R=1;else return;if(c.G!=0){if(f.o)if(R==1){x=f.m?f.m.length:0,f=Date.now()-f.F;var q=c.B;R=un(),gt(R,new va(R,x)),id(c)}else s0(c);else if(q=f.s,q==3||q==0&&0<f.X||!(R==1&&U1(c,f)||R==2&&um(c)))switch(x&&0<x.length&&(f=c.h,f.i=f.i.concat(x)),q){case 1:Ci(c,5);break;case 4:Ci(c,10);break;case 3:Ci(c,6);break;default:Ci(c,2)}}}function i0(c,f){let x=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(x*=2),x*f}function Ci(c,f){if(c.j.info("Error code "+f),f==2){var x=g(c.fb,c),R=c.Xa;const q=!R;R=new Jn(R||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Si(R,"https"),J(R),q?om(R.toString(),x):lm(R.toString(),x)}else St(2);c.G=0,c.l&&c.l.sa(f),a0(c),Zx(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),St(2)):(this.j.info("Failed to ping google.com"),St(1))};function a0(c){if(c.G=0,c.ka=[],c.l){const f=Zc(c.h);(f.length!=0||c.i.length!=0)&&(E(c.ka,f),E(c.ka,c.i),c.h.i.length=0,C(c.i),c.i.length=0),c.l.ra()}}function o0(c,f,x){var R=x instanceof Jn?Qs(x):new Jn(x);if(R.g!="")f&&(R.g=f+"."+R.g),Ti(R,R.s);else{var q=l.location;R=q.protocol,f=f?f+"."+q.hostname:q.hostname,q=+q.port;var H=new Jn(null);R&&Si(H,R),f&&(H.g=f),q&&Ti(H,q),x&&(H.l=x),R=H}return x=c.D,f=c.ya,x&&f&&A(R,x,f),A(R,"VER",c.la),Wo(c,R),R}function l0(c,f,x){if(f&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Ca&&!c.pa?new ft(new Cs({eb:x})):new ft(c.pa),f.Ha(c.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function c0(){}t=c0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function od(){}od.prototype.g=function(c,f){return new As(c,f)};function As(c,f){it.call(this),this.g=new Jx(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(c?c["X-WebChannel-Client-Profile"]=f.va:c={"X-WebChannel-Client-Profile":f.va}),this.g.S=c,(c=f&&f.Sb)&&!v(c)&&(this.g.m=c),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!v(f)&&(this.g.D=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new _a(this)}w(As,it),As.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},As.prototype.close=function(){dm(this.g)},As.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var x={};x.__data__=c,c=x}else this.u&&(x={},x.__data__=pa(c),c=x);f.i.push(new sm(f.Ya++,c)),f.G==3&&id(f)},As.prototype.N=function(){this.g.l=null,delete this.j,dm(this.g),delete this.g,As.aa.N.call(this)};function d0(c){Ar.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(const x in f){c=x;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}w(d0,Ar);function u0(){xa.call(this),this.status=1}w(u0,xa);function _a(c){this.g=c}w(_a,c0),_a.prototype.ua=function(){gt(this.g,"a")},_a.prototype.ta=function(c){gt(this.g,new d0(c))},_a.prototype.sa=function(c){gt(this.g,new u0)},_a.prototype.ra=function(){gt(this.g,"b")},od.prototype.createWebChannel=od.prototype.g,As.prototype.send=As.prototype.o,As.prototype.open=As.prototype.m,As.prototype.close=As.prototype.close,Uj=function(){return new od},Fj=function(){return un()},Vj=In,xp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pr.NO_ERROR=0,Pr.TIMEOUT=8,Pr.HTTP_ERROR=6,su=Pr,Mo.COMPLETE="complete",Mj=Mo,En.EventType=Cr,Cr.OPEN="a",Cr.CLOSE="b",Cr.ERROR="c",Cr.MESSAGE="d",it.prototype.listen=it.prototype.K,ul=En,ft.prototype.listenOnce=ft.prototype.L,ft.prototype.getLastError=ft.prototype.Ka,ft.prototype.getLastErrorCode=ft.prototype.Ba,ft.prototype.getStatus=ft.prototype.Z,ft.prototype.getResponseJson=ft.prototype.Oa,ft.prototype.getResponseText=ft.prototype.oa,ft.prototype.send=ft.prototype.ea,ft.prototype.setWithCredentials=ft.prototype.Ha,Lj=ft}).apply(typeof Id<"u"?Id:typeof self<"u"?self:typeof window<"u"?window:{});const ov="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rs=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};rs.UNAUTHENTICATED=new rs(null),rs.GOOGLE_CREDENTIALS=new rs("google-credentials-uid"),rs.FIRST_PARTY=new rs("first-party-uid"),rs.MOCK_USER=new rs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ko="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ea=new Og("@firebase/firestore");function tl(){return ea.logLevel}function he(t,...e){if(ea.logLevel<=Ie.DEBUG){const s=e.map(Kg);ea.debug(`Firestore (${ko}): ${t}`,...s)}}function vr(t,...e){if(ea.logLevel<=Ie.ERROR){const s=e.map(Kg);ea.error(`Firestore (${ko}): ${t}`,...s)}}function ta(t,...e){if(ea.logLevel<=Ie.WARN){const s=e.map(Kg);ea.warn(`Firestore (${ko}): ${t}`,...s)}}function Kg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(s){return JSON.stringify(s)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(t="Unexpected state"){const e=`FIRESTORE (${ko}) INTERNAL ASSERTION FAILED: `+t;throw vr(e),new Error(e)}function Fe(t,e){t||ye()}function be(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ae extends Hn{constructor(e,s){super(e,s),this.code=e,this.message=s,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(){this.promise=new Promise((e,s)=>{this.resolve=e,this.reject=s})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(e,s){this.user=s,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Bj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,s){e.enqueueRetryable(()=>s(rs.UNAUTHENTICATED))}shutdown(){}}class C4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,s){this.changeListener=s,e.enqueueRetryable(()=>s(this.token.user))}shutdown(){this.changeListener=null}}class A4{constructor(e){this.t=e,this.currentUser=rs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,s){Fe(this.o===void 0);let r=this.i;const i=d=>this.i!==r?(r=this.i,s(d)):Promise.resolve();let a=new cr;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new cr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const d=a;e.enqueueRetryable(async()=>{await d.promise,await i(this.currentUser)})},l=d=>{he("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(d=>l(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?l(d):(he("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new cr)}},0),o()}getToken(){const e=this.i,s=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(s).then(r=>this.i!==e?(he("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Fe(typeof r.accessToken=="string"),new $j(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Fe(e===null||typeof e=="string"),new rs(e)}}class R4{constructor(e,s,r){this.l=e,this.h=s,this.P=r,this.type="FirstParty",this.user=rs.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class P4{constructor(e,s,r){this.l=e,this.h=s,this.P=r}getToken(){return Promise.resolve(new R4(this.l,this.h,this.P))}start(e,s){e.enqueueRetryable(()=>s(rs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class D4{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class O4{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,s){Fe(this.o===void 0);const r=a=>{a.error!=null&&he("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.R;return this.R=a.token,he("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?s(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{he("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?i(a):he("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(s=>s?(Fe(typeof s.token=="string"),this.R=s.token,new D4(s.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L4(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),s=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(s);else for(let r=0;r<t;r++)s[r]=Math.floor(256*Math.random());return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=L4(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<s&&(r+=e.charAt(i[a]%e.length))}return r}}function Le(t,e){return t<e?-1:t>e?1:0}function lo(t,e,s){return t.length===e.length&&t.every((r,i)=>s(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e,s){if(this.seconds=e,this.nanoseconds=s,s<0)throw new ae(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(s>=1e9)throw new ae(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(e<-62135596800)throw new ae(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ae(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return bt.fromMillis(Date.now())}static fromDate(e){return bt.fromMillis(e.getTime())}static fromMillis(e){const s=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*s));return new bt(s,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.timestamp=e}static fromTimestamp(e){return new we(e)}static min(){return new we(new bt(0,0))}static max(){return new we(new bt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,s,r){s===void 0?s=0:s>e.length&&ye(),r===void 0?r=e.length-s:r>e.length-s&&ye(),this.segments=e,this.offset=s,this.len=r}get length(){return this.len}isEqual(e){return nc.comparator(this,e)===0}child(e){const s=this.segments.slice(this.offset,this.limit());return e instanceof nc?e.forEach(r=>{s.push(r)}):s.push(e),this.construct(s)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}forEach(e){for(let s=this.offset,r=this.limit();s<r;s++)e(this.segments[s])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,s){const r=Math.min(e.length,s.length);for(let i=0;i<r;i++){const a=e.get(i),o=s.get(i);if(a<o)return-1;if(a>o)return 1}return e.length<s.length?-1:e.length>s.length?1:0}}class et extends nc{construct(e,s,r){return new et(e,s,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const s=[];for(const r of e){if(r.indexOf("//")>=0)throw new ae(K.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);s.push(...r.split("/").filter(i=>i.length>0))}return new et(s)}static emptyPath(){return new et([])}}const M4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ut extends nc{construct(e,s,r){return new Ut(e,s,r)}static isValidIdentifier(e){return M4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ut.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ut(["__name__"])}static fromServerFormat(e){const s=[];let r="",i=0;const a=()=>{if(r.length===0)throw new ae(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);s.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new ae(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new ae(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(a(),i++)}if(a(),o)throw new ae(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ut(s)}static emptyPath(){return new Ut([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.path=e}static fromPath(e){return new me(et.fromString(e))}static fromName(e){return new me(et.fromString(e).popFirst(5))}static empty(){return new me(et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,s){return et.comparator(e.path,s.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new me(new et(e.slice()))}}function V4(t,e){const s=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=we.fromTimestamp(r===1e9?new bt(s+1,0):new bt(s,r));return new mi(i,me.empty(),e)}function F4(t){return new mi(t.readTime,t.key,-1)}class mi{constructor(e,s,r){this.readTime=e,this.documentKey=s,this.largestBatchId=r}static min(){return new mi(we.min(),me.empty(),-1)}static max(){return new mi(we.max(),me.empty(),-1)}}function U4(t,e){let s=t.readTime.compareTo(e.readTime);return s!==0?s:(s=me.comparator(t.documentKey,e.documentKey),s!==0?s:Le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class B4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sc(t){if(t.code!==K.FAILED_PRECONDITION||t.message!==$4)throw t;he("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(s=>{this.isDone=!0,this.result=s,this.nextCallback&&this.nextCallback(s)},s=>{this.isDone=!0,this.error=s,this.catchCallback&&this.catchCallback(s)})}catch(e){return this.next(void 0,e)}next(e,s){return this.callbackAttached&&ye(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(s,this.error):this.wrapSuccess(e,this.result):new Z((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(s,a).next(r,i)}})}toPromise(){return new Promise((e,s)=>{this.next(e,s)})}wrapUserFunction(e){try{const s=e();return s instanceof Z?s:Z.resolve(s)}catch(s){return Z.reject(s)}}wrapSuccess(e,s){return e?this.wrapUserFunction(()=>e(s)):Z.resolve(s)}wrapFailure(e,s){return e?this.wrapUserFunction(()=>e(s)):Z.reject(s)}static resolve(e){return new Z((s,r)=>{s(e)})}static reject(e){return new Z((s,r)=>{r(e)})}static waitFor(e){return new Z((s,r)=>{let i=0,a=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++a,o&&a===i&&s()},d=>r(d))}),o=!0,a===i&&s()})}static or(e){let s=Z.resolve(!1);for(const r of e)s=s.next(i=>i?Z.resolve(i):r());return s}static forEach(e,s){const r=[];return e.forEach((i,a)=>{r.push(s.call(this,i,a))}),this.waitFor(r)}static mapArray(e,s){return new Z((r,i)=>{const a=e.length,o=new Array(a);let l=0;for(let d=0;d<a;d++){const u=d;s(e[u]).next(h=>{o[u]=h,++l,l===a&&r(o)},h=>i(h))}})}static doWhile(e,s){return new Z((r,i)=>{const a=()=>{e()===!0?s().next(()=>{a()},i):r()};a()})}}function z4(t){const e=t.match(/Android ([\d.]+)/i),s=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(s)}function Tc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e,s){this.previousValue=e,s&&(s.sequenceNumberHandler=r=>this.ie(r),this.se=r=>s.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Qg.oe=-1;function Th(t){return t==null}function $u(t){return t===0&&1/t==-1/0}function q4(t){return typeof t=="number"&&Number.isInteger(t)&&!$u(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(t){let e=0;for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&e++;return e}function da(t,e){for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&e(s,t[s])}function zj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e,s){this.comparator=e,this.root=s||Kt.EMPTY}insert(e,s){return new ut(this.comparator,this.root.insert(e,s,this.comparator).copy(null,null,Kt.BLACK,null,null))}remove(e){return new ut(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Kt.BLACK,null,null))}get(e){let s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return s.value;r<0?s=s.left:r>0&&(s=s.right)}return null}indexOf(e){let s=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return s+r.left.size;i<0?r=r.left:(s+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((s,r)=>(e(s,r),!1))}toString(){const e=[];return this.inorderTraversal((s,r)=>(e.push(`${s}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sd(this.root,e,this.comparator,!0)}}class Sd{constructor(e,s,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=s?r(e.key,s):1,s&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const s={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return s}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Kt{constructor(e,s,r,i,a){this.key=e,this.value=s,this.color=r??Kt.RED,this.left=i??Kt.EMPTY,this.right=a??Kt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,s,r,i,a){return new Kt(e??this.key,s??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,s,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,s,r),null):a===0?i.copy(null,s,null,null,null):i.copy(null,null,null,null,i.right.insert(e,s,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Kt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,s){let r,i=this;if(s(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,s),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),s(e,i.key)===0){if(i.right.isEmpty())return Kt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,s))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Kt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Kt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,s)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ye();const e=this.left.check();if(e!==this.right.check())throw ye();return e+(this.isRed()?0:1)}}Kt.EMPTY=null,Kt.RED=!0,Kt.BLACK=!1;Kt.EMPTY=new class{constructor(){this.size=0}get key(){throw ye()}get value(){throw ye()}get color(){throw ye()}get left(){throw ye()}get right(){throw ye()}copy(e,s,r,i,a){return this}insert(e,s,r){return new Kt(e,s)}remove(e,s){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.comparator=e,this.data=new ut(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((s,r)=>(e(s),!1))}forEachInRange(e,s){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;s(i.key)}}forEachWhile(e,s){let r;for(r=s!==void 0?this.data.getIteratorFrom(s):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const s=this.data.getIteratorFrom(e);return s.hasNext()?s.getNext().key:null}getIterator(){return new cv(this.data.getIterator())}getIteratorFrom(e){return new cv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let s=this;return s.size<e.size&&(s=e,e=this),e.forEach(r=>{s=s.add(r)}),s}isEqual(e){if(!(e instanceof Qt)||this.size!==e.size)return!1;const s=this.data.getIterator(),r=e.data.getIterator();for(;s.hasNext();){const i=s.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(s=>{e.push(s)}),e}toString(){const e=[];return this.forEach(s=>e.push(s)),"SortedSet("+e.toString()+")"}copy(e){const s=new Qt(this.comparator);return s.data=e,s}}class cv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e){this.fields=e,e.sort(Ut.comparator)}static empty(){return new Os([])}unionWith(e){let s=new Qt(Ut.comparator);for(const r of this.fields)s=s.add(r);for(const r of e)s=s.add(r);return new Os(s.toArray())}covers(e){for(const s of this.fields)if(s.isPrefixOf(e))return!0;return!1}isEqual(e){return lo(this.fields,e.fields,(s,r)=>s.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.binaryString=e}static fromBase64String(e){const s=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new qj("Invalid base64 string: "+a):a}}(e);return new zt(s)}static fromUint8Array(e){const s=function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a}(e);return new zt(s)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(s){return btoa(s)}(this.binaryString)}toUint8Array(){return function(s){const r=new Uint8Array(s.length);for(let i=0;i<s.length;i++)r[i]=s.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zt.EMPTY_BYTE_STRING=new zt("");const H4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fi(t){if(Fe(!!t),typeof t=="string"){let e=0;const s=H4.exec(t);if(Fe(!!s),s[1]){let i=s[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:yt(t.seconds),nanos:yt(t.nanos)}}function yt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function sa(t){return typeof t=="string"?zt.fromBase64String(t):zt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(t){var e,s;return((s=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||s===void 0?void 0:s.stringValue)==="server_timestamp"}function Yg(t){const e=t.mapValue.fields.__previous_value__;return Xg(e)?Yg(e):e}function rc(t){const e=fi(t.mapValue.fields.__local_write_time__.timestampValue);return new bt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e,s,r,i,a,o,l,d,u){this.databaseId=e,this.appId=s,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=d,this.useFetchStreams=u}}class co{constructor(e,s){this.projectId=e,this.database=s||"(default)"}static empty(){return new co("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof co&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Td={mapValue:{}};function na(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Xg(t)?4:G4(t)?9007199254740991:K4(t)?10:11:ye()}function Bn(t,e){if(t===e)return!0;const s=na(t);if(s!==na(e))return!1;switch(s){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return rc(t).isEqual(rc(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=fi(i.timestampValue),l=fi(a.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return sa(i.bytesValue).isEqual(sa(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return yt(i.geoPointValue.latitude)===yt(a.geoPointValue.latitude)&&yt(i.geoPointValue.longitude)===yt(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return yt(i.integerValue)===yt(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=yt(i.doubleValue),l=yt(a.doubleValue);return o===l?$u(o)===$u(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return lo(t.arrayValue.values||[],e.arrayValue.values||[],Bn);case 10:case 11:return function(i,a){const o=i.mapValue.fields||{},l=a.mapValue.fields||{};if(lv(o)!==lv(l))return!1;for(const d in o)if(o.hasOwnProperty(d)&&(l[d]===void 0||!Bn(o[d],l[d])))return!1;return!0}(t,e);default:return ye()}}function ic(t,e){return(t.values||[]).find(s=>Bn(s,e))!==void 0}function uo(t,e){if(t===e)return 0;const s=na(t),r=na(e);if(s!==r)return Le(s,r);switch(s){case 0:case 9007199254740991:return 0;case 1:return Le(t.booleanValue,e.booleanValue);case 2:return function(a,o){const l=yt(a.integerValue||a.doubleValue),d=yt(o.integerValue||o.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1}(t,e);case 3:return dv(t.timestampValue,e.timestampValue);case 4:return dv(rc(t),rc(e));case 5:return Le(t.stringValue,e.stringValue);case 6:return function(a,o){const l=sa(a),d=sa(o);return l.compareTo(d)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const l=a.split("/"),d=o.split("/");for(let u=0;u<l.length&&u<d.length;u++){const h=Le(l[u],d[u]);if(h!==0)return h}return Le(l.length,d.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const l=Le(yt(a.latitude),yt(o.latitude));return l!==0?l:Le(yt(a.longitude),yt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return uv(t.arrayValue,e.arrayValue);case 10:return function(a,o){var l,d,u,h;const p=a.fields||{},g=o.fields||{},y=(l=p.value)===null||l===void 0?void 0:l.arrayValue,w=(d=g.value)===null||d===void 0?void 0:d.arrayValue,C=Le(((u=y==null?void 0:y.values)===null||u===void 0?void 0:u.length)||0,((h=w==null?void 0:w.values)===null||h===void 0?void 0:h.length)||0);return C!==0?C:uv(y,w)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===Td.mapValue&&o===Td.mapValue)return 0;if(a===Td.mapValue)return 1;if(o===Td.mapValue)return-1;const l=a.fields||{},d=Object.keys(l),u=o.fields||{},h=Object.keys(u);d.sort(),h.sort();for(let p=0;p<d.length&&p<h.length;++p){const g=Le(d[p],h[p]);if(g!==0)return g;const y=uo(l[d[p]],u[h[p]]);if(y!==0)return y}return Le(d.length,h.length)}(t.mapValue,e.mapValue);default:throw ye()}}function dv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Le(t,e);const s=fi(t),r=fi(e),i=Le(s.seconds,r.seconds);return i!==0?i:Le(s.nanos,r.nanos)}function uv(t,e){const s=t.values||[],r=e.values||[];for(let i=0;i<s.length&&i<r.length;++i){const a=uo(s[i],r[i]);if(a)return a}return Le(s.length,r.length)}function ho(t){return yp(t)}function yp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(s){const r=fi(s);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(s){return sa(s).toBase64()}(t.bytesValue):"referenceValue"in t?function(s){return me.fromName(s).toString()}(t.referenceValue):"geoPointValue"in t?function(s){return`geo(${s.latitude},${s.longitude})`}(t.geoPointValue):"arrayValue"in t?function(s){let r="[",i=!0;for(const a of s.values||[])i?i=!1:r+=",",r+=yp(a);return r+"]"}(t.arrayValue):"mapValue"in t?function(s){const r=Object.keys(s.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${yp(s.fields[o])}`;return i+"}"}(t.mapValue):ye()}function hv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function vp(t){return!!t&&"integerValue"in t}function Jg(t){return!!t&&"arrayValue"in t}function mv(t){return!!t&&"nullValue"in t}function fv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function nu(t){return!!t&&"mapValue"in t}function K4(t){var e,s;return((s=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||s===void 0?void 0:s.stringValue)==="__vector__"}function El(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return da(t.mapValue.fields,(s,r)=>e.mapValue.fields[s]=El(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let s=0;s<(t.arrayValue.values||[]).length;++s)e.arrayValue.values[s]=El(t.arrayValue.values[s]);return e}return Object.assign({},t)}function G4(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e){this.value=e}static empty(){return new Ns({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let s=this.value;for(let r=0;r<e.length-1;++r)if(s=(s.mapValue.fields||{})[e.get(r)],!nu(s))return null;return s=(s.mapValue.fields||{})[e.lastSegment()],s||null}}set(e,s){this.getFieldsMap(e.popLast())[e.lastSegment()]=El(s)}setAll(e){let s=Ut.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!s.isImmediateParentOf(l)){const d=this.getFieldsMap(s);this.applyChanges(d,r,i),r={},i=[],s=l.popLast()}o?r[l.lastSegment()]=El(o):i.push(l.lastSegment())});const a=this.getFieldsMap(s);this.applyChanges(a,r,i)}delete(e){const s=this.field(e.popLast());nu(s)&&s.mapValue.fields&&delete s.mapValue.fields[e.lastSegment()]}isEqual(e){return Bn(this.value,e.value)}getFieldsMap(e){let s=this.value;s.mapValue.fields||(s.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=s.mapValue.fields[e.get(r)];nu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},s.mapValue.fields[e.get(r)]=i),s=i}return s.mapValue.fields}applyChanges(e,s,r){da(s,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new Ns(El(this.value))}}function Hj(t){const e=[];return da(t.fields,(s,r)=>{const i=new Ut([s]);if(nu(r)){const a=Hj(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)}),new Os(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,s,r,i,a,o,l){this.key=e,this.documentType=s,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=l}static newInvalidDocument(e){return new as(e,0,we.min(),we.min(),we.min(),Ns.empty(),0)}static newFoundDocument(e,s,r,i){return new as(e,1,s,we.min(),r,i,0)}static newNoDocument(e,s){return new as(e,2,s,we.min(),we.min(),Ns.empty(),0)}static newUnknownDocument(e,s){return new as(e,3,s,we.min(),we.min(),Ns.empty(),2)}convertToFoundDocument(e,s){return!this.createTime.isEqual(we.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=s,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ns.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ns.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof as&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new as(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(e,s){this.position=e,this.inclusive=s}}function pv(t,e,s){let r=0;for(let i=0;i<t.position.length;i++){const a=e[i],o=t.position[i];if(a.field.isKeyField()?r=me.comparator(me.fromName(o.referenceValue),s.key):r=uo(o,s.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function gv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let s=0;s<t.position.length;s++)if(!Bn(t.position[s],e.position[s]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e,s="asc"){this.field=e,this.dir=s}}function Q4(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{}class It extends Wj{constructor(e,s,r){super(),this.field=e,this.op=s,this.value=r}static create(e,s,r){return e.isKeyField()?s==="in"||s==="not-in"?this.createKeyFieldInFilter(e,s,r):new Y4(e,s,r):s==="array-contains"?new eC(e,r):s==="in"?new tC(e,r):s==="not-in"?new sC(e,r):s==="array-contains-any"?new nC(e,r):new It(e,s,r)}static createKeyFieldInFilter(e,s,r){return s==="in"?new J4(e,r):new Z4(e,r)}matches(e){const s=e.data.field(this.field);return this.op==="!="?s!==null&&this.matchesComparison(uo(s,this.value)):s!==null&&na(this.value)===na(s)&&this.matchesComparison(uo(s,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ye()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _n extends Wj{constructor(e,s){super(),this.filters=e,this.op=s,this.ae=null}static create(e,s){return new _n(e,s)}matches(e){return Kj(this)?this.filters.find(s=>!s.matches(e))===void 0:this.filters.find(s=>s.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,s)=>e.concat(s.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Kj(t){return t.op==="and"}function Gj(t){return X4(t)&&Kj(t)}function X4(t){for(const e of t.filters)if(e instanceof _n)return!1;return!0}function wp(t){if(t instanceof It)return t.field.canonicalString()+t.op.toString()+ho(t.value);if(Gj(t))return t.filters.map(e=>wp(e)).join(",");{const e=t.filters.map(s=>wp(s)).join(",");return`${t.op}(${e})`}}function Qj(t,e){return t instanceof It?function(r,i){return i instanceof It&&r.op===i.op&&r.field.isEqual(i.field)&&Bn(r.value,i.value)}(t,e):t instanceof _n?function(r,i){return i instanceof _n&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((a,o,l)=>a&&Qj(o,i.filters[l]),!0):!1}(t,e):void ye()}function Xj(t){return t instanceof It?function(s){return`${s.field.canonicalString()} ${s.op} ${ho(s.value)}`}(t):t instanceof _n?function(s){return s.op.toString()+" {"+s.getFilters().map(Xj).join(" ,")+"}"}(t):"Filter"}class Y4 extends It{constructor(e,s,r){super(e,s,r),this.key=me.fromName(r.referenceValue)}matches(e){const s=me.comparator(e.key,this.key);return this.matchesComparison(s)}}class J4 extends It{constructor(e,s){super(e,"in",s),this.keys=Yj("in",s)}matches(e){return this.keys.some(s=>s.isEqual(e.key))}}class Z4 extends It{constructor(e,s){super(e,"not-in",s),this.keys=Yj("not-in",s)}matches(e){return!this.keys.some(s=>s.isEqual(e.key))}}function Yj(t,e){var s;return(((s=e.arrayValue)===null||s===void 0?void 0:s.values)||[]).map(r=>me.fromName(r.referenceValue))}class eC extends It{constructor(e,s){super(e,"array-contains",s)}matches(e){const s=e.data.field(this.field);return Jg(s)&&ic(s.arrayValue,this.value)}}class tC extends It{constructor(e,s){super(e,"in",s)}matches(e){const s=e.data.field(this.field);return s!==null&&ic(this.value.arrayValue,s)}}class sC extends It{constructor(e,s){super(e,"not-in",s)}matches(e){if(ic(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const s=e.data.field(this.field);return s!==null&&!ic(this.value.arrayValue,s)}}class nC extends It{constructor(e,s){super(e,"array-contains-any",s)}matches(e){const s=e.data.field(this.field);return!(!Jg(s)||!s.arrayValue.values)&&s.arrayValue.values.some(r=>ic(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e,s=null,r=[],i=[],a=null,o=null,l=null){this.path=e,this.collectionGroup=s,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=l,this.ue=null}}function xv(t,e=null,s=[],r=[],i=null,a=null,o=null){return new rC(t,e,s,r,i,a,o)}function Zg(t){const e=be(t);if(e.ue===null){let s=e.path.canonicalString();e.collectionGroup!==null&&(s+="|cg:"+e.collectionGroup),s+="|f:",s+=e.filters.map(r=>wp(r)).join(","),s+="|ob:",s+=e.orderBy.map(r=>function(a){return a.field.canonicalString()+a.dir}(r)).join(","),Th(e.limit)||(s+="|l:",s+=e.limit),e.startAt&&(s+="|lb:",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map(r=>ho(r)).join(",")),e.endAt&&(s+="|ub:",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map(r=>ho(r)).join(",")),e.ue=s}return e.ue}function ex(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<t.orderBy.length;s++)if(!Q4(t.orderBy[s],e.orderBy[s]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(!Qj(t.filters[s],e.filters[s]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gv(t.startAt,e.startAt)&&gv(t.endAt,e.endAt)}function bp(t){return me.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e,s=null,r=[],i=[],a=null,o="F",l=null,d=null){this.path=e,this.collectionGroup=s,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=l,this.endAt=d,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function iC(t,e,s,r,i,a,o,l){return new Eo(t,e,s,r,i,a,o,l)}function Ch(t){return new Eo(t)}function yv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Jj(t){return t.collectionGroup!==null}function Il(t){const e=be(t);if(e.ce===null){e.ce=[];const s=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),s.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Qt(Ut.comparator);return o.filters.forEach(d=>{d.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(a=>{s.has(a.canonicalString())||a.isKeyField()||e.ce.push(new ac(a,r))}),s.has(Ut.keyField().canonicalString())||e.ce.push(new ac(Ut.keyField(),r))}return e.ce}function Fn(t){const e=be(t);return e.le||(e.le=aC(e,Il(t))),e.le}function aC(t,e){if(t.limitType==="F")return xv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new ac(i.field,a)});const s=t.endAt?new Bu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Bu(t.startAt.position,t.startAt.inclusive):null;return xv(t.path,t.collectionGroup,e,t.filters,t.limit,s,r)}}function Np(t,e){const s=t.filters.concat([e]);return new Eo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),s,t.limit,t.limitType,t.startAt,t.endAt)}function zu(t,e,s){return new Eo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,s,t.startAt,t.endAt)}function Ah(t,e){return ex(Fn(t),Fn(e))&&t.limitType===e.limitType}function Zj(t){return`${Zg(Fn(t))}|lt:${t.limitType}`}function Sa(t){return`Query(target=${function(s){let r=s.path.canonicalString();return s.collectionGroup!==null&&(r+=" collectionGroup="+s.collectionGroup),s.filters.length>0&&(r+=`, filters: [${s.filters.map(i=>Xj(i)).join(", ")}]`),Th(s.limit)||(r+=", limit: "+s.limit),s.orderBy.length>0&&(r+=`, orderBy: [${s.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),s.startAt&&(r+=", startAt: ",r+=s.startAt.inclusive?"b:":"a:",r+=s.startAt.position.map(i=>ho(i)).join(",")),s.endAt&&(r+=", endAt: ",r+=s.endAt.inclusive?"a:":"b:",r+=s.endAt.position.map(i=>ho(i)).join(",")),`Target(${r})`}(Fn(t))}; limitType=${t.limitType})`}function Rh(t,e){return e.isFoundDocument()&&function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):me.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(t,e)&&function(r,i){for(const a of Il(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,l,d){const u=pv(o,l,d);return o.inclusive?u<=0:u<0}(r.startAt,Il(r),i)||r.endAt&&!function(o,l,d){const u=pv(o,l,d);return o.inclusive?u>=0:u>0}(r.endAt,Il(r),i))}(t,e)}function oC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function e_(t){return(e,s)=>{let r=!1;for(const i of Il(t)){const a=lC(i,e,s);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function lC(t,e,s){const r=t.field.isKeyField()?me.comparator(e.key,s.key):function(a,o,l){const d=o.data.field(a),u=l.data.field(a);return d!==null&&u!==null?uo(d,u):ye()}(t.field,e,s);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ye()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,s){this.mapKeyFn=e,this.equalsFn=s,this.inner={},this.innerSize=0}get(e){const s=this.mapKeyFn(e),r=this.inner[s];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,s){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,s]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,s]);i.push([e,s]),this.innerSize++}delete(e){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[s]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){da(this.inner,(s,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return zj(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC=new ut(me.comparator);function wr(){return cC}const t_=new ut(me.comparator);function hl(...t){let e=t_;for(const s of t)e=e.insert(s.key,s);return e}function s_(t){let e=t_;return t.forEach((s,r)=>e=e.insert(s,r.overlayedDocument)),e}function Ui(){return Sl()}function n_(){return Sl()}function Sl(){return new Io(t=>t.toString(),(t,e)=>t.isEqual(e))}const dC=new ut(me.comparator),uC=new Qt(me.comparator);function Ee(...t){let e=uC;for(const s of t)e=e.add(s);return e}const hC=new Qt(Le);function mC(){return hC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tx(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$u(e)?"-0":e}}function r_(t){return{integerValue:""+t}}function i_(t,e){return q4(e)?r_(e):tx(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(){this._=void 0}}function fC(t,e,s){return t instanceof oc?function(i,a){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Xg(a)&&(a=Yg(a)),a&&(o.fields.__previous_value__=a),{mapValue:o}}(s,e):t instanceof lc?o_(t,e):t instanceof cc?l_(t,e):function(i,a){const o=a_(i,a),l=vv(o)+vv(i.Pe);return vp(o)&&vp(i.Pe)?r_(l):tx(i.serializer,l)}(t,e)}function pC(t,e,s){return t instanceof lc?o_(t,e):t instanceof cc?l_(t,e):s}function a_(t,e){return t instanceof dc?function(r){return vp(r)||function(a){return!!a&&"doubleValue"in a}(r)}(e)?e:{integerValue:0}:null}class oc extends Ph{}class lc extends Ph{constructor(e){super(),this.elements=e}}function o_(t,e){const s=c_(e);for(const r of t.elements)s.some(i=>Bn(i,r))||s.push(r);return{arrayValue:{values:s}}}class cc extends Ph{constructor(e){super(),this.elements=e}}function l_(t,e){let s=c_(e);for(const r of t.elements)s=s.filter(i=>!Bn(i,r));return{arrayValue:{values:s}}}class dc extends Ph{constructor(e,s){super(),this.serializer=e,this.Pe=s}}function vv(t){return yt(t.integerValue||t.doubleValue)}function c_(t){return Jg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(e,s){this.field=e,this.transform=s}}function gC(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof lc&&i instanceof lc||r instanceof cc&&i instanceof cc?lo(r.elements,i.elements,Bn):r instanceof dc&&i instanceof dc?Bn(r.Pe,i.Pe):r instanceof oc&&i instanceof oc}(t.transform,e.transform)}class xC{constructor(e,s){this.version=e,this.transformResults=s}}class rn{constructor(e,s){this.updateTime=e,this.exists=s}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ru(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Dh{}function u_(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new sx(t.key,rn.none()):new Cc(t.key,t.data,rn.none());{const s=t.data,r=Ns.empty();let i=new Qt(Ut.comparator);for(let a of e.fields)if(!i.has(a)){let o=s.field(a);o===null&&a.length>1&&(a=a.popLast(),o=s.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new ji(t.key,r,new Os(i.toArray()),rn.none())}}function yC(t,e,s){t instanceof Cc?function(i,a,o){const l=i.value.clone(),d=bv(i.fieldTransforms,a,o.transformResults);l.setAll(d),a.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,s):t instanceof ji?function(i,a,o){if(!ru(i.precondition,a))return void a.convertToUnknownDocument(o.version);const l=bv(i.fieldTransforms,a,o.transformResults),d=a.data;d.setAll(h_(i)),d.setAll(l),a.convertToFoundDocument(o.version,d).setHasCommittedMutations()}(t,e,s):function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,s)}function Tl(t,e,s,r){return t instanceof Cc?function(a,o,l,d){if(!ru(a.precondition,o))return l;const u=a.value.clone(),h=Nv(a.fieldTransforms,d,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,s,r):t instanceof ji?function(a,o,l,d){if(!ru(a.precondition,o))return l;const u=Nv(a.fieldTransforms,d,o),h=o.data;return h.setAll(h_(a)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(p=>p.field))}(t,e,s,r):function(a,o,l){return ru(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,s)}function vC(t,e){let s=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),a=a_(r.transform,i||null);a!=null&&(s===null&&(s=Ns.empty()),s.set(r.field,a))}return s||null}function wv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&lo(r,i,(a,o)=>gC(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Cc extends Dh{constructor(e,s,r,i=[]){super(),this.key=e,this.value=s,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ji extends Dh{constructor(e,s,r,i,a=[]){super(),this.key=e,this.data=s,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function h_(t){const e=new Map;return t.fieldMask.fields.forEach(s=>{if(!s.isEmpty()){const r=t.data.field(s);e.set(s,r)}}),e}function bv(t,e,s){const r=new Map;Fe(t.length===s.length);for(let i=0;i<s.length;i++){const a=t[i],o=a.transform,l=e.data.field(a.field);r.set(a.field,pC(o,l,s[i]))}return r}function Nv(t,e,s){const r=new Map;for(const i of t){const a=i.transform,o=s.data.field(i.field);r.set(i.field,fC(a,o,e))}return r}class sx extends Dh{constructor(e,s){super(),this.key=e,this.precondition=s,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wC extends Dh{constructor(e,s){super(),this.key=e,this.precondition=s,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e,s,r,i){this.batchId=e,this.localWriteTime=s,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,s){const r=s.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&yC(a,e,r[i])}}applyToLocalView(e,s){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(s=Tl(r,e,s,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(s=Tl(r,e,s,this.localWriteTime));return s}applyToLocalDocumentSet(e,s){const r=n_();return this.mutations.forEach(i=>{const a=e.get(i.key),o=a.overlayedDocument;let l=this.applyToLocalView(o,a.mutatedFields);l=s.has(i.key)?null:l;const d=u_(o,l);d!==null&&r.set(i.key,d),o.isValidDocument()||o.convertToNoDocument(we.min())}),r}keys(){return this.mutations.reduce((e,s)=>e.add(s.key),Ee())}isEqual(e){return this.batchId===e.batchId&&lo(this.mutations,e.mutations,(s,r)=>wv(s,r))&&lo(this.baseMutations,e.baseMutations,(s,r)=>wv(s,r))}}class nx{constructor(e,s,r,i){this.batch=e,this.commitVersion=s,this.mutationResults=r,this.docVersions=i}static from(e,s,r){Fe(e.mutations.length===r.length);let i=function(){return dC}();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new nx(e,s,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,s){this.largestBatchId=e,this.mutation=s}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e,s){this.count=e,this.unchangedNames=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _t,Te;function _C(t){switch(t){default:return ye();case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0}}function m_(t){if(t===void 0)return vr("GRPC error has no .code"),K.UNKNOWN;switch(t){case _t.OK:return K.OK;case _t.CANCELLED:return K.CANCELLED;case _t.UNKNOWN:return K.UNKNOWN;case _t.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case _t.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case _t.INTERNAL:return K.INTERNAL;case _t.UNAVAILABLE:return K.UNAVAILABLE;case _t.UNAUTHENTICATED:return K.UNAUTHENTICATED;case _t.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case _t.NOT_FOUND:return K.NOT_FOUND;case _t.ALREADY_EXISTS:return K.ALREADY_EXISTS;case _t.PERMISSION_DENIED:return K.PERMISSION_DENIED;case _t.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case _t.ABORTED:return K.ABORTED;case _t.OUT_OF_RANGE:return K.OUT_OF_RANGE;case _t.UNIMPLEMENTED:return K.UNIMPLEMENTED;case _t.DATA_LOSS:return K.DATA_LOSS;default:return ye()}}(Te=_t||(_t={}))[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kC(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC=new zi([4294967295,4294967295],0);function jv(t){const e=kC().encode(t),s=new Oj;return s.update(e),new Uint8Array(s.digest())}function _v(t){const e=new DataView(t.buffer),s=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new zi([s,r],0),new zi([i,a],0)]}class rx{constructor(e,s,r){if(this.bitmap=e,this.padding=s,this.hashCount=r,s<0||s>=8)throw new ml(`Invalid padding: ${s}`);if(r<0)throw new ml(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ml(`Invalid hash count: ${r}`);if(e.length===0&&s!==0)throw new ml(`Invalid padding when bitmap length is 0: ${s}`);this.Ie=8*e.length-s,this.Te=zi.fromNumber(this.Ie)}Ee(e,s,r){let i=e.add(s.multiply(zi.fromNumber(r)));return i.compare(EC)===1&&(i=new zi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const s=jv(e),[r,i]=_v(s);for(let a=0;a<this.hashCount;a++){const o=this.Ee(r,i,a);if(!this.de(o))return!1}return!0}static create(e,s,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new rx(a,i,s);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const s=jv(e),[r,i]=_v(s);for(let a=0;a<this.hashCount;a++){const o=this.Ee(r,i,a);this.Ae(o)}}Ae(e){const s=Math.floor(e/8),r=e%8;this.bitmap[s]|=1<<r}}class ml extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e,s,r,i,a){this.snapshotVersion=e,this.targetChanges=s,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,s,r){const i=new Map;return i.set(e,Ac.createSynthesizedTargetChangeForCurrentChange(e,s,r)),new Oh(we.min(),i,new ut(Le),wr(),Ee())}}class Ac{constructor(e,s,r,i,a){this.resumeToken=e,this.current=s,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,s,r){return new Ac(r,s,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,s,r,i){this.Re=e,this.removedTargetIds=s,this.key=r,this.Ve=i}}class f_{constructor(e,s){this.targetId=e,this.me=s}}class p_{constructor(e,s,r=zt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=s,this.resumeToken=r,this.cause=i}}class kv{constructor(){this.fe=0,this.ge=Iv(),this.pe=zt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ee(),s=Ee(),r=Ee();return this.ge.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:s=s.add(i);break;case 1:r=r.add(i);break;default:ye()}}),new Ac(this.pe,this.ye,e,s,r)}Ce(){this.we=!1,this.ge=Iv()}Fe(e,s){this.we=!0,this.ge=this.ge.insert(e,s)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Fe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class IC{constructor(e){this.Le=e,this.Be=new Map,this.ke=wr(),this.qe=Ev(),this.Qe=new ut(Le)}Ke(e){for(const s of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(s,e.Ve):this.Ue(s,e.key,e.Ve);for(const s of e.removedTargetIds)this.Ue(s,e.key,e.Ve)}We(e){this.forEachTarget(e,s=>{const r=this.Ge(s);switch(e.state){case 0:this.ze(s)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(s);break;case 3:this.ze(s)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(s)&&(this.je(s),r.De(e.resumeToken));break;default:ye()}})}forEachTarget(e,s){e.targetIds.length>0?e.targetIds.forEach(s):this.Be.forEach((r,i)=>{this.ze(i)&&s(i)})}He(e){const s=e.targetId,r=e.me.count,i=this.Je(s);if(i){const a=i.target;if(bp(a))if(r===0){const o=new me(a.path);this.Ue(s,o,as.newNoDocument(o,we.min()))}else Fe(r===1);else{const o=this.Ye(s);if(o!==r){const l=this.Ze(e),d=l?this.Xe(l,e,o):1;if(d!==0){this.je(s);const u=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(s,u)}}}}}Ze(e){const s=e.me.unchangedNames;if(!s||!s.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=s;let o,l;try{o=sa(r).toUint8Array()}catch(d){if(d instanceof qj)return ta("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{l=new rx(o,i,a)}catch(d){return ta(d instanceof ml?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return l.Ie===0?null:l}Xe(e,s,r){return s.me.count===r-this.nt(e,s.targetId)?0:2}nt(e,s){const r=this.Le.getRemoteKeysForTarget(s);let i=0;return r.forEach(a=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(l)||(this.Ue(s,a,null),i++)}),i}rt(e){const s=new Map;this.Be.forEach((a,o)=>{const l=this.Je(o);if(l){if(a.current&&bp(l.target)){const d=new me(l.target.path);this.ke.get(d)!==null||this.it(o,d)||this.Ue(o,d,as.newNoDocument(d,e))}a.be&&(s.set(o,a.ve()),a.Ce())}});let r=Ee();this.qe.forEach((a,o)=>{let l=!0;o.forEachWhile(d=>{const u=this.Je(d);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(a))}),this.ke.forEach((a,o)=>o.setReadTime(e));const i=new Oh(e,s,this.Qe,this.ke,r);return this.ke=wr(),this.qe=Ev(),this.Qe=new ut(Le),i}$e(e,s){if(!this.ze(e))return;const r=this.it(e,s.key)?2:0;this.Ge(e).Fe(s.key,r),this.ke=this.ke.insert(s.key,s),this.qe=this.qe.insert(s.key,this.st(s.key).add(e))}Ue(e,s,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,s)?i.Fe(s,1):i.Me(s),this.qe=this.qe.insert(s,this.st(s).delete(e)),r&&(this.ke=this.ke.insert(s,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const s=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+s.addedDocuments.size-s.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let s=this.Be.get(e);return s||(s=new kv,this.Be.set(e,s)),s}st(e){let s=this.qe.get(e);return s||(s=new Qt(Le),this.qe=this.qe.insert(e,s)),s}ze(e){const s=this.Je(e)!==null;return s||he("WatchChangeAggregator","Detected inactive target",e),s}Je(e){const s=this.Be.get(e);return s&&s.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new kv),this.Le.getRemoteKeysForTarget(e).forEach(s=>{this.Ue(e,s,null)})}it(e,s){return this.Le.getRemoteKeysForTarget(e).has(s)}}function Ev(){return new ut(me.comparator)}function Iv(){return new ut(me.comparator)}const SC={asc:"ASCENDING",desc:"DESCENDING"},TC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},CC={and:"AND",or:"OR"};class AC{constructor(e,s){this.databaseId=e,this.useProto3Json=s}}function jp(t,e){return t.useProto3Json||Th(e)?e:{value:e}}function qu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function g_(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function RC(t,e){return qu(t,e.toTimestamp())}function Un(t){return Fe(!!t),we.fromTimestamp(function(s){const r=fi(s);return new bt(r.seconds,r.nanos)}(t))}function ix(t,e){return _p(t,e).canonicalString()}function _p(t,e){const s=function(i){return new et(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?s:s.child(e)}function x_(t){const e=et.fromString(t);return Fe(N_(e)),e}function kp(t,e){return ix(t.databaseId,e.path)}function Qm(t,e){const s=x_(e);if(s.get(1)!==t.databaseId.projectId)throw new ae(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+s.get(1)+" vs "+t.databaseId.projectId);if(s.get(3)!==t.databaseId.database)throw new ae(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+s.get(3)+" vs "+t.databaseId.database);return new me(v_(s))}function y_(t,e){return ix(t.databaseId,e)}function PC(t){const e=x_(t);return e.length===4?et.emptyPath():v_(e)}function Ep(t){return new et(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function v_(t){return Fe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Sv(t,e,s){return{name:kp(t,e),fields:s.value.mapValue.fields}}function DC(t,e){let s;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ye()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(u,h){return u.useProto3Json?(Fe(h===void 0||typeof h=="string"),zt.fromBase64String(h||"")):(Fe(h===void 0||h instanceof Buffer||h instanceof Uint8Array),zt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const h=u.code===void 0?K.UNKNOWN:m_(u.code);return new ae(h,u.message||"")}(o);s=new p_(r,i,a,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Qm(t,r.document.name),a=Un(r.document.updateTime),o=r.document.createTime?Un(r.document.createTime):we.min(),l=new Ns({mapValue:{fields:r.document.fields}}),d=as.newFoundDocument(i,a,o,l),u=r.targetIds||[],h=r.removedTargetIds||[];s=new iu(u,h,d.key,d)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Qm(t,r.document),a=r.readTime?Un(r.readTime):we.min(),o=as.newNoDocument(i,a),l=r.removedTargetIds||[];s=new iu([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Qm(t,r.document),a=r.removedTargetIds||[];s=new iu([],a,i,null)}else{if(!("filter"in e))return ye();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new jC(i,a),l=r.targetId;s=new f_(l,o)}}return s}function OC(t,e){let s;if(e instanceof Cc)s={update:Sv(t,e.key,e.value)};else if(e instanceof sx)s={delete:kp(t,e.key)};else if(e instanceof ji)s={update:Sv(t,e.key,e.data),updateMask:qC(e.fieldMask)};else{if(!(e instanceof wC))return ye();s={verify:kp(t,e.key)}}return e.fieldTransforms.length>0&&(s.updateTransforms=e.fieldTransforms.map(r=>function(a,o){const l=o.transform;if(l instanceof oc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof lc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof cc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof dc)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw ye()}(0,r))),e.precondition.isNone||(s.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:RC(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ye()}(t,e.precondition)),s}function LC(t,e){return t&&t.length>0?(Fe(e!==void 0),t.map(s=>function(i,a){let o=i.updateTime?Un(i.updateTime):Un(a);return o.isEqual(we.min())&&(o=Un(a)),new xC(o,i.transformResults||[])}(s,e))):[]}function MC(t,e){return{documents:[y_(t,e.path)]}}function VC(t,e){const s={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,s.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),s.structuredQuery.from=[{collectionId:r.lastSegment()}]),s.parent=y_(t,i);const a=function(u){if(u.length!==0)return b_(_n.create(u,"and"))}(e.filters);a&&(s.structuredQuery.where=a);const o=function(u){if(u.length!==0)return u.map(h=>function(g){return{field:Ta(g.field),direction:$C(g.dir)}}(h))}(e.orderBy);o&&(s.structuredQuery.orderBy=o);const l=jp(t,e.limit);return l!==null&&(s.structuredQuery.limit=l),e.startAt&&(s.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(s.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:s,parent:i}}function FC(t){let e=PC(t.parent);const s=t.structuredQuery,r=s.from?s.from.length:0;let i=null;if(r>0){Fe(r===1);const h=s.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];s.where&&(a=function(p){const g=w_(p);return g instanceof _n&&Gj(g)?g.getFilters():[g]}(s.where));let o=[];s.orderBy&&(o=function(p){return p.map(g=>function(w){return new ac(Ca(w.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(g))}(s.orderBy));let l=null;s.limit&&(l=function(p){let g;return g=typeof p=="object"?p.value:p,Th(g)?null:g}(s.limit));let d=null;s.startAt&&(d=function(p){const g=!!p.before,y=p.values||[];return new Bu(y,g)}(s.startAt));let u=null;return s.endAt&&(u=function(p){const g=!p.before,y=p.values||[];return new Bu(y,g)}(s.endAt)),iC(e,i,o,a,l,"F",d,u)}function UC(t,e){const s=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ye()}}(e.purpose);return s==null?null:{"goog-listen-tags":s}}function w_(t){return t.unaryFilter!==void 0?function(s){switch(s.unaryFilter.op){case"IS_NAN":const r=Ca(s.unaryFilter.field);return It.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ca(s.unaryFilter.field);return It.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Ca(s.unaryFilter.field);return It.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ca(s.unaryFilter.field);return It.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ye()}}(t):t.fieldFilter!==void 0?function(s){return It.create(Ca(s.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ye()}}(s.fieldFilter.op),s.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(s){return _n.create(s.compositeFilter.filters.map(r=>w_(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ye()}}(s.compositeFilter.op))}(t):ye()}function $C(t){return SC[t]}function BC(t){return TC[t]}function zC(t){return CC[t]}function Ta(t){return{fieldPath:t.canonicalString()}}function Ca(t){return Ut.fromServerFormat(t.fieldPath)}function b_(t){return t instanceof It?function(s){if(s.op==="=="){if(fv(s.value))return{unaryFilter:{field:Ta(s.field),op:"IS_NAN"}};if(mv(s.value))return{unaryFilter:{field:Ta(s.field),op:"IS_NULL"}}}else if(s.op==="!="){if(fv(s.value))return{unaryFilter:{field:Ta(s.field),op:"IS_NOT_NAN"}};if(mv(s.value))return{unaryFilter:{field:Ta(s.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ta(s.field),op:BC(s.op),value:s.value}}}(t):t instanceof _n?function(s){const r=s.getFilters().map(i=>b_(i));return r.length===1?r[0]:{compositeFilter:{op:zC(s.op),filters:r}}}(t):ye()}function qC(t){const e=[];return t.fields.forEach(s=>e.push(s.canonicalString())),{fieldPaths:e}}function N_(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e,s,r,i,a=we.min(),o=we.min(),l=zt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=s,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=d}withSequenceNumber(e){return new Xr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,s){return new Xr(this.target,this.targetId,this.purpose,this.sequenceNumber,s,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e){this.ct=e}}function WC(t){const e=FC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?zu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(){this.un=new GC}addToCollectionParentIndex(e,s){return this.un.add(s),Z.resolve()}getCollectionParents(e,s){return Z.resolve(this.un.getEntries(s))}addFieldIndex(e,s){return Z.resolve()}deleteFieldIndex(e,s){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,s){return Z.resolve()}getDocumentsMatchingTarget(e,s){return Z.resolve(null)}getIndexType(e,s){return Z.resolve(0)}getFieldIndexes(e,s){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,s){return Z.resolve(mi.min())}getMinOffsetFromCollectionGroup(e,s){return Z.resolve(mi.min())}updateCollectionGroup(e,s,r){return Z.resolve()}updateIndexEntries(e,s){return Z.resolve()}}class GC{constructor(){this.index={}}add(e){const s=e.lastSegment(),r=e.popLast(),i=this.index[s]||new Qt(et.comparator),a=!i.has(r);return this.index[s]=i.add(r),a}has(e){const s=e.lastSegment(),r=e.popLast(),i=this.index[s];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qt(et.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new mo(0)}static kn(){return new mo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(){this.changes=new Io(e=>e.toString(),(e,s)=>e.isEqual(s)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,s){this.assertNotApplied(),this.changes.set(e,as.newInvalidDocument(e).setReadTime(s))}getEntry(e,s){this.assertNotApplied();const r=this.changes.get(s);return r!==void 0?Z.resolve(r):this.getFromCache(e,s)}getEntries(e,s){return this.getAllFromCache(e,s)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e,s){this.overlayedDocument=e,this.mutatedFields=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,s,r,i){this.remoteDocumentCache=e,this.mutationQueue=s,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,s){let r=null;return this.documentOverlayCache.getOverlay(e,s).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,s))).next(i=>(r!==null&&Tl(r.mutation,i,Os.empty(),bt.now()),i))}getDocuments(e,s){return this.remoteDocumentCache.getEntries(e,s).next(r=>this.getLocalViewOfDocuments(e,r,Ee()).next(()=>r))}getLocalViewOfDocuments(e,s,r=Ee()){const i=Ui();return this.populateOverlays(e,i,s).next(()=>this.computeViews(e,s,i,r).next(a=>{let o=hl();return a.forEach((l,d)=>{o=o.insert(l,d.overlayedDocument)}),o}))}getOverlayedDocuments(e,s){const r=Ui();return this.populateOverlays(e,r,s).next(()=>this.computeViews(e,s,r,Ee()))}populateOverlays(e,s,r){const i=[];return r.forEach(a=>{s.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((o,l)=>{s.set(o,l)})})}computeViews(e,s,r,i){let a=wr();const o=Sl(),l=function(){return Sl()}();return s.forEach((d,u)=>{const h=r.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof ji)?a=a.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Tl(h.mutation,u,h.mutation.getFieldMask(),bt.now())):o.set(u.key,Os.empty())}),this.recalculateAndSaveOverlays(e,a).next(d=>(d.forEach((u,h)=>o.set(u,h)),s.forEach((u,h)=>{var p;return l.set(u,new XC(h,(p=o.get(u))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,s){const r=Sl();let i=new ut((o,l)=>o-l),a=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,s).next(o=>{for(const l of o)l.keys().forEach(d=>{const u=s.get(d);if(u===null)return;let h=r.get(d)||Os.empty();h=l.applyToLocalView(u,h),r.set(d,h);const p=(i.get(l.batchId)||Ee()).add(d);i=i.insert(l.batchId,p)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const d=l.getNext(),u=d.key,h=d.value,p=n_();h.forEach(g=>{if(!a.has(g)){const y=u_(s.get(g),r.get(g));y!==null&&p.set(g,y),a=a.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return Z.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,s){return this.remoteDocumentCache.getEntries(e,s).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,s,r,i){return function(o){return me.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(s)?this.getDocumentsMatchingDocumentQuery(e,s.path):Jj(s)?this.getDocumentsMatchingCollectionGroupQuery(e,s,r,i):this.getDocumentsMatchingCollectionQuery(e,s,r,i)}getNextDocuments(e,s,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,s,r,i).next(a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,s,r.largestBatchId,i-a.size):Z.resolve(Ui());let l=-1,d=a;return o.next(u=>Z.forEach(u,(h,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),a.get(h)?Z.resolve():this.remoteDocumentCache.getEntry(e,h).next(g=>{d=d.insert(h,g)}))).next(()=>this.populateOverlays(e,u,a)).next(()=>this.computeViews(e,d,u,Ee())).next(h=>({batchId:l,changes:s_(h)})))})}getDocumentsMatchingDocumentQuery(e,s){return this.getDocument(e,new me(s)).next(r=>{let i=hl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,s,r,i){const a=s.collectionGroup;let o=hl();return this.indexManager.getCollectionParents(e,a).next(l=>Z.forEach(l,d=>{const u=function(p,g){return new Eo(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(s,d.child(a));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(h=>{h.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,s,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,s.path,r.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,s,r,a,i))).next(o=>{a.forEach((d,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,as.newInvalidDocument(h)))});let l=hl();return o.forEach((d,u)=>{const h=a.get(d);h!==void 0&&Tl(h.mutation,u,Os.empty(),bt.now()),Rh(s,u)&&(l=l.insert(d,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,s){return Z.resolve(this.hr.get(s))}saveBundleMetadata(e,s){return this.hr.set(s.id,function(i){return{id:i.id,version:i.version,createTime:Un(i.createTime)}}(s)),Z.resolve()}getNamedQuery(e,s){return Z.resolve(this.Pr.get(s))}saveNamedQuery(e,s){return this.Pr.set(s.name,function(i){return{name:i.name,query:WC(i.bundledQuery),readTime:Un(i.readTime)}}(s)),Z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(){this.overlays=new ut(me.comparator),this.Ir=new Map}getOverlay(e,s){return Z.resolve(this.overlays.get(s))}getOverlays(e,s){const r=Ui();return Z.forEach(s,i=>this.getOverlay(e,i).next(a=>{a!==null&&r.set(i,a)})).next(()=>r)}saveOverlays(e,s,r){return r.forEach((i,a)=>{this.ht(e,s,a)}),Z.resolve()}removeOverlaysForBatchId(e,s,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(r)),Z.resolve()}getOverlaysForCollection(e,s,r){const i=Ui(),a=s.length+1,o=new me(s.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const d=l.getNext().value,u=d.getKey();if(!s.isPrefixOf(u.path))break;u.path.length===a&&d.largestBatchId>r&&i.set(d.getKey(),d)}return Z.resolve(i)}getOverlaysForCollectionGroup(e,s,r,i){let a=new ut((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===s&&u.largestBatchId>r){let h=a.get(u.largestBatchId);h===null&&(h=Ui(),a=a.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=Ui(),d=a.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((u,h)=>l.set(u,h)),!(l.size()>=i)););return Z.resolve(l)}ht(e,s,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new NC(s,r));let a=this.Ir.get(s);a===void 0&&(a=Ee(),this.Ir.set(s,a)),this.Ir.set(s,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(){this.sessionToken=zt.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,s){return this.sessionToken=s,Z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(){this.Tr=new Qt(Lt.Er),this.dr=new Qt(Lt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,s){const r=new Lt(e,s);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,s){e.forEach(r=>this.addReference(r,s))}removeReference(e,s){this.Vr(new Lt(e,s))}mr(e,s){e.forEach(r=>this.removeReference(r,s))}gr(e){const s=new me(new et([])),r=new Lt(s,e),i=new Lt(s,e+1),a=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),a.push(o.key)}),a}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const s=new me(new et([])),r=new Lt(s,e),i=new Lt(s,e+1);let a=Ee();return this.dr.forEachInRange([r,i],o=>{a=a.add(o.key)}),a}containsKey(e){const s=new Lt(e,0),r=this.Tr.firstAfterOrEqual(s);return r!==null&&e.isEqual(r.key)}}class Lt{constructor(e,s){this.key=e,this.wr=s}static Er(e,s){return me.comparator(e.key,s.key)||Le(e.wr,s.wr)}static Ar(e,s){return Le(e.wr,s.wr)||me.comparator(e.key,s.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(e,s){this.indexManager=e,this.referenceDelegate=s,this.mutationQueue=[],this.Sr=1,this.br=new Qt(Lt.Er)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,s,r,i){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new bC(a,s,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new Lt(l.key,a)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Z.resolve(o)}lookupMutationBatch(e,s){return Z.resolve(this.Dr(s))}getNextMutationBatchAfterBatchId(e,s){const r=s+1,i=this.vr(r),a=i<0?0:i;return Z.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,s){const r=new Lt(s,0),i=new Lt(s,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);a.push(l)}),Z.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,s){let r=new Qt(Le);return s.forEach(i=>{const a=new Lt(i,0),o=new Lt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,o],l=>{r=r.add(l.wr)})}),Z.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,s){const r=s.path,i=r.length+1;let a=r;me.isDocumentKey(a)||(a=a.child(""));const o=new Lt(new me(a),0);let l=new Qt(Le);return this.br.forEachWhile(d=>{const u=d.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(l=l.add(d.wr)),!0)},o),Z.resolve(this.Cr(l))}Cr(e){const s=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&s.push(i)}),s}removeMutationBatch(e,s){Fe(this.Fr(s.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Z.forEach(s.mutations,i=>{const a=new Lt(i.key,s.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,s){const r=new Lt(s,0),i=this.br.firstAfterOrEqual(r);return Z.resolve(s.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}Fr(e,s){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const s=this.vr(e);return s<0||s>=this.mutationQueue.length?null:this.mutationQueue[s]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{constructor(e){this.Mr=e,this.docs=function(){return new ut(me.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,s){const r=s.key,i=this.docs.get(r),a=i?i.size:0,o=this.Mr(s);return this.docs=this.docs.insert(r,{document:s.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const s=this.docs.get(e);s&&(this.docs=this.docs.remove(e),this.size-=s.size)}getEntry(e,s){const r=this.docs.get(s);return Z.resolve(r?r.document.mutableCopy():as.newInvalidDocument(s))}getEntries(e,s){let r=wr();return s.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():as.newInvalidDocument(i))}),Z.resolve(r)}getDocumentsMatchingQuery(e,s,r,i){let a=wr();const o=s.path,l=new me(o.child("")),d=this.docs.getIteratorFrom(l);for(;d.hasNext();){const{key:u,value:{document:h}}=d.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||U4(F4(h),r)<=0||(i.has(h.key)||Rh(s,h))&&(a=a.insert(h.key,h.mutableCopy()))}return Z.resolve(a)}getAllFromCollectionGroup(e,s,r,i){ye()}Or(e,s){return Z.forEach(this.docs,r=>s(r))}newChangeBuffer(e){return new nA(this)}getSize(e){return Z.resolve(this.size)}}class nA extends QC{constructor(e){super(),this.cr=e}applyChanges(e){const s=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?s.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),Z.waitFor(s)}getFromCache(e,s){return this.cr.getEntry(e,s)}getAllFromCache(e,s){return this.cr.getEntries(e,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e){this.persistence=e,this.Nr=new Io(s=>Zg(s),ex),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ax,this.targetCount=0,this.kr=mo.Bn()}forEachTarget(e,s){return this.Nr.forEach((r,i)=>s(i)),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,s,r){return r&&(this.lastRemoteSnapshotVersion=r),s>this.Lr&&(this.Lr=s),Z.resolve()}Kn(e){this.Nr.set(e.target,e);const s=e.targetId;s>this.highestTargetId&&(this.kr=new mo(s),this.highestTargetId=s),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,s){return this.Kn(s),this.targetCount+=1,Z.resolve()}updateTargetData(e,s){return this.Kn(s),Z.resolve()}removeTargetData(e,s){return this.Nr.delete(s.target),this.Br.gr(s.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,s,r){let i=0;const a=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=s&&r.get(l.targetId)===null&&(this.Nr.delete(o),a.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),Z.waitFor(a).next(()=>i)}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,s){const r=this.Nr.get(s)||null;return Z.resolve(r)}addMatchingKeys(e,s,r){return this.Br.Rr(s,r),Z.resolve()}removeMatchingKeys(e,s,r){this.Br.mr(s,r);const i=this.persistence.referenceDelegate,a=[];return i&&s.forEach(o=>{a.push(i.markPotentiallyOrphaned(e,o))}),Z.waitFor(a)}removeMatchingKeysForTargetId(e,s){return this.Br.gr(s),Z.resolve()}getMatchingKeysForTargetId(e,s){const r=this.Br.yr(s);return Z.resolve(r)}containsKey(e,s){return Z.resolve(this.Br.containsKey(s))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e,s){this.qr={},this.overlays={},this.Qr=new Qg(0),this.Kr=!1,this.Kr=!0,this.$r=new eA,this.referenceDelegate=e(this),this.Ur=new rA(this),this.indexManager=new KC,this.remoteDocumentCache=function(i){return new sA(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new HC(s),this.Gr=new JC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let s=this.overlays[e.toKey()];return s||(s=new ZC,this.overlays[e.toKey()]=s),s}getMutationQueue(e,s){let r=this.qr[e.toKey()];return r||(r=new tA(s,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,s,r){he("MemoryPersistence","Starting transaction:",e);const i=new aA(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(a=>this.referenceDelegate.jr(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Hr(e,s){return Z.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,s)))}}class aA extends B4{constructor(e){super(),this.currentSequenceNumber=e}}class ox{constructor(e){this.persistence=e,this.Jr=new ax,this.Yr=null}static Zr(e){return new ox(e)}get Xr(){if(this.Yr)return this.Yr;throw ye()}addReference(e,s,r){return this.Jr.addReference(r,s),this.Xr.delete(r.toString()),Z.resolve()}removeReference(e,s,r){return this.Jr.removeReference(r,s),this.Xr.add(r.toString()),Z.resolve()}markPotentiallyOrphaned(e,s){return this.Xr.add(s.toString()),Z.resolve()}removeTarget(e,s){this.Jr.gr(s.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,s.targetId).next(i=>{i.forEach(a=>this.Xr.add(a.toString()))}).next(()=>r.removeTargetData(e,s))}zr(){this.Yr=new Set}jr(e){const s=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.Xr,r=>{const i=me.fromPath(r);return this.ei(e,i).next(a=>{a||s.removeEntry(i,we.min())})}).next(()=>(this.Yr=null,s.apply(e)))}updateLimboDocument(e,s){return this.ei(e,s).next(r=>{r?this.Xr.delete(s.toString()):this.Xr.add(s.toString())})}Wr(e){return 0}ei(e,s){return Z.or([()=>Z.resolve(this.Jr.containsKey(s)),()=>this.persistence.getTargetCache().containsKey(e,s),()=>this.persistence.Hr(e,s)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(e,s,r,i){this.targetId=e,this.fromCache=s,this.$i=r,this.Ui=i}static Wi(e,s){let r=Ee(),i=Ee();for(const a of s.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new lx(e,s.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return RI()?8:z4(cs())>0?6:4}()}initialize(e,s){this.Ji=e,this.indexManager=s,this.Gi=!0}getDocumentsMatchingQuery(e,s,r,i){const a={result:null};return this.Yi(e,s).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.Zi(e,s,i,r).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new oA;return this.Xi(e,s,o).next(l=>{if(a.result=l,this.zi)return this.es(e,s,o,l.size)})}).next(()=>a.result)}es(e,s,r,i){return r.documentReadCount<this.ji?(tl()<=Ie.DEBUG&&he("QueryEngine","SDK will not create cache indexes for query:",Sa(s),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Z.resolve()):(tl()<=Ie.DEBUG&&he("QueryEngine","Query:",Sa(s),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(tl()<=Ie.DEBUG&&he("QueryEngine","The SDK decides to create cache indexes for query:",Sa(s),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fn(s))):Z.resolve())}Yi(e,s){if(yv(s))return Z.resolve(null);let r=Fn(s);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(s.limit!==null&&i===1&&(s=zu(s,null,"F"),r=Fn(s)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const o=Ee(...a);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(d=>{const u=this.ts(s,l);return this.ns(s,u,o,d.readTime)?this.Yi(e,zu(s,null,"F")):this.rs(e,u,s,d)}))})))}Zi(e,s,r,i){return yv(s)||i.isEqual(we.min())?Z.resolve(null):this.Ji.getDocuments(e,r).next(a=>{const o=this.ts(s,a);return this.ns(s,o,r,i)?Z.resolve(null):(tl()<=Ie.DEBUG&&he("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Sa(s)),this.rs(e,o,s,V4(i,-1)).next(l=>l))})}ts(e,s){let r=new Qt(e_(e));return s.forEach((i,a)=>{Rh(e,a)&&(r=r.add(a))}),r}ns(e,s,r,i){if(e.limit===null)return!1;if(r.size!==s.size)return!0;const a=e.limitType==="F"?s.last():s.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Xi(e,s,r){return tl()<=Ie.DEBUG&&he("QueryEngine","Using full collection scan to execute query:",Sa(s)),this.Ji.getDocumentsMatchingQuery(e,s,mi.min(),r)}rs(e,s,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(a=>(s.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(e,s,r,i){this.persistence=e,this.ss=s,this.serializer=i,this.os=new ut(Le),this._s=new Io(a=>Zg(a),ex),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YC(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",s=>e.collect(s,this.os))}}function dA(t,e,s,r){return new cA(t,e,s,r)}async function j_(t,e){const s=be(t);return await s.persistence.runTransaction("Handle user change","readonly",r=>{let i;return s.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,s.ls(e),s.mutationQueue.getAllMutationBatches(r))).next(a=>{const o=[],l=[];let d=Ee();for(const u of i){o.push(u.batchId);for(const h of u.mutations)d=d.add(h.key)}for(const u of a){l.push(u.batchId);for(const h of u.mutations)d=d.add(h.key)}return s.localDocuments.getDocuments(r,d).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function uA(t,e){const s=be(t);return s.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=s.cs.newChangeBuffer({trackRemovals:!0});return function(l,d,u,h){const p=u.batch,g=p.keys();let y=Z.resolve();return g.forEach(w=>{y=y.next(()=>h.getEntry(d,w)).next(C=>{const E=u.docVersions.get(w);Fe(E!==null),C.version.compareTo(E)<0&&(p.applyToRemoteDocument(C,u),C.isValidDocument()&&(C.setReadTime(u.commitVersion),h.addEntry(C)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(d,p))}(s,r,e,a).next(()=>a.apply(r)).next(()=>s.mutationQueue.performConsistencyCheck(r)).next(()=>s.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>s.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let d=Ee();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(d=d.add(l.batch.mutations[u].key));return d}(e))).next(()=>s.localDocuments.getDocuments(r,i))})}function __(t){const e=be(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",s=>e.Ur.getLastRemoteSnapshotVersion(s))}function hA(t,e){const s=be(t),r=e.snapshotVersion;let i=s.os;return s.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=s.cs.newChangeBuffer({trackRemovals:!0});i=s.os;const l=[];e.targetChanges.forEach((h,p)=>{const g=i.get(p);if(!g)return;l.push(s.Ur.removeMatchingKeys(a,h.removedDocuments,p).next(()=>s.Ur.addMatchingKeys(a,h.addedDocuments,p)));let y=g.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken(zt.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(p,y),function(C,E,N){return C.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0}(g,y,h)&&l.push(s.Ur.updateTargetData(a,y))});let d=wr(),u=Ee();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(s.persistence.referenceDelegate.updateLimboDocument(a,h))}),l.push(mA(a,o,e.documentUpdates).next(h=>{d=h.Ps,u=h.Is})),!r.isEqual(we.min())){const h=s.Ur.getLastRemoteSnapshotVersion(a).next(p=>s.Ur.setTargetsMetadata(a,a.currentSequenceNumber,r));l.push(h)}return Z.waitFor(l).next(()=>o.apply(a)).next(()=>s.localDocuments.getLocalViewOfDocuments(a,d,u)).next(()=>d)}).then(a=>(s.os=i,a))}function mA(t,e,s){let r=Ee(),i=Ee();return s.forEach(a=>r=r.add(a)),e.getEntries(t,r).next(a=>{let o=wr();return s.forEach((l,d)=>{const u=a.get(l);d.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),d.isNoDocument()&&d.version.isEqual(we.min())?(e.removeEntry(l,d.readTime),o=o.insert(l,d)):!u.isValidDocument()||d.version.compareTo(u.version)>0||d.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(d),o=o.insert(l,d)):he("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",d.version)}),{Ps:o,Is:i}})}function fA(t,e){const s=be(t);return s.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),s.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function pA(t,e){const s=be(t);return s.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return s.Ur.getTargetData(r,e).next(a=>a?(i=a,Z.resolve(i)):s.Ur.allocateTargetId(r).next(o=>(i=new Xr(e,o,"TargetPurposeListen",r.currentSequenceNumber),s.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=s.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(s.os=s.os.insert(r.targetId,r),s._s.set(e,r.targetId)),r})}async function Ip(t,e,s){const r=be(t),i=r.os.get(e),a=s?"readwrite":"readwrite-primary";try{s||await r.persistence.runTransaction("Release target",a,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Tc(o))throw o;he("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Tv(t,e,s){const r=be(t);let i=we.min(),a=Ee();return r.persistence.runTransaction("Execute query","readwrite",o=>function(d,u,h){const p=be(d),g=p._s.get(h);return g!==void 0?Z.resolve(p.os.get(g)):p.Ur.getTargetData(u,h)}(r,o,Fn(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(d=>{a=d})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,s?i:we.min(),s?a:Ee())).next(l=>(gA(r,oC(e),l),{documents:l,Ts:a})))}function gA(t,e,s){let r=t.us.get(e)||we.min();s.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),t.us.set(e,r)}class Cv{constructor(){this.activeTargetIds=mC()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xA{constructor(){this.so=new Cv,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,s,r){}addLocalQueryTarget(e,s=!0){return s&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,s,r){this.oo[e]=s}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Cv,Promise.resolve()}handleUserChange(e,s,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){he("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){he("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cd=null;function Xm(){return Cd===null?Cd=function(){return 268435456+Math.round(2147483648*Math.random())}():Cd++,"0x"+Cd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns="WebChannelConnection";class bA extends class{constructor(s){this.databaseInfo=s,this.databaseId=s.databaseId;const r=s.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+s.host,this.vo=`projects/${i}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${a}`}get Fo(){return!1}Mo(s,r,i,a,o){const l=Xm(),d=this.xo(s,r.toUriEncodedString());he("RestConnection",`Sending RPC '${s}' ${l}:`,d,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,a,o),this.No(s,d,u,i).then(h=>(he("RestConnection",`Received RPC '${s}' ${l}: `,h),h),h=>{throw ta("RestConnection",`RPC '${s}' ${l} failed with error: `,h,"url: ",d,"request:",i),h})}Lo(s,r,i,a,o,l){return this.Mo(s,r,i,a,o)}Oo(s,r,i){s["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ko}(),s["Content-Type"]="text/plain",this.databaseInfo.appId&&(s["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((a,o)=>s[o]=a),i&&i.headers.forEach((a,o)=>s[o]=a)}xo(s,r){const i=vA[s];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,s,r,i){const a=Xm();return new Promise((o,l)=>{const d=new Lj;d.setWithCredentials(!0),d.listenOnce(Mj.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case su.NO_ERROR:const h=d.getResponseJson();he(ns,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),o(h);break;case su.TIMEOUT:he(ns,`RPC '${e}' ${a} timed out`),l(new ae(K.DEADLINE_EXCEEDED,"Request time out"));break;case su.HTTP_ERROR:const p=d.getStatus();if(he(ns,`RPC '${e}' ${a} failed with status:`,p,"response text:",d.getResponseText()),p>0){let g=d.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g==null?void 0:g.error;if(y&&y.status&&y.message){const w=function(E){const N=E.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(N)>=0?N:K.UNKNOWN}(y.status);l(new ae(w,y.message))}else l(new ae(K.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new ae(K.UNAVAILABLE,"Connection failed."));break;default:ye()}}finally{he(ns,`RPC '${e}' ${a} completed.`)}});const u=JSON.stringify(i);he(ns,`RPC '${e}' ${a} sending request:`,i),d.send(s,"POST",u,r,15)})}Bo(e,s,r){const i=Xm(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Uj(),l=Fj(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(d.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Oo(d.initMessageHeaders,s,r),d.encodeInitMessageHeaders=!0;const h=a.join("");he(ns,`Creating RPC '${e}' stream ${i}: ${h}`,d);const p=o.createWebChannel(h,d);let g=!1,y=!1;const w=new wA({Io:E=>{y?he(ns,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(g||(he(ns,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),he(ns,`RPC '${e}' stream ${i} sending:`,E),p.send(E))},To:()=>p.close()}),C=(E,N,v)=>{E.listen(N,k=>{try{v(k)}catch(P){setTimeout(()=>{throw P},0)}})};return C(p,ul.EventType.OPEN,()=>{y||(he(ns,`RPC '${e}' stream ${i} transport opened.`),w.yo())}),C(p,ul.EventType.CLOSE,()=>{y||(y=!0,he(ns,`RPC '${e}' stream ${i} transport closed`),w.So())}),C(p,ul.EventType.ERROR,E=>{y||(y=!0,ta(ns,`RPC '${e}' stream ${i} transport errored:`,E),w.So(new ae(K.UNAVAILABLE,"The operation could not be completed")))}),C(p,ul.EventType.MESSAGE,E=>{var N;if(!y){const v=E.data[0];Fe(!!v);const k=v,P=k.error||((N=k[0])===null||N===void 0?void 0:N.error);if(P){he(ns,`RPC '${e}' stream ${i} received error:`,P);const O=P.status;let U=function(j){const I=_t[j];if(I!==void 0)return m_(I)}(O),b=P.message;U===void 0&&(U=K.INTERNAL,b="Unknown error status: "+O+" with message "+P.message),y=!0,w.So(new ae(U,b)),p.close()}else he(ns,`RPC '${e}' stream ${i} received:`,v),w.bo(v)}}),C(l,Vj.STAT_EVENT,E=>{E.stat===xp.PROXY?he(ns,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===xp.NOPROXY&&he(ns,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.wo()},0),w}}function Ym(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lh(t){return new AC(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(e,s,r=1e3,i=1.5,a=6e4){this.ui=e,this.timerId=s,this.ko=r,this.qo=i,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const s=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,s-r);i>0&&he("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${s} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e,s,r,i,a,o,l,d){this.ui=e,this.Ho=r,this.Jo=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=d,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new k_(e,s)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,s){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():s&&s.code===K.RESOURCE_EXHAUSTED?(vr(s.toString()),vr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):s&&s.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(s)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),s=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===s&&this.P_(r,i)},r=>{e(()=>{const i=new ae(K.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,s){const r=this.h_(this.Yo);this.stream=this.T_(e,s),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return he("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return s=>{this.ui.enqueueAndForget(()=>this.Yo===e?s():(he("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class NA extends E_{constructor(e,s,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",s,r,i,o),this.serializer=a}T_(e,s){return this.connection.Bo("Listen",e,s)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const s=DC(this.serializer,e),r=function(a){if(!("targetChange"in a))return we.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?we.min():o.readTime?Un(o.readTime):we.min()}(e);return this.listener.d_(s,r)}A_(e){const s={};s.database=Ep(this.serializer),s.addTarget=function(a,o){let l;const d=o.target;if(l=bp(d)?{documents:MC(a,d)}:{query:VC(a,d)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=g_(a,o.resumeToken);const u=jp(a,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(we.min())>0){l.readTime=qu(a,o.snapshotVersion.toTimestamp());const u=jp(a,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=UC(this.serializer,e);r&&(s.labels=r),this.a_(s)}R_(e){const s={};s.database=Ep(this.serializer),s.removeTarget=e,this.a_(s)}}class jA extends E_{constructor(e,s,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",s,r,i,o),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,s){return this.connection.Bo("Write",e,s)}E_(e){return Fe(!!e.streamToken),this.lastStreamToken=e.streamToken,Fe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Fe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const s=LC(e.writeResults,e.commitTime),r=Un(e.commitTime);return this.listener.g_(r,s)}p_(){const e={};e.database=Ep(this.serializer),this.a_(e)}m_(e){const s={streamToken:this.lastStreamToken,writes:e.map(r=>OC(this.serializer,r))};this.a_(s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A extends class{}{constructor(e,s,r,i){super(),this.authCredentials=e,this.appCheckCredentials=s,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ae(K.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,s,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Mo(e,_p(s,r),i,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ae(K.UNKNOWN,a.toString())})}Lo(e,s,r,i,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,_p(s,r),i,o,l,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ae(K.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class kA{constructor(e,s){this.asyncQueue=e,this.onlineStateHandler=s,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const s=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(vr(s),this.D_=!1):he("OnlineStateTracker",s)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e,s,r,i,a){this.localStore=e,this.datastore=s,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(o=>{r.enqueueAndForget(async()=>{ua(this)&&(he("RemoteStore","Restarting streams for network reachability change."),await async function(d){const u=be(d);u.L_.add(4),await Rc(u),u.q_.set("Unknown"),u.L_.delete(4),await Mh(u)}(this))})}),this.q_=new kA(r,i)}}async function Mh(t){if(ua(t))for(const e of t.B_)await e(!0)}async function Rc(t){for(const e of t.B_)await e(!1)}function I_(t,e){const s=be(t);s.N_.has(e.targetId)||(s.N_.set(e.targetId,e),hx(s)?ux(s):So(s).r_()&&dx(s,e))}function cx(t,e){const s=be(t),r=So(s);s.N_.delete(e),r.r_()&&S_(s,e),s.N_.size===0&&(r.r_()?r.o_():ua(s)&&s.q_.set("Unknown"))}function dx(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(we.min())>0){const s=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(s)}So(t).A_(e)}function S_(t,e){t.Q_.xe(e),So(t).R_(e)}function ux(t){t.Q_=new IC({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),So(t).start(),t.q_.v_()}function hx(t){return ua(t)&&!So(t).n_()&&t.N_.size>0}function ua(t){return be(t).L_.size===0}function T_(t){t.Q_=void 0}async function IA(t){t.q_.set("Online")}async function SA(t){t.N_.forEach((e,s)=>{dx(t,e)})}async function TA(t,e){T_(t),hx(t)?(t.q_.M_(e),ux(t)):t.q_.set("Unknown")}async function CA(t,e,s){if(t.q_.set("Online"),e instanceof p_&&e.state===2&&e.cause)try{await async function(i,a){const o=a.cause;for(const l of a.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(t,e)}catch(r){he("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Hu(t,r)}else if(e instanceof iu?t.Q_.Ke(e):e instanceof f_?t.Q_.He(e):t.Q_.We(e),!s.isEqual(we.min()))try{const r=await __(t.localStore);s.compareTo(r)>=0&&await function(a,o){const l=a.Q_.rt(o);return l.targetChanges.forEach((d,u)=>{if(d.resumeToken.approximateByteSize()>0){const h=a.N_.get(u);h&&a.N_.set(u,h.withResumeToken(d.resumeToken,o))}}),l.targetMismatches.forEach((d,u)=>{const h=a.N_.get(d);if(!h)return;a.N_.set(d,h.withResumeToken(zt.EMPTY_BYTE_STRING,h.snapshotVersion)),S_(a,d);const p=new Xr(h.target,d,u,h.sequenceNumber);dx(a,p)}),a.remoteSyncer.applyRemoteEvent(l)}(t,s)}catch(r){he("RemoteStore","Failed to raise snapshot:",r),await Hu(t,r)}}async function Hu(t,e,s){if(!Tc(e))throw e;t.L_.add(1),await Rc(t),t.q_.set("Offline"),s||(s=()=>__(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{he("RemoteStore","Retrying IndexedDB access"),await s(),t.L_.delete(1),await Mh(t)})}function C_(t,e){return e().catch(s=>Hu(t,s,e))}async function Vh(t){const e=be(t),s=pi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;AA(e);)try{const i=await fA(e.localStore,r);if(i===null){e.O_.length===0&&s.o_();break}r=i.batchId,RA(e,i)}catch(i){await Hu(e,i)}A_(e)&&R_(e)}function AA(t){return ua(t)&&t.O_.length<10}function RA(t,e){t.O_.push(e);const s=pi(t);s.r_()&&s.V_&&s.m_(e.mutations)}function A_(t){return ua(t)&&!pi(t).n_()&&t.O_.length>0}function R_(t){pi(t).start()}async function PA(t){pi(t).p_()}async function DA(t){const e=pi(t);for(const s of t.O_)e.m_(s.mutations)}async function OA(t,e,s){const r=t.O_.shift(),i=nx.from(r,e,s);await C_(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Vh(t)}async function LA(t,e){e&&pi(t).V_&&await async function(r,i){if(function(o){return _C(o)&&o!==K.ABORTED}(i.code)){const a=r.O_.shift();pi(r).s_(),await C_(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Vh(r)}}(t,e),A_(t)&&R_(t)}async function Rv(t,e){const s=be(t);s.asyncQueue.verifyOperationInProgress(),he("RemoteStore","RemoteStore received new credentials");const r=ua(s);s.L_.add(3),await Rc(s),r&&s.q_.set("Unknown"),await s.remoteSyncer.handleCredentialChange(e),s.L_.delete(3),await Mh(s)}async function MA(t,e){const s=be(t);e?(s.L_.delete(2),await Mh(s)):e||(s.L_.add(2),await Rc(s),s.q_.set("Unknown"))}function So(t){return t.K_||(t.K_=function(s,r,i){const a=be(s);return a.w_(),new NA(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Eo:IA.bind(null,t),Ro:SA.bind(null,t),mo:TA.bind(null,t),d_:CA.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),hx(t)?ux(t):t.q_.set("Unknown")):(await t.K_.stop(),T_(t))})),t.K_}function pi(t){return t.U_||(t.U_=function(s,r,i){const a=be(s);return a.w_(),new jA(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:PA.bind(null,t),mo:LA.bind(null,t),f_:DA.bind(null,t),g_:OA.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Vh(t)):(await t.U_.stop(),t.O_.length>0&&(he("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{constructor(e,s,r,i,a){this.asyncQueue=e,this.timerId=s,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,s,r,i,a){const o=Date.now()+r,l=new mx(e,s,o,i,a);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ae(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fx(t,e){if(vr("AsyncQueue",`${e}: ${t}`),Tc(t))return new ae(K.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e){this.comparator=e?(s,r)=>e(s,r)||me.comparator(s.key,r.key):(s,r)=>me.comparator(s.key,r.key),this.keyedMap=hl(),this.sortedSet=new ut(this.comparator)}static emptySet(e){return new eo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const s=this.keyedMap.get(e);return s?this.sortedSet.indexOf(s):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((s,r)=>(e(s),!1))}add(e){const s=this.delete(e.key);return s.copy(s.keyedMap.insert(e.key,e),s.sortedSet.insert(e,null))}delete(e){const s=this.get(e);return s?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(s)):this}isEqual(e){if(!(e instanceof eo)||this.size!==e.size)return!1;const s=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;s.hasNext();){const i=s.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(s=>{e.push(s.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,s){const r=new eo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=s,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(){this.W_=new ut(me.comparator)}track(e){const s=e.doc.key,r=this.W_.get(s);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(s,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(s,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(s,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(s,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(s):e.type===1&&r.type===2?this.W_=this.W_.insert(s,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(s,{type:2,doc:e.doc}):ye():this.W_=this.W_.insert(s,e)}G_(){const e=[];return this.W_.inorderTraversal((s,r)=>{e.push(r)}),e}}class fo{constructor(e,s,r,i,a,o,l,d,u){this.query=e,this.docs=s,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=d,this.hasCachedResults=u}static fromInitialDocuments(e,s,r,i,a){const o=[];return s.forEach(l=>{o.push({type:0,doc:l})}),new fo(e,s,eo.emptySet(s),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ah(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const s=this.docChanges,r=e.docChanges;if(s.length!==r.length)return!1;for(let i=0;i<s.length;i++)if(s[i].type!==r[i].type||!s[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class FA{constructor(){this.queries=Dv(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(s,r){const i=be(s),a=i.queries;i.queries=Dv(),a.forEach((o,l)=>{for(const d of l.j_)d.onError(r)})})(this,new ae(K.ABORTED,"Firestore shutting down"))}}function Dv(){return new Io(t=>Zj(t),Ah)}async function px(t,e){const s=be(t);let r=3;const i=e.query;let a=s.queries.get(i);a?!a.H_()&&e.J_()&&(r=2):(a=new VA,r=e.J_()?0:1);try{switch(r){case 0:a.z_=await s.onListen(i,!0);break;case 1:a.z_=await s.onListen(i,!1);break;case 2:await s.onFirstRemoteStoreListen(i)}}catch(o){const l=fx(o,`Initialization of query '${Sa(e.query)}' failed`);return void e.onError(l)}s.queries.set(i,a),a.j_.push(e),e.Z_(s.onlineState),a.z_&&e.X_(a.z_)&&xx(s)}async function gx(t,e){const s=be(t),r=e.query;let i=3;const a=s.queries.get(r);if(a){const o=a.j_.indexOf(e);o>=0&&(a.j_.splice(o,1),a.j_.length===0?i=e.J_()?0:1:!a.H_()&&e.J_()&&(i=2))}switch(i){case 0:return s.queries.delete(r),s.onUnlisten(r,!0);case 1:return s.queries.delete(r),s.onUnlisten(r,!1);case 2:return s.onLastRemoteStoreUnlisten(r);default:return}}function UA(t,e){const s=be(t);let r=!1;for(const i of e){const a=i.query,o=s.queries.get(a);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&xx(s)}function $A(t,e,s){const r=be(t),i=r.queries.get(e);if(i)for(const a of i.j_)a.onError(s);r.queries.delete(e)}function xx(t){t.Y_.forEach(e=>{e.next()})}var Sp,Ov;(Ov=Sp||(Sp={})).ea="default",Ov.Cache="cache";class yx{constructor(e,s,r){this.query=e,this.ta=s,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new fo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let s=!1;return this.na?this.ia(e)&&(this.ta.next(e),s=!0):this.sa(e,this.onlineState)&&(this.oa(e),s=!0),this.ra=e,s}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let s=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),s=!0),s}sa(e,s){if(!e.fromCache||!this.J_())return!0;const r=s!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||s==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const s=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!s)&&this.options.includeMetadataChanges===!0}oa(e){e=fo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Sp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e){this.key=e}}class D_{constructor(e){this.key=e}}class BA{constructor(e,s){this.query=e,this.Ta=s,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ee(),this.mutatedKeys=Ee(),this.Aa=e_(e),this.Ra=new eo(this.Aa)}get Va(){return this.Ta}ma(e,s){const r=s?s.fa:new Pv,i=s?s.Ra:this.Ra;let a=s?s.mutatedKeys:this.mutatedKeys,o=i,l=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{const g=i.get(h),y=Rh(this.query,p)?p:null,w=!!g&&this.mutatedKeys.has(g.key),C=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let E=!1;g&&y?g.data.isEqual(y.data)?w!==C&&(r.track({type:3,doc:y}),E=!0):this.ga(g,y)||(r.track({type:2,doc:y}),E=!0,(d&&this.Aa(y,d)>0||u&&this.Aa(y,u)<0)&&(l=!0)):!g&&y?(r.track({type:0,doc:y}),E=!0):g&&!y&&(r.track({type:1,doc:g}),E=!0,(d||u)&&(l=!0)),E&&(y?(o=o.add(y),a=C?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{Ra:o,fa:r,ns:l,mutatedKeys:a}}ga(e,s){return e.hasLocalMutations&&s.hasCommittedMutations&&!s.hasLocalMutations}applyChanges(e,s,r,i){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,p)=>function(y,w){const C=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ye()}};return C(y)-C(w)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),i=i!=null&&i;const l=s&&!i?this.ya():[],d=this.da.size===0&&this.current&&!i?1:0,u=d!==this.Ea;return this.Ea=d,o.length!==0||u?{snapshot:new fo(this.query,e.Ra,a,o,e.mutatedKeys,d===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Pv,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(s=>this.Ta=this.Ta.add(s)),e.modifiedDocuments.forEach(s=>{}),e.removedDocuments.forEach(s=>this.Ta=this.Ta.delete(s)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ee(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const s=[];return e.forEach(r=>{this.da.has(r)||s.push(new D_(r))}),this.da.forEach(r=>{e.has(r)||s.push(new P_(r))}),s}ba(e){this.Ta=e.Ts,this.da=Ee();const s=this.ma(e.documents);return this.applyChanges(s,!0)}Da(){return fo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class zA{constructor(e,s,r){this.query=e,this.targetId=s,this.view=r}}class qA{constructor(e){this.key=e,this.va=!1}}class HA{constructor(e,s,r,i,a,o){this.localStore=e,this.remoteStore=s,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Io(l=>Zj(l),Ah),this.Ma=new Map,this.xa=new Set,this.Oa=new ut(me.comparator),this.Na=new Map,this.La=new ax,this.Ba={},this.ka=new Map,this.qa=mo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function WA(t,e,s=!0){const r=U_(t);let i;const a=r.Fa.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.Da()):i=await O_(r,e,s,!0),i}async function KA(t,e){const s=U_(t);await O_(s,e,!0,!1)}async function O_(t,e,s,r){const i=await pA(t.localStore,Fn(e)),a=i.targetId,o=t.sharedClientState.addLocalQueryTarget(a,s);let l;return r&&(l=await GA(t,e,a,o==="current",i.resumeToken)),t.isPrimaryClient&&s&&I_(t.remoteStore,i),l}async function GA(t,e,s,r,i){t.Ka=(p,g,y)=>async function(C,E,N,v){let k=E.view.ma(N);k.ns&&(k=await Tv(C.localStore,E.query,!1).then(({documents:b})=>E.view.ma(b,k)));const P=v&&v.targetChanges.get(E.targetId),O=v&&v.targetMismatches.get(E.targetId)!=null,U=E.view.applyChanges(k,C.isPrimaryClient,P,O);return Mv(C,E.targetId,U.wa),U.snapshot}(t,p,g,y);const a=await Tv(t.localStore,e,!0),o=new BA(e,a.Ts),l=o.ma(a.documents),d=Ac.createSynthesizedTargetChangeForCurrentChange(s,r&&t.onlineState!=="Offline",i),u=o.applyChanges(l,t.isPrimaryClient,d);Mv(t,s,u.wa);const h=new zA(e,s,o);return t.Fa.set(e,h),t.Ma.has(s)?t.Ma.get(s).push(e):t.Ma.set(s,[e]),u.snapshot}async function QA(t,e,s){const r=be(t),i=r.Fa.get(e),a=r.Ma.get(i.targetId);if(a.length>1)return r.Ma.set(i.targetId,a.filter(o=>!Ah(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ip(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),s&&cx(r.remoteStore,i.targetId),Tp(r,i.targetId)}).catch(Sc)):(Tp(r,i.targetId),await Ip(r.localStore,i.targetId,!0))}async function XA(t,e){const s=be(t),r=s.Fa.get(e),i=s.Ma.get(r.targetId);s.isPrimaryClient&&i.length===1&&(s.sharedClientState.removeLocalQueryTarget(r.targetId),cx(s.remoteStore,r.targetId))}async function YA(t,e,s){const r=rR(t);try{const i=await function(o,l){const d=be(o),u=bt.now(),h=l.reduce((y,w)=>y.add(w.key),Ee());let p,g;return d.persistence.runTransaction("Locally write mutations","readwrite",y=>{let w=wr(),C=Ee();return d.cs.getEntries(y,h).next(E=>{w=E,w.forEach((N,v)=>{v.isValidDocument()||(C=C.add(N))})}).next(()=>d.localDocuments.getOverlayedDocuments(y,w)).next(E=>{p=E;const N=[];for(const v of l){const k=vC(v,p.get(v.key).overlayedDocument);k!=null&&N.push(new ji(v.key,k,Hj(k.value.mapValue),rn.exists(!0)))}return d.mutationQueue.addMutationBatch(y,u,N,l)}).next(E=>{g=E;const N=E.applyToLocalDocumentSet(p,C);return d.documentOverlayCache.saveOverlays(y,E.batchId,N)})}).then(()=>({batchId:g.batchId,changes:s_(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,d){let u=o.Ba[o.currentUser.toKey()];u||(u=new ut(Le)),u=u.insert(l,d),o.Ba[o.currentUser.toKey()]=u}(r,i.batchId,s),await Pc(r,i.changes),await Vh(r.remoteStore)}catch(i){const a=fx(i,"Failed to persist write");s.reject(a)}}async function L_(t,e){const s=be(t);try{const r=await hA(s.localStore,e);e.targetChanges.forEach((i,a)=>{const o=s.Na.get(a);o&&(Fe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Fe(o.va):i.removedDocuments.size>0&&(Fe(o.va),o.va=!1))}),await Pc(s,r,e)}catch(r){await Sc(r)}}function Lv(t,e,s){const r=be(t);if(r.isPrimaryClient&&s===0||!r.isPrimaryClient&&s===1){const i=[];r.Fa.forEach((a,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const d=be(o);d.onlineState=l;let u=!1;d.queries.forEach((h,p)=>{for(const g of p.j_)g.Z_(l)&&(u=!0)}),u&&xx(d)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function JA(t,e,s){const r=be(t);r.sharedClientState.updateQueryState(e,"rejected",s);const i=r.Na.get(e),a=i&&i.key;if(a){let o=new ut(me.comparator);o=o.insert(a,as.newNoDocument(a,we.min()));const l=Ee().add(a),d=new Oh(we.min(),new Map,new ut(Le),o,l);await L_(r,d),r.Oa=r.Oa.remove(a),r.Na.delete(e),vx(r)}else await Ip(r.localStore,e,!1).then(()=>Tp(r,e,s)).catch(Sc)}async function ZA(t,e){const s=be(t),r=e.batch.batchId;try{const i=await uA(s.localStore,e);V_(s,r,null),M_(s,r),s.sharedClientState.updateMutationState(r,"acknowledged"),await Pc(s,i)}catch(i){await Sc(i)}}async function eR(t,e,s){const r=be(t);try{const i=await function(o,l){const d=be(o);return d.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return d.mutationQueue.lookupMutationBatch(u,l).next(p=>(Fe(p!==null),h=p.keys(),d.mutationQueue.removeMutationBatch(u,p))).next(()=>d.mutationQueue.performConsistencyCheck(u)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(u,h,l)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>d.localDocuments.getDocuments(u,h))})}(r.localStore,e);V_(r,e,s),M_(r,e),r.sharedClientState.updateMutationState(e,"rejected",s),await Pc(r,i)}catch(i){await Sc(i)}}function M_(t,e){(t.ka.get(e)||[]).forEach(s=>{s.resolve()}),t.ka.delete(e)}function V_(t,e,s){const r=be(t);let i=r.Ba[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(s?a.reject(s):a.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Tp(t,e,s=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),s&&t.Ca.$a(r,s);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||F_(t,r)})}function F_(t,e){t.xa.delete(e.path.canonicalString());const s=t.Oa.get(e);s!==null&&(cx(t.remoteStore,s),t.Oa=t.Oa.remove(e),t.Na.delete(s),vx(t))}function Mv(t,e,s){for(const r of s)r instanceof P_?(t.La.addReference(r.key,e),tR(t,r)):r instanceof D_?(he("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||F_(t,r.key)):ye()}function tR(t,e){const s=e.key,r=s.path.canonicalString();t.Oa.get(s)||t.xa.has(r)||(he("SyncEngine","New document in limbo: "+s),t.xa.add(r),vx(t))}function vx(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const s=new me(et.fromString(e)),r=t.qa.next();t.Na.set(r,new qA(s)),t.Oa=t.Oa.insert(s,r),I_(t.remoteStore,new Xr(Fn(Ch(s.path)),r,"TargetPurposeLimboResolution",Qg.oe))}}async function Pc(t,e,s){const r=be(t),i=[],a=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,d)=>{o.push(r.Ka(d,e,s).then(u=>{var h;if((u||s)&&r.isPrimaryClient){const p=u?!u.fromCache:(h=s==null?void 0:s.targetChanges.get(d.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(d.targetId,p?"current":"not-current")}if(u){i.push(u);const p=lx.Wi(d.targetId,u);a.push(p)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(d,u){const h=be(d);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>Z.forEach(u,g=>Z.forEach(g.$i,y=>h.persistence.referenceDelegate.addReference(p,g.targetId,y)).next(()=>Z.forEach(g.Ui,y=>h.persistence.referenceDelegate.removeReference(p,g.targetId,y)))))}catch(p){if(!Tc(p))throw p;he("LocalStore","Failed to update sequence numbers: "+p)}for(const p of u){const g=p.targetId;if(!p.fromCache){const y=h.os.get(g),w=y.snapshotVersion,C=y.withLastLimboFreeSnapshotVersion(w);h.os=h.os.insert(g,C)}}}(r.localStore,a))}async function sR(t,e){const s=be(t);if(!s.currentUser.isEqual(e)){he("SyncEngine","User change. New user:",e.toKey());const r=await j_(s.localStore,e);s.currentUser=e,function(a,o){a.ka.forEach(l=>{l.forEach(d=>{d.reject(new ae(K.CANCELLED,o))})}),a.ka.clear()}(s,"'waitForPendingWrites' promise is rejected due to a user change."),s.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Pc(s,r.hs)}}function nR(t,e){const s=be(t),r=s.Na.get(e);if(r&&r.va)return Ee().add(r.key);{let i=Ee();const a=s.Ma.get(e);if(!a)return i;for(const o of a){const l=s.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function U_(t){const e=be(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=L_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=JA.bind(null,e),e.Ca.d_=UA.bind(null,e.eventManager),e.Ca.$a=$A.bind(null,e.eventManager),e}function rR(t){const e=be(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ZA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eR.bind(null,e),e}class Wu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Lh(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,s){return null}Ha(e,s){return null}za(e){return dA(this.persistence,new lA,e.initialUser,this.serializer)}Ga(e){return new iA(ox.Zr,this.serializer)}Wa(e){return new xA}async terminate(){var e,s;(e=this.gcScheduler)===null||e===void 0||e.stop(),(s=this.indexBackfillerScheduler)===null||s===void 0||s.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Wu.provider={build:()=>new Wu};class Cp{async initialize(e,s){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(s),this.remoteStore=this.createRemoteStore(s),this.eventManager=this.createEventManager(s),this.syncEngine=this.createSyncEngine(s,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Lv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=sR.bind(null,this.syncEngine),await MA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new FA}()}createDatastore(e){const s=Lh(e.databaseInfo.databaseId),r=function(a){return new bA(a)}(e.databaseInfo);return function(a,o,l,d){return new _A(a,o,l,d)}(e.authCredentials,e.appCheckCredentials,r,s)}createRemoteStore(e){return function(r,i,a,o,l){return new EA(r,i,a,o,l)}(this.localStore,this.datastore,e.asyncQueue,s=>Lv(this.syncEngine,s,0),function(){return Av.D()?new Av:new yA}())}createSyncEngine(e,s){return function(i,a,o,l,d,u,h){const p=new HA(i,a,o,l,d,u);return h&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,s)}async terminate(){var e,s;await async function(i){const a=be(i);he("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await Rc(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(s=this.eventManager)===null||s===void 0||s.terminate()}}Cp.provider={build:()=>new Cp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):vr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,s){setTimeout(()=>{this.muted||e(s)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e,s,r,i,a){this.authCredentials=e,this.appCheckCredentials=s,this.asyncQueue=r,this.databaseInfo=i,this.user=rs.UNAUTHENTICATED,this.clientId=Gg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,async o=>{he("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(he("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(s){const r=fx(s,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Jm(t,e){t.asyncQueue.verifyOperationInProgress(),he("FirestoreClient","Initializing OfflineComponentProvider");const s=t.configuration;await e.initialize(s);let r=s.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await j_(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Vv(t,e){t.asyncQueue.verifyOperationInProgress();const s=await aR(t);he("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(s,t.configuration),t.setCredentialChangeListener(r=>Rv(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Rv(e.remoteStore,i)),t._onlineComponents=e}async function aR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){he("FirestoreClient","Using user provided OfflineComponentProvider");try{await Jm(t,t._uninitializedComponentsProvider._offline)}catch(e){const s=e;if(!function(i){return i.name==="FirebaseError"?i.code===K.FAILED_PRECONDITION||i.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(s))throw s;ta("Error using user provided cache. Falling back to memory cache: "+s),await Jm(t,new Wu)}}else he("FirestoreClient","Using default OfflineComponentProvider"),await Jm(t,new Wu);return t._offlineComponents}async function $_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(he("FirestoreClient","Using user provided OnlineComponentProvider"),await Vv(t,t._uninitializedComponentsProvider._online)):(he("FirestoreClient","Using default OnlineComponentProvider"),await Vv(t,new Cp))),t._onlineComponents}function oR(t){return $_(t).then(e=>e.syncEngine)}async function Ku(t){const e=await $_(t),s=e.eventManager;return s.onListen=WA.bind(null,e.syncEngine),s.onUnlisten=QA.bind(null,e.syncEngine),s.onFirstRemoteStoreListen=KA.bind(null,e.syncEngine),s.onLastRemoteStoreUnlisten=XA.bind(null,e.syncEngine),s}function lR(t,e,s={}){const r=new cr;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,l,d,u){const h=new wx({next:g=>{h.Za(),o.enqueueAndForget(()=>gx(a,p));const y=g.docs.has(l);!y&&g.fromCache?u.reject(new ae(K.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&d&&d.source==="server"?u.reject(new ae(K.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new yx(Ch(l.path),h,{includeMetadataChanges:!0,_a:!0});return px(a,p)}(await Ku(t),t.asyncQueue,e,s,r)),r.promise}function cR(t,e,s={}){const r=new cr;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,l,d,u){const h=new wx({next:g=>{h.Za(),o.enqueueAndForget(()=>gx(a,p)),g.fromCache&&d.source==="server"?u.reject(new ae(K.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new yx(l,h,{includeMetadataChanges:!0,_a:!0});return px(a,p)}(await Ku(t),t.asyncQueue,e,s,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B_(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(t,e,s){if(!s)throw new ae(K.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function q_(t,e,s,r){if(e===!0&&r===!0)throw new ae(K.INVALID_ARGUMENT,`${t} and ${s} cannot be used together.`)}function Uv(t){if(!me.isDocumentKey(t))throw new ae(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $v(t){if(me.isDocumentKey(t))throw new ae(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Fh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ye()}function ps(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ae(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const s=Fh(t);throw new ae(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${s}`)}}return t}function dR(t,e){if(e<=0)throw new ae(K.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e){var s,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ae(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(s=e.ssl)===null||s===void 0||s;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ae(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}q_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=B_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new ae(K.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new ae(K.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new ae(K.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Uh{constructor(e,s,r,i){this._authCredentials=e,this._appCheckCredentials=s,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Bv({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ae(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ae(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Bv(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Bj;switch(r.type){case"firstParty":return new P4(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ae(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(s){const r=Fv.get(s);r&&(he("ComponentProvider","Removing Datastore"),Fv.delete(s),r.terminate())}(this),Promise.resolve()}}function H_(t,e,s,r={}){var i;const a=(t=ps(t,Uh))._getSettings(),o=`${e}:${s}`;if(a.host!=="firestore.googleapis.com"&&a.host!==o&&ta("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),r.mockUserToken){let l,d;if(typeof r.mockUserToken=="string")l=r.mockUserToken,d=rs.MOCK_USER;else{l=zN(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new ae(K.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new rs(u)}t._authCredentials=new C4(new $j(l,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,s,r){this.converter=s,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Kn(this.firestore,e,this._query)}}class Xt{constructor(e,s,r){this.converter=s,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xt(this.firestore,e,this._key)}}class dr extends Kn{constructor(e,s,r){super(e,s,Ch(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xt(this.firestore,null,new me(e))}withConverter(e){return new dr(this.firestore,e,this._path)}}function re(t,e,...s){if(t=Ye(t),z_("collection","path",e),t instanceof Uh){const r=et.fromString(e,...s);return $v(r),new dr(t,null,r)}{if(!(t instanceof Xt||t instanceof dr))throw new ae(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(et.fromString(e,...s));return $v(r),new dr(t.firestore,null,r)}}function X(t,e,...s){if(t=Ye(t),arguments.length===1&&(e=Gg.newId()),z_("doc","path",e),t instanceof Uh){const r=et.fromString(e,...s);return Uv(r),new Xt(t,null,new me(r))}{if(!(t instanceof Xt||t instanceof dr))throw new ae(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(et.fromString(e,...s));return Uv(r),new Xt(t.firestore,t instanceof dr?t.converter:null,new me(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new k_(this,"async_queue_retry"),this.Vu=()=>{const r=Ym();r&&he("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const s=Ym();s&&typeof s.addEventListener=="function"&&s.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const s=Ym();s&&typeof s.removeEventListener=="function"&&s.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const s=new cr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(s.resolve,s.reject),s.promise)).then(()=>s.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Tc(e))throw e;he("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const s=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw vr("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=s,s}enqueueAfterDelay(e,s,r){this.fu(),this.Ru.indexOf(e)>-1&&(s=0);const i=mx.createAndSchedule(this,e,s,r,a=>this.yu(a));return this.Tu.push(i),i}fu(){this.Eu&&ye()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const s of this.Tu)if(s.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((s,r)=>s.targetTimeMs-r.targetTimeMs);for(const s of this.Tu)if(s.skipDelay(),e!=="all"&&s.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const s=this.Tu.indexOf(e);this.Tu.splice(s,1)}}function qv(t){return function(s,r){if(typeof s!="object"||s===null)return!1;const i=s;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1}(t,["next","error","complete"])}class zn extends Uh{constructor(e,s,r,i){super(e,s,r,i),this.type="firestore",this._queue=new zv,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new zv(e),this._firestoreClient=void 0,await e}}}function W_(t,e){const s=typeof t=="object"?t:kh(),r=typeof t=="string"?t:"(default)",i=_h(s,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=UN("firestore");a&&H_(i,...a)}return i}function Dc(t){if(t._terminated)throw new ae(K.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||uR(t),t._firestoreClient}function uR(t){var e,s,r;const i=t._freezeSettings(),a=function(l,d,u,h){return new W4(l,d,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,B_(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((s=i.localCache)===null||s===void 0)&&s._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new iR(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(l){const d=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ra(zt.fromBase64String(e))}catch(s){throw new ae(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+s)}}static fromUint8Array(e){return new ra(zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(...e){for(let s=0;s<e.length;++s)if(e[s].length===0)throw new ae(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ut(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function K_(){return new To("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,s){if(!isFinite(e)||e<-90||e>90)throw new ae(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(s)||s<-180||s>180)throw new ae(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+s);this._lat=e,this._long=s}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e){this._values=(e||[]).map(s=>s)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR=/^__.*__$/;class mR{constructor(e,s,r){this.data=e,this.fieldMask=s,this.fieldTransforms=r}toMutation(e,s){return this.fieldMask!==null?new ji(e,this.data,this.fieldMask,s,this.fieldTransforms):new Cc(e,this.data,s,this.fieldTransforms)}}class G_{constructor(e,s,r){this.data=e,this.fieldMask=s,this.fieldTransforms=r}toMutation(e,s){return new ji(e,this.data,this.fieldMask,s,this.fieldTransforms)}}function Q_(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ye()}}class bx{constructor(e,s,r,i,a,o){this.settings=e,this.databaseId=s,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new bx(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var s;const r=(s=this.path)===null||s===void 0?void 0:s.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var s;const r=(s=this.path)===null||s===void 0?void 0:s.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Gu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(s=>e.isPrefixOf(s))!==void 0||this.fieldTransforms.find(s=>e.isPrefixOf(s.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Q_(this.Cu)&&hR.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class fR{constructor(e,s,r){this.databaseId=e,this.ignoreUndefinedProperties=s,this.serializer=r||Lh(e)}Qu(e,s,r,i=!1){return new bx({Cu:e,methodName:s,qu:r,path:Ut.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zh(t){const e=t._freezeSettings(),s=Lh(t._databaseId);return new fR(t._databaseId,!!e.ignoreUndefinedProperties,s)}function X_(t,e,s,r,i,a={}){const o=t.Qu(a.merge||a.mergeFields?2:0,e,s,i);_x("Data must be an object, but it was:",o,r);const l=Y_(r,o);let d,u;if(a.merge)d=new Os(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const g=Ap(e,p,s);if(!o.contains(g))throw new ae(K.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Z_(h,g)||h.push(g)}d=new Os(h),u=o.fieldTransforms.filter(p=>d.covers(p.field))}else d=null,u=o.fieldTransforms;return new mR(new Ns(l),d,u)}class qh extends Co{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof qh}}class Nx extends Co{_toFieldTransform(e){return new d_(e.path,new oc)}isEqual(e){return e instanceof Nx}}class jx extends Co{constructor(e,s){super(e),this.$u=s}_toFieldTransform(e){const s=new dc(e.serializer,i_(e.serializer,this.$u));return new d_(e.path,s)}isEqual(e){return e instanceof jx&&this.$u===e.$u}}function pR(t,e,s,r){const i=t.Qu(1,e,s);_x("Data must be an object, but it was:",i,r);const a=[],o=Ns.empty();da(r,(d,u)=>{const h=kx(e,d,s);u=Ye(u);const p=i.Nu(h);if(u instanceof qh)a.push(h);else{const g=Oc(u,p);g!=null&&(a.push(h),o.set(h,g))}});const l=new Os(a);return new G_(o,l,i.fieldTransforms)}function gR(t,e,s,r,i,a){const o=t.Qu(1,e,s),l=[Ap(e,r,s)],d=[i];if(a.length%2!=0)throw new ae(K.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<a.length;g+=2)l.push(Ap(e,a[g])),d.push(a[g+1]);const u=[],h=Ns.empty();for(let g=l.length-1;g>=0;--g)if(!Z_(u,l[g])){const y=l[g];let w=d[g];w=Ye(w);const C=o.Nu(y);if(w instanceof qh)u.push(y);else{const E=Oc(w,C);E!=null&&(u.push(y),h.set(y,E))}}const p=new Os(u);return new G_(h,p,o.fieldTransforms)}function xR(t,e,s,r=!1){return Oc(s,t.Qu(r?4:3,e))}function Oc(t,e){if(J_(t=Ye(t)))return _x("Unsupported field value:",e,t),Y_(t,e);if(t instanceof Co)return function(r,i){if(!Q_(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const a=[];let o=0;for(const l of r){let d=Oc(l,i.Lu(o));d==null&&(d={nullValue:"NULL_VALUE"}),a.push(d),o++}return{arrayValue:{values:a}}}(t,e)}return function(r,i){if((r=Ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return i_(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=bt.fromDate(r);return{timestampValue:qu(i.serializer,a)}}if(r instanceof bt){const a=new bt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:qu(i.serializer,a)}}if(r instanceof $h)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ra)return{bytesValue:g_(i.serializer,r._byteString)};if(r instanceof Xt){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:ix(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Bh)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw l.Bu("VectorValues must only contain numeric values.");return tx(l.serializer,d)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Fh(r)}`)}(t,e)}function Y_(t,e){const s={};return zj(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):da(t,(r,i)=>{const a=Oc(i,e.Mu(r));a!=null&&(s[r]=a)}),{mapValue:{fields:s}}}function J_(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof bt||t instanceof $h||t instanceof ra||t instanceof Xt||t instanceof Co||t instanceof Bh)}function _x(t,e,s){if(!J_(s)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(s)){const r=Fh(s);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Ap(t,e,s){if((e=Ye(e))instanceof To)return e._internalPath;if(typeof e=="string")return kx(t,e);throw Gu("Field path arguments must be of type string or ",t,!1,void 0,s)}const yR=new RegExp("[~\\*/\\[\\]]");function kx(t,e,s){if(e.search(yR)>=0)throw Gu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,s);try{return new To(...e.split("."))._internalPath}catch{throw Gu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,s)}}function Gu(t,e,s,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;s&&(l+=" (via `toFirestore()`)"),l+=". ";let d="";return(a||o)&&(d+=" (found",a&&(d+=` in field ${r}`),o&&(d+=` in document ${i}`),d+=")"),new ae(K.INVALID_ARGUMENT,l+t+d)}function Z_(t,e){return t.some(s=>s.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e,s,r,i,a){this._firestore=e,this._userDataWriter=s,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Xt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const s=this._document.data.field(Hh("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s)}}}class vR extends e1{data(){return super.data()}}function Hh(t,e){return typeof e=="string"?kx(t,e):e instanceof To?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t1(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ae(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ex{}class Wh extends Ex{}function je(t,e,...s){let r=[];e instanceof Ex&&r.push(e),r=r.concat(s),function(a){const o=a.filter(d=>d instanceof Kh).length,l=a.filter(d=>d instanceof Lc).length;if(o>1||o>0&&l>0)throw new ae(K.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Lc extends Wh{constructor(e,s,r){super(),this._field=e,this._op=s,this._value=r,this.type="where"}static _create(e,s,r){return new Lc(e,s,r)}_apply(e){const s=this._parse(e);return s1(e._query,s),new Kn(e.firestore,e.converter,Np(e._query,s))}_parse(e){const s=zh(e.firestore);return function(a,o,l,d,u,h,p){let g;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new ae(K.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Wv(p,h);const y=[];for(const w of p)y.push(Hv(d,a,w));g={arrayValue:{values:y}}}else g=Hv(d,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Wv(p,h),g=xR(l,o,p,h==="in"||h==="not-in");return It.create(u,h,g)}(e._query,"where",s,e.firestore._databaseId,this._field,this._op,this._value)}}function Ne(t,e,s){const r=e,i=Hh("where",t);return Lc._create(i,r,s)}class Kh extends Ex{constructor(e,s){super(),this.type=e,this._queryConstraints=s}static _create(e,s){return new Kh(e,s)}_parse(e){const s=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return s.length===1?s[0]:_n.create(s,this._getOperator())}_apply(e){const s=this._parse(e);return s.getFilters().length===0?e:(function(i,a){let o=i;const l=a.getFlattenedFilters();for(const d of l)s1(o,d),o=Np(o,d)}(e._query,s),new Kn(e.firestore,e.converter,Np(e._query,s)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Gh extends Wh{constructor(e,s){super(),this._field=e,this._direction=s,this.type="orderBy"}static _create(e,s){return new Gh(e,s)}_apply(e){const s=function(i,a,o){if(i.startAt!==null)throw new ae(K.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ae(K.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ac(a,o)}(e._query,this._field,this._direction);return new Kn(e.firestore,e.converter,function(i,a){const o=i.explicitOrderBy.concat([a]);return new Eo(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,s))}}function ln(t,e="asc"){const s=e,r=Hh("orderBy",t);return Gh._create(r,s)}class Qh extends Wh{constructor(e,s,r){super(),this.type=e,this._limit=s,this._limitType=r}static _create(e,s,r){return new Qh(e,s,r)}_apply(e){return new Kn(e.firestore,e.converter,zu(e._query,this._limit,this._limitType))}}function ia(t){return dR("limit",t),Qh._create("limit",t,"F")}function Hv(t,e,s){if(typeof(s=Ye(s))=="string"){if(s==="")throw new ae(K.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Jj(e)&&s.indexOf("/")!==-1)throw new ae(K.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${s}' contains a '/' character.`);const r=e.path.child(et.fromString(s));if(!me.isDocumentKey(r))throw new ae(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return hv(t,new me(r))}if(s instanceof Xt)return hv(t,s._key);throw new ae(K.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Fh(s)}.`)}function Wv(t,e){if(!Array.isArray(t)||t.length===0)throw new ae(K.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function s1(t,e){const s=function(i,a){for(const o of i)for(const l of o.getFlattenedFilters())if(a.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(s!==null)throw s===e.op?new ae(K.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ae(K.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${s.toString()}' filters.`)}class n1{convertValue(e,s="none"){switch(na(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,s);case 5:return e.stringValue;case 6:return this.convertBytes(sa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,s);case 11:return this.convertObject(e.mapValue,s);case 10:return this.convertVectorValue(e.mapValue);default:throw ye()}}convertObject(e,s){return this.convertObjectMap(e.fields,s)}convertObjectMap(e,s="none"){const r={};return da(e,(i,a)=>{r[i]=this.convertValue(a,s)}),r}convertVectorValue(e){var s,r,i;const a=(i=(r=(s=e.fields)===null||s===void 0?void 0:s.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>yt(o.doubleValue));return new Bh(a)}convertGeoPoint(e){return new $h(yt(e.latitude),yt(e.longitude))}convertArray(e,s){return(e.values||[]).map(r=>this.convertValue(r,s))}convertServerTimestamp(e,s){switch(s){case"previous":const r=Yg(e);return r==null?null:this.convertValue(r,s);case"estimate":return this.convertTimestamp(rc(e));default:return null}}convertTimestamp(e){const s=fi(e);return new bt(s.seconds,s.nanos)}convertDocumentKey(e,s){const r=et.fromString(e);Fe(N_(r));const i=new co(r.get(1),r.get(3)),a=new me(r.popFirst(5));return i.isEqual(s)||vr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${s.projectId}/${s.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r1(t,e,s){let r;return r=t?s&&(s.merge||s.mergeFields)?t.toFirestore(e,s):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,s){this.hasPendingWrites=e,this.fromCache=s}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ix extends e1{constructor(e,s,r,i,a,o){super(e,s,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const s=new Cl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(s,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,s={}){if(this._document){const r=this._document.data.field(Hh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,s.serverTimestamps)}}}class Cl extends Ix{data(e={}){return super.data(e)}}class Sx{constructor(e,s,r,i){this._firestore=e,this._userDataWriter=s,this._snapshot=i,this.metadata=new qa(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(s=>e.push(s)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,s){this._snapshot.docs.forEach(r=>{e.call(s,new Cl(this._firestore,this._userDataWriter,r.key,r,new qa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const s=!!e.includeMetadataChanges;if(s&&this._snapshot.excludesMetadataChanges)throw new ae(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===s||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const d=new Cl(i._firestore,i._userDataWriter,l.doc.key,l.doc,new qa(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:d,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>a||l.type!==3).map(l=>{const d=new Cl(i._firestore,i._userDataWriter,l.doc.key,l.doc,new qa(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:wR(l.type),doc:d,oldIndex:u,newIndex:h}})}}(this,s),this._cachedChangesIncludeMetadataChanges=s),this._cachedChanges}}function wR(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ye()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(t){t=ps(t,Xt);const e=ps(t.firestore,zn);return lR(Dc(e),t._key).then(s=>i1(e,t,s))}class Tx extends n1{constructor(e){super(),this.firestore=e}convertBytes(e){return new ra(e)}convertReference(e){const s=this.convertDocumentKey(e,this.firestore._databaseId);return new Xt(this.firestore,null,s)}}function ve(t){t=ps(t,Kn);const e=ps(t.firestore,zn),s=Dc(e),r=new Tx(e);return t1(t._query),cR(s,t._query).then(i=>new Sx(e,r,t,i))}function Ft(t,e,s){t=ps(t,Xt);const r=ps(t.firestore,zn),i=r1(t.converter,e,s);return Mc(r,[X_(zh(r),"setDoc",t._key,i,t.converter!==null,s).toMutation(t._key,rn.none())])}function fe(t,e,s,...r){t=ps(t,Xt);const i=ps(t.firestore,zn),a=zh(i);let o;return o=typeof(e=Ye(e))=="string"||e instanceof To?gR(a,"updateDoc",t._key,e,s,r):pR(a,"updateDoc",t._key,e),Mc(i,[o.toMutation(t._key,rn.exists(!0))])}function sn(t){return Mc(ps(t.firestore,zn),[new sx(t._key,rn.none())])}function tt(t,e){const s=ps(t.firestore,zn),r=X(t),i=r1(t.converter,e);return Mc(s,[X_(zh(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,rn.exists(!1))]).then(()=>r)}function qn(t,...e){var s,r,i;t=Ye(t);let a={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||qv(e[o])||(a=e[o],o++);const l={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(qv(e[o])){const p=e[o];e[o]=(s=p.next)===null||s===void 0?void 0:s.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let d,u,h;if(t instanceof Xt)u=ps(t.firestore,zn),h=Ch(t._key.path),d={next:p=>{e[o]&&e[o](i1(u,t,p))},error:e[o+1],complete:e[o+2]};else{const p=ps(t,Kn);u=ps(p.firestore,zn),h=p._query;const g=new Tx(u);d={next:y=>{e[o]&&e[o](new Sx(u,g,p,y))},error:e[o+1],complete:e[o+2]},t1(t._query)}return function(g,y,w,C){const E=new wx(C),N=new yx(y,E,w);return g.asyncQueue.enqueueAndForget(async()=>px(await Ku(g),N)),()=>{E.Za(),g.asyncQueue.enqueueAndForget(async()=>gx(await Ku(g),N))}}(Dc(u),h,l,d)}function Mc(t,e){return function(r,i){const a=new cr;return r.asyncQueue.enqueueAndForget(async()=>YA(await oR(r),i,a)),a.promise}(Dc(t),e)}function i1(t,e,s){const r=s.docs.get(e._key),i=new Tx(t);return new Ix(t,i,e._key,r,new qa(s.hasPendingWrites,s.fromCache),e.converter)}function se(){return new Nx("serverTimestamp")}function ms(t){return new jx("increment",t)}(function(e,s=!0){(function(i){ko=i})(ca),Yi(new hi("firestore",(r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),l=new zn(new A4(r.getProvider("auth-internal")),new O4(r.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ae(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new co(u.options.projectId,h)}(o,i),o);return a=Object.assign({useFetchStreams:s},a),l._setSettings(a),l},"PUBLIC").setMultipleInstances(!0)),Mn(ov,"4.7.3",e),Mn(ov,"4.7.3","esm2017")})();const Zm=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:n1,Bytes:ra,CollectionReference:dr,DocumentReference:Xt,DocumentSnapshot:Ix,FieldPath:To,FieldValue:Co,Firestore:zn,FirestoreError:ae,GeoPoint:$h,Query:Kn,QueryCompositeFilterConstraint:Kh,QueryConstraint:Wh,QueryDocumentSnapshot:Cl,QueryFieldFilterConstraint:Lc,QueryLimitConstraint:Qh,QueryOrderByConstraint:Gh,QuerySnapshot:Sx,SnapshotMetadata:qa,Timestamp:bt,VectorValue:Bh,_AutoId:Gg,_ByteString:zt,_DatabaseId:co,_DocumentKey:me,_EmptyAuthCredentialsProvider:Bj,_FieldPath:Ut,_cast:ps,_logWarn:ta,_validateIsNotUsedTogether:q_,addDoc:tt,collection:re,connectFirestoreEmulator:H_,deleteDoc:sn,doc:X,documentId:K_,ensureFirestoreConfigured:Dc,executeWrite:Mc,getDoc:Ce,getDocs:ve,getFirestore:W_,increment:ms,limit:ia,onSnapshot:qn,orderBy:ln,query:je,serverTimestamp:se,setDoc:Ft,updateDoc:fe,where:Ne},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1="firebasestorage.googleapis.com",o1="storageBucket",bR=2*60*1e3,NR=10*60*1e3,jR=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht extends Hn{constructor(e,s,r=0){super(ef(e),`Firebase Storage: ${s} (${ef(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ht.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ef(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var nt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(nt||(nt={}));function ef(t){return"storage/"+t}function Cx(){const t="An unknown error occurred, please check the error payload for server response.";return new ht(nt.UNKNOWN,t)}function _R(t){return new ht(nt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function kR(t){return new ht(nt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function ER(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ht(nt.UNAUTHENTICATED,t)}function IR(){return new ht(nt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function SR(t){return new ht(nt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function l1(){return new ht(nt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function c1(){return new ht(nt.CANCELED,"User canceled the upload/download.")}function TR(t){return new ht(nt.INVALID_URL,"Invalid URL '"+t+"'.")}function CR(t){return new ht(nt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function AR(){return new ht(nt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+o1+"' property when initializing the app?")}function d1(){return new ht(nt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function RR(){return new ht(nt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function PR(){return new ht(nt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function DR(t){return new ht(nt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Rp(t){return new ht(nt.INVALID_ARGUMENT,t)}function u1(){return new ht(nt.APP_DELETED,"The Firebase app was deleted.")}function OR(t){return new ht(nt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Al(t,e){return new ht(nt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function sl(t){throw new ht(nt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,s){this.bucket=e,this.path_=s}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,s){let r;try{r=Ls.makeFromUrl(e,s)}catch{return new Ls(e,"")}if(r.path==="")return r;throw CR(e)}static makeFromUrl(e,s){let r=null;const i="([A-Za-z0-9.\\-_]+)";function a(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+i+o,"i"),d={bucket:1,path:3};function u(P){P.path_=decodeURIComponent(P.path)}const h="v[A-Za-z0-9_]+",p=s.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",y=new RegExp(`^https?://${p}/${h}/b/${i}/o${g}`,"i"),w={bucket:1,path:3},C=s===a1?"(?:storage.googleapis.com|storage.cloud.google.com)":s,E="([^?#]*)",N=new RegExp(`^https?://${C}/${i}/${E}`,"i"),k=[{regex:l,indices:d,postModify:a},{regex:y,indices:w,postModify:u},{regex:N,indices:{bucket:1,path:2},postModify:u}];for(let P=0;P<k.length;P++){const O=k[P],U=O.regex.exec(e);if(U){const b=U[O.indices.bucket];let m=U[O.indices.path];m||(m=""),r=new Ls(b,m),O.postModify(r);break}}if(r==null)throw TR(e);return r}}class LR{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MR(t,e,s){let r=1,i=null,a=null,o=!1,l=0;function d(){return l===2}let u=!1;function h(...E){u||(u=!0,e.apply(null,E))}function p(E){i=setTimeout(()=>{i=null,t(y,d())},E)}function g(){a&&clearTimeout(a)}function y(E,...N){if(u){g();return}if(E){g(),h.call(null,E,...N);return}if(d()||o){g(),h.call(null,E,...N);return}r<64&&(r*=2);let k;l===1?(l=2,k=0):k=(r+Math.random())*1e3,p(k)}let w=!1;function C(E){w||(w=!0,g(),!u&&(i!==null?(E||(l=2),clearTimeout(i),p(0)):E||(l=1)))}return p(0),a=setTimeout(()=>{o=!0,C(!0)},s),C}function VR(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FR(t){return t!==void 0}function UR(t){return typeof t=="function"}function $R(t){return typeof t=="object"&&!Array.isArray(t)}function Xh(t){return typeof t=="string"||t instanceof String}function Kv(t){return Ax()&&t instanceof Blob}function Ax(){return typeof Blob<"u"}function Gv(t,e,s,r){if(r<e)throw Rp(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>s)throw Rp(`Invalid value for '${t}'. Expected ${s} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t,e,s){let r=e;return s==null&&(r=`https://${e}`),`${s}://${r}/v0${t}`}function h1(t){const e=encodeURIComponent;let s="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);s=s+i+"&"}return s=s.slice(0,-1),s}var qi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(qi||(qi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m1(t,e){const s=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return s||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,s,r,i,a,o,l,d,u,h,p,g=!0){this.url_=e,this.method_=s,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=d,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=p,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,w)=>{this.resolve_=y,this.reject_=w,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Ad(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const o=l=>{const d=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,u)};this.progressCallback_!==null&&a.addUploadProgressListener(o),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(o),this.pendingConnection_=null;const l=a.getErrorCode()===qi.NO_ERROR,d=a.getStatus();if(!l||m1(d,this.additionalRetryCodes_)&&this.retry){const h=a.getErrorCode()===qi.ABORT;r(!1,new Ad(!1,null,h));return}const u=this.successCodes_.indexOf(d)!==-1;r(!0,new Ad(u,a))})},s=(r,i)=>{const a=this.resolve_,o=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const d=this.callback_(l,l.getResponse());FR(d)?a(d):a()}catch(d){o(d)}else if(l!==null){const d=Cx();d.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,d)):o(d)}else if(i.canceled){const d=this.appDelete_?u1():c1();o(d)}else{const d=l1();o(d)}};this.canceled_?s(!1,new Ad(!1,null,!0)):this.backoffId_=MR(e,s,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&VR(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ad{constructor(e,s,r){this.wasSuccessCode=e,this.connection=s,this.canceled=!!r}}function zR(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function qR(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function HR(t,e){e&&(t["X-Firebase-GMPID"]=e)}function WR(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function KR(t,e,s,r,i,a,o=!0){const l=h1(t.urlParams),d=t.url+l,u=Object.assign({},t.headers);return HR(u,e),zR(u,s),qR(u,a),WR(u,r),new BR(d,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GR(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function QR(...t){const e=GR();if(e!==void 0){const s=new e;for(let r=0;r<t.length;r++)s.append(t[r]);return s.getBlob()}else{if(Ax())return new Blob(t);throw new ht(nt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function XR(t,e,s){return t.webkitSlice?t.webkitSlice(e,s):t.mozSlice?t.mozSlice(e,s):t.slice?t.slice(e,s):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YR(t){if(typeof atob>"u")throw DR("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class tf{constructor(e,s){this.data=e,this.contentType=s||null}}function JR(t,e){switch(t){case Rn.RAW:return new tf(f1(e));case Rn.BASE64:case Rn.BASE64URL:return new tf(p1(t,e));case Rn.DATA_URL:return new tf(eP(e),tP(e))}throw Cx()}function f1(t){const e=[];for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(s<t.length-1&&(t.charCodeAt(s+1)&64512)===56320))e.push(239,191,189);else{const a=r,o=t.charCodeAt(++s);r=65536|(a&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function ZR(t){let e;try{e=decodeURIComponent(t)}catch{throw Al(Rn.DATA_URL,"Malformed data URL.")}return f1(e)}function p1(t,e){switch(t){case Rn.BASE64:{const i=e.indexOf("-")!==-1,a=e.indexOf("_")!==-1;if(i||a)throw Al(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Rn.BASE64URL:{const i=e.indexOf("+")!==-1,a=e.indexOf("/")!==-1;if(i||a)throw Al(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let s;try{s=YR(e)}catch(i){throw i.message.includes("polyfill")?i:Al(t,"Invalid character found")}const r=new Uint8Array(s.length);for(let i=0;i<s.length;i++)r[i]=s.charCodeAt(i);return r}class g1{constructor(e){this.base64=!1,this.contentType=null;const s=e.match(/^data:([^,]+)?,/);if(s===null)throw Al(Rn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=s[1]||null;r!=null&&(this.base64=sP(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function eP(t){const e=new g1(t);return e.base64?p1(Rn.BASE64,e.rest):ZR(e.rest)}function tP(t){return new g1(t).contentType}function sP(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,s){let r=0,i="";Kv(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(s?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(s?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,s){if(Kv(this.data_)){const r=this.data_,i=XR(r,e,s);return i===null?null:new sr(i)}else{const r=new Uint8Array(this.data_.buffer,e,s-e);return new sr(r,!0)}}static getBlob(...e){if(Ax()){const s=e.map(r=>r instanceof sr?r.data_:r);return new sr(QR.apply(null,s))}else{const s=e.map(o=>Xh(o)?JR(Rn.RAW,o).data:o.data_);let r=0;s.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let a=0;return s.forEach(o=>{for(let l=0;l<o.length;l++)i[a++]=o[l]}),new sr(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x1(t){let e;try{e=JSON.parse(t)}catch{return null}return $R(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function rP(t,e){const s=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?s:t+"/"+s}function y1(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iP(t,e){return e}class us{constructor(e,s,r,i){this.server=e,this.local=s||e,this.writable=!!r,this.xform=i||iP}}let Rd=null;function aP(t){return!Xh(t)||t.length<2?t:y1(t)}function Rx(){if(Rd)return Rd;const t=[];t.push(new us("bucket")),t.push(new us("generation")),t.push(new us("metageneration")),t.push(new us("name","fullPath",!0));function e(a,o){return aP(o)}const s=new us("name");s.xform=e,t.push(s);function r(a,o){return o!==void 0?Number(o):o}const i=new us("size");return i.xform=r,t.push(i),t.push(new us("timeCreated")),t.push(new us("updated")),t.push(new us("md5Hash",null,!0)),t.push(new us("cacheControl",null,!0)),t.push(new us("contentDisposition",null,!0)),t.push(new us("contentEncoding",null,!0)),t.push(new us("contentLanguage",null,!0)),t.push(new us("contentType",null,!0)),t.push(new us("metadata","customMetadata",!0)),Rd=t,Rd}function oP(t,e){function s(){const r=t.bucket,i=t.fullPath,a=new Ls(r,i);return e._makeStorageReference(a)}Object.defineProperty(t,"ref",{get:s})}function lP(t,e,s){const r={};r.type="file";const i=s.length;for(let a=0;a<i;a++){const o=s[a];r[o.local]=o.xform(r,e[o.server])}return oP(r,t),r}function v1(t,e,s){const r=x1(e);return r===null?null:lP(t,r,s)}function cP(t,e,s,r){const i=x1(e);if(i===null||!Xh(i.downloadTokens))return null;const a=i.downloadTokens;if(a.length===0)return null;const o=encodeURIComponent;return a.split(",").map(u=>{const h=t.bucket,p=t.fullPath,g="/b/"+o(h)+"/o/"+o(p),y=Vc(g,s,r),w=h1({alt:"media",token:u});return y+w})[0]}function w1(t,e){const s={},r=e.length;for(let i=0;i<r;i++){const a=e[i];a.writable&&(s[a.server]=t[a.local])}return JSON.stringify(s)}class Ao{constructor(e,s,r,i){this.url=e,this.method=s,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(t){if(!t)throw Cx()}function Px(t,e){function s(r,i){const a=v1(t,i,e);return ur(a!==null),a}return s}function dP(t,e){function s(r,i){const a=v1(t,i,e);return ur(a!==null),cP(a,i,t.host,t._protocol)}return s}function Fc(t){function e(s,r){let i;return s.getStatus()===401?s.getErrorText().includes("Firebase App Check token is invalid")?i=IR():i=ER():s.getStatus()===402?i=kR(t.bucket):s.getStatus()===403?i=SR(t.path):i=r,i.status=s.getStatus(),i.serverResponse=r.serverResponse,i}return e}function b1(t){const e=Fc(t);function s(r,i){let a=e(r,i);return r.getStatus()===404&&(a=_R(t.path)),a.serverResponse=i.serverResponse,a}return s}function uP(t,e,s){const r=e.fullServerUrl(),i=Vc(r,t.host,t._protocol),a="GET",o=t.maxOperationRetryTime,l=new Ao(i,a,Px(t,s),o);return l.errorHandler=b1(e),l}function hP(t,e,s){const r=e.fullServerUrl(),i=Vc(r,t.host,t._protocol),a="GET",o=t.maxOperationRetryTime,l=new Ao(i,a,dP(t,s),o);return l.errorHandler=b1(e),l}function mP(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function N1(t,e,s){const r=Object.assign({},s);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=mP(null,e)),r}function j1(t,e,s,r,i){const a=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let k="";for(let P=0;P<2;P++)k=k+Math.random().toString().slice(2);return k}const d=l();o["Content-Type"]="multipart/related; boundary="+d;const u=N1(e,r,i),h=w1(u,s),p="--"+d+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+d+`\r
Content-Type: `+u.contentType+`\r
\r
`,g=`\r
--`+d+"--",y=sr.getBlob(p,r,g);if(y===null)throw d1();const w={name:u.fullPath},C=Vc(a,t.host,t._protocol),E="POST",N=t.maxUploadRetryTime,v=new Ao(C,E,Px(t,s),N);return v.urlParams=w,v.headers=o,v.body=y.uploadData(),v.errorHandler=Fc(e),v}class Qu{constructor(e,s,r,i){this.current=e,this.total=s,this.finalized=!!r,this.metadata=i||null}}function Dx(t,e){let s=null;try{s=t.getResponseHeader("X-Goog-Upload-Status")}catch{ur(!1)}return ur(!!s&&(e||["active"]).indexOf(s)!==-1),s}function fP(t,e,s,r,i){const a=e.bucketOnlyServerUrl(),o=N1(e,r,i),l={name:o.fullPath},d=Vc(a,t.host,t._protocol),u="POST",h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},p=w1(o,s),g=t.maxUploadRetryTime;function y(C){Dx(C);let E;try{E=C.getResponseHeader("X-Goog-Upload-URL")}catch{ur(!1)}return ur(Xh(E)),E}const w=new Ao(d,u,y,g);return w.urlParams=l,w.headers=h,w.body=p,w.errorHandler=Fc(e),w}function pP(t,e,s,r){const i={"X-Goog-Upload-Command":"query"};function a(u){const h=Dx(u,["active","final"]);let p=null;try{p=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{ur(!1)}p||ur(!1);const g=Number(p);return ur(!isNaN(g)),new Qu(g,r.size(),h==="final")}const o="POST",l=t.maxUploadRetryTime,d=new Ao(s,o,a,l);return d.headers=i,d.errorHandler=Fc(e),d}const Qv=256*1024;function gP(t,e,s,r,i,a,o,l){const d=new Qu(0,0);if(o?(d.current=o.current,d.total=o.total):(d.current=0,d.total=r.size()),r.size()!==d.total)throw RR();const u=d.total-d.current;let h=u;i>0&&(h=Math.min(h,i));const p=d.current,g=p+h;let y="";h===0?y="finalize":u===h?y="upload, finalize":y="upload";const w={"X-Goog-Upload-Command":y,"X-Goog-Upload-Offset":`${d.current}`},C=r.slice(p,g);if(C===null)throw d1();function E(P,O){const U=Dx(P,["active","final"]),b=d.current+h,m=r.size();let j;return U==="final"?j=Px(e,a)(P,O):j=null,new Qu(b,m,U==="final",j)}const N="POST",v=e.maxUploadRetryTime,k=new Ao(s,N,E,v);return k.headers=w,k.body=C.uploadData(),k.progressCallback=l||null,k.errorHandler=Fc(t),k}const ws={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function sf(t){switch(t){case"running":case"pausing":case"canceling":return ws.RUNNING;case"paused":return ws.PAUSED;case"success":return ws.SUCCESS;case"canceled":return ws.CANCELED;case"error":return ws.ERROR;default:return ws.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e,s,r){if(UR(e)||s!=null||r!=null)this.next=e,this.error=s??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ia(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class yP{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=qi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=qi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=qi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,s,r,i){if(this.sent_)throw sl("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(s,e,!0),i!==void 0)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw sl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw sl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw sl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw sl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class vP extends yP{initXhr(){this.xhr_.responseType="text"}}function Li(){return new vP}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,s,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=s,this._metadata=r,this._mappings=Rx(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(nt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const a=this.isExponentialBackoffExpired();if(m1(i.status,[]))if(a)i=l1();else{this.sleepTime=Math.max(this.sleepTime*2,jR),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(nt.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,a)=>{this._resolve=i,this._reject=a,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return s=>this._updateProgress(e+s)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([s,r])=>{switch(this._state){case"running":e(s,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,s)=>{const r=fP(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Li,e,s);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((s,r)=>{const i=pP(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(i,Li,s,r);this._request=a,a.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=Qv*this._chunkMultiplier,s=new Qu(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,a)=>{let o;try{o=gP(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,s,this._makeProgressCallback())}catch(d){this._error=d,this._transition("error");return}const l=this._ref.storage._makeRequest(o,Li,i,a,!1);this._request=l,l.getPromise().then(d=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(d.current),d.finalized?(this._metadata=d.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){Qv*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,s)=>{const r=uP(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Li,e,s);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,s)=>{const r=j1(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Li,e,s);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const s=this._transferred;this._transferred=e,this._transferred!==s&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const s=this._state==="paused";this._state=e,s&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=c1(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=sf(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,s,r,i){const a=new xP(s||void 0,r||void 0,i||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,s){return this._promise.then(e,s)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const s=this._observers.indexOf(e);s!==-1&&this._observers.splice(s,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(s=>{this._notifyObserver(s)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(sf(this._state)){case ws.SUCCESS:Ia(this._resolve.bind(null,this.snapshot))();break;case ws.CANCELED:case ws.ERROR:const s=this._reject;Ia(s.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(sf(this._state)){case ws.RUNNING:case ws.PAUSED:e.next&&Ia(e.next.bind(e,this.snapshot))();break;case ws.SUCCESS:e.complete&&Ia(e.complete.bind(e))();break;case ws.CANCELED:case ws.ERROR:e.error&&Ia(e.error.bind(e,this._error))();break;default:e.error&&Ia(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e,s){this._service=e,s instanceof Ls?this._location=s:this._location=Ls.makeFromUrl(s,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,s){return new aa(e,s)}get root(){const e=new Ls(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return y1(this._location.path)}get storage(){return this._service}get parent(){const e=nP(this._location.path);if(e===null)return null;const s=new Ls(this._location.bucket,e);return new aa(this._service,s)}_throwIfRoot(e){if(this._location.path==="")throw OR(e)}}function bP(t,e,s){t._throwIfRoot("uploadBytes");const r=j1(t.storage,t._location,Rx(),new sr(e,!0),s);return t.storage.makeRequestWithTokens(r,Li).then(i=>({metadata:i,ref:t}))}function NP(t,e,s){return t._throwIfRoot("uploadBytesResumable"),new wP(t,new sr(e),s)}function jP(t){t._throwIfRoot("getDownloadURL");const e=hP(t.storage,t._location,Rx());return t.storage.makeRequestWithTokens(e,Li).then(s=>{if(s===null)throw PR();return s})}function _P(t,e){const s=rP(t._location.path,e),r=new Ls(t._location.bucket,s);return new aa(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kP(t){return/^[A-Za-z]+:\/\//.test(t)}function EP(t,e){return new aa(t,e)}function _1(t,e){if(t instanceof Ox){const s=t;if(s._bucket==null)throw AR();const r=new aa(s,s._bucket);return e!=null?_1(r,e):r}else return e!==void 0?_P(t,e):t}function IP(t,e){if(e&&kP(e)){if(t instanceof Ox)return EP(t,e);throw Rp("To use ref(service, url), the first argument must be a Storage instance.")}else return _1(t,e)}function Xv(t,e){const s=e==null?void 0:e[o1];return s==null?null:Ls.makeFromBucketSpec(s,t)}function SP(t,e,s,r={}){t.host=`${e}:${s}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:zN(i,t.app.options.projectId))}class Ox{constructor(e,s,r,i,a){this.app=e,this._authProvider=s,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=a1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=bR,this._maxUploadRetryTime=NR,this._requests=new Set,i!=null?this._bucket=Ls.makeFromBucketSpec(i,this._host):this._bucket=Xv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ls.makeFromBucketSpec(this._url,e):this._bucket=Xv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Gv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Gv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const s=await e.getToken();if(s!==null)return s.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new aa(this,e)}_makeRequest(e,s,r,i,a=!0){if(this._deleted)return new LR(u1());{const o=KR(e,this._appId,r,i,s,this._firebaseVersion,a);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,s){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,s,r,i).getPromise()}}const Yv="@firebase/storage",Jv="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="storage";function uc(t,e,s){return t=Ye(t),bP(t,e,s)}function Xu(t,e,s){return t=Ye(t),NP(t,e,s)}function br(t){return t=Ye(t),jP(t)}function Nr(t,e){return t=Ye(t),IP(t,e)}function Yh(t=kh(),e){t=Ye(t);const r=_h(t,k1).getImmediate({identifier:e}),i=UN("storage");return i&&TP(r,...i),r}function TP(t,e,s,r={}){SP(t,e,s,r)}function CP(t,{instanceIdentifier:e}){const s=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Ox(s,r,i,e,ca)}function AP(){Yi(new hi(k1,CP,"PUBLIC").setMultipleInstances(!0)),Mn(Yv,Jv,""),Mn(Yv,Jv,"esm2017")}AP();const RP={apiKey:"AIzaSyC1iM3g3gGfu23GKLpDRQplBuHidPniFIk",authDomain:"albayt-sofra.firebaseapp.com",projectId:"albayt-sofra",storageBucket:"albayt-sofra.firebasestorage.app",messagingSenderId:"895117143740",appId:"1:895117143740:web:239cfccc93d101c1f36ab9",measurementId:"G-FK3746ERH8"},Ps=KN().length?kh():WN(RP),Fs=KN().length>0?E4(Ps):gj(Ps,{persistence:[Aj,kj]}),B=W_(Ps),Yu=Yh(Ps),nl="broast_session_location",E1=_.createContext({user:null,role:null,loading:!0,logout:async()=>{},userLocation:null,locationRequired:!1,refreshUserData:async()=>{}}),PP=({children:t})=>{const[e,s]=_.useState(null),[r,i]=_.useState(null),[a,o]=_.useState(!0),[l,d]=_.useState(null),[u,h]=_.useState(!1),p=async()=>{if(!e)return;const y=await Ce(X(B,"users",e.uid));if(y.exists()){const w=y.data(),C=w==null?void 0:w.role,E=w==null?void 0:w.location,N=w==null?void 0:w.savedLocation;if(C==="customer"||C==="admin"){const v=N?{lat:N.lat,lng:N.lng}:E||null;d(v),v&&sessionStorage.setItem(nl,JSON.stringify(v))}else d(E||null),E&&sessionStorage.setItem(nl,JSON.stringify(E));h(!1)}};_.useEffect(()=>{const y=ZT(Fs,async w=>{if(s(w),w){const C=await Ce(X(B,"users",w.uid)),E=C.data(),N=C.exists()?E==null?void 0:E.role:null;i(N);const v=E==null?void 0:E.location,k=E==null?void 0:E.savedLocation,P=sessionStorage.getItem(nl),O=P?JSON.parse(P):null;let U=null;if(N==="customer"||N==="admin"?U=k?{lat:k.lat,lng:k.lng}:O||v||null:U=O||v||null,d(U),N==="customer"||N==="admin"){const b=!!k||!!O;!b&&navigator.geolocation?navigator.geolocation.getCurrentPosition(async m=>{const j={lat:m.coords.latitude,lng:m.coords.longitude,address:"  ()"};try{await fe(X(B,"users",w.uid),{savedLocation:j,location:{lat:j.lat,lng:j.lng}}),d({lat:j.lat,lng:j.lng}),sessionStorage.setItem(nl,JSON.stringify({lat:j.lat,lng:j.lng})),h(!1)}catch(I){console.warn("   :",I)}},m=>{console.warn("   :",m),h(!0)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):h(!b),k&&!O&&sessionStorage.setItem(nl,JSON.stringify({lat:k.lat,lng:k.lng}))}else h(N==="owner"||N==="courier"?!v:!1);if(N==="owner")try{const b=X(B,"restaurants",w.uid);(await Ce(b)).exists()||await Ft(b,{name:(E==null?void 0:E.restaurantName)||(E==null?void 0:E.name)||" ",ownerId:w.uid,email:(E==null?void 0:E.email)||w.email||"",phone:"",city:"",location:"",logoUrl:""},{merge:!0})}catch(b){console.warn("    ",b)}}else i(null),d(null),h(!1);o(!1)});return()=>y()},[]);const g=async()=>{await e5(Fs)};return n.jsx(E1.Provider,{value:{user:e,role:r,loading:a,logout:g,userLocation:l,locationRequired:u,refreshUserData:p},children:t})},Ue=()=>_.useContext(E1);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),OP=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,r)=>r?r.toUpperCase():s.toLowerCase()),Zv=t=>{const e=OP(t);return e.charAt(0).toUpperCase()+e.slice(1)},I1=(...t)=>t.filter((e,s,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===s).join(" ").trim(),LP=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var MP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=_.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...l},d)=>_.createElement("svg",{ref:d,...MP,width:e,height:e,stroke:t,strokeWidth:r?Number(s)*24/Number(e):s,className:I1("lucide",i),...!a&&!LP(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,h])=>_.createElement(u,h)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=(t,e)=>{const s=_.forwardRef(({className:r,...i},a)=>_.createElement(VP,{ref:a,iconNode:e,className:I1(`lucide-${DP(Zv(t))}`,`lucide-${t}`,r),...i}));return s.displayName=Zv(t),s};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],UP=te("arrow-left",FP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],$n=te("arrow-right",$P);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BP=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],au=te("award",BP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],hc=te("bell",zP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],mc=te("briefcase",qP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],Pn=te("building-2",HP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WP=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],KP=te("calendar",WP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GP=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],ou=te("chart-column",GP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QP=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],ew=te("check-check",QP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],_s=te("check",XP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YP=[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]],fc=te("chef-hat",YP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JP=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Lx=te("chevron-down",JP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZP=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ju=te("chevron-left",ZP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e6=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],t6=te("chevron-right",e6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s6=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],S1=te("chevron-up",s6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Dn=te("circle-alert",n6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r6=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Xe=te("circle-check-big",r6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],a6=te("circle-check",i6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],li=te("circle-x",o6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l6=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],pc=te("clipboard-list",l6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c6=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Rt=te("clock",c6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d6=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],Mx=te("code-xml",d6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u6=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],T1=te("copy",u6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Zu=te("credit-card",h6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m6=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Vt=te("crown",m6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f6=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],p6=te("dollar-sign",f6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g6=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Pp=te("external-link",g6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x6=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Rl=te("eye",x6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y6=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],tw=te("file-check",y6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v6=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Vx=te("file-text",v6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w6=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],sw=te("flask-conical",w6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b6=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],N6=te("funnel",b6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j6=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],nf=te("gift",j6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],k6=te("globe",_6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E6=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],eh=te("heart",E6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I6=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],th=te("house",I6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S6=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],C1=te("image",S6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],nw=te("info",T6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C6=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],A1=te("key-round",C6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A6=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],R6=te("key",A6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ci=te("loader-circle",P6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D6=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],po=te("lock",D6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O6=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],Fx=te("log-in",O6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L6=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Pl=te("mail",L6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Nt=te("map-pin",M6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V6=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],F6=te("map",V6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U6=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],Dp=te("medal",U6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $6=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],hr=te("megaphone",$6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B6=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],z6=te("menu",B6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Uc=te("message-circle",q6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H6=[["path",{d:"M5 12h14",key:"1ays0h"}]],W6=te("minus",H6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K6=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],Hi=te("navigation",K6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G6=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Bt=te("package",G6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],gc=te("pen-line",Q6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X6=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Jh=te("phone",X6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y6=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],J6=te("play",Y6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z6=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],$c=te("plus",Z6);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],os=te("refresh-cw",e3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],R1=te("save",t3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],n3=te("search",s3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],i3=te("send",r3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],o3=te("server",a3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],sh=te("settings",l3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Op=te("share-2",c3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],u3=te("shield-check",d3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],ha=te("shield",h3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],jr=te("shopping-bag",m3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],nh=te("shopping-cart",f3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],g3=te("smartphone",p3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],y3=te("smile",x3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Us=te("sparkles",v3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],rw=te("square-check-big",w3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],iw=te("square",b3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],go=te("star",N3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],lt=te("store",j3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],k3=te("target",_3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ss=te("trash-2",E3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],S3=te("trending-up",I3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Lp=te("triangle-alert",T3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],Ts=te("truck",C3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ux=te("upload",A3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],rf=te("user-check",R3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],D3=te("user-minus",P3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],xc=te("user-plus",O3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],aw=te("user-x",L3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],en=te("user",M3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],F3=te("users",V3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]],xo=te("utensils",U3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],B3=te("video",$3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],$x=te("wallet",z3);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],_r=te("x",q3),Je=({to:t,label:e,icon:s,onClick:r})=>{const{pathname:i}=bi(),a=i===t;return n.jsxs(de,{to:t,onClick:r,className:"flex items-center gap-2 px-4 py-3 sm:py-2.5 rounded-2xl text-sm font-bold transition-all duration-300 "+(a?"bg-white text-sky-600 shadow-lg shadow-sky-200/50 scale-105":"text-white/90 hover:text-white hover:bg-white/20 backdrop-blur-sm"),children:[s,n.jsx("span",{children:e})]})},H3=()=>{const{user:t,role:e,logout:s}=Ue(),[r,i]=_.useState(!1),[a,o]=_.useState(0),l=bi(),d=ys(),u=l.pathname==="/";return _.useEffect(()=>{i(!1)},[l.pathname]),_.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]),_.useEffect(()=>{if(!(t!=null&&t.uid)){o(0);return}const h=je(re(B,"notifications"),Ne("recipientId","==",t.uid),Ne("read","==",!1)),p=qn(h,g=>{o(g.size)},g=>{console.warn("Notifications listener error:",g),o(0)});return()=>p()},[t==null?void 0:t.uid]),n.jsxs("header",{className:"bg-gradient-to-r from-sky-600/95 via-sky-500/95 to-sky-600/95 backdrop-blur-lg shadow-xl shadow-sky-200/30",children:[n.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-4 py-3 sm:py-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[!u&&n.jsx("button",{onClick:()=>d(-1),className:"w-9 h-9 sm:w-10 sm:h-10 bg-white/20 hover:bg-white/30 rounded-xl flex items-center justify-center text-white transition-all","aria-label":"",children:n.jsx($n,{className:"w-5 h-5"})}),n.jsxs("button",{onClick:()=>window.location.href="/",className:"text-xl sm:text-2xl font-black text-white flex items-center gap-2 sm:gap-3 hover:scale-105 transition-transform drop-shadow-lg",children:[n.jsx("div",{className:"w-9 h-9 sm:w-10 sm:h-10 bg-white rounded-xl sm:rounded-2xl flex items-center justify-center shadow-lg",children:n.jsx("span",{className:"text-xl sm:text-2xl",children:""})}),n.jsx("span",{className:"text-lg sm:text-2xl",children:" "})]})]}),n.jsxs("nav",{className:"hidden md:flex items-center gap-1 lg:gap-2",children:[n.jsx(Je,{to:"/restaurants",label:"",icon:n.jsx(lt,{className:"w-4 h-4"})}),e==="customer"&&n.jsxs(n.Fragment,{children:[n.jsx(Je,{to:"/cart",label:" "}),n.jsx(Je,{to:"/orders",label:""}),n.jsx(Je,{to:"/profile",label:"",icon:n.jsx(en,{className:"w-4 h-4"})})]}),e==="owner"&&n.jsxs(n.Fragment,{children:[n.jsx(Je,{to:"/owner",label:" "}),n.jsx(Je,{to:"/owner/orders",label:" "}),n.jsx(Je,{to:"/owner/courier-requests",label:""})]}),e==="courier"&&n.jsxs(n.Fragment,{children:[n.jsx(Je,{to:"/courier",label:" "}),n.jsx(Je,{to:"/courier/hiring",label:""})]}),e==="admin"&&n.jsx(Je,{to:"/admin",label:" "}),e==="developer"&&n.jsx(Je,{to:"/developer",label:" "}),t&&n.jsxs(de,{to:"/notifications",className:"relative p-2.5 rounded-xl bg-white/20 hover:bg-white/30 transition text-white",title:"",children:[n.jsx(hc,{className:"w-5 h-5"}),a>0&&n.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold animate-pulse",children:a>9?"9+":a})]}),t?n.jsx("button",{onClick:s,className:"px-5 py-2.5 rounded-2xl text-sm font-bold text-sky-600 bg-white shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300",children:""}):n.jsx(Je,{to:"/login",label:""})]}),n.jsx("button",{className:"md:hidden p-2.5 rounded-2xl bg-white/20 hover:bg-white/30 transition backdrop-blur-sm",onClick:()=>i(!r),children:r?n.jsx(_r,{className:"w-6 h-6 text-white"}):n.jsx(z6,{className:"w-6 h-6 text-white"})})]}),r&&n.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden backdrop-blur-sm",onClick:()=>i(!1)}),n.jsxs("div",{className:`
        fixed top-0 right-0 h-full w-72 max-w-[80vw] bg-gradient-to-b from-sky-500 to-sky-700 
        z-50 md:hidden transform transition-transform duration-300 ease-out shadow-2xl
        ${r?"translate-x-0":"translate-x-full"}
      `,children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white/20",children:[n.jsx("span",{className:"text-white font-bold text-lg",children:""}),n.jsx("button",{onClick:()=>i(!1),className:"p-2 rounded-xl bg-white/20 hover:bg-white/30 transition",children:n.jsx(_r,{className:"w-5 h-5 text-white"})})]}),n.jsxs("div",{className:"p-4 flex flex-col gap-2 overflow-y-auto max-h-[calc(100vh-80px)]",children:[n.jsx(Je,{to:"/restaurants",label:"",icon:n.jsx(lt,{className:"w-5 h-5"}),onClick:()=>i(!1)}),e==="customer"&&n.jsxs(n.Fragment,{children:[n.jsx(Je,{to:"/cart",label:"",icon:n.jsx(nh,{className:"w-5 h-5"}),onClick:()=>i(!1)}),n.jsx(Je,{to:"/orders",label:"",icon:n.jsx(Bt,{className:"w-5 h-5"}),onClick:()=>i(!1)}),n.jsx(Je,{to:"/profile",label:"",icon:n.jsx(en,{className:"w-5 h-5"}),onClick:()=>i(!1)})]}),e==="owner"&&n.jsxs(n.Fragment,{children:[n.jsx(Je,{to:"/owner",label:" ",icon:n.jsx(th,{className:"w-5 h-5"}),onClick:()=>i(!1)}),n.jsx(Je,{to:"/owner/orders",label:" ",icon:n.jsx(Bt,{className:"w-5 h-5"}),onClick:()=>i(!1)}),n.jsx(Je,{to:"/owner/courier-requests",label:"",icon:n.jsx(Ts,{className:"w-5 h-5"}),onClick:()=>i(!1)})]}),e==="courier"&&n.jsxs(n.Fragment,{children:[n.jsx(Je,{to:"/courier",label:" ",icon:n.jsx(Ts,{className:"w-5 h-5"}),onClick:()=>i(!1)}),n.jsx(Je,{to:"/courier/hiring",label:"",icon:n.jsx(Bt,{className:"w-5 h-5"}),onClick:()=>i(!1)})]}),e==="admin"&&n.jsx(Je,{to:"/admin",label:" ",icon:n.jsx(ha,{className:"w-5 h-5"}),onClick:()=>i(!1)}),e==="developer"&&n.jsx(Je,{to:"/developer",label:" ",icon:n.jsx(Mx,{className:"w-5 h-5"}),onClick:()=>i(!1)}),t&&n.jsx(Je,{to:"/notifications",label:` ${a>0?`(${a})`:""}`,icon:n.jsx(hc,{className:"w-5 h-5"}),onClick:()=>i(!1)}),n.jsx("div",{className:"h-px bg-white/20 my-2"}),t?n.jsx("button",{onClick:()=>{s(),i(!1)},className:"w-full mt-2 px-5 py-3 rounded-2xl text-sm font-bold text-sky-600 bg-white shadow-lg hover:scale-105 transition-all duration-300 text-center",children:"  "}):n.jsx(Je,{to:"/login",label:" ",icon:n.jsx(th,{className:"w-5 h-5"}),onClick:()=>i(!1)})]})]})]})},P1=_.createContext(null),cn=()=>{const t=_.useContext(P1);if(!t)throw new Error("useDialog must be used within DialogProvider");return t},W3=({children:t})=>{const[e,s]=_.useState({isOpen:!1,message:"",type:"confirm"}),r=_.useCallback(d=>new Promise(u=>{s({...d,isOpen:!0,resolve:u})}),[]),i=_.useCallback(d=>{e.resolve&&e.resolve(d),s(u=>({...u,isOpen:!1}))},[e.resolve]),a=_.useCallback(async()=>{e.onConfirm&&await e.onConfirm(),i(!0)},[e.onConfirm,i]),o=_.useCallback(()=>{e.onCancel&&e.onCancel(),i(!1)},[e.onCancel,i]),l=_.useMemo(()=>({confirm:(d,u={})=>r({message:d,type:"confirm",title:u.title||"",confirmText:u.confirmText||"",cancelText:u.cancelText||"",...u}),alert:(d,u={})=>r({message:d,type:"alert",title:u.title||"",confirmText:u.confirmText||"",...u}).then(()=>{}),success:(d,u={})=>r({message:d,type:"success",title:u.title||" ",confirmText:u.confirmText||"",...u}).then(()=>{}),error:(d,u={})=>r({message:d,type:"error",title:u.title||"",confirmText:u.confirmText||"",...u}).then(()=>{}),warning:(d,u={})=>r({message:d,type:"warning",title:u.title||"",confirmText:u.confirmText||"",...u}).then(()=>{}),info:(d,u={})=>r({message:d,type:"info",title:u.title||"",confirmText:u.confirmText||"",...u}).then(()=>{})}),[r]);return n.jsxs(P1.Provider,{value:l,children:[t,n.jsx(K3,{...e,onConfirm:a,onCancel:o})]})},K3=({isOpen:t,title:e,message:s,type:r="confirm",confirmText:i="",cancelText:a="",dangerous:o,onConfirm:l,onCancel:d})=>{if(!t)return null;const h={confirm:{icon:n.jsx(nw,{className:"w-8 h-8"}),iconBg:"bg-sky-100",iconColor:"text-sky-600",buttonColor:o?"bg-red-600 hover:bg-red-700":"bg-sky-600 hover:bg-sky-700"},alert:{icon:n.jsx(Lp,{className:"w-8 h-8"}),iconBg:"bg-amber-100",iconColor:"text-amber-600",buttonColor:"bg-amber-600 hover:bg-amber-700"},success:{icon:n.jsx(Xe,{className:"w-8 h-8"}),iconBg:"bg-green-100",iconColor:"text-green-600",buttonColor:"bg-green-600 hover:bg-green-700"},error:{icon:n.jsx(li,{className:"w-8 h-8"}),iconBg:"bg-red-100",iconColor:"text-red-600",buttonColor:"bg-red-600 hover:bg-red-700"},warning:{icon:n.jsx(Lp,{className:"w-8 h-8"}),iconBg:"bg-orange-100",iconColor:"text-orange-600",buttonColor:"bg-orange-600 hover:bg-orange-700"},info:{icon:n.jsx(nw,{className:"w-8 h-8"}),iconBg:"bg-blue-100",iconColor:"text-blue-600",buttonColor:"bg-blue-600 hover:bg-blue-700"}}[r],p=r==="confirm";return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9998] animate-fadeIn",onClick:d}),n.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 pointer-events-none",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-sm pointer-events-auto animate-scaleIn overflow-hidden",onClick:g=>g.stopPropagation(),children:[n.jsxs("div",{className:"relative p-6 pb-0",children:[n.jsx("button",{onClick:d,className:"absolute top-4 left-4 p-1.5 rounded-lg hover:bg-gray-100 transition text-gray-400 hover:text-gray-600",children:n.jsx(_r,{className:"w-5 h-5"})}),n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("div",{className:`w-16 h-16 rounded-full ${h.iconBg} ${h.iconColor} flex items-center justify-center`,children:h.icon})}),n.jsx("h3",{className:"text-xl font-bold text-center text-gray-900",children:e})]}),n.jsx("div",{className:"p-6 pt-3",children:n.jsx("p",{className:"text-center text-gray-600 leading-relaxed",children:s})}),n.jsxs("div",{className:`p-4 pt-0 flex gap-3 ${p?"flex-row-reverse":"justify-center"}`,children:[n.jsx("button",{onClick:l,className:`flex-1 py-3 px-6 rounded-xl font-bold text-white transition-all duration-200 hover:scale-[1.02] active:scale-[0.98] ${h.buttonColor}`,children:i}),p&&n.jsx("button",{onClick:d,className:"flex-1 py-3 px-6 rounded-xl font-bold text-gray-700 bg-gray-100 hover:bg-gray-200 transition-all duration-200 hover:scale-[1.02] active:scale-[0.98]",children:a})]})]})}),n.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes scaleIn {
          from { opacity: 0; transform: scale(0.9); }
          to { opacity: 1; transform: scale(1); }
        }
        .animate-fadeIn {
          animation: fadeIn 0.2s ease-out;
        }
        .animate-scaleIn {
          animation: scaleIn 0.2s ease-out;
        }
      `})]})},G3=()=>{const{user:t}=Ue(),e=ys(),s=cn(),r=async()=>{if(!(!t||!await s.confirm("     .     .",{title:"  ",dangerous:!0,confirmText:"  ",cancelText:""})))try{await sn(X(B,"users",t.uid)),await t5(Fs.currentUser),s.success("   "),e("/account-deleted")}catch(a){console.error("Error deleting account:",a),s.error("    .   .")}};return n.jsx("footer",{className:"bg-gradient-to-b from-sky-600 to-sky-700 text-white text-center py-8 sm:py-10 mt-12 sm:mt-16 shadow-[0_-10px_40px_rgba(14,165,233,0.2)]",children:n.jsxs("div",{className:"max-w-4xl mx-auto flex flex-col items-center gap-4 sm:gap-6 px-4",children:[n.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[n.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-white rounded-xl sm:rounded-2xl flex items-center justify-center shadow-lg",children:n.jsx("span",{className:"text-2xl sm:text-3xl",children:""})}),n.jsx("span",{className:"text-xl sm:text-2xl font-black",children:" "})]}),n.jsxs("p",{className:"text-xs sm:text-sm md:text-base font-medium text-sky-100 flex items-center gap-2",children:["  ",n.jsx(eh,{className:"w-3 h-3 sm:w-4 sm:h-4 text-red-400 fill-red-400"}),"    ",new Date().getFullYear()]}),n.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-2 sm:gap-3",children:[n.jsxs(de,{to:"/privacy-policy",className:"flex items-center gap-1.5 sm:gap-2 bg-white/20 backdrop-blur-sm text-white font-semibold px-3 sm:px-5 py-2 sm:py-2.5 rounded-xl sm:rounded-2xl hover:bg-white/30 hover:scale-105 transition-all duration-300 text-xs sm:text-sm",children:[n.jsx(ha,{className:"w-3 h-3 sm:w-4 sm:h-4"}),""]}),n.jsxs(de,{to:"/developer",className:"flex items-center gap-1.5 sm:gap-2 bg-white/20 backdrop-blur-sm text-white font-semibold px-3 sm:px-5 py-2 sm:py-2.5 rounded-xl sm:rounded-2xl hover:bg-white/30 hover:scale-105 transition-all duration-300 text-xs sm:text-sm",children:[n.jsx(Mx,{className:"w-3 h-3 sm:w-4 sm:h-4"}),""]}),t&&n.jsxs("button",{onClick:r,className:"flex items-center gap-1.5 sm:gap-2 bg-red-500/80 backdrop-blur-sm text-white font-semibold px-3 sm:px-5 py-2 sm:py-2.5 rounded-xl sm:rounded-2xl hover:bg-red-500 hover:scale-105 transition-all duration-300 text-xs sm:text-sm",children:[n.jsx(Ss,{className:"w-3 h-3 sm:w-4 sm:h-4"})," "]})]}),n.jsx("div",{className:"w-24 sm:w-32 h-1 bg-white/20 rounded-full"}),n.jsx("p",{className:"text-[10px] sm:text-xs text-sky-200",children:"     "})]})})},Q3=()=>n.jsx("div",{className:"w-full bg-gradient-to-r from-sky-500 via-sky-400 to-sky-500 text-white py-2 sm:py-3 overflow-hidden shadow-lg",children:n.jsxs("div",{className:"flex items-center justify-center gap-1 sm:gap-2 px-2",children:[n.jsx(Us,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white animate-pulse flex-shrink-0"}),n.jsx("div",{className:"marquee whitespace-nowrap font-bold text-xs sm:text-sm tracking-wide",children:"            ! "}),n.jsx(Us,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white animate-pulse flex-shrink-0"})]})}),X3=()=>n.jsx("div",{className:"w-full bg-gradient-to-r from-amber-500 via-orange-500 to-amber-500 text-white py-1.5 overflow-hidden",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx(sw,{className:"w-4 h-4 text-white animate-pulse flex-shrink-0"}),n.jsx("div",{className:"beta-marquee whitespace-nowrap font-bold text-xs tracking-wide",children:"     (Beta)     ! "}),n.jsx(sw,{className:"w-4 h-4 text-white animate-pulse flex-shrink-0"})]})}),Y3=({onLocationSaved:t})=>{const{user:e,role:s}=Ue(),[r,i]=_.useState(null),[a,o]=_.useState(!1),[l,d]=_.useState(!1),[u,h]=_.useState(null),[p,g]=_.useState(!1),[y,w]=_.useState(!1),C={lat:24.7136,lng:46.6753},E=_.useCallback(()=>{if(!navigator.geolocation){h("    ");return}d(!0),h(null),navigator.geolocation.getCurrentPosition(k=>{const P={lat:k.coords.latitude,lng:k.coords.longitude};i(P),d(!1),window.locationRequiredMap&&(window.locationRequiredMap.setView([P.lat,P.lng],17),window.locationRequiredMarker&&window.locationRequiredMarker.setLatLng([P.lat,P.lng]))},k=>{d(!1),k.code===1?h("   .     "):k.code===2?h("  .    GPS"):h("   .   ")},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})},[]);_.useEffect(()=>{if(!document.getElementById("leaflet-css")){const k=document.createElement("link");k.id="leaflet-css",k.rel="stylesheet",k.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(k)}if(window.L)g(!0);else{const k=document.createElement("script");k.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",k.onload=()=>g(!0),document.body.appendChild(k)}},[]),_.useEffect(()=>{if(!p||!window.L)return;const k=window.L;if(!document.getElementById("location-required-map"))return;window.locationRequiredMap&&window.locationRequiredMap.remove();const O=r||C,U=k.map("location-required-map",{zoomControl:!0,attributionControl:!1}).setView([O.lat,O.lng],12);k.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19}).addTo(U);const b=k.divIcon({className:"custom-marker",html:`
        <div style="
          width: 50px; 
          height: 50px; 
          background: linear-gradient(135deg, #0EA5E9, #0284C7);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 4px 20px rgba(14, 165, 233, 0.5);
          border: 3px solid white;
        ">
          <div style="transform: rotate(45deg); color: white; font-size: 20px;"></div>
        </div>
      `,iconSize:[50,50],iconAnchor:[25,50]}),m=k.marker([O.lat,O.lng],{icon:b,draggable:!0}).addTo(U);return m.on("dragend",()=>{const j=m.getLatLng();i({lat:j.lat,lng:j.lng})}),U.on("click",j=>{const{lat:I,lng:T}=j.latlng;i({lat:I,lng:T}),m.setLatLng([I,T])}),window.locationRequiredMap=U,window.locationRequiredMarker=m,()=>{window.locationRequiredMap&&(window.locationRequiredMap.remove(),window.locationRequiredMap=null,window.locationRequiredMarker=null)}},[p]);const N=async()=>{if(!(!r||!e)){w(!0);try{if(await fe(X(B,"users",e.uid),{location:r,locationUpdatedAt:new Date}),s==="owner")try{await fe(X(B,"restaurants",e.uid),{geoLocation:r,locationUpdatedAt:new Date})}catch(k){console.warn("   :",k)}t()}catch{h("   .   ")}finally{w(!1)}}},v=()=>{switch(s){case"owner":return"";case"courier":return" ";default:return""}};return n.jsx("div",{className:"fixed inset-0 z-50 bg-gradient-to-br from-sky-50 via-white to-sky-100 flex items-center justify-center p-4",children:n.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-lg w-full overflow-hidden",children:[n.jsxs("div",{className:"bg-gradient-to-r from-sky-500 to-sky-600 p-6 text-white text-center",children:[n.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Nt,{className:"w-10 h-10"})}),n.jsxs("h1",{className:"text-2xl font-bold mb-2",children:["  ",v()]}),n.jsx("p",{className:"text-sky-100 text-sm",children:s==="owner"?"    ":"     (15 )"})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[u&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 flex items-center gap-3 text-red-700",children:[n.jsx(Lp,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{className:"text-sm",children:u})]}),n.jsx("button",{onClick:E,disabled:l,className:"w-full flex items-center justify-center gap-3 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold p-4 rounded-xl shadow-lg transition disabled:opacity-50",children:l?n.jsxs(n.Fragment,{children:[n.jsx(ci,{className:"w-5 h-5 animate-spin"}),"  ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Hi,{className:"w-5 h-5"}),"   "]})}),n.jsxs("div",{className:"relative",children:[n.jsx("p",{className:"text-sm text-gray-500 mb-2 text-center",children:"      "}),n.jsx("div",{id:"location-required-map",className:"h-64 rounded-xl overflow-hidden border-2 border-gray-200",style:{background:"#f0f9ff"}}),!p&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-sky-50",children:n.jsx(ci,{className:"w-8 h-8 animate-spin text-sky-500"})})]}),r&&n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 flex items-center gap-3 text-green-700",children:[n.jsx(Xe,{className:"w-5 h-5 flex-shrink-0"}),n.jsxs("div",{className:"text-sm",children:[n.jsx("p",{className:"font-semibold",children:"   "}),n.jsxs("p",{className:"text-xs text-green-600",children:[r.lat.toFixed(6),", ",r.lng.toFixed(6)]})]})]}),n.jsx("button",{onClick:N,disabled:!r||y,className:"w-full flex items-center justify-center gap-3 bg-gradient-to-r from-sky-500 to-sky-600 hover:from-sky-600 hover:to-sky-700 text-white font-bold p-4 rounded-xl shadow-lg transition disabled:opacity-50 disabled:cursor-not-allowed",children:y?n.jsxs(n.Fragment,{children:[n.jsx(ci,{className:"w-5 h-5 animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Xe,{className:"w-5 h-5"}),"  "]})}),n.jsx("p",{className:"text-xs text-gray-400 text-center",children:"       "})]})]})})},Ge=({to:t,icon:e,label:s,color:r,emoji:i})=>n.jsxs(de,{to:t,className:`flex flex-col items-center justify-center gap-2 p-4 sm:p-5 rounded-2xl bg-gradient-to-br ${r} text-white shadow-lg shadow-sky-200/30 active:scale-95 transition-all duration-200 backdrop-blur-sm`,children:[n.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 bg-white/25 backdrop-blur rounded-xl flex items-center justify-center",children:i?n.jsx("span",{className:"text-2xl sm:text-3xl",children:i}):e}),n.jsx("span",{className:"font-bold text-sm sm:text-base text-center leading-tight",children:s})]}),J3=()=>{var i;const{user:t,role:e,loading:s,logout:r}=Ue();return s?n.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-sky-50 via-white to-sky-100",children:[n.jsx("div",{className:"w-20 h-20 mb-6 bg-gradient-to-br from-sky-500 to-sky-600 rounded-3xl flex items-center justify-center shadow-2xl animate-pulse",children:n.jsx("span",{className:"text-5xl",children:""})}),n.jsx(ci,{className:"w-8 h-8 text-sky-500 animate-spin mb-3"}),n.jsx("p",{className:"text-sky-600 font-semibold",children:" ..."})]}):n.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-sky-50 via-white to-sky-100 px-3 py-4 sm:px-4 sm:py-6",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 mx-auto mb-3 bg-gradient-to-br from-sky-500 to-sky-600 rounded-2xl sm:rounded-3xl flex items-center justify-center shadow-xl",children:n.jsx("span",{className:"text-4xl sm:text-5xl",children:""})}),n.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-sky-600 to-sky-500 mb-1",children:" "}),t&&n.jsxs("p",{className:"text-sky-600/80 text-sm",children:[" ",t.displayName||((i=t.email)==null?void 0:i.split("@")[0])," "]})]}),!t&&n.jsxs("div",{className:"max-w-sm mx-auto space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(Ge,{to:"/restaurants",emoji:"",icon:n.jsx(lt,{className:"w-6 h-6"}),label:" ",color:"from-sky-500 to-sky-600"}),n.jsx(Ge,{to:"/customer-login",emoji:"",icon:n.jsx(Jh,{className:"w-6 h-6"}),label:" ",color:"from-green-500 to-green-600"}),n.jsx(Ge,{to:"/login",emoji:"",icon:n.jsx(Fx,{className:"w-6 h-6"}),label:" ",color:"from-amber-500 to-orange-500"}),n.jsx(Ge,{to:"/register",emoji:"",icon:n.jsx(xc,{className:"w-6 h-6"}),label:" ",color:"from-purple-500 to-purple-600"})]}),n.jsx("p",{className:"text-center text-sky-600/70 text-xs",children:"      "})]}),e==="customer"&&n.jsxs("div",{className:"max-w-sm mx-auto space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(Ge,{to:"/restaurants",emoji:"",icon:n.jsx(lt,{className:"w-6 h-6"}),label:" ",color:"from-sky-500 to-sky-600"}),n.jsx(Ge,{to:"/cart",emoji:"",icon:n.jsx(nh,{className:"w-6 h-6"}),label:"",color:"from-green-500 to-green-600"}),n.jsx(Ge,{to:"/orders",emoji:"",icon:n.jsx(Bt,{className:"w-6 h-6"}),label:"",color:"from-amber-500 to-orange-500"}),n.jsx(Ge,{to:"/profile",emoji:"",icon:n.jsx(en,{className:"w-6 h-6"}),label:"",color:"from-purple-500 to-purple-600"})]}),n.jsx("button",{onClick:r,className:"w-full py-3 rounded-xl glass-light text-sky-600 font-semibold text-sm active:bg-white/70 transition",children:" "})]}),e==="owner"&&n.jsxs("div",{className:"max-w-sm mx-auto space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(Ge,{to:"/owner",emoji:"",icon:n.jsx(fc,{className:"w-6 h-6"}),label:" ",color:"from-sky-500 to-sky-600"}),n.jsx(Ge,{to:"/owner/orders",emoji:"",icon:n.jsx(pc,{className:"w-6 h-6"}),label:"",color:"from-green-500 to-green-600"}),n.jsx(Ge,{to:"/owner/menu",emoji:"",icon:n.jsx(lt,{className:"w-6 h-6"}),label:"",color:"from-amber-500 to-orange-500"}),n.jsx(Ge,{to:"/owner/edit",emoji:"",icon:n.jsx(sh,{className:"w-6 h-6"}),label:" ",color:"from-purple-500 to-purple-600"}),n.jsx(Ge,{to:"/owner/courier-requests",emoji:"",icon:n.jsx(Ts,{className:"w-6 h-6"}),label:"",color:"from-cyan-500 to-cyan-600"}),n.jsx(Ge,{to:"/profile",emoji:"",icon:n.jsx(en,{className:"w-6 h-6"}),label:"",color:"from-gray-500 to-gray-600"})]}),n.jsx("button",{onClick:r,className:"w-full py-3 rounded-xl glass-light text-sky-600 font-semibold text-sm active:bg-white/70 transition",children:" "})]}),e==="courier"&&n.jsxs("div",{className:"max-w-sm mx-auto space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(Ge,{to:"/courier",emoji:"",icon:n.jsx(Ts,{className:"w-6 h-6"}),label:" ",color:"from-sky-500 to-sky-600"}),n.jsx(Ge,{to:"/courier/hiring",emoji:"",icon:n.jsx(lt,{className:"w-6 h-6"}),label:" ",color:"from-green-500 to-green-600"}),n.jsx(Ge,{to:"/profile",emoji:"",icon:n.jsx(en,{className:"w-6 h-6"}),label:"",color:"from-purple-500 to-purple-600"})]}),n.jsx("button",{onClick:r,className:"w-full py-3 rounded-xl glass-light text-sky-600 font-semibold text-sm active:bg-white/70 transition",children:" "})]}),e==="admin"&&n.jsxs("div",{className:"max-w-sm mx-auto space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(Ge,{to:"/admin",emoji:"",icon:n.jsx(ha,{className:"w-6 h-6"}),label:" ",color:"from-sky-500 to-sky-600"}),n.jsx(Ge,{to:"/admin/restaurants",emoji:"",icon:n.jsx(lt,{className:"w-6 h-6"}),label:"",color:"from-green-500 to-green-600"}),n.jsx(Ge,{to:"/admin/orders",emoji:"",icon:n.jsx(Bt,{className:"w-6 h-6"}),label:"",color:"from-amber-500 to-orange-500"}),n.jsx(Ge,{to:"/restaurants",emoji:"",icon:n.jsx(nh,{className:"w-6 h-6"}),label:" ",color:"from-purple-500 to-purple-600"}),n.jsx(Ge,{to:"/profile",emoji:"",icon:n.jsx(en,{className:"w-6 h-6"}),label:"",color:"from-gray-500 to-gray-600"})]}),n.jsx("button",{onClick:r,className:"w-full py-3 rounded-xl glass-light text-sky-600 font-semibold text-sm active:bg-white/70 transition",children:" "})]}),e==="developer"&&n.jsxs("div",{className:"max-w-sm mx-auto space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(Ge,{to:"/developer",emoji:"",icon:n.jsx(Mx,{className:"w-6 h-6"}),label:" ",color:"from-sky-500 to-sky-600"}),n.jsx(Ge,{to:"/restaurants",emoji:"",icon:n.jsx(lt,{className:"w-6 h-6"}),label:"",color:"from-green-500 to-green-600"}),n.jsx(Ge,{to:"/admin/orders",emoji:"",icon:n.jsx(Bt,{className:"w-6 h-6"}),label:"",color:"from-amber-500 to-orange-500"}),n.jsx(Ge,{to:"/profile",emoji:"",icon:n.jsx(en,{className:"w-6 h-6"}),label:"",color:"from-purple-500 to-purple-600"})]}),n.jsx("button",{onClick:r,className:"w-full py-3 rounded-xl glass-light text-sky-600 font-semibold text-sm active:bg-white/70 transition",children:" "})]})]})},Bx=["",""," "," ","","","","","","","","","",""," ","","","","",""," ","","","","","","","","","","","","","",""," ","","","",""];function Z3(t,e){const r=Pd(e.lat-t.lat),i=Pd(e.lng-t.lng),a=Math.sin(r/2)*Math.sin(r/2)+Math.cos(Pd(t.lat))*Math.cos(Pd(e.lat))*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}function Pd(t){return t*(Math.PI/180)}const af=15,ow=async(t,e,s)=>{try{await tt(re(B,"visitLogs"),{restaurantId:t,visitorId:e||null,visitorType:e?"customer":"anonymous",source:s||"direct",page:"menu",createdAt:se()});const r=X(B,"restaurantStats",t),i=await Ce(r),a=new Date().toISOString().split("T")[0];if(i.exists()){const l=i.data().dailyViews||{};l[a]=(l[a]||0)+1,await fe(r,{totalProfileViews:ms(1),dailyViews:l,updatedAt:se()})}else await Ft(r,{totalProfileViews:1,totalMenuViews:0,totalItemViews:0,totalShareClicks:0,whatsappShareCount:0,registeredCustomers:0,appDownloads:0,dailyViews:{[a]:1},updatedAt:se()})}catch(r){console.warn("   :",r)}},eD=()=>{var k,P,O,U,b;const{userLocation:t,role:e,user:s}=Ue(),[r]=Nh(),i=r.get("ref"),[a,o]=_.useState([]),[l,d]=_.useState([]),[u,h]=_.useState(0),[p,g]=_.useState(!0),[y,w]=_.useState(""),[C,E]=_.useState("grid");_.useEffect(()=>{(async()=>{const j=(await ve(re(B,"restaurants"))).docs.map(T=>({id:T.id,...T.data()}));try{const T=je(re(B,"promotions"),Ne("isActive","==",!0)),D=await ve(T),S=new Date,W=D.docs.map(F=>{var V,z;return{id:F.id,...F.data(),expiresAt:(z=(V=F.data().expiresAt)==null?void 0:V.toDate)==null?void 0:z.call(V)}}).filter(F=>!F.expiresAt||new Date(F.expiresAt)>S).map(F=>{const V=j.find(z=>z.id===F.ownerId);return{...F,restaurantName:V==null?void 0:V.name}});d(W)}catch(T){console.warn("Error loading promotions:",T)}let I=[];t?(I=j.map(T=>{if(T.geoLocation){const D=Z3(t,T.geoLocation);return{...T,distance:D}}return{...T,distance:void 0}}),(e==="customer"||e==="courier")&&(I=I.filter(T=>!T.geoLocation||T.distance===void 0?!1:T.distance<=af)),I.sort((T,D)=>{const S=T.packageType==="premium"?1:0,W=D.packageType==="premium"?1:0;if(W!==S)return W-S;const F={gold:3,silver:2,bronze:1},V=F[T.sellerTier||"bronze"]||0,z=F[D.sellerTier||"bronze"]||0;if(z!==V)return z-V;const L=T.isVerified?1:0,$=D.isVerified?1:0;return $!==L?$-L:(T.distance||999)-(D.distance||999)})):I=j.sort((T,D)=>{const S={gold:3,silver:2,bronze:1},W=S[T.sellerTier||"bronze"]||0,F=S[D.sellerTier||"bronze"]||0;if(F!==W)return F-W;const V=T.isVerified?1:0;return(D.isVerified?1:0)-V}),o(I),g(!1)})()},[t,e]);const N=_.useMemo(()=>{const m=new Set(a.map(j=>j.city).filter(Boolean));return Bx.filter(j=>m.has(j))},[a]),v=_.useMemo(()=>y?a.filter(m=>m.city===y):a,[a,y]);return p?n.jsx("div",{className:"flex items-center justify-center h-96 text-lg text-gray-300",children:"   ..."}):n.jsxs("div",{className:"py-10",children:[n.jsx("h1",{className:"text-3xl font-extrabold text-center mb-8 text-sky-600",children:"  "}),l.length>0&&n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3",children:[n.jsx(hr,{className:"w-5 h-5 text-purple-500"}),n.jsx("span",{className:"font-bold text-purple-600",children:" "})]}),n.jsxs("div",{className:"relative",children:[n.jsxs(de,{to:`/menu?restaurant=${(k=l[u])==null?void 0:k.ownerId}`,onClick:async()=>{try{await fe(X(B,"promotions",l[u].id),{viewsCount:ms(1)})}catch{}},className:"block bg-gradient-to-r from-purple-900 via-purple-800 to-pink-900 rounded-2xl shadow-xl overflow-hidden",children:[n.jsxs("div",{className:"absolute top-3 right-3 z-10 inline-flex items-center gap-1 px-3 py-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-bold rounded-full shadow",children:[n.jsx(hr,{className:"w-3 h-3"}),""]}),((P=l[u])==null?void 0:P.mediaUrl)&&n.jsx("div",{className:"relative h-48",children:l[u].type==="video"?n.jsxs(n.Fragment,{children:[n.jsx("video",{src:l[u].mediaUrl,className:"w-full h-full object-cover",muted:!0,loop:!0,autoPlay:!0,playsInline:!0}),n.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:n.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",children:n.jsx(J6,{className:"w-6 h-6 text-white fill-white"})})})]}):n.jsx("img",{src:l[u].mediaUrl,alt:l[u].title,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"p-4",children:[n.jsx("div",{className:"flex items-center gap-2 mb-2",children:((O=l[u])==null?void 0:O.restaurantName)&&n.jsx("span",{className:"text-xs bg-white/20 text-white px-2 py-1 rounded-full",children:l[u].restaurantName})}),((U=l[u])==null?void 0:U.title)&&n.jsx("h3",{className:"text-lg font-bold text-white",children:l[u].title}),((b=l[u])==null?void 0:b.description)&&n.jsx("p",{className:"text-purple-100 text-sm mt-1 line-clamp-2",children:l[u].description})]})]}),l.length>1&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:m=>{m.preventDefault(),h(j=>j===0?l.length-1:j-1)},className:"absolute left-2 top-1/2 -translate-y-1/2 p-2 bg-white/80 hover:bg-white rounded-full shadow-lg transition z-10",children:n.jsx(Ju,{className:"w-5 h-5 text-gray-800"})}),n.jsx("button",{onClick:m=>{m.preventDefault(),h(j=>j===l.length-1?0:j+1)},className:"absolute right-2 top-1/2 -translate-y-1/2 p-2 bg-white/80 hover:bg-white rounded-full shadow-lg transition z-10",children:n.jsx(t6,{className:"w-5 h-5 text-gray-800"})})]}),l.length>1&&n.jsx("div",{className:"flex justify-center gap-2 mt-3",children:l.map((m,j)=>n.jsx("button",{onClick:()=>h(j),className:`w-2 h-2 rounded-full transition ${j===u?"bg-purple-500 w-4":"bg-gray-300"}`},j))})]})]}),N.length>0&&n.jsxs("div",{className:"mb-6 flex flex-wrap items-center justify-center gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sky-600",children:[n.jsx(N6,{className:"w-5 h-5"}),n.jsx("span",{className:"font-semibold",children:":"})]}),n.jsx("button",{onClick:()=>w(""),className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${y?"bg-sky-100 text-sky-700 hover:bg-sky-200":"bg-sky-500 text-white shadow-lg"}`,children:""}),N.map(m=>n.jsxs("button",{onClick:()=>w(m),className:`px-4 py-2 rounded-full text-sm font-medium transition-all flex items-center gap-1 ${y===m?"bg-sky-500 text-white shadow-lg":"bg-sky-100 text-sky-700 hover:bg-sky-200"}`,children:[n.jsx(Nt,{className:"w-4 h-4"}),m]},m)),y&&n.jsx("button",{onClick:()=>w(""),className:"p-2 text-gray-400 hover:text-red-500 transition-colors",title:" ",children:n.jsx(_r,{className:"w-5 h-5"})})]}),v.length===0&&n.jsxs("div",{className:"text-center py-10",children:[n.jsx("div",{className:"w-20 h-20 bg-sky-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Dn,{className:"w-10 h-10 text-sky-500"})}),t?n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-gray-600 text-lg font-semibold",children:"     "}),n.jsxs("p",{className:"text-gray-400 text-sm mt-2",children:["   ",af,"  "]})]}):n.jsx(n.Fragment,{children:n.jsx("p",{className:"text-gray-600 text-lg font-semibold",children:y?`     ${y}`:"    "})})]}),t&&v.length>0&&(e==="customer"||e==="courier")&&n.jsxs("div",{className:"mb-6 bg-sky-50 border border-sky-200 rounded-xl p-4 flex items-center gap-3",children:[n.jsx(Hi,{className:"w-6 h-6 text-sky-500 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sky-700 font-semibold",children:"    "}),n.jsxs("p",{className:"text-sky-600 text-sm",children:["  : ",af," "]})]})]}),v.filter(m=>m.packageType==="premium").length>0&&n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Vt,{className:"w-6 h-6 text-amber-500"}),n.jsx("h2",{className:"text-xl font-bold text-amber-400",children:"  "})]}),n.jsxs("span",{className:"text-sm text-gray-400",children:[v.filter(m=>m.packageType==="premium").length," "]})]}),n.jsx("div",{className:"grid grid-cols-2 xs:grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 sm:gap-4",children:v.filter(m=>m.packageType==="premium").map(m=>n.jsxs(de,{to:`/menu?restaurant=${m.id}${i?`&ref=${i}`:""}`,onClick:()=>ow(m.id,s==null?void 0:s.uid,i||"direct"),className:"group bg-[#1E293B] border border-amber-500/30 rounded-[16px] shadow-lg shadow-amber-500/10 hover:shadow-xl hover:shadow-amber-500/20 hover:-translate-y-2 transform transition-all duration-300 p-3 sm:p-4 flex flex-col items-center text-center relative overflow-hidden active:scale-[0.98]",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-purple-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),n.jsx("div",{className:"absolute top-2 right-2",children:n.jsxs("div",{className:"bg-gradient-to-r from-amber-500 to-orange-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow flex items-center gap-1",children:[n.jsx(Vt,{className:"w-3 h-3"}),""]})}),m.distance!==void 0&&n.jsxs("div",{className:"absolute top-2 left-2 bg-sky-500/90 backdrop-blur text-white text-[10px] font-bold px-2 py-0.5 rounded-full flex items-center gap-0.5",children:[n.jsx(Hi,{className:"w-2.5 h-2.5"}),m.distance<1?`${Math.round(m.distance*1e3)}`:`${m.distance.toFixed(1)}`]}),n.jsx("div",{className:"relative mt-6 mb-3",children:m.logoUrl?n.jsx("img",{src:m.logoUrl,alt:m.name,className:"w-20 h-20 object-cover rounded-full border-4 border-amber-400 shadow-lg group-hover:scale-110 transition-transform duration-300"}):n.jsx("div",{className:"w-20 h-20 flex items-center justify-center rounded-full bg-slate-700 border-4 border-amber-400 shadow-lg group-hover:scale-110 transition-transform duration-300",children:n.jsx(xo,{className:"w-8 h-8 text-amber-400"})})}),n.jsx("h3",{className:"font-bold text-sm text-white line-clamp-1",children:m.name}),m.city&&n.jsxs("p",{className:"text-xs text-gray-400 flex items-center gap-0.5 mt-1 mb-2",children:[n.jsx(Nt,{className:"w-3 h-3"}),m.city]}),m.isVerified||m.licenseStatus==="approved"?n.jsxs("div",{className:"bg-emerald-500/20 border border-emerald-500/50 text-emerald-400 text-[11px] font-bold px-3 py-1 rounded-full flex items-center gap-1 mb-2",children:[n.jsx(Xe,{className:"w-3 h-3"}),"  "]}):n.jsxs("div",{className:"bg-amber-500/20 border border-amber-500/50 text-amber-400 text-[11px] font-bold px-3 py-1 rounded-full flex items-center gap-1 mb-2",children:[n.jsx(Rt,{className:"w-3 h-3"}),"  "]}),n.jsxs("div",{className:"flex items-center justify-center gap-3 text-[10px] text-gray-400",children:[m.averageRating!==void 0&&m.averageRating>0&&n.jsxs("span",{className:"flex items-center gap-0.5",children:[n.jsx(go,{className:"w-3 h-3 text-amber-400 fill-amber-400"}),m.averageRating.toFixed(1)]}),m.totalOrders!==void 0&&m.totalOrders>0&&n.jsxs("span",{className:"flex items-center gap-0.5",children:[n.jsx(jr,{className:"w-3 h-3"}),m.totalOrders]})]}),n.jsxs("div",{className:"flex gap-1 mt-2",children:[m.sellerTier==="gold"&&n.jsx("span",{className:"bg-gradient-to-r from-amber-400 to-yellow-400 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full",children:" Gold"}),m.sellerTier==="silver"&&n.jsx("span",{className:"bg-gradient-to-r from-gray-400 to-gray-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full",children:" Silver"})]}),n.jsxs("div",{className:"flex flex-wrap gap-1 mt-1.5 justify-center",children:[m.allowDelivery!==!1&&n.jsxs("span",{className:"inline-flex items-center gap-0.5 bg-sky-500/20 text-sky-400 text-[9px] font-medium px-1.5 py-0.5 rounded-full",children:[n.jsx(Ts,{className:"w-2.5 h-2.5"}),""]}),m.allowPickup&&n.jsxs("span",{className:"inline-flex items-center gap-0.5 bg-green-500/20 text-green-400 text-[9px] font-medium px-1.5 py-0.5 rounded-full",children:[n.jsx(lt,{className:"w-2.5 h-2.5"}),""]})]})]},m.id))})]}),v.filter(m=>m.packageType!=="premium").length>0&&n.jsxs("div",{children:[v.filter(m=>m.packageType==="premium").length>0&&n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(xo,{className:"w-5 h-5 text-gray-400"}),n.jsx("h2",{className:"text-lg font-bold text-gray-300",children:" "})]}),n.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6",children:v.filter(m=>m.packageType!=="premium").map(m=>n.jsxs(de,{to:`/menu?restaurant=${m.id}${i?`&ref=${i}`:""}`,onClick:()=>ow(m.id,s==null?void 0:s.uid,i||"direct"),className:"group bg-[#1E293B] rounded-[16px] shadow-lg shadow-black/20 hover:shadow-xl hover:shadow-black/30 hover:-translate-y-1 transform transition-all duration-300 p-4 sm:p-6 flex flex-col items-center text-center relative overflow-hidden active:scale-[0.98]",children:[m.distance!==void 0&&n.jsxs("div",{className:"absolute top-3 left-3 bg-sky-500/90 backdrop-blur-sm text-white text-xs font-bold px-3 py-1 rounded-full flex items-center gap-1",children:[n.jsx(Hi,{className:"w-3 h-3"}),m.distance<1?`${Math.round(m.distance*1e3)} `:`${m.distance.toFixed(1)} `]}),n.jsxs("div",{className:"absolute top-3 right-3 flex flex-col gap-1.5",children:[m.sellerTier==="gold"&&n.jsxs("div",{className:"bg-gradient-to-r from-amber-400 to-yellow-500 text-white text-xs font-bold px-2.5 py-1 rounded-full flex items-center gap-1 shadow-lg",children:[n.jsx(Vt,{className:"w-3 h-3"}),"Gold"]}),m.sellerTier==="silver"&&n.jsxs("div",{className:"bg-gradient-to-r from-gray-300 to-gray-400 text-gray-800 text-xs font-bold px-2.5 py-1 rounded-full flex items-center gap-1 shadow-lg",children:[n.jsx(Dp,{className:"w-3 h-3"}),"Silver"]})]}),n.jsx("div",{className:"mt-2 mb-4",children:m.logoUrl?n.jsx("img",{src:m.logoUrl,alt:m.name,className:`w-24 h-24 object-cover rounded-full border-4 shadow-lg group-hover:scale-105 transition-transform duration-300 ${m.sellerTier==="gold"?"border-amber-400 ring-4 ring-amber-400/30":m.sellerTier==="silver"?"border-gray-300 ring-4 ring-gray-300/30":"border-slate-500"}`}):n.jsx("div",{className:`w-24 h-24 flex items-center justify-center rounded-full text-4xl border-4 shadow-lg group-hover:scale-105 transition-transform duration-300 ${m.sellerTier==="gold"?"bg-amber-900/50 border-amber-400":m.sellerTier==="silver"?"bg-gray-700 border-gray-300":"bg-slate-700 border-slate-500"}`,children:""})}),n.jsx("h3",{className:"font-bold text-xl text-white mb-1",children:m.name}),m.city&&n.jsxs("p",{className:"text-sm text-gray-400 flex items-center justify-center gap-1 mb-3",children:[n.jsx(Nt,{className:"w-4 h-4"}),m.city]}),m.isVerified||m.licenseStatus==="approved"?n.jsxs("div",{className:"bg-emerald-500/20 border border-emerald-500/50 text-emerald-400 text-sm font-bold px-4 py-1.5 rounded-full flex items-center gap-2 mb-3",children:[n.jsx(Xe,{className:"w-4 h-4"}),"  "]}):n.jsxs("div",{className:"bg-amber-500/20 border border-amber-500/50 text-amber-400 text-sm font-bold px-4 py-1.5 rounded-full flex items-center gap-2 mb-3",children:[n.jsx(Rt,{className:"w-4 h-4"}),"  "]}),n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[(m.allowDelivery===void 0||m.allowDelivery===!0)&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-sky-500/20 text-sky-400 text-xs font-semibold rounded-full",children:[n.jsx(Ts,{className:"w-3 h-3"}),""]}),m.allowPickup&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-500/20 text-green-400 text-xs font-semibold rounded-full",children:[n.jsx(lt,{className:"w-3 h-3"}),""]})]})]},m.id))})]})]})},lw="broast_cart";function zx(){const[t,e]=_.useState(()=>{try{const l=localStorage.getItem(lw);return l?JSON.parse(l):[]}catch{return[]}});_.useEffect(()=>{localStorage.setItem(lw,JSON.stringify(t))},[t]);const s=_.useCallback((l,d=1)=>{e(u=>{const h=u.findIndex(p=>p.id===l.id);if(h>=0){const p=[...u];return p[h]={...p[h],qty:p[h].qty+d,ownerId:l.ownerId??p[h].ownerId},p}return[...u,{...l,qty:d}]})},[]),r=_.useCallback(l=>e(d=>d.filter(u=>u.id!==l)),[]),i=_.useCallback((l,d)=>e(u=>u.map(h=>h.id===l?{...h,qty:d}:h)),[]),a=_.useCallback(()=>e([]),[]),o=_.useMemo(()=>t.reduce((l,d)=>l+d.price*d.qty,0),[t]);return{items:t,add:s,remove:r,changeQty:i,clear:a,subtotal:o}}const D1=_.createContext(null),Jt=()=>{const t=_.useContext(D1);if(!t)throw new Error("useToast must be used within ToastProvider");return t},tD=({children:t})=>{const[e,s]=_.useState([]),r=_.useCallback(o=>{s(l=>l.filter(d=>d.id!==o))},[]),i=_.useCallback((o,l,d)=>{const u=Math.random().toString(36).slice(2),h={id:u,message:o,type:l,title:d==null?void 0:d.title,duration:(d==null?void 0:d.duration)??3e3};s(p=>[...p,h]),h.duration&&h.duration>0&&setTimeout(()=>r(u),h.duration)},[r]),a=_.useMemo(()=>({show:(o,l)=>i(o,(l==null?void 0:l.type)??"info",l),success:(o,l)=>i(o,"success",l),error:(o,l)=>i(o,"error",l),info:(o,l)=>i(o,"info",l),warning:(o,l)=>i(o,"warning",l)}),[i]);return n.jsxs(D1.Provider,{value:a,children:[t,n.jsx(rD,{items:e,onClose:r})]})},sD={success:"bg-green-600 text-white",error:"bg-red-600 text-white",info:"bg-slate-800 text-white",warning:"bg-yellow-500 text-black"},nD={success:"",error:"",info:"",warning:""},rD=({items:t,onClose:e})=>(_.useEffect(()=>{},[]),n.jsxs("div",{className:"fixed z-[9999] inset-0 pointer-events-none flex flex-col items-center sm:items-end gap-2 p-4 sm:p-6",children:[n.jsx("div",{className:"mt-auto w-full sm:w-auto flex flex-col gap-2",children:t.map(s=>n.jsx("div",{className:`pointer-events-auto ${sD[s.type]} rounded-2xl shadow-lg px-4 py-3 sm:min-w-[320px] animate-[toastIn_.2s_ease]`,children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"text-xl leading-none",children:nD[s.type]}),n.jsxs("div",{className:"flex-1",children:[s.title&&n.jsx("div",{className:"font-bold",children:s.title}),n.jsx("div",{className:"text-sm",children:s.message})]}),n.jsx("button",{onClick:()=>e(s.id),className:"opacity-80 hover:opacity-100 transition","aria-label":"Close",children:""})]})},s.id))}),n.jsx("style",{children:"@keyframes toastIn{from{transform:translateY(8px);opacity:0}to{transform:translateY(0);opacity:1}}"})]})),iD=(t,e)=>{const s=[];for(let r=0;r<t.length;r+=e)s.push(t.slice(r,r+e));return s},aD=()=>{var L;const[t,e]=_.useState([]),[s,r]=_.useState(!0),[i,a]=_.useState(null),[o,l]=_.useState(null),[d,u]=_.useState(!0),[h,p]=_.useState(!1),[g,y]=_.useState(null),[w,C]=_.useState(0),{add:E,subtotal:N,items:v}=zx(),{user:k,role:P}=Ue(),O=Jt(),[U]=Nh(),b=U.get("restaurant"),m=1.75,j=$=>{navigator.clipboard.writeText($),O.success(" ! ")},I=()=>{navigator.share?navigator.share({title:(i==null?void 0:i.name)||" ",text:`  ${i==null?void 0:i.name}   `,url:window.location.href}):j(window.location.href)};_.useEffect(()=>{if(!b)return;(async()=>{try{const M=je(re(B,"storeFollowers"),Ne("restaurantId","==",b)),G=await ve(M);if(C(G.size),k){const Y=je(re(B,"storeFollowers"),Ne("restaurantId","==",b),Ne("followerId","==",k.uid)),ie=await ve(Y);ie.empty||(p(!0),y(ie.docs[0].id))}}catch(M){console.warn("    :",M)}})()},[b,k]);const T=async()=>{var $;if(!k){O.warning("   ");return}if(b)try{if(h&&g){await sn(X(B,"storeFollowers",g)),p(!1),y(null),C(G=>Math.max(0,G-1));const M=X(B,"restaurantStats",b);await fe(M,{followersCount:ms(-1)}).catch(()=>{}),O.info("  ")}else{const M=await tt(re(B,"storeFollowers"),{followerId:k.uid,followerName:k.displayName||(($=k.email)==null?void 0:$.split("@")[0])||"",restaurantId:b,createdAt:se()});p(!0),y(M.id),C(ie=>ie+1);const G=X(B,"restaurantStats",b);(await Ce(G)).exists()?await fe(G,{followersCount:ms(1)}):await tt(re(B,"restaurantStats"),{restaurantId:b,totalProfileViews:0,totalMenuViews:0,totalItemViews:0,totalShareClicks:0,whatsappShareCount:0,registeredCustomers:0,appDownloads:0,followersCount:1,dailyViews:{},updatedAt:se()}),O.success("    ! ")}}catch(M){console.error("  :",M),O.error("    ")}};_.useEffect(()=>{(async()=>{let $;if(b){$=je(re(B,"menuItems"),Ne("available","==",!0),Ne("ownerId","==",b));const pe=await Ce(X(B,"restaurants",b));pe.exists()&&a({id:pe.id,...pe.data()});try{const Ae=je(re(B,"promotions"),Ne("ownerId","==",b),Ne("isActive","==",!0)),De=await ve(Ae);if(!De.empty){const $e=De.docs.map(rt=>{var qt,Hs;return{id:rt.id,...rt.data(),expiresAt:(Hs=(qt=rt.data().expiresAt)==null?void 0:qt.toDate)==null?void 0:Hs.call(qt)}}),jt=new Date,Pt=$e.filter(rt=>!rt.expiresAt||new Date(rt.expiresAt)>jt);if(Pt.length>0){const rt=Pt[0];l(rt),await fe(X(B,"promotions",rt.id),{viewsCount:ms(1)})}}}catch{}}else $=je(re(B,"menuItems"),Ne("available","==",!0));const G=(await ve($)).docs.map(pe=>({id:pe.id,...pe.data()})),Y=[...new Set(G.map(pe=>pe.ownerId).filter(Boolean))],ie=new Map;if(Y.length>0){const pe=iD(Y,30);for(const Ae of pe){const De=je(re(B,"restaurants"),Ne(K_(),"in",Ae));(await ve(De)).docs.forEach(jt=>ie.set(jt.id,{id:jt.id,...jt.data()}))}}const le=G.map(pe=>({...pe,restaurant:pe.ownerId?ie.get(pe.ownerId):void 0}));e(le),r(!1)})()},[b]);const D=$=>{var Ae,De,$e;if(!$.ownerId){O.warning("    ");return}const M=(Ae=v[0])==null?void 0:Ae.ownerId;if(M&&M!==$.ownerId){O.warning("           ");return}const G=$.discountPercent&&$.discountPercent>0,Y=(($e=(De=$.discountExpiresAt)==null?void 0:De.toDate)==null?void 0:$e.call(De))||($.discountExpiresAt?new Date($.discountExpiresAt):null),ie=G&&(!Y||Y>new Date),le=$.price+m,pe=ie?le-le*(($.discountPercent||0)/100):le;E({id:$.id,name:$.name,price:pe,ownerId:$.ownerId}),O.success("  ")};if(s)return n.jsxs("div",{className:"flex flex-col items-center justify-center h-screen gap-4",children:[n.jsx("div",{className:"w-16 h-16 border-4 border-amber-500 border-t-transparent rounded-full animate-spin"}),n.jsx("p",{className:"text-gray-400 text-lg",children:" ..."})]});const S=k&&(P==="customer"||P==="admin"||P==="developer"||!P),W=(i==null?void 0:i.isOpen)!==!1,F=k&&b===k.uid,z=($=>{switch($){case"gold":return{label:"",bg:"bg-gradient-to-r from-yellow-400 to-amber-500",icon:""};case"silver":return{label:"",bg:"bg-gradient-to-r from-gray-300 to-gray-400",icon:""};default:return{label:"",bg:"bg-gradient-to-r from-orange-500 to-orange-600",icon:""}}})(i==null?void 0:i.sellerTier);return n.jsxs("div",{className:"min-h-screen pb-32 -mx-4 -mt-4",children:[!W&&!F&&n.jsxs("div",{className:"bg-gradient-to-l from-red-500 to-rose-600 text-white p-4 flex items-center justify-center gap-3",children:[n.jsx(po,{className:"w-6 h-6"}),n.jsx("span",{className:"font-bold text-lg",children:"    -   "})]}),F&&n.jsxs("div",{className:"bg-gradient-to-l from-emerald-500 to-teal-600 text-white p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Pn,{className:"w-6 h-6"}),n.jsx("span",{className:"font-bold",children:" !  :"})]}),n.jsxs(de,{to:"/",className:"bg-white text-emerald-600 px-4 py-2 rounded-full font-bold hover:bg-gray-100 transition flex items-center gap-2",children:[" ",n.jsx($n,{className:"w-4 h-4"})]})]}),n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"h-48 sm:h-56 bg-gradient-to-br from-amber-500 via-orange-500 to-red-500 relative overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-black/20"}),n.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-black/10 rounded-full translate-y-1/2 -translate-x-1/2"}),n.jsxs(de,{to:"/restaurants",className:"absolute top-4 right-4 flex items-center gap-2 bg-black/30 backdrop-blur-sm text-white px-4 py-2 rounded-full text-sm font-bold hover:bg-black/50 transition",children:[n.jsx($n,{className:"w-4 h-4"}),""]}),n.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2",children:[!F&&n.jsxs("button",{onClick:T,className:`flex items-center gap-2 px-4 py-2 backdrop-blur-sm rounded-full font-bold transition ${h?"bg-pink-500 text-white hover:bg-pink-600":"bg-black/30 text-white hover:bg-black/50"}`,children:[n.jsx(eh,{className:`w-5 h-5 ${h?"fill-white":""}`}),n.jsx("span",{className:"text-sm",children:h?"":""})]}),n.jsx("button",{onClick:I,className:"p-3 bg-black/30 backdrop-blur-sm rounded-full text-white hover:bg-black/50 transition",children:n.jsx(Op,{className:"w-5 h-5"})})]})]}),i&&n.jsx("div",{className:"mx-4 -mt-20 relative z-10",children:n.jsxs("div",{className:"bg-gray-900 rounded-3xl shadow-2xl border border-gray-800 overflow-hidden",children:[n.jsxs("div",{className:"p-6 text-center relative",children:[n.jsxs("div",{className:"relative inline-block mb-4",children:[n.jsx("div",{className:"w-28 h-28 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 p-1 shadow-2xl",children:n.jsx("div",{className:"w-full h-full rounded-full bg-white overflow-hidden",children:i.logoUrl?n.jsx("img",{src:i.logoUrl,alt:i.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-gradient-to-br from-amber-50 to-orange-100 flex items-center justify-center",children:n.jsx("span",{className:"text-5xl",children:""})})})}),i.isVerified||i.licenseStatus==="approved"?n.jsx("div",{className:"absolute -bottom-1 -right-1 w-8 h-8 bg-green-500 rounded-full flex items-center justify-center border-4 border-gray-900 shadow-lg",title:" ",children:n.jsx(Xe,{className:"w-5 h-5 text-white"})}):n.jsx("div",{className:"absolute -bottom-1 -right-1 w-8 h-8 bg-amber-500 rounded-full flex items-center justify-center border-4 border-gray-900 shadow-lg",title:" ",children:n.jsx(Rt,{className:"w-5 h-5 text-white"})})]}),n.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-white mb-2",children:i.name}),i.city&&n.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-400 mb-3",children:[n.jsx(Nt,{className:"w-4 h-4"}),n.jsx("span",{children:i.city})]}),n.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:[W?n.jsx("span",{className:"bg-green-500 text-white text-xs font-bold px-3 py-1.5 rounded-full animate-pulse",children:"  "}):n.jsx("span",{className:"bg-red-500 text-white text-xs font-bold px-3 py-1.5 rounded-full",children:" "}),n.jsxs("span",{className:`${z.bg} text-white text-xs font-bold px-3 py-1.5 rounded-full shadow-lg`,children:[z.icon," ",z.label]}),i.isVerified||i.licenseStatus==="approved"?n.jsx("span",{className:"bg-green-500 text-white text-xs font-bold px-3 py-1.5 rounded-full",children:"  "}):n.jsx("span",{className:"bg-amber-500 text-white text-xs font-bold px-3 py-1.5 rounded-full",children:" "})]})]}),n.jsxs("div",{className:"grid grid-cols-5 border-t border-gray-800",children:[n.jsxs("div",{className:"p-3 text-center border-l border-gray-800",children:[n.jsx(eh,{className:"w-5 h-5 text-pink-400 mx-auto mb-1"}),n.jsx("p",{className:"text-lg font-black text-white",children:w}),n.jsx("p",{className:"text-[10px] text-gray-500",children:""})]}),n.jsxs("div",{className:"p-3 text-center border-l border-gray-800",children:[n.jsx(xo,{className:"w-5 h-5 text-amber-400 mx-auto mb-1"}),n.jsx("p",{className:"text-lg font-black text-white",children:t.length}),n.jsx("p",{className:"text-[10px] text-gray-500",children:""})]}),n.jsxs("div",{className:"p-3 text-center border-l border-gray-800",children:[n.jsx(Bt,{className:"w-5 h-5 text-green-400 mx-auto mb-1"}),n.jsx("p",{className:"text-lg font-black text-white",children:i.totalOrders||0}),n.jsx("p",{className:"text-[10px] text-gray-500",children:""})]}),n.jsxs("div",{className:"p-3 text-center border-l border-gray-800",children:[n.jsx(go,{className:"w-5 h-5 text-yellow-400 mx-auto mb-1"}),n.jsx("p",{className:"text-lg font-black text-white",children:((L=i.averageRating)==null?void 0:L.toFixed(1))||"0"}),n.jsx("p",{className:"text-[10px] text-gray-500",children:""})]}),n.jsxs("div",{className:"p-3 text-center",children:[n.jsx(Rt,{className:"w-5 h-5 text-sky-400 mx-auto mb-1"}),n.jsx("p",{className:"text-lg font-black text-white",children:i.onTimeDeliveryRate?`${Math.round(i.onTimeDeliveryRate)}%`:""}),n.jsx("p",{className:"text-[10px] text-gray-500",children:""})]})]}),n.jsxs("div",{className:"p-4 border-t border-gray-800 space-y-3",children:[(P==="admin"||P==="developer"||P==="owner"&&(k==null?void 0:k.uid)===b)&&i.phone&&n.jsxs("a",{href:`tel:${i.phone}`,className:"flex items-center justify-between p-3 bg-green-500/10 hover:bg-green-500/20 rounded-xl transition",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-xl flex items-center justify-center",children:n.jsx(Jh,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-white font-bold",children:" "}),n.jsx("p",{className:"text-green-400 text-sm",dir:"ltr",children:i.phone})]})]}),n.jsx($n,{className:"w-5 h-5 text-green-400 rotate-180"})]}),i.location&&n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-800/50 rounded-xl",children:[n.jsx("div",{className:"w-10 h-10 bg-sky-500/20 rounded-xl flex items-center justify-center",children:n.jsx(Nt,{className:"w-5 h-5 text-sky-400"})}),n.jsx("p",{className:"text-gray-300 text-sm",children:i.location})]})]}),i.isHiring&&n.jsx("div",{className:"p-4 border-t border-gray-800",children:n.jsxs("div",{className:"bg-gradient-to-br from-purple-900/40 to-pink-900/40 rounded-2xl p-4 border border-purple-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-xl flex items-center justify-center",children:n.jsx(mc,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("span",{className:"text-purple-400 font-bold block",children:"  !"}),n.jsx("span",{className:"text-purple-300/70 text-xs",children:"  "})]})]}),i.hiringDescription&&n.jsx("p",{className:"text-gray-300 text-sm mb-4 leading-relaxed bg-gray-900/40 p-3 rounded-xl",children:i.hiringDescription}),(P==="admin"||P==="developer"||P==="owner"&&(k==null?void 0:k.uid)===b)&&i.hiringContact&&n.jsxs("a",{href:`https://wa.me/${i.hiringContact.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full py-3 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white rounded-xl font-bold transition",children:[n.jsx(Uc,{className:"w-5 h-5"})," "]})]})})]})})]}),o&&d&&n.jsxs("div",{className:"mx-4 mt-6 bg-gradient-to-r from-purple-900 via-purple-800 to-pink-900 rounded-2xl shadow-xl overflow-hidden relative",children:[n.jsx("button",{onClick:()=>u(!1),className:"absolute top-3 left-3 z-10 p-2 bg-black/40 hover:bg-black/60 rounded-full text-white transition",children:n.jsx(_r,{className:"w-4 h-4"})}),n.jsxs("div",{className:"absolute top-3 right-3 z-10 inline-flex items-center gap-1 px-3 py-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-bold rounded-full shadow",children:[n.jsx(hr,{className:"w-3 h-3"}),""]}),o.mediaUrl&&n.jsx("img",{src:o.mediaUrl,alt:"",className:"w-full h-40 object-cover"}),n.jsxs("div",{className:"p-4",children:[o.title&&n.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:o.title}),o.description&&n.jsx("p",{className:"text-purple-100 text-sm",children:o.description})]})]}),n.jsxs("div",{className:"px-4 mt-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-10 h-10 bg-amber-500/20 rounded-xl flex items-center justify-center",children:n.jsx(xo,{className:"w-5 h-5 text-amber-400"})}),n.jsx("h2",{className:"text-xl font-bold text-white",children:" "}),n.jsx("span",{className:"bg-amber-500/20 text-amber-400 text-sm font-bold px-3 py-1 rounded-full mr-auto",children:t.length})]}),t.length===0?n.jsxs("div",{className:"text-center py-16 bg-gray-800/30 rounded-2xl",children:[n.jsx(jr,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-400 text-lg",children:"   "})]}):n.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map($=>n.jsxs("div",{className:"bg-gray-800 rounded-2xl overflow-hidden border border-gray-700/50 hover:border-amber-500/50 shadow-lg transition-all",children:[n.jsxs("div",{className:"relative h-28 sm:h-36 overflow-hidden",children:[$.imageUrl?n.jsx("img",{src:$.imageUrl,alt:$.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-700 to-gray-800",children:n.jsx("span",{className:"text-4xl opacity-30",children:""})}),(()=>{var ie,le;const M=$.discountPercent&&$.discountPercent>0,G=((le=(ie=$.discountExpiresAt)==null?void 0:ie.toDate)==null?void 0:le.call(ie))||($.discountExpiresAt?new Date($.discountExpiresAt):null),Y=!G||G>new Date;return M&&Y?n.jsxs("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg animate-pulse",children:[" ",$.discountPercent,"%"]}):null})(),(()=>{var le,pe;const M=$.discountPercent&&$.discountPercent>0,G=((pe=(le=$.discountExpiresAt)==null?void 0:le.toDate)==null?void 0:pe.call(le))||($.discountExpiresAt?new Date($.discountExpiresAt):null),Y=!G||G>new Date,ie=$.price+m;if(M&&Y){const Ae=ie-ie*(($.discountPercent||0)/100);return n.jsxs("div",{className:"absolute bottom-2 left-2 flex items-center gap-1.5",children:[n.jsxs("span",{className:"bg-green-500 text-white font-black text-sm px-2 py-1 rounded-full shadow",children:[Ae.toFixed(0)," ."]}),n.jsx("span",{className:"bg-black/60 text-gray-300 text-xs px-1.5 py-0.5 rounded-full line-through",children:ie.toFixed(0)})]})}return n.jsx("div",{className:"absolute bottom-2 left-2 bg-black/80 px-2 py-1 rounded-full",children:n.jsxs("span",{className:"font-black text-amber-400 text-sm",children:[ie.toFixed(0)," ."]})})})()]}),n.jsxs("div",{className:"p-3",children:[n.jsx("h3",{className:"font-bold text-white text-sm mb-2 line-clamp-1",children:$.name}),S&&W&&n.jsx("button",{onClick:()=>D($),className:"w-full py-2 rounded-xl font-bold text-sm bg-gradient-to-r from-amber-500 to-orange-500 text-black",children:"+ "}),S&&!W&&n.jsxs("div",{className:"w-full py-2 rounded-xl font-bold text-sm bg-gray-600 text-gray-300 text-center flex items-center justify-center gap-2",children:[n.jsx(po,{className:"w-4 h-4"}),""]})]})]},$.id))})]}),N>0&&S&&n.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 p-4 bg-gradient-to-t from-gray-900 via-gray-900/98 to-transparent",children:n.jsxs(de,{to:"/checkout",className:"flex items-center justify-between w-full max-w-lg mx-auto px-5 py-4 rounded-2xl bg-gradient-to-r from-sky-500 to-blue-600 text-white shadow-2xl font-bold",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"relative",children:[n.jsx(jr,{className:"w-6 h-6"}),n.jsx("span",{className:"absolute -top-2 -right-2 w-5 h-5 bg-amber-400 text-black text-xs font-black rounded-full flex items-center justify-center",children:v.reduce(($,M)=>$+M.qty,0)})]}),n.jsx("span",{children:" "})]}),n.jsxs("span",{className:"text-xl font-black",children:[N.toFixed(2)," ."]})]})})]})},oD=()=>{const{items:t,subtotal:e,remove:s,clear:r,changeQty:i}=zx();return t.length===0?n.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-sky-50 via-white to-sky-100 flex flex-col items-center justify-center py-20 px-4",children:[n.jsx("div",{className:"w-24 h-24 bg-white/80 backdrop-blur rounded-full flex items-center justify-center mb-6 shadow-lg",children:n.jsx(jr,{className:"w-12 h-12 text-sky-400"})}),n.jsx("h2",{className:"text-xl font-bold text-sky-800 mb-2",children:" "}),n.jsx("p",{className:"text-sky-600/70 mb-6",children:"   !"}),n.jsxs(de,{to:"/restaurants",className:"flex items-center gap-2 bg-gradient-to-r from-sky-500 to-sky-600 text-white px-6 py-3 rounded-xl font-bold shadow-lg shadow-sky-200/50 hover:shadow-xl transition",children:[n.jsx(UP,{className:"w-5 h-5"})," "]})]}):n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sky-50 via-white to-sky-100 py-6",children:n.jsxs("div",{className:"max-w-3xl mx-auto space-y-4 px-2 sm:px-4",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("h1",{className:"text-xl sm:text-2xl font-bold flex items-center gap-2",children:[n.jsx(jr,{className:"w-6 h-6 text-primary"})," ",n.jsx("span",{className:"text-sm bg-primary text-white px-2 py-0.5 rounded-full",children:t.length})]})}),n.jsx("div",{className:"space-y-3",children:t.map(a=>n.jsxs("div",{className:"flex items-center gap-3 glass-card p-3 sm:p-4 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gray-100 rounded-xl flex items-center justify-center flex-shrink-0",children:n.jsx("span",{className:"text-3xl",children:""})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h3",{className:"font-bold text-sm sm:text-base truncate",children:a.name}),n.jsxs("p",{className:"text-primary font-bold text-sm",children:[a.price.toFixed(2)," ."]}),n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsx("button",{onClick:()=>a.qty>1?i(a.id,a.qty-1):s(a.id),className:"w-7 h-7 sm:w-8 sm:h-8 rounded-lg bg-gray-100 hover:bg-gray-200 flex items-center justify-center transition",children:n.jsx(W6,{className:"w-4 h-4"})}),n.jsx("span",{className:"font-bold text-lg w-8 text-center",children:a.qty}),n.jsx("button",{onClick:()=>i(a.id,a.qty+1),className:"w-7 h-7 sm:w-8 sm:h-8 rounded-lg bg-primary text-white hover:bg-sky-600 flex items-center justify-center transition",children:n.jsx($c,{className:"w-4 h-4"})})]})]}),n.jsxs("div",{className:"flex flex-col items-end gap-2",children:[n.jsxs("span",{className:"font-bold text-lg text-gray-900",children:[(a.price*a.qty).toFixed(2)," ."]}),n.jsx("button",{onClick:()=>s(a.id),className:"p-2 rounded-lg bg-red-50 hover:bg-red-100 text-red-500 transition",children:n.jsx(Ss,{className:"w-4 h-4"})})]})]},a.id))}),n.jsxs("div",{className:"glass-card rounded-xl p-4 space-y-3",children:[n.jsxs("div",{className:"flex justify-between text-sky-700",children:[n.jsx("span",{children:" "}),n.jsxs("span",{className:"font-bold",children:[e.toFixed(2)," ."]})]}),n.jsxs("div",{className:"flex justify-between text-amber-600",children:[n.jsx("span",{children:" "}),n.jsx("span",{className:"font-semibold text-sm",children:"   "})]}),n.jsx("div",{className:"h-px bg-sky-200/50"}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"font-bold text-lg text-sky-900",children:""}),n.jsxs("span",{className:"font-bold text-xl text-sky-600",children:[e.toFixed(2)," ."]})]}),n.jsx("p",{className:"text-xs text-gray-500 text-center",children:"        "})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pb-6",children:[n.jsxs("button",{onClick:r,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 rounded-xl glass-light text-sky-700 font-semibold hover:bg-white/70 transition",children:[n.jsx(Ss,{className:"w-5 h-5"})," "]}),n.jsx(de,{to:"/checkout",className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 rounded-xl bg-gradient-to-r from-green-500 to-green-600 text-white font-bold shadow-lg shadow-green-200/50 hover:shadow-xl hover:scale-[1.02] transition",children:"  "})]})]})})},lD=()=>{const[t,e]=_.useState(""),[s,r]=_.useState(""),[i,a]=_.useState(!1),[o,l]=_.useState(!1),[d,u]=_.useState(""),[h,p]=_.useState(!1),g=ys(),y=cn(),w=Jt(),C=async N=>{N.preventDefault(),a(!0);try{const k=(await XT(Fs,t,s)).user.uid,P=await Ce(X(B,"users",k));if(P.exists()){const O=P.data();O.role==="owner"?g("/owner"):O.role==="admin"?g("/admin"):O.role==="developer"?g("/developer"):O.role==="courier"?g("/courier"):g("/")}else y.warning("   Auth       Firestore")}catch(v){y.error(v.message,{title:"   "})}finally{a(!1)}},E=async N=>{if(N.preventDefault(),!d.trim()){w.warning("   ");return}p(!0);try{await QT(Fs,d.trim().toLowerCase()),w.success("      !    "),setTimeout(()=>{y.info("          (Spam)",{title:"  "})},1e3),l(!1),u("")}catch(v){console.error("Reset password error:",v),v.code==="auth/user-not-found"?w.error("      "):v.code==="auth/invalid-email"?w.error("   "):v.code==="auth/too-many-requests"?w.error("         "):w.error(` : ${v.message}`)}finally{p(!1)}};return n.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-sky-50 via-white to-sky-100 px-4",children:[n.jsx("div",{className:"absolute top-0 left-0 w-72 h-72 bg-sky-300/20 rounded-full blur-3xl"}),n.jsx("div",{className:"absolute bottom-0 right-0 w-72 h-72 bg-sky-400/20 rounded-full blur-3xl"}),n.jsxs("div",{className:"relative bg-white/80 backdrop-blur-xl border border-sky-100 rounded-[2rem] shadow-2xl shadow-sky-200/50 w-full max-w-md p-8",children:[n.jsxs("div",{className:"flex flex-col items-center mb-8",children:[n.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-sky-500 to-sky-600 rounded-2xl flex items-center justify-center shadow-xl shadow-sky-300/50 mb-4",children:n.jsx("span",{className:"text-4xl",children:"  "})}),n.jsx("h1",{className:"text-3xl font-black text-sky-600",children:" "}),n.jsx("p",{className:"text-sky-500 mt-1",children:" "})]}),n.jsxs("form",{onSubmit:C,className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Pl,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-sky-400"}),n.jsx("input",{type:"email",placeholder:"",className:`w-full rounded-2xl p-4 pr-12 bg-sky-50 text-sky-900 border-2 border-sky-100 
                         focus:outline-none focus:border-sky-400 focus:ring-4 focus:ring-sky-100 transition-all`,value:t,onChange:N=>e(N.target.value)})]}),n.jsxs("div",{className:"relative",children:[n.jsx(po,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-sky-400"}),n.jsx("input",{type:"password",placeholder:" ",className:`w-full rounded-2xl p-4 pr-12 bg-sky-50 text-sky-900 border-2 border-sky-100 
                         focus:outline-none focus:border-sky-400 focus:ring-4 focus:ring-sky-100 transition-all`,value:s,onChange:N=>r(N.target.value)})]}),n.jsx("div",{className:"text-left",children:n.jsx("button",{type:"button",onClick:()=>{l(!0),u(t)},className:"text-sm text-sky-500 hover:text-sky-700 font-medium hover:underline",children:"   "})}),n.jsx("button",{disabled:i,className:`w-full flex items-center justify-center gap-3 bg-gradient-to-r from-sky-500 to-sky-600 hover:from-sky-600 hover:to-sky-700 text-white font-bold p-4 rounded-2xl 
                       shadow-xl shadow-sky-300/50 transition-all hover:scale-[1.02] hover:shadow-sky-400/50`,children:i?n.jsx(n.Fragment,{children:" ..."}):n.jsxs(n.Fragment,{children:[n.jsx(Fx,{className:"w-5 h-5"}),""]})})]}),n.jsxs("p",{className:"mt-8 text-center text-sky-600",children:["  "," ",n.jsx(de,{className:"text-sky-500 hover:text-sky-700 font-bold",to:"/register",children:"  "})]}),n.jsxs("div",{className:"mt-6 pt-6 border-t border-sky-100",children:[n.jsx("p",{className:"text-center text-sm text-gray-500 mb-3",children:"    "}),n.jsx(de,{to:"/customer-login",className:"block w-full text-center bg-green-50 hover:bg-green-100 text-green-700 font-semibold py-3 px-4 rounded-2xl transition",children:"   "})]})]}),o&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-md p-8 relative",children:[n.jsx("button",{onClick:()=>l(!1),className:"absolute top-4 left-4 p-2 hover:bg-gray-100 rounded-full transition",children:n.jsx($n,{className:"w-5 h-5 text-gray-500"})}),n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-400 to-orange-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:n.jsx(A1,{className:"w-8 h-8 text-white"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"  "}),n.jsx("p",{className:"text-gray-500 mt-2 text-sm",children:"         "})]}),n.jsxs("form",{onSubmit:E,className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Pl,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-amber-500"}),n.jsx("input",{type:"email",placeholder:" ",className:`w-full rounded-2xl p-4 pr-12 bg-amber-50 text-gray-900 border-2 border-amber-100 
                             focus:outline-none focus:border-amber-400 focus:ring-4 focus:ring-amber-100 transition-all`,value:d,onChange:N=>u(N.target.value),autoFocus:!0})]}),n.jsx("button",{type:"submit",disabled:h,className:`w-full flex items-center justify-center gap-3 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white font-bold p-4 rounded-2xl 
                           shadow-xl shadow-amber-300/50 transition-all hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed`,children:h?n.jsxs(n.Fragment,{children:[n.jsx(ci,{className:"w-5 h-5 animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Pl,{className:"w-5 h-5"}),"   "]})})]}),n.jsx("button",{onClick:()=>l(!1),className:"w-full mt-4 text-center text-gray-500 hover:text-gray-700 font-medium",children:"  "})]})})]})},cD=()=>{const[t]=Nh(),e=t.get("ref_restaurant"),[s,r]=_.useState(""),[i,a]=_.useState(""),[o,l]=_.useState(""),[d,u]=_.useState(""),[h,p]=_.useState(""),[g,y]=_.useState(""),[w,C]=_.useState(!1),[E,N]=_.useState(!1),v=ys();_.useEffect(()=>{e&&y("customer")},[e]);const k=g==="owner"||g==="courier",P=b=>{y(b),C(!1)},O=async b=>{if(b.preventDefault(),!g)return alert("  ");if(g==="owner"&&!d)return alert("  ");if(k&&!w)return alert("    ");N(!0);try{const m=await kl(Fs,s,i);if(await Ft(X(B,"users",m.user.uid),{name:o,email:s,role:g,restaurantName:g==="owner"?d:null,referredBy:e||null,createdAt:se()}),g==="owner"&&await Ft(X(B,"restaurants",m.user.uid),{name:d||o||" ",ownerId:m.user.uid,email:s,phone:"",city:h||"",location:"",logoUrl:""},{merge:!0}),e&&g==="customer")try{await tt(re(B,"customerRegistrations"),{customerId:m.user.uid,customerName:o,customerEmail:s,restaurantId:e,registrationType:"website",createdAt:se()});const j=X(B,"restaurantStats",e);(await Ce(j)).exists()?await fe(j,{registeredCustomers:ms(1),updatedAt:se()}):await Ft(j,{totalProfileViews:0,totalMenuViews:0,totalItemViews:0,totalShareClicks:0,whatsappShareCount:0,registeredCustomers:1,appDownloads:0,dailyViews:{},updatedAt:se()}),await tt(re(B,"notifications"),{recipientId:e,title:"     !",message:` "${o}"        `,type:"new_customer_registration",read:!1,createdAt:se()})}catch(j){console.warn("   :",j)}v("/")}catch(m){alert(m.message)}finally{N(!1)}},U=[{value:"customer",label:"",icon:F3,color:"sky"},{value:"courier",label:"",icon:Ts,color:"emerald"},{value:"owner",label:" ",icon:fc,color:"orange"}];return n.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-sky-50 via-white to-sky-100 px-4 py-8",children:[n.jsx("div",{className:"absolute top-0 left-0 w-72 h-72 bg-sky-300/20 rounded-full blur-3xl"}),n.jsx("div",{className:"absolute bottom-0 right-0 w-72 h-72 bg-sky-400/20 rounded-full blur-3xl"}),n.jsxs("div",{className:"relative bg-white/80 backdrop-blur-xl border border-sky-100 rounded-[2rem] shadow-2xl shadow-sky-200/50 w-full max-w-md p-8",children:[n.jsxs("div",{className:"flex flex-col items-center mb-6",children:[n.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-sky-500 to-sky-600 rounded-2xl flex items-center justify-center shadow-xl shadow-sky-300/50 mb-3",children:n.jsx(xc,{className:"w-8 h-8 text-white"})}),n.jsx("h1",{className:"text-2xl font-black text-sky-600",children:"  "})]}),n.jsxs("form",{onSubmit:O,className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(en,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-sky-400"}),n.jsx("input",{className:"w-full rounded-2xl p-4 pr-12 bg-sky-50 text-sky-900 border-2 border-sky-100 focus:outline-none focus:border-sky-400 focus:ring-4 focus:ring-sky-100 transition-all",placeholder:"",value:o,onChange:b=>l(b.target.value)})]}),n.jsxs("div",{className:"relative",children:[n.jsx(Pl,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-sky-400"}),n.jsx("input",{className:"w-full rounded-2xl p-4 pr-12 bg-sky-50 text-sky-900 border-2 border-sky-100 focus:outline-none focus:border-sky-400 focus:ring-4 focus:ring-sky-100 transition-all",placeholder:"",type:"email",value:s,onChange:b=>r(b.target.value)})]}),n.jsxs("div",{className:"relative",children:[n.jsx(po,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-sky-400"}),n.jsx("input",{className:"w-full rounded-2xl p-4 pr-12 bg-sky-50 text-sky-900 border-2 border-sky-100 focus:outline-none focus:border-sky-400 focus:ring-4 focus:ring-sky-100 transition-all",placeholder:" ",type:"password",value:i,onChange:b=>a(b.target.value)})]}),n.jsx("div",{className:"grid grid-cols-3 gap-3",children:U.map(b=>{const m=b.icon,j=g===b.value;return n.jsxs("label",{className:`relative flex flex-col items-center gap-2 p-4 rounded-2xl cursor-pointer transition-all duration-300 ${j?"bg-gradient-to-br from-sky-500 to-sky-600 text-white shadow-lg shadow-sky-300/50 scale-105":"bg-sky-50 text-sky-600 hover:bg-sky-100 border-2 border-sky-100"}`,children:[n.jsx("input",{type:"radio",name:"role",value:b.value,className:"hidden",onChange:()=>P(b.value)}),n.jsx(m,{className:"w-6 h-6"}),n.jsx("span",{className:"text-sm font-bold",children:b.label})]},b.value)})}),g==="owner"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"relative",children:[n.jsx(lt,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-orange-400"}),n.jsx("input",{className:"w-full rounded-2xl p-4 pr-12 bg-orange-50 text-orange-900 border-2 border-orange-200 focus:outline-none focus:border-orange-400 focus:ring-4 focus:ring-orange-100 transition-all",placeholder:" ",value:d,onChange:b=>u(b.target.value)})]}),n.jsxs("div",{className:"relative",children:[n.jsx(Nt,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-orange-400 pointer-events-none"}),n.jsxs("select",{value:h,onChange:b=>p(b.target.value),className:"w-full rounded-2xl p-4 pr-12 bg-orange-50 text-orange-900 border-2 border-orange-200 focus:outline-none focus:border-orange-400 focus:ring-4 focus:ring-orange-100 transition-all appearance-none cursor-pointer",children:[n.jsx("option",{value:"",children:" "}),Bx.map(b=>n.jsx("option",{value:b,children:b},b))]})]}),n.jsxs("div",{onClick:()=>C(!w),className:`flex items-start gap-3 p-4 rounded-2xl cursor-pointer transition-all border-2 ${w?"bg-green-50 border-green-400":"bg-orange-50 border-orange-200 hover:border-orange-300"}`,children:[w?n.jsx(rw,{className:"w-6 h-6 text-green-500 flex-shrink-0 mt-0.5"}):n.jsx(iw,{className:"w-6 h-6 text-orange-400 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm leading-relaxed",children:[n.jsxs("span",{className:w?"text-green-700":"text-orange-700",children:[" "," "]}),n.jsx(de,{to:"/terms",target:"_blank",onClick:b=>b.stopPropagation(),className:"text-sky-600 hover:text-sky-800 font-bold underline",children:" "}),n.jsxs("span",{className:w?"text-green-700":"text-orange-700",children:[" ",""," "]}),n.jsx(de,{to:"/privacy-policy",target:"_blank",onClick:b=>b.stopPropagation(),className:"text-sky-600 hover:text-sky-800 font-bold underline",children:" "}),n.jsxs("span",{className:w?"text-green-700":"text-orange-700",children:[" ","   "]})]})]})]}),g==="courier"&&n.jsxs("div",{onClick:()=>C(!w),className:`flex items-start gap-3 p-4 rounded-2xl cursor-pointer transition-all border-2 ${w?"bg-green-50 border-green-400":"bg-emerald-50 border-emerald-200 hover:border-emerald-300"}`,children:[w?n.jsx(rw,{className:"w-6 h-6 text-green-500 flex-shrink-0 mt-0.5"}):n.jsx(iw,{className:"w-6 h-6 text-emerald-400 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm leading-relaxed",children:[n.jsxs("span",{className:w?"text-green-700":"text-emerald-700",children:[" "," "]}),n.jsx(de,{to:"/courier-terms",target:"_blank",onClick:b=>b.stopPropagation(),className:"text-emerald-600 hover:text-emerald-800 font-bold underline",children:"  "}),n.jsxs("span",{className:w?"text-green-700":"text-emerald-700",children:[" ","    "]})]})]}),n.jsx("button",{disabled:E||k&&!w,className:`w-full flex items-center justify-center gap-3 text-white font-bold p-4 rounded-2xl shadow-xl transition-all ${k&&!w?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-sky-500 to-sky-600 hover:from-sky-600 hover:to-sky-700 shadow-sky-300/50 hover:scale-[1.02]"}`,children:E?" ...":n.jsxs(n.Fragment,{children:[n.jsx(xc,{className:"w-5 h-5"}),""]})}),k&&!w&&n.jsx("p",{className:`text-center text-sm p-3 rounded-xl ${g==="courier"?"text-emerald-600 bg-emerald-50":"text-orange-600 bg-orange-50"}`,children:"       "})]}),n.jsxs("p",{className:"mt-6 text-center text-sky-600",children:[" "," ",n.jsx(de,{className:"text-sky-500 hover:text-sky-700 font-bold",to:"/login",children:"  "})]})]})]})},cw=t=>{let e=t.replace(/\D/g,"");return e.startsWith("0")&&(e=e.substring(1)),e.startsWith("966")||(e="966"+e),"+"+e},dD=()=>{const[t,e]=_.useState(""),[s,r]=_.useState(""),[i,a]=_.useState("phone"),[o,l]=_.useState(!1),[d,u]=_.useState(null),[h,p]=_.useState(0),g=_.useRef(null),y=_.useRef(null),w=ys(),C=cn();_.useEffect(()=>(g.current&&!y.current&&(y.current=new Jy(Fs,g.current,{size:"invisible",callback:()=>{},"expired-callback":()=>{y.current=null}})),()=>{y.current&&(y.current.clear(),y.current=null)}),[]),_.useEffect(()=>{if(h>0){const k=setTimeout(()=>p(h-1),1e3);return()=>clearTimeout(k)}},[h]);const E=async()=>{if(!t||t.length<9){C.warning("   ");return}const k=cw(t);l(!0);try{!y.current&&g.current&&(y.current=new Jy(Fs,g.current,{size:"invisible"}));const P=await T5(Fs,k,y.current);u(P),a("otp"),p(60),C.success("     ")}catch(P){console.error("OTP Error:",P),y.current&&(y.current.clear(),y.current=null),P.code==="auth/invalid-phone-number"?C.error("   "):P.code==="auth/too-many-requests"?C.error("   "):P.code==="auth/quota-exceeded"?C.error("     "):C.error(P.message||"  ")}finally{l(!1)}},N=async()=>{if(!s||s.length!==6){C.warning("     6 ");return}if(!d){C.error("    "),a("phone");return}l(!0);try{const k=await d.confirm(s),P=k.user.uid,O=k.user.phoneNumber,U=await Ce(X(B,"users",P));let b=!1;U.exists()?C.success(" ! "):(b=!0,await Ft(X(B,"users",P),{phone:O,role:"customer",name:"",createdAt:se()}),C.success("   ! "));const m=U.exists()?U.data():{role:"customer"};if(!((m==null?void 0:m.savedLocation)||(m==null?void 0:m.location))&&(m.role==="customer"||b))try{navigator.geolocation&&navigator.geolocation.getCurrentPosition(async I=>{const T={lat:I.coords.latitude,lng:I.coords.longitude,address:" "};await fe(X(B,"users",P),{savedLocation:T,location:{lat:T.lat,lng:T.lng}}),sessionStorage.setItem("broast_session_location",JSON.stringify({lat:T.lat,lng:T.lng}))},I=>{console.warn("   :",I)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}catch(I){console.warn("   :",I)}m.role==="owner"?w("/owner"):m.role==="admin"?w("/admin"):m.role==="developer"?w("/developer"):m.role==="courier"?w("/courier"):w("/")}catch(k){console.error("Verify Error:",k),k.code==="auth/invalid-verification-code"?C.error("   "):k.code==="auth/code-expired"?(C.error("    "),a("phone")):C.error(k.message||" ")}finally{l(!1)}},v=()=>{h>0||(a("phone"),r(""),u(null))};return n.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-sky-50 via-white to-sky-100 px-4",children:[n.jsx("div",{className:"absolute top-0 left-0 w-72 h-72 bg-sky-300/20 rounded-full blur-3xl"}),n.jsx("div",{className:"absolute bottom-0 right-0 w-72 h-72 bg-sky-400/20 rounded-full blur-3xl"}),n.jsx("div",{ref:g,id:"recaptcha-container"}),n.jsxs("div",{className:"relative bg-white/80 backdrop-blur-xl border border-sky-100 rounded-[2rem] shadow-2xl shadow-sky-200/50 w-full max-w-md p-8",children:[n.jsxs("div",{className:"flex flex-col items-center mb-8",children:[n.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-sky-500 to-sky-600 rounded-2xl flex items-center justify-center shadow-xl shadow-sky-300/50 mb-4",children:n.jsx("span",{className:"text-4xl",children:""})}),n.jsx("h1",{className:"text-3xl font-black text-sky-600",children:" "}),n.jsx("p",{className:"text-sky-500 mt-1",children:i==="phone"?" ":"  "})]}),i==="phone"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Jh,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-sky-400"}),n.jsx("input",{type:"tel",placeholder:"05xxxxxxxx",dir:"ltr",className:`w-full rounded-2xl p-4 pr-12 bg-sky-50 text-sky-900 border-2 border-sky-100 
                           focus:outline-none focus:border-sky-400 focus:ring-4 focus:ring-sky-100 transition-all text-center text-lg tracking-wider`,value:t,onChange:k=>e(k.target.value.replace(/\D/g,"")),maxLength:10})]}),n.jsx("p",{className:"text-sm text-gray-500 text-center",children:"     SMS"}),n.jsx("button",{onClick:E,disabled:o||t.length<9,className:`w-full flex items-center justify-center gap-3 bg-gradient-to-r from-sky-500 to-sky-600 hover:from-sky-600 hover:to-sky-700 text-white font-bold p-4 rounded-2xl 
                         shadow-xl shadow-sky-300/50 transition-all hover:scale-[1.02] hover:shadow-sky-400/50 disabled:opacity-50 disabled:hover:scale-100`,children:o?n.jsxs(n.Fragment,{children:[n.jsx(os,{className:"w-5 h-5 animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx($n,{className:"w-5 h-5"}),"  "]})})]}),i==="otp"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("p",{className:"text-gray-600",children:"   "}),n.jsx("p",{className:"font-bold text-sky-600 text-lg",dir:"ltr",children:cw(t)})]}),n.jsxs("div",{className:"relative",children:[n.jsx(A1,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-sky-400"}),n.jsx("input",{type:"text",inputMode:"numeric",placeholder:"000000",dir:"ltr",className:`w-full rounded-2xl p-4 pr-12 bg-sky-50 text-sky-900 border-2 border-sky-100 
                           focus:outline-none focus:border-sky-400 focus:ring-4 focus:ring-sky-100 transition-all text-center text-2xl tracking-[0.5em] font-bold`,value:s,onChange:k=>r(k.target.value.replace(/\D/g,"")),maxLength:6,autoFocus:!0})]}),n.jsx("button",{onClick:N,disabled:o||s.length!==6,className:`w-full flex items-center justify-center gap-3 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold p-4 rounded-2xl 
                         shadow-xl shadow-green-300/50 transition-all hover:scale-[1.02] hover:shadow-green-400/50 disabled:opacity-50 disabled:hover:scale-100`,children:o?n.jsxs(n.Fragment,{children:[n.jsx(os,{className:"w-5 h-5 animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Fx,{className:"w-5 h-5"})," "]})}),n.jsx("div",{className:"text-center",children:h>0?n.jsxs("p",{className:"text-gray-500 text-sm",children:["   ",n.jsx("span",{className:"font-bold text-sky-600",children:h})," "]}):n.jsx("button",{onClick:v,className:"text-sky-600 hover:text-sky-700 font-semibold text-sm",children:"    "})}),n.jsx("button",{onClick:()=>{a("phone"),r("")},className:"w-full text-gray-500 hover:text-gray-700 text-sm",children:"   "})]}),n.jsxs("div",{className:"mt-8 pt-6 border-t border-sky-100",children:[n.jsx("p",{className:"text-center text-sm text-gray-500 mb-3",children:"   "}),n.jsx(de,{to:"/login",className:"block text-center text-sky-600 hover:text-sky-700 font-semibold",children:"   "})]})]})]})};function uD(){return n.jsx("div",{className:"min-h-screen bg-gray-100 text-gray-800 px-6 py-10 leading-relaxed",children:n.jsxs("div",{className:"max-w-3xl mx-auto bg-white shadow-lg rounded-2xl p-8",children:[n.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4 text-center",children:"  -   "}),n.jsxs("p",{className:"mb-4",children:["   ",n.jsx("strong",{children:" "}),"          ."]}),n.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2 text-gray-900",children:"1.  "}),n.jsx("p",{className:"mb-4",children:"                   .            ."}),n.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2 text-gray-900",children:"2.  "}),n.jsx("p",{className:"mb-4",children:"               ."}),n.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2 text-gray-900",children:"3.  "}),n.jsx("p",{className:"mb-4",children:"              .                 ."}),n.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2 text-gray-900",children:"4.  "}),n.jsx("p",{className:"mb-4",children:"       (    )         ."}),n.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2 text-gray-900",children:"5.  "}),n.jsxs("p",{className:"mb-4",children:["              .         :",n.jsx("strong",{children:" mymwalknany976@gmail.com "})]}),n.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2 text-gray-900",children:"6.   "}),n.jsx("p",{className:"mb-4",children:"                  ."}),n.jsxs("p",{className:"mt-6 text-sm text-gray-600 text-center",children:["      ",new Date().toLocaleDateString("ar-SA"),"."]}),n.jsx("div",{className:"mt-8 text-center",children:n.jsx(de,{to:"/",className:"text-white bg-red-500 hover:bg-red-600 px-6 py-2 rounded-lg",children:"   "})})]})})}function hD(){return n.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 text-center",children:[n.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"   "}),n.jsx("p",{className:"text-gray-600 mb-6",children:"          ."}),n.jsx(de,{to:"/",className:"text-white bg-red-500 px-6 py-2 rounded-lg hover:bg-red-600",children:"   "})]})}const mD="modulepreload",fD=function(t){return"/"+t},dw={},of=function(e,s,r){let i=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(s.map(d=>{if(d=fD(d),d in dw)return;dw[d]=!0;const u=d.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":mD,u||(p.as="script"),p.crossOrigin="",p.href=d,l&&p.setAttribute("nonce",l),document.head.appendChild(p),u)return new Promise((g,y)=>{p.addEventListener("load",g),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})},We=({allow:t,children:e})=>{const{role:s,loading:r}=Ue();return r?n.jsx("div",{className:"p-8 text-center",children:" ..."}):!s||!t.includes(s)?n.jsx(bh,{to:"/",replace:!0}):n.jsx(n.Fragment,{children:e})},O1=({isOpen:t,onClose:e,onConfirm:s,initialLocation:r})=>{const[i,a]=_.useState(r||null),[o,l]=_.useState(""),[d,u]=_.useState(!1),[h,p]=_.useState(!1),[g,y]=_.useState(null),[w,C]=_.useState(!1),[E,N]=_.useState(""),[v,k]=_.useState([]),[P,O]=_.useState(!1),[U,b]=_.useState(!1),[m,j]=_.useState("map"),I={lat:24.7136,lng:46.6753},T=_.useCallback(async V=>{if(!V.trim()||V.length<2){k([]),b(!1);return}O(!0);try{const z=V.includes("")?V:`${V}, `,$=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(z)}&limit=5&accept-language=ar`,{headers:{Accept:"application/json"}})).json();k($),b($.length>0)}catch(z){console.error("  :",z),k([])}finally{O(!1)}},[]),D=_.useCallback(V=>{const z={lat:parseFloat(V.lat),lng:parseFloat(V.lon)};a(z),N(""),k([]),b(!1),window.leafletMap&&(window.leafletMap.setView([z.lat,z.lng],16,{animate:!0,duration:.5}),window.leafletMarker&&window.leafletMarker.setLatLng([z.lat,z.lng]));const L=V.display_name.split(",").slice(0,3).join("");l(L)},[]),S=_.useCallback(()=>{if(!navigator.geolocation){y("    ");return}p(!0),y(null),navigator.geolocation.getCurrentPosition(V=>{const z={lat:V.coords.latitude,lng:V.coords.longitude};a(z),p(!1),window.leafletMap&&(window.leafletMap.setView([z.lat,z.lng],17),window.leafletMarker&&window.leafletMarker.setLatLng([z.lat,z.lng]))},V=>{p(!1),V.code===1?y("   .     "):V.code===2?y("  .    GPS"):y("   .   ")},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})},[]);_.useEffect(()=>{if(t){if(!document.getElementById("leaflet-css")){const V=document.createElement("link");V.id="leaflet-css",V.rel="stylesheet",V.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(V)}if(window.L)C(!0);else{const V=document.createElement("script");V.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",V.onload=()=>C(!0),document.body.appendChild(V)}}},[t]),_.useEffect(()=>{if(!t||!w||!window.L)return;const V=window.L;if(!document.getElementById("location-map"))return;window.leafletMap&&window.leafletMap.remove();const L=i||I,$=V.map("location-map",{zoomControl:!1,attributionControl:!1}).setView([L.lat,L.lng],i?17:12);V.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19}).addTo($);const M=V.divIcon({className:"custom-marker",html:`
        <div style="
          width: 50px; 
          height: 50px; 
          background: linear-gradient(135deg, #0EA5E9, #0284C7);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 4px 20px rgba(14, 165, 233, 0.5);
          border: 3px solid white;
        ">
          <div style="transform: rotate(45deg); color: white; font-size: 20px;"></div>
        </div>
      `,iconSize:[50,50],iconAnchor:[25,50]}),G=V.marker([L.lat,L.lng],{icon:M,draggable:!0}).addTo($);return G.on("dragend",()=>{const Y=G.getLatLng();a({lat:Y.lat,lng:Y.lng})}),$.on("click",Y=>{const{lat:ie,lng:le}=Y.latlng;G.setLatLng([ie,le]),a({lat:ie,lng:le})}),window.leafletMap=$,window.leafletMarker=G,i&&a(i),()=>{window.leafletMap&&(window.leafletMap.remove(),window.leafletMap=null,window.leafletMarker=null)}},[t,w]);const W=()=>{i&&window.leafletMap&&window.leafletMap.setView([i.lat,i.lng],17,{animate:!0,duration:.5})},F=()=>{if(m==="manual"){if(!o.trim()){y("  ");return}s({lat:24.7136,lng:46.6753},o);return}if(!i){y("  ");return}if(!o.trim()){y("  ");return}s(i,o)};return t?n.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),n.jsxs("div",{className:"relative w-full h-full sm:w-[95%] sm:h-[90%] sm:max-w-2xl sm:rounded-3xl overflow-hidden bg-white shadow-2xl flex flex-col",children:[n.jsxs("div",{className:"bg-gradient-to-r from-sky-500 to-sky-600 text-white p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center",children:n.jsx(Nt,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"font-bold text-lg",children:"  "}),n.jsx("p",{className:"text-sm text-white/80",children:m==="map"?"   ":"  "})]})]}),n.jsx("button",{onClick:e,className:"w-10 h-10 bg-white/20 hover:bg-white/30 rounded-xl flex items-center justify-center transition",children:n.jsx(_r,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"flex gap-2 mb-3",children:[n.jsxs("button",{onClick:()=>j("map"),className:`flex-1 py-2.5 rounded-xl font-semibold text-sm flex items-center justify-center gap-2 transition ${m==="map"?"bg-white text-sky-600":"bg-white/20 text-white hover:bg-white/30"}`,children:[n.jsx(F6,{className:"w-4 h-4"}),""]}),n.jsxs("button",{onClick:()=>j("manual"),className:`flex-1 py-2.5 rounded-xl font-semibold text-sm flex items-center justify-center gap-2 transition ${m==="manual"?"bg-white text-sky-600":"bg-white/20 text-white hover:bg-white/30"}`,children:[n.jsx(gc,{className:"w-4 h-4"})," "]})]}),m==="map"&&n.jsxs("div",{className:"relative",children:[n.jsx(n3,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:E,onChange:V=>{N(V.target.value),T(V.target.value)},onFocus:()=>v.length>0&&b(!0),placeholder:"     ...",className:"w-full bg-white/95 text-gray-800 rounded-xl p-3 pr-10 pl-10 focus:outline-none focus:ring-2 focus:ring-white/50 transition placeholder:text-gray-400"}),P&&n.jsx(ci,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-sky-500 animate-spin"}),U&&v.length>0&&n.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-2xl overflow-hidden z-[1001] max-h-60 overflow-y-auto",children:v.map((V,z)=>n.jsxs("button",{onClick:()=>D(V),className:"w-full p-3 text-right hover:bg-sky-50 border-b border-gray-100 last:border-0 transition flex items-start gap-3",children:[n.jsx(Nt,{className:"w-5 h-5 text-sky-500 flex-shrink-0 mt-0.5"}),n.jsx("span",{className:"text-gray-700 text-sm leading-relaxed",children:V.display_name})]},z))})]})]}),m==="map"&&n.jsxs("div",{className:"flex-1 relative",children:[!w&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-sky-50",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ci,{className:"w-12 h-12 text-sky-500 animate-spin mx-auto mb-3"}),n.jsx("p",{className:"text-sky-600 font-medium",children:"  ..."})]})}),n.jsx("div",{id:"location-map",className:"w-full h-full"}),n.jsxs("div",{className:"absolute left-4 top-4 flex flex-col gap-2 z-[1000]",children:[n.jsx("button",{onClick:S,disabled:h,className:"w-12 h-12 bg-white rounded-xl shadow-lg flex items-center justify-center hover:bg-sky-50 transition disabled:opacity-50",title:" ",children:h?n.jsx(ci,{className:"w-5 h-5 text-sky-500 animate-spin"}):n.jsx(Hi,{className:"w-5 h-5 text-sky-500"})}),i&&n.jsx("button",{onClick:W,className:"w-12 h-12 bg-white rounded-xl shadow-lg flex items-center justify-center hover:bg-sky-50 transition",title:"",children:n.jsx(k3,{className:"w-5 h-5 text-gray-600"})})]}),i&&n.jsxs("div",{className:"absolute right-4 top-4 bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 z-[1000] max-w-[200px]",children:[n.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[n.jsx(_s,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm font-medium",children:"  "})]}),n.jsxs("p",{className:"text-xs text-gray-500 font-mono",children:[i.lat.toFixed(6),", ",i.lng.toFixed(6)]})]})]}),m==="manual"&&n.jsx("div",{className:"flex-1 p-6 overflow-y-auto bg-gray-50",children:n.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[n.jsxs("div",{className:"text-center py-4",children:[n.jsx("div",{className:"w-20 h-20 bg-sky-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(gc,{className:"w-10 h-10 text-sky-500"})}),n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"  "}),n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"     "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:""}),n.jsxs("select",{className:"w-full border-2 border-gray-200 rounded-xl p-3 bg-white focus:border-sky-400 focus:outline-none",onChange:V=>l(z=>{const L=z.split("").slice(1);return V.target.value+(L.length?""+L.join(""):"")}),children:[n.jsx("option",{value:"",children:" "}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:" ",children:" "}),n.jsx("option",{value:" ",children:" "}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:" ",children:" "}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",placeholder:":  ",className:"w-full border-2 border-gray-200 rounded-xl p-3 focus:border-sky-400 focus:outline-none",onChange:V=>l(z=>(z.split("")[0]||"")+(V.target.value?" "+V.target.value:""))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",placeholder:":   ",className:"w-full border-2 border-gray-200 rounded-xl p-3 focus:border-sky-400 focus:outline-none",onChange:V=>l(z=>z.split("").slice(0,2).join("")+(V.target.value?" "+V.target.value:""))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:" "}),n.jsx("textarea",{placeholder:"    ...",rows:3,className:"w-full border-2 border-gray-200 rounded-xl p-3 focus:border-sky-400 focus:outline-none resize-none",onChange:V=>l(z=>z.split("").slice(0,3).join("")+(V.target.value?" "+V.target.value:""))})]}),o&&n.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-2",children:[n.jsx(_s,{className:"w-5 h-5"}),n.jsx("span",{className:"font-semibold",children:":"})]}),n.jsx("p",{className:"text-gray-700",children:o})]})]})}),n.jsxs("div",{className:"bg-white border-t p-4 space-y-3",children:[g&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-600 rounded-xl p-3 text-sm flex items-center gap-2",children:[n.jsx(_r,{className:"w-4 h-4 flex-shrink-0"}),g]}),m==="map"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"relative",children:[n.jsx(g3,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:o,onChange:V=>l(V.target.value),placeholder:"  (:       ...)",className:"w-full border-2 border-gray-200 rounded-xl p-3 pr-10 focus:border-sky-400 focus:outline-none transition text-gray-800"})]}),n.jsx("p",{className:"text-xs text-gray-500 text-center",children:"      "})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:e,className:"flex-1 py-3 px-4 rounded-xl border-2 border-gray-200 text-gray-600 font-semibold hover:bg-gray-50 transition",children:""}),n.jsxs("button",{onClick:F,disabled:m==="map"&&!i,className:"flex-1 py-3 px-4 rounded-xl bg-gradient-to-r from-green-500 to-green-600 text-white font-bold shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center gap-2",children:[n.jsx(_s,{className:"w-5 h-5"})," "]})]})]})]}),n.jsx("style",{children:`
        .custom-marker {
          background: transparent !important;
          border: none !important;
        }
        .leaflet-container {
          font-family: inherit;
        }
        .leaflet-control-zoom {
          display: none;
        }
        #location-map {
          background: #f0f9ff;
        }
      `})]}):null},lf=1,Dd=.75,pD=3.75,cf=!0,gD=()=>{const{items:t,subtotal:e,clear:s}=zx(),{user:r}=Ue(),i=ys(),a=cn(),o=Jt(),[l,d]=_.useState(""),[u,h]=_.useState(!1),[p,g]=_.useState(null),[y,w]=_.useState(null),[C,E]=_.useState(!1),[N,v]=_.useState("pickup");t.reduce((U,b)=>U+b.qty,0);const k=e;_.useEffect(()=>{(async()=>{var I,T;if(t.length===0)return;let b=(I=t[0])==null?void 0:I.ownerId;if(!b&&((T=t[0])!=null&&T.id))try{const D=await Ce(X(B,"menuItems",t[0].id)),S=D.exists()?D.data():null;b=(S==null?void 0:S.ownerId)||null}catch(D){console.error("    :",D)}if(!b){g(null);return}const m=await Ce(X(B,"restaurants",b)),j=m.exists()?m.data():null;g({id:b,name:(j==null?void 0:j.name)||"",referredBy:j==null?void 0:j.referredBy,referrerType:j==null?void 0:j.referrerType})})()},[t]);const P=(U,b)=>{w(U),d(b),E(!1),o.success("   ! ")},O=async()=>{var F;if(!r)return;if(t.length===0){a.warning(" ");return}if(N==="delivery"&&cf){if(!l){a.warning(" ");return}if(!y){a.warning("   ");return}}let U=p==null?void 0:p.id;if(!U&&((F=t[0])!=null&&F.id)){const V=await Ce(X(B,"menuItems",t[0].id)),z=V.exists()?V.data():null;U=(z==null?void 0:z.ownerId)||null}if(!U){a.error("   .    .");return}h(!0);const b=(p==null?void 0:p.referrerType)==="admin"&&(p==null?void 0:p.referredBy),m=t.reduce((V,z)=>V+z.qty,0),j=lf+Dd,T=e-j*m,D=lf*m,S=b?Dd*m:0,W=D+(b?0:Dd*m);await tt(re(B,"orders"),{customerId:r.uid,restaurantId:U,restaurantName:(p==null?void 0:p.name)||"",items:t.map(V=>({id:V.id,name:V.name,price:V.price,qty:V.qty,ownerId:V.ownerId??U})),subtotal:e,deliveryFee:0,deliveryFeeSetBy:null,deliveryFeeSetAt:null,total:e,status:"pending",deliveryType:N,address:N==="pickup"?"  ":l,location:N==="pickup"?null:y,createdAt:se(),updatedAt:se(),paymentMethod:"cod",restaurantEarnings:T,platformFee:D,platformFeePerItem:lf,adminCommission:S,adminCommissionPerItem:Dd,appEarnings:W,totalItemsCount:m,referredBy:(p==null?void 0:p.referredBy)||null,courierPlatformFee:N==="delivery"?pD:0});try{const V=X(B,"wallets",U);if((await Ce(V)).exists())await fe(V,{balance:ms(T),totalEarnings:ms(T),updatedAt:se()});else{const{setDoc:L}=await of(async()=>{const{setDoc:$}=await Promise.resolve().then(()=>Zm);return{setDoc:$}},void 0);await L(V,{balance:T,totalEarnings:T,totalWithdrawn:0,transactions:[],updatedAt:se()})}}catch{}if(b&&(p!=null&&p.referredBy)&&S>0)try{const V=X(B,"wallets",p.referredBy);if((await Ce(V)).exists())await fe(V,{balance:ms(S),totalEarnings:ms(S),updatedAt:se()});else{const{setDoc:L}=await of(async()=>{const{setDoc:$}=await Promise.resolve().then(()=>Zm);return{setDoc:$}},void 0);await L(V,{balance:S,totalEarnings:S,totalWithdrawn:0,transactions:[],updatedAt:se()})}}catch{}try{const V=X(B,"wallets","app_earnings");if((await Ce(V)).exists())await fe(V,{balance:ms(W),totalEarnings:ms(W),updatedAt:se()});else{const{setDoc:L}=await of(async()=>{const{setDoc:$}=await Promise.resolve().then(()=>Zm);return{setDoc:$}},void 0);await L(V,{balance:W,totalEarnings:W,totalWithdrawn:0,transactions:[],updatedAt:se()})}}catch{}s(),h(!1),i("/orders")};return n.jsx(We,{allow:["customer","admin"],children:n.jsxs("div",{className:"max-w-xl mx-auto space-y-4",children:[n.jsx("div",{className:"bg-gradient-to-r from-sky-500 to-sky-600 rounded-2xl p-5 text-white shadow-lg",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:n.jsx(jr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-xl font-bold",children:" "}),n.jsx("p",{className:"text-sm text-white/80",children:(p==null?void 0:p.name)||" ..."})]})]})}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b flex items-center gap-2",children:[n.jsx(jr,{className:"w-5 h-5 text-sky-500"}),n.jsx("span",{className:"font-bold text-gray-800",children:" "}),n.jsxs("span",{className:"text-xs bg-sky-100 text-sky-600 px-2 py-0.5 rounded-full mr-auto",children:[t.length," "]})]}),n.jsx("div",{className:"p-4 space-y-2",children:t.map(U=>n.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-0",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("span",{className:"w-8 h-8 bg-sky-100 rounded-lg flex items-center justify-center text-sm",children:[U.qty,""]}),n.jsx("span",{className:"text-gray-800 font-medium",children:U.name})]}),n.jsxs("span",{className:"font-bold text-sky-600",children:[(U.price*U.qty).toFixed(2)," ."]})]},U.id))})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b flex items-center gap-2",children:[n.jsx(Ts,{className:"w-5 h-5 text-sky-500"}),n.jsx("span",{className:"font-bold text-gray-800",children:" "})]}),n.jsxs("div",{className:"p-4 space-y-3",children:[n.jsxs("button",{onClick:()=>v("pickup"),className:`w-full p-4 rounded-xl border-2 transition flex items-center gap-4 ${N==="pickup"?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[n.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${N==="pickup"?"bg-green-500":"bg-gray-100"}`,children:n.jsx(lt,{className:`w-6 h-6 ${N==="pickup"?"text-white":"text-gray-500"}`})}),n.jsxs("div",{className:"flex-1 text-right",children:[n.jsx("p",{className:`font-bold ${N==="pickup"?"text-green-700":"text-gray-800"}`,children:"  "}),n.jsx("p",{className:"text-sm text-gray-500",children:" -   "})]}),N==="pickup"&&n.jsx(_s,{className:"w-6 h-6 text-green-500"})]}),n.jsxs("button",{onClick:()=>v("delivery"),className:`w-full p-4 rounded-xl border-2 transition flex items-center gap-4 ${N==="delivery"?"border-sky-500 bg-sky-50":"border-gray-200 hover:border-gray-300"}`,children:[n.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${N==="delivery"?"bg-sky-500":"bg-gray-100"}`,children:n.jsx(Ts,{className:`w-6 h-6 ${N==="delivery"?"text-white":"text-gray-500"}`})}),n.jsxs("div",{className:"flex-1 text-right",children:[n.jsx("p",{className:`font-bold ${N==="delivery"?"text-sky-700":"text-gray-800"}`,children:" "}),n.jsx("p",{className:"text-sm text-amber-600",children:"   /"})]}),N==="delivery"&&n.jsx(_s,{className:"w-6 h-6 text-sky-500"})]})]})]}),N==="delivery"&&n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b flex items-center gap-2",children:[n.jsx(Nt,{className:"w-5 h-5 text-green-500"}),n.jsx("span",{className:"font-bold text-gray-800",children:" "})]}),n.jsx("div",{className:"p-4",children:y?n.jsxs("div",{className:"space-y-3",children:[n.jsx("div",{className:"bg-green-50 border-2 border-green-200 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-xl flex items-center justify-center flex-shrink-0",children:n.jsx(_s,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-bold text-green-700 mb-1",children:"   "}),n.jsx("p",{className:"text-sm text-gray-600 break-words",children:l}),n.jsxs("p",{className:"text-xs text-gray-400 mt-1 font-mono",children:[y.lat.toFixed(5),", ",y.lng.toFixed(5)]})]})]})}),n.jsxs("button",{onClick:()=>E(!0),className:"w-full py-3 px-4 rounded-xl border-2 border-sky-200 text-sky-600 font-semibold hover:bg-sky-50 transition flex items-center justify-center gap-2",children:[n.jsx(Nt,{className:"w-5 h-5"})," "]})]}):n.jsxs("button",{onClick:()=>E(!0),className:"w-full py-4 rounded-xl bg-gradient-to-r from-sky-500 to-sky-600 text-white font-bold shadow-lg hover:shadow-xl transition flex items-center justify-center gap-3",children:[n.jsx(Nt,{className:"w-6 h-6"}),n.jsx("span",{children:"  "}),n.jsx(Ju,{className:"w-5 h-5"})]})})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b flex items-center gap-2",children:[n.jsx(Zu,{className:"w-5 h-5 text-amber-500"}),n.jsx("span",{className:"font-bold text-gray-800",children:" "})]}),n.jsxs("div",{className:"p-4 space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between text-gray-600",children:[n.jsx("span",{children:" "}),n.jsxs("span",{className:"font-semibold",children:[e.toFixed(2)," ."]})]}),N==="delivery"&&n.jsxs("div",{className:"flex items-center justify-between text-amber-600",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ts,{className:"w-4 h-4"}),n.jsx("span",{children:" "})]}),n.jsx("span",{className:"font-semibold text-sm",children:" "})]}),N==="pickup"&&n.jsxs("div",{className:"flex items-center justify-between text-green-600",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(lt,{className:"w-4 h-4"}),n.jsx("span",{children:"  "})]}),n.jsx("span",{className:"font-semibold",children:""})]}),n.jsx("div",{className:"h-px bg-gray-200 my-2"}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"font-bold text-lg text-gray-800",children:""}),n.jsxs("span",{className:"font-black text-xl text-sky-600",children:[k.toFixed(2)," ."]})]})]})]}),n.jsx("button",{disabled:u||N==="delivery"&&cf&&!y,onClick:O,className:"w-full py-4 rounded-2xl bg-gradient-to-r from-green-500 to-green-600 text-white font-bold text-lg shadow-xl hover:shadow-2xl disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center gap-3",children:u?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"  ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(_s,{className:"w-6 h-6"}),N==="pickup"?"  (  )":"  (  )"]})}),N==="delivery"&&cf&&!y&&n.jsx("p",{className:"text-center text-sm text-amber-600 bg-amber-50 rounded-xl p-3",children:"       "}),n.jsx(O1,{isOpen:C,onClose:()=>E(!1),onConfirm:P,initialLocation:y})]})})},xD=()=>{var O,U;const{user:t}=Ue(),e=ys(),s=Jt(),[r,i]=_.useState(null),[a,o]=_.useState([]),[l,d]=_.useState(null),[u,h]=_.useState(null),[p,g]=_.useState(null),[y,w]=_.useState(!1),C=async(b,m)=>{w(!0),h(m);try{const j=await Ce(X(B,"restaurants",b,"private","bankInfo"));if(j.exists()){const I=j.data();g({bankName:I.bankName||"",bankAccountName:I.bankAccountName||"",bankAccountNumber:I.bankAccountNumber||""})}else{const I=await Ce(X(B,"restaurants",b));if(I.exists()){const T=I.data();g({bankName:T.bankName||"",bankAccountName:T.bankAccountName||"",bankAccountNumber:T.bankAccountNumber||""})}else g(null)}}catch{s.error("   "),g(null)}finally{w(!1)}},E=b=>{navigator.clipboard.writeText(b),s.success("   ! ")};_.useEffect(()=>{if(!t)return;i(null),d(null);const b=je(re(B,"orders"),Ne("customerId","==",t.uid),ln("createdAt","desc")),m=qn(b,j=>{o(j.docs.map(I=>({id:I.id,...I.data()}))),i(null)},async j=>{console.error("TrackOrders onSnapshot error:",j),i("   Composite Index  customerId + createdAt.     .");const I=je(re(B,"orders"),Ne("customerId","==",t.uid)),D=(await ve(I)).docs.map(F=>({id:F.id,...F.data()})),S=je(re(B,"orders"),ln("createdAt","desc"),ia(5));let W=[];try{W=(await ve(S)).docs.map(V=>{var L,$,M,G;const z=V.data();return{id:V.id,customerId:z.customerId,restaurantId:z.restaurantId,createdAt:((G=(M=($=(L=z.createdAt)==null?void 0:L.toDate)==null?void 0:$.call(L))==null?void 0:M.toISOString)==null?void 0:G.call(M))??null}})}catch{}d({uid:t.uid,fallbackCount:D.length,sample:W}),o(D)});return()=>m()},[t]);const N=b=>({pending:{text:" ",emoji:"",color:"bg-yellow-500",icon:Rt},accepted:{text:" ",emoji:"",color:"bg-blue-500",icon:Xe},preparing:{text:" ",emoji:"",color:"bg-orange-500",icon:fc},ready:{text:" ",emoji:"",color:"bg-purple-500",icon:Bt},out_for_delivery:{text:" ",emoji:"",color:"bg-sky-500",icon:Ts},delivered:{text:" ",emoji:"",color:"bg-green-500",icon:Xe},cancelled:{text:"",emoji:"",color:"bg-red-500",icon:li}})[b]||{text:b,emoji:"",color:"bg-gray-500",icon:Bt},v=b=>b.courierId&&b.status==="out_for_delivery",k=b=>{const m=["pending","accepted","preparing","ready"];return!b.courierId&&b.restaurantId&&m.includes(b.status)},P=b=>["pending","accepted"].includes(b.status);return n.jsxs("div",{className:"space-y-3",children:[n.jsx("h1",{className:"text-xl font-bold",children:""}),u&&n.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>h(null),children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden",onClick:b=>b.stopPropagation(),children:[n.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 p-4 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Zu,{className:"w-6 h-6"}),n.jsx("h2",{className:"text-lg font-bold",children:" "})]}),n.jsx("button",{onClick:()=>h(null),className:"p-1 hover:bg-white/20 rounded-lg",children:n.jsx(_r,{className:"w-5 h-5"})})]})}),n.jsx("div",{className:"p-5",children:y?n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-10 h-10 border-3 border-green-500 border-t-transparent rounded-full animate-spin mx-auto mb-3"}),n.jsx("p",{className:"text-gray-500",children:" ..."})]}):p&&p.bankName&&p.bankAccountNumber?n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-sm text-gray-600 bg-amber-50 p-3 rounded-xl",children:"          "}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Pn,{className:"w-5 h-5 text-green-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-500",children:""}),n.jsx("p",{className:"font-bold text-gray-800",children:p.bankName})]})]}),n.jsxs("div",{className:"border-t pt-3",children:[n.jsx("p",{className:"text-xs text-gray-500",children:"  "}),n.jsx("p",{className:"font-bold text-gray-800",children:p.bankAccountName})]}),n.jsxs("div",{className:"border-t pt-3",children:[n.jsx("p",{className:"text-xs text-gray-500",children:"  / "}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("p",{className:"font-mono font-bold text-gray-800 flex-1 text-left",dir:"ltr",children:p.bankAccountNumber}),n.jsx("button",{onClick:()=>E(p.bankAccountNumber||""),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition",children:n.jsx(T1,{className:"w-4 h-4"})})]})]})]}),a.find(b=>b.id===u)&&n.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-sm text-green-600 mb-1",children:"  "}),n.jsxs("p",{className:"text-3xl font-black text-green-700",children:[(U=(O=a.find(b=>b.id===u))==null?void 0:O.total)==null?void 0:U.toFixed(2)," ."]})]}),n.jsx("p",{className:"text-xs text-gray-500 text-center",children:"       "})]}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Pn,{className:"w-8 h-8 text-gray-400"})}),n.jsx("p",{className:"text-gray-600 font-semibold mb-2",children:"     "}),n.jsx("p",{className:"text-sm text-gray-500",children:"       "})]})})]})}),r&&n.jsxs("div",{className:"text-xs bg-yellow-50 text-yellow-800 border border-yellow-200 rounded-xl p-3",children:[r,l&&n.jsxs("div",{className:"mt-1",children:[n.jsxs("div",{children:["UID: ",n.jsx("b",{children:l.uid})]}),n.jsxs("div",{children:["  : ",n.jsx("b",{children:l.fallbackCount})]}),Array.isArray(l.sample)&&l.sample.length>0&&n.jsxs("div",{className:"mt-1",children:[n.jsx("div",{className:"font-semibold",children:" ( 5):"}),l.sample.map(b=>n.jsxs("div",{className:"truncate",children:["#",b.id,"  customerId: ",String(b.customerId),"  restaurantId: ",String(b.restaurantId),"  createdAt: ",b.createdAt||""]},b.id))]})]})]}),a.map(b=>{var m,j,I,T,D,S,W;return n.jsxs("div",{className:"bg-white rounded-2xl shadow-card overflow-hidden hover:shadow-lg transition-shadow",children:[n.jsxs("div",{className:`${N(b.status).color} px-4 py-3 flex items-center justify-between`,children:[n.jsxs("div",{className:"flex items-center gap-2 text-white",children:[n.jsx("span",{className:"text-xl",children:N(b.status).emoji}),n.jsx("span",{className:"font-bold",children:N(b.status).text})]}),n.jsxs("div",{className:"text-white/80 text-sm font-medium",children:["#",b.id.slice(-6)]})]}),n.jsxs("div",{className:"p-4",children:[b.restaurantName&&n.jsxs("div",{className:"flex items-center gap-2 text-primary font-semibold mb-2",children:[n.jsx("span",{children:""}),n.jsx("span",{children:String(b.restaurantName)})]}),n.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 rounded-xl p-3 mb-3",children:(m=b.items)==null?void 0:m.map(F=>`${F.name}${F.qty}`).join("  ")}),n.jsx("div",{className:"text-sm text-gray-600 space-y-2",children:b.deliveryType==="pickup"?n.jsxs("div",{className:"flex items-center gap-2 text-green-600 font-medium bg-green-50 rounded-xl p-3",children:[n.jsx(Nt,{className:"w-4 h-4"}),n.jsx("span",{children:"  "})]}):n.jsxs("div",{className:"space-y-1 bg-gray-50 rounded-xl p-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:" :"}),n.jsxs("span",{children:[((I=(j=b.subtotal)==null?void 0:j.toFixed)==null?void 0:I.call(j,2))||""," ."]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:" :"}),b.deliveryFee!==void 0&&b.deliveryFee>0?n.jsxs("span",{className:"font-medium",children:[(D=(T=b.deliveryFee)==null?void 0:T.toFixed)==null?void 0:D.call(T,2)," ."]}):n.jsx("span",{className:"text-amber-600",children:"  "})]})]})}),n.jsxs("div",{className:"mt-3 pt-3 border-t space-y-3",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{className:"font-bold text-lg text-primary",children:[": ",(W=(S=b.total)==null?void 0:S.toFixed)==null?void 0:W.call(S,2)," ."]})}),P(b)&&b.restaurantId&&n.jsxs("button",{onClick:()=>C(b.restaurantId,b.id),className:`w-full flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-green-500 to-green-600 
                             text-white rounded-xl font-bold shadow-lg hover:shadow-xl 
                             hover:scale-[1.02] transition-all duration-200`,children:[n.jsx(Zu,{className:"w-5 h-5"}),n.jsx("span",{children:"  "})]}),n.jsxs("div",{className:"flex gap-2",children:[v(b)&&n.jsxs("button",{onClick:()=>e(`/chat?orderId=${b.id}`),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-gradient-to-r from-primary to-accent 
                               text-white rounded-full font-medium shadow-lg hover:shadow-xl 
                               hover:scale-105 transition-all duration-200 animate-pulse`,children:[n.jsx(Uc,{className:"w-5 h-5"}),n.jsx("span",{children:"   "})]}),k(b)&&n.jsxs("button",{onClick:()=>e(`/chat?orderId=${b.id}`),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 
                               text-white rounded-full font-medium shadow-lg hover:shadow-xl 
                               hover:scale-105 transition-all duration-200`,children:[n.jsx(lt,{className:"w-5 h-5"}),n.jsx("span",{children:"   "})]})]})]})]})]},b.id)}),a.length===0&&!r&&n.jsx("div",{className:"text-gray-600",children:"    ."})]})},yD=()=>{const{user:t,role:e}=Ue(),s=cn(),r=Jt(),[i,a]=_.useState({name:"",phone:"",city:"",address:"",restaurantName:""}),[o,l]=_.useState([]),[d,u]=_.useState(0),[h,p]=_.useState(!1),[g,y]=_.useState(null),[w,C]=_.useState(""),[E,N]=_.useState(!0),[v,k]=_.useState(!1);_.useEffect(()=>{if(!t)return;(async()=>{const T=await Ce(X(B,"users",t.uid));if(T.exists()){const D=T.data();a({name:D.name||"",phone:D.phone||t.phoneNumber||"",city:D.city||"",address:D.address||"",restaurantName:D.restaurantName||""}),D.savedLocations&&Array.isArray(D.savedLocations)?(l(D.savedLocations),u(D.defaultLocationIndex||0)):D.savedLocation&&(l([{...D.savedLocation,label:""}]),u(0))}N(!1)})()},[t]);const P=async I=>{if(I.preventDefault(),!!t){k(!0);try{const T=o[d]||null;await fe(X(B,"users",t.uid),{name:i.name,phone:i.phone,city:i.city,address:i.address,savedLocation:T,savedLocations:o,defaultLocationIndex:d,...e==="owner"&&{restaurantName:i.restaurantName}}),s.success("   ! ")}catch{s.error("   ")}finally{k(!1)}}},O=(I,T)=>{const D={lat:I.lat,lng:I.lng,address:T,label:w||` ${o.length+1}`};l([...o,D]),C(""),p(!1),r.success("  !    ")},U=(I,T)=>{if(g===null)return;const D=[...o];D[g]={...D[g],lat:I.lat,lng:I.lng,address:T},l(D),y(null),p(!1),r.success("  !    ")},b=async I=>{if(!await s.confirm("    "))return;const D=o.filter((S,W)=>W!==I);l(D),d>=D.length?u(Math.max(0,D.length-1)):d>I&&u(d-1),r.info("  ")},m=I=>{u(I),r.success("   ")};if(E)return n.jsxs("div",{className:"flex items-center justify-center h-96 text-lg",children:[n.jsx(os,{className:"w-6 h-6 animate-spin ml-2"}),"  ..."]});const j=()=>e==="owner"?"  ":e==="courier"?"  ":e==="admin"?"  ":" ";return n.jsxs("div",{className:"max-w-md mx-auto py-8 px-4",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsx("div",{className:"w-12 h-12 bg-sky-100 rounded-xl flex items-center justify-center",children:n.jsx(en,{className:"w-6 h-6 text-sky-600"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-xl font-bold text-gray-800",children:j()}),n.jsx("p",{className:"text-sm text-gray-500",children:(t==null?void 0:t.email)||(t==null?void 0:t.phoneNumber)})]})]}),n.jsxs("form",{onSubmit:P,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:[n.jsx(en,{className:"w-4 h-4 inline ml-1"})," "]}),n.jsx("input",{className:"w-full border-2 border-gray-200 rounded-xl p-3 focus:border-sky-400 focus:outline-none transition",placeholder:" ",value:i.name,onChange:I=>a({...i,name:I.target.value})})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:[n.jsx(Jh,{className:"w-4 h-4 inline ml-1"})," "]}),n.jsx("input",{className:"w-full border-2 border-gray-200 rounded-xl p-3 focus:border-sky-400 focus:outline-none transition",placeholder:"05xxxxxxxx",value:i.phone,onChange:I=>a({...i,phone:I.target.value}),dir:"ltr"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:[n.jsx(Pn,{className:"w-4 h-4 inline ml-1"}),""]}),n.jsx("input",{className:"w-full border-2 border-gray-200 rounded-xl p-3 focus:border-sky-400 focus:outline-none transition",placeholder:": ",value:i.city,onChange:I=>a({...i,city:I.target.value})})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:[n.jsx(Nt,{className:"w-4 h-4 inline ml-1"})," "]}),n.jsx("textarea",{className:"w-full border-2 border-gray-200 rounded-xl p-3 focus:border-sky-400 focus:outline-none transition h-24",placeholder:"     ...",value:i.address,onChange:I=>a({...i,address:I.target.value})})]}),(e==="customer"||e==="admin")&&n.jsxs("div",{className:"border-t pt-4 mt-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("label",{className:"text-sm font-semibold text-gray-700 flex items-center gap-1",children:[n.jsx(Hi,{className:"w-4 h-4"}),"  "]}),n.jsxs("span",{className:"text-xs text-gray-400",children:[o.length,"/5"]})]}),o.length>0&&n.jsx("div",{className:"space-y-3 mb-4",children:o.map((I,T)=>n.jsxs("div",{className:`rounded-xl p-3 border-2 transition ${T===d?"bg-green-50 border-green-300":"bg-gray-50 border-gray-200"}`,children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${T===d?"bg-green-500":"bg-gray-400"}`,children:n.jsx(Nt,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("p",{className:"font-bold text-gray-800",children:I.label||` ${T+1}`}),T===d&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-500 text-white text-xs font-bold rounded-full",children:[n.jsx(go,{className:"w-3 h-3"})," "]})]}),n.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:I.address})]})]}),n.jsxs("div",{className:"flex gap-2 mt-3",children:[T!==d&&n.jsxs("button",{type:"button",onClick:()=>m(T),className:"flex-1 py-2 px-3 rounded-lg border border-green-200 text-green-600 text-xs font-medium hover:bg-green-50 transition flex items-center justify-center gap-1",children:[n.jsx(_s,{className:"w-3 h-3"}),"  "]}),n.jsx("button",{type:"button",onClick:()=>{y(T),p(!0)},className:"flex-1 py-2 px-3 rounded-lg border border-sky-200 text-sky-600 text-xs font-medium hover:bg-sky-50 transition",children:""}),n.jsx("button",{type:"button",onClick:()=>b(T),className:"py-2 px-3 rounded-lg border border-red-200 text-red-500 hover:bg-red-50 transition",children:n.jsx(Ss,{className:"w-4 h-4"})})]})]},T))}),o.length<5&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("input",{type:"text",value:w,onChange:I=>C(I.target.value),placeholder:"  (:  ...)",className:"w-full border-2 border-gray-200 rounded-xl p-3 text-sm focus:border-sky-400 focus:outline-none"}),n.jsxs("button",{type:"button",onClick:()=>{y(null),p(!0)},className:"w-full py-4 rounded-xl bg-gradient-to-r from-sky-100 to-sky-50 border-2 border-dashed border-sky-300 text-sky-600 font-semibold hover:border-sky-400 transition flex items-center justify-center gap-3",children:[n.jsx($c,{className:"w-5 h-5"}),n.jsx("span",{children:"  "})]})]}),o.length===0&&n.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"     "})]}),e==="owner"&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:[n.jsx(th,{className:"w-4 h-4 inline ml-1"})," "]}),n.jsx("input",{className:"w-full border-2 border-gray-200 rounded-xl p-3 focus:border-sky-400 focus:outline-none transition",placeholder:" ",value:i.restaurantName,onChange:I=>a({...i,restaurantName:I.target.value})})]}),n.jsx("button",{type:"submit",disabled:v,className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-sky-500 to-sky-600 hover:from-sky-600 hover:to-sky-700 text-white font-bold p-4 rounded-xl shadow-lg transition disabled:opacity-50",children:v?n.jsxs(n.Fragment,{children:[n.jsx(os,{className:"w-5 h-5 animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(R1,{className:"w-5 h-5"})," "]})})]}),n.jsxs("div",{className:"mt-6 pt-4 border-t text-center text-sm text-gray-500",children:[n.jsx("p",{children:"      "}),(e==="customer"||e==="admin")&&n.jsx("p",{className:"mt-1",children:"    5  "})]})]}),n.jsx(O1,{isOpen:h,onClose:()=>{p(!1),y(null)},onConfirm:(I,T)=>{g!==null?U(I,T):O(I,T)},initialLocation:g!==null&&o[g]?{lat:o[g].lat,lng:o[g].lng}:null})]})},vD=()=>{const{user:t}=Ue(),e=Jt(),[s,r]=_.useState(!0),[i,a]=_.useState(!1),[o,l]=_.useState(null),[d,u]=_.useState("overview"),[h,p]=_.useState({todayOrders:0,todayRevenue:0,weekOrders:0,weekRevenue:0,monthOrders:0,monthRevenue:0,totalOrders:0,totalRevenue:0,pendingOrders:0,preparingOrders:0,deliveredOrders:0,cancelledOrders:0,menuItems:0,availableItems:0,averageRating:0,deliveryRate:0,activePromotions:0,totalViews:0,uniqueCustomers:0,profileViews:0,menuViews:0,itemViews:0,shareClicks:0,whatsappShares:0,registeredViaLink:0,todayViews:0,followersCount:0}),[g,y]=_.useState(!1),[w,C]=_.useState(null),E=F=>{const V=`${window.location.origin}/menu?restaurant=${t==null?void 0:t.uid}`;return F?`${V}&ref=${F}`:V},N=async F=>{if(t!=null&&t.uid)try{const V=X(B,"restaurantStats",t.uid),z={totalShareClicks:ms(1),updatedAt:se()};F==="whatsapp"&&(z.whatsappShareCount=ms(1)),await fe(V,z).catch(async()=>{await Ft(V,{totalProfileViews:0,totalMenuViews:0,totalItemViews:0,totalShareClicks:1,whatsappShareCount:F==="whatsapp"?1:0,registeredCustomers:0,appDownloads:0,dailyViews:{},updatedAt:se()})})}catch(V){console.warn("   :",V)}},v=async()=>{const F=E("copy");await navigator.clipboard.writeText(F),y(!0),setTimeout(()=>y(!1),2e3),e.success("  ! "),N("copy")},k=()=>{const F=E("whatsapp"),V=encodeURIComponent(`    ${(o==null?void 0:o.name)||""}   !

${F}`);window.open(`https://wa.me/?text=${V}`,"_blank"),e.success("  ... "),N("whatsapp")},P=async()=>{const F=E("social");if(navigator.share)try{await navigator.share({title:(o==null?void 0:o.name)||"",text:`  ${o==null?void 0:o.name}   `,url:F}),N("social")}catch{v()}else v()},[O,U]=_.useState([]),[b,m]=_.useState([]),j=async()=>{var F,V,z;if(t!=null&&t.uid)try{const L=await Ce(X(B,"restaurants",t.uid));L.exists()&&l(L.data());const $=je(re(B,"menuItems"),Ne("ownerId","==",t.uid)),G=(await ve($)).docs.map(ue=>({id:ue.id,...ue.data()})),Y=je(re(B,"orders"),Ne("ownerId","==",t.uid),ln("createdAt","desc")),le=(await ve(Y)).docs.map(ue=>({id:ue.id,...ue.data()}));let pe=0,Ae=0;try{const ue=je(re(B,"promotions"),Ne("ownerId","==",t.uid));(await ve(ue)).docs.forEach(Ke=>{const Be=Ke.data();Be.isActive&&pe++,Ae+=Be.viewsCount||0})}catch{}const De=new Date,$e=new Date(De.getFullYear(),De.getMonth(),De.getDate()),jt=new Date($e.getTime()-7*24*60*60*1e3),Pt=new Date($e.getTime()-30*24*60*60*1e3),rt=le.filter(ue=>{var Ke,Be;return(((Be=(Ke=ue.createdAt)==null?void 0:Ke.toDate)==null?void 0:Be.call(Ke))||new Date(0))>=$e&&ue.status!=="cancelled"}),qt=le.filter(ue=>{var Ke,Be;return(((Be=(Ke=ue.createdAt)==null?void 0:Ke.toDate)==null?void 0:Be.call(Ke))||new Date(0))>=jt&&ue.status!=="cancelled"}),Hs=le.filter(ue=>{var Ke,Be;return(((Be=(Ke=ue.createdAt)==null?void 0:Ke.toDate)==null?void 0:Be.call(Ke))||new Date(0))>=Pt&&ue.status!=="cancelled"}),kn=le.filter(ue=>ue.status==="delivered"),Er=le.filter(ue=>ue.status==="pending"),_i=le.filter(ue=>["accepted","preparing"].includes(ue.status)),ma=le.filter(ue=>ue.status==="cancelled"),ki=new Set(le.map(ue=>ue.customerId).filter(Boolean)),Gn={};kn.forEach(ue=>{var _e;(_e=ue.items)==null||_e.forEach(Ke=>{const Be=Ke.name||" ";Gn[Be]=(Gn[Be]||0)+(Ke.qty||1)})});const Ws=Object.entries(Gn).sort((ue,_e)=>_e[1]-ue[1]).slice(0,5).map(([ue,_e])=>({name:ue,count:_e}));m(Ws),U(le.slice(0,5));let Ir=0,Sr=0,Qn=0,Ks=0,Tr=0,it=0,gt=0,dn=0;try{const ue=await Ce(X(B,"restaurantStats",t.uid));if(ue.exists()){const _e=ue.data();C(_e),Ir=_e.totalProfileViews||0,Sr=_e.totalMenuViews||0,Qn=_e.totalItemViews||0,Ks=_e.totalShareClicks||0,Tr=_e.whatsappShareCount||0,it=_e.registeredCustomers||0,dn=_e.followersCount||0;const Ke=new Date().toISOString().split("T")[0];gt=((F=_e.dailyViews)==null?void 0:F[Ke])||0}}catch(ue){console.warn("    :",ue)}try{const ue=je(re(B,"customerRegistrations"),Ne("restaurantId","==",t.uid));it=(await ve(ue)).size}catch{}try{const ue=je(re(B,"storeFollowers"),Ne("restaurantId","==",t.uid));dn=(await ve(ue)).size}catch{}p({todayOrders:rt.length,todayRevenue:rt.reduce((ue,_e)=>ue+(_e.subtotal||0),0),weekOrders:qt.length,weekRevenue:qt.reduce((ue,_e)=>ue+(_e.subtotal||0),0),monthOrders:Hs.length,monthRevenue:Hs.reduce((ue,_e)=>ue+(_e.subtotal||0),0),totalOrders:le.filter(ue=>ue.status!=="cancelled").length,totalRevenue:kn.reduce((ue,_e)=>ue+(_e.subtotal||0),0),pendingOrders:Er.length,preparingOrders:_i.length,deliveredOrders:kn.length,cancelledOrders:ma.length,menuItems:G.length,availableItems:G.filter(ue=>ue.available).length,averageRating:((V=L.data())==null?void 0:V.rating)||0,deliveryRate:((z=L.data())==null?void 0:z.deliveryRate)||0,activePromotions:pe,totalViews:Ae,uniqueCustomers:ki.size,profileViews:Ir,menuViews:Sr,itemViews:Qn,shareClicks:Ks,whatsappShares:Tr,registeredViaLink:it,todayViews:gt,followersCount:dn})}catch(L){console.error("   :",L)}finally{r(!1),a(!1)}};_.useEffect(()=>{j()},[t==null?void 0:t.uid]);const I=()=>{a(!0),j()},T=F=>({pending:{label:" ",color:"bg-yellow-100 text-yellow-700",icon:Rt},accepted:{label:"",color:"bg-blue-100 text-blue-700",icon:Xe},preparing:{label:" ",color:"bg-orange-100 text-orange-700",icon:fc},ready:{label:" ",color:"bg-purple-100 text-purple-700",icon:Bt},out_for_delivery:{label:" ",color:"bg-indigo-100 text-indigo-700",icon:Ts},delivered:{label:" ",color:"bg-green-100 text-green-700",icon:Xe},cancelled:{label:"",color:"bg-red-100 text-red-700",icon:Dn}})[F]||{label:F,color:"bg-gray-100 text-gray-700",icon:Rt},D=F=>{switch(F){case"gold":return{label:"",color:"from-yellow-400 to-amber-500",icon:""};case"silver":return{label:"",color:"from-gray-300 to-gray-400",icon:""};default:return{label:"",color:"from-orange-500 to-orange-600",icon:""}}};if(s)return n.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 border-4 border-amber-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:" ..."})]})});const S=(o==null?void 0:o.packageType)==="premium",W=D(o==null?void 0:o.sellerTier);return S?n.jsxs("div",{className:"space-y-6 pb-24 -mx-4 -mt-4",children:[n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"h-40 sm:h-48 bg-gradient-to-br from-gray-900 via-gray-800 to-black relative overflow-hidden",children:[n.jsxs("div",{className:"absolute inset-0",children:[n.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-amber-500/20 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-purple-500/20 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2"})]}),n.jsx("button",{onClick:I,disabled:i,className:"absolute top-4 left-4 p-2 bg-white/10 hover:bg-white/20 rounded-xl transition z-10",children:n.jsx(os,{className:`w-5 h-5 text-white ${i?"animate-spin":""}`})}),n.jsx("div",{className:"absolute top-4 right-4 z-10",children:n.jsxs("div",{className:"bg-gradient-to-r from-amber-500 to-orange-500 px-4 py-1.5 rounded-full flex items-center gap-2 shadow-lg",children:[n.jsx(Vt,{className:"w-4 h-4 text-white"}),n.jsx("span",{className:"text-white font-bold text-sm",children:" "})]})})]}),n.jsx("div",{className:"relative px-4 -mt-16",children:n.jsxs("div",{className:"bg-white rounded-3xl shadow-xl p-5",children:[n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsxs("div",{className:"relative -mt-12",children:[n.jsx("div",{className:"w-24 h-24 rounded-2xl bg-white shadow-xl overflow-hidden border-4 border-white",children:o!=null&&o.logoUrl?n.jsx("img",{src:o.logoUrl,alt:o.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-gradient-to-br from-amber-100 to-orange-100 flex items-center justify-center",children:n.jsx(lt,{className:"w-10 h-10 text-amber-500"})})}),(o==null?void 0:o.isVerified)&&n.jsx("div",{className:"absolute -bottom-1 -right-1 w-7 h-7 bg-blue-500 rounded-full flex items-center justify-center border-2 border-white",children:n.jsx(Xe,{className:"w-4 h-4 text-white"})})]}),n.jsxs("div",{className:"flex-1 pt-2",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("h1",{className:"text-xl font-bold text-gray-900",children:(o==null?void 0:o.name)||""}),n.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold text-white bg-gradient-to-r ${W.color}`,children:[W.icon," ",W.label]})]}),(o==null?void 0:o.city)&&n.jsxs("p",{className:"text-gray-500 text-sm flex items-center gap-1 mt-1",children:[n.jsx(Nt,{className:"w-3 h-3"}),o.city]}),n.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[n.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[n.jsx(go,{className:"w-4 h-4 text-amber-500 fill-amber-500"}),n.jsx("span",{className:"font-bold",children:h.averageRating.toFixed(1)})]}),n.jsx("div",{className:"text-gray-300",children:"|"}),n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-bold text-gray-900",children:h.totalOrders})," "]}),n.jsx("div",{className:"text-gray-300",children:"|"}),n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-bold text-gray-900",children:h.menuItems})," "]})]})]})]}),n.jsxs("div",{className:"flex gap-2 mt-4 overflow-x-auto pb-2 -mx-2 px-2",children:[n.jsxs(de,{to:`/menu?restaurant=${t==null?void 0:t.uid}`,className:"flex items-center gap-2 bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-xl text-sm font-semibold whitespace-nowrap",children:[n.jsx(Rl,{className:"w-4 h-4"})," "]}),n.jsxs(de,{to:"/owner/edit",className:"flex items-center gap-2 bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-xl text-sm font-semibold whitespace-nowrap",children:[n.jsx(gc,{className:"w-4 h-4"}),""]}),n.jsxs(de,{to:"/owner/promotion",className:"flex items-center gap-2 bg-purple-100 hover:bg-purple-200 text-purple-700 px-4 py-2 rounded-xl text-sm font-semibold whitespace-nowrap",children:[n.jsx(hr,{className:"w-4 h-4"})," "]})]})]})})]}),n.jsxs("div",{className:"px-4 space-y-3",children:[h.pendingOrders>0&&n.jsx(de,{to:"/owner/orders",className:"block bg-gradient-to-r from-red-500 to-orange-500 rounded-2xl p-4 text-white shadow-lg animate-pulse",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:n.jsx(hc,{className:"w-6 h-6"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("h3",{className:"font-bold text-lg",children:[" ",h.pendingOrders,"  !"]}),n.jsx("p",{className:"text-white/80 text-sm",children:"  "})]}),n.jsx($n,{className:"w-6 h-6"})]})}),!(o!=null&&o.bankName)&&n.jsx(de,{to:"/owner/edit#bank",className:"block bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-2xl p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-amber-500 rounded-xl flex items-center justify-center",children:n.jsx(Pn,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-bold text-amber-700",children:"  "}),n.jsx("p",{className:"text-sm text-amber-600",children:"   "})]})]})})]}),n.jsx("div",{className:"px-4",children:n.jsxs("div",{className:"bg-gradient-to-br from-purple-600 via-pink-600 to-rose-500 rounded-2xl p-5 text-white shadow-xl relative overflow-hidden",children:[n.jsxs("div",{className:"absolute inset-0 opacity-20",children:[n.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white rounded-full -translate-y-1/2 translate-x-1/2"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white rounded-full translate-y-1/2 -translate-x-1/2"})]}),n.jsxs("div",{className:"relative z-10",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(Op,{className:"w-6 h-6"}),n.jsx("h2",{className:"text-lg font-bold",children:"  !"})]}),n.jsx("p",{className:"text-white/80 text-sm mb-4",children:"           !"}),n.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-xl p-3 mb-4",children:[n.jsx("p",{className:"text-white/60 text-xs mb-1",children:"  :"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"flex-1 bg-white/10 rounded-lg p-2 text-sm font-mono truncate",dir:"ltr",children:[window.location.origin,"/menu?restaurant=",t==null?void 0:t.uid]}),n.jsx("button",{onClick:v,className:`p-2 rounded-lg transition ${g?"bg-green-500":"bg-white/20 hover:bg-white/30"}`,children:g?n.jsx(Xe,{className:"w-5 h-5"}):n.jsx(T1,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:k,className:"flex-1 flex items-center justify-center gap-2 bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-xl transition",children:[n.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:n.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),""]}),n.jsxs("button",{onClick:P,className:"flex-1 flex items-center justify-center gap-2 bg-white text-purple-600 font-bold py-3 rounded-xl hover:bg-purple-50 transition",children:[n.jsx(Op,{className:"w-5 h-5"}),""]}),n.jsxs(de,{to:`/menu?restaurant=${t==null?void 0:t.uid}`,className:"flex items-center justify-center gap-2 bg-white/20 hover:bg-white/30 px-4 py-3 rounded-xl transition",children:[n.jsx(Rl,{className:"w-5 h-5"}),""]})]}),n.jsxs("div",{className:"grid grid-cols-5 gap-2 mt-4 pt-4 border-t border-white/20",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xl font-bold",children:h.followersCount}),n.jsx("p",{className:"text-white/70 text-[10px]",children:" "})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xl font-bold",children:h.todayViews}),n.jsx("p",{className:"text-white/70 text-[10px]",children:" "})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xl font-bold",children:h.profileViews}),n.jsx("p",{className:"text-white/70 text-[10px]",children:" "})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xl font-bold",children:h.whatsappShares}),n.jsx("p",{className:"text-white/70 text-[10px]",children:" "})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xl font-bold",children:h.registeredViaLink}),n.jsx("p",{className:"text-white/70 text-[10px]",children:" "})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2 pt-2 border-t border-white/20",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-2xl font-bold",children:h.uniqueCustomers}),n.jsx("p",{className:"text-white/70 text-xs",children:""})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-2xl font-bold",children:h.totalViews}),n.jsx("p",{className:"text-white/70 text-xs",children:""})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-2xl font-bold",children:h.totalOrders}),n.jsx("p",{className:"text-white/70 text-xs",children:""})]})]})]})]})}),n.jsx("div",{className:"px-4",children:n.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-emerald-700 rounded-2xl p-5 text-white shadow-xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx($x,{className:"w-6 h-6"}),n.jsx("h2",{className:"text-lg font-bold",children:" "})]}),n.jsx(de,{to:"/owner/orders",className:"text-white/80 text-sm hover:text-white",children:"  "})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-xl p-4",children:[n.jsx("p",{className:"text-white/70 text-sm mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold",children:[h.todayRevenue.toFixed(0)," ",n.jsx("span",{className:"text-sm",children:"."})]}),n.jsxs("p",{className:"text-white/60 text-xs mt-1",children:[h.todayOrders," "]})]}),n.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-xl p-4",children:[n.jsx("p",{className:"text-white/70 text-sm mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold",children:[h.weekRevenue.toFixed(0)," ",n.jsx("span",{className:"text-sm",children:"."})]}),n.jsxs("p",{className:"text-white/60 text-xs mt-1",children:[h.weekOrders," "]})]}),n.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-xl p-4",children:[n.jsx("p",{className:"text-white/70 text-sm mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold",children:[h.monthRevenue.toFixed(0)," ",n.jsx("span",{className:"text-sm",children:"."})]}),n.jsxs("p",{className:"text-white/60 text-xs mt-1",children:[h.monthOrders," "]})]}),n.jsxs("div",{className:"bg-white/20 backdrop-blur rounded-xl p-4 ring-2 ring-white/30",children:[n.jsx("p",{className:"text-white/70 text-sm mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold",children:[h.totalRevenue.toFixed(0)," ",n.jsx("span",{className:"text-sm",children:"."})]}),n.jsxs("p",{className:"text-white/60 text-xs mt-1",children:[h.deliveredOrders," "]})]})]})]})}),n.jsxs("div",{className:"px-4",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:"  "}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs(de,{to:"/owner/orders",className:"bg-white rounded-2xl shadow-lg p-4 hover:shadow-xl transition border border-gray-100",children:[n.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mb-3",children:n.jsx(pc,{className:"w-6 h-6 text-white"})}),n.jsx("h3",{className:"font-bold text-gray-900",children:""}),n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsxs("span",{className:"bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded-full text-xs font-bold",children:[h.pendingOrders," "]}),n.jsxs("span",{className:"bg-orange-100 text-orange-700 px-2 py-0.5 rounded-full text-xs font-bold",children:[h.preparingOrders," "]})]})]}),n.jsxs(de,{to:"/owner/menu",className:"bg-white rounded-2xl shadow-lg p-4 hover:shadow-xl transition border border-gray-100",children:[n.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-500 to-orange-500 rounded-xl flex items-center justify-center mb-3",children:n.jsx(xo,{className:"w-6 h-6 text-white"})}),n.jsx("h3",{className:"font-bold text-gray-900",children:""}),n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsxs("span",{className:"bg-green-100 text-green-700 px-2 py-0.5 rounded-full text-xs font-bold",children:[h.availableItems," "]}),n.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-0.5 rounded-full text-xs font-bold",children:[h.menuItems," "]})]})]}),n.jsxs(de,{to:"/owner/promotion",className:"bg-white rounded-2xl shadow-lg p-4 hover:shadow-xl transition border border-gray-100",children:[n.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center mb-3",children:n.jsx(hr,{className:"w-6 h-6 text-white"})}),n.jsx("h3",{className:"font-bold text-gray-900",children:""}),n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsxs("span",{className:"bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full text-xs font-bold",children:[h.activePromotions," "]}),n.jsxs("span",{className:"bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full text-xs font-bold flex items-center gap-1",children:[n.jsx(Rl,{className:"w-3 h-3"}),h.totalViews]})]})]}),n.jsxs(de,{to:"/owner/edit",className:"bg-white rounded-2xl shadow-lg p-4 hover:shadow-xl transition border border-gray-100",children:[n.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-600 to-gray-700 rounded-xl flex items-center justify-center mb-3",children:n.jsx(sh,{className:"w-6 h-6 text-white"})}),n.jsx("h3",{className:"font-bold text-gray-900",children:""}),n.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"  "})]})]})]}),n.jsxs("div",{className:"px-4",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:"  "}),n.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 border border-gray-100",children:n.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[n.jsxs(de,{to:"/owner/orders?status=pending",className:"text-center p-3 bg-yellow-50 rounded-xl hover:bg-yellow-100 transition",children:[n.jsx(Rt,{className:"w-6 h-6 text-yellow-500 mx-auto mb-1"}),n.jsx("p",{className:"text-lg font-bold text-yellow-700",children:h.pendingOrders}),n.jsx("p",{className:"text-xs text-yellow-600",children:""})]}),n.jsxs(de,{to:"/owner/orders?status=preparing",className:"text-center p-3 bg-orange-50 rounded-xl hover:bg-orange-100 transition",children:[n.jsx(fc,{className:"w-6 h-6 text-orange-500 mx-auto mb-1"}),n.jsx("p",{className:"text-lg font-bold text-orange-700",children:h.preparingOrders}),n.jsx("p",{className:"text-xs text-orange-600",children:""})]}),n.jsxs(de,{to:"/owner/orders?status=delivered",className:"text-center p-3 bg-green-50 rounded-xl hover:bg-green-100 transition",children:[n.jsx(Xe,{className:"w-6 h-6 text-green-500 mx-auto mb-1"}),n.jsx("p",{className:"text-lg font-bold text-green-700",children:h.deliveredOrders}),n.jsx("p",{className:"text-xs text-green-600",children:""})]}),n.jsxs(de,{to:"/owner/orders?status=cancelled",className:"text-center p-3 bg-red-50 rounded-xl hover:bg-red-100 transition",children:[n.jsx(Dn,{className:"w-6 h-6 text-red-500 mx-auto mb-1"}),n.jsx("p",{className:"text-lg font-bold text-red-700",children:h.cancelledOrders}),n.jsx("p",{className:"text-xs text-red-600",children:""})]})]})})]}),b.length>0&&n.jsxs("div",{className:"px-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"  "}),n.jsx(de,{to:"/owner/menu",className:"text-amber-600 text-sm font-semibold",children:"  "})]}),n.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100",children:b.map((F,V)=>n.jsxs("div",{className:`flex items-center gap-3 p-4 ${V!==b.length-1?"border-b":""}`,children:[n.jsx("span",{className:"text-2xl w-8",children:V===0?"":V===1?"":V===2?"":`#${V+1}`}),n.jsx("div",{className:"flex-1",children:n.jsx("p",{className:"font-semibold text-gray-900",children:F.name})}),n.jsxs("div",{className:"bg-amber-100 text-amber-700 px-3 py-1 rounded-full text-sm font-bold",children:[F.count," "]})]},V))})]}),O.length>0&&n.jsxs("div",{className:"px-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"  "}),n.jsx(de,{to:"/owner/orders",className:"text-blue-600 text-sm font-semibold",children:"  "})]}),n.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100",children:O.map((F,V)=>{var $,M,G,Y;const z=T(F.status),L=z.icon;return n.jsxs(de,{to:"/owner/orders",className:`flex items-center gap-3 p-4 hover:bg-gray-50 transition ${V!==O.length-1?"border-b":""}`,children:[n.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${z.color}`,children:n.jsx(L,{className:"w-5 h-5"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("p",{className:"font-semibold text-gray-900",children:[(($=F.items)==null?void 0:$.length)||0," "]}),n.jsx("p",{className:"text-xs text-gray-500",children:((G=(M=F.createdAt)==null?void 0:M.toDate)==null?void 0:G.call(M).toLocaleDateString("ar-SA"))||""})]}),n.jsxs("div",{className:"text-left",children:[n.jsxs("p",{className:"font-bold text-green-600",children:[(Y=F.subtotal)==null?void 0:Y.toFixed(0)," ."]}),n.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${z.color}`,children:z.label})]})]},F.id)})})]}),n.jsxs("div",{className:"px-4",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:"  "}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[n.jsxs(de,{to:"/owner/edit#hiring",className:`flex items-center gap-3 bg-white rounded-2xl shadow p-4 border ${o!=null&&o.isHiring?"border-purple-300 bg-purple-50":"border-gray-100"}`,children:[n.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${o!=null&&o.isHiring?"bg-purple-500":"bg-gray-200"}`,children:n.jsx(mc,{className:`w-5 h-5 ${o!=null&&o.isHiring?"text-white":"text-gray-500"}`})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-semibold text-gray-900",children:" "}),n.jsx("p",{className:"text-xs text-gray-500",children:o!=null&&o.isHiring?"   ":"    "})]})]}),n.jsxs(de,{to:"/owner/edit#bank",className:`flex items-center gap-3 bg-white rounded-2xl shadow p-4 border ${o!=null&&o.bankName?"border-green-300 bg-green-50":"border-gray-100"}`,children:[n.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${o!=null&&o.bankName?"bg-green-500":"bg-gray-200"}`,children:n.jsx(Pn,{className:`w-5 h-5 ${o!=null&&o.bankName?"text-white":"text-gray-500"}`})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-semibold text-gray-900",children:" "}),n.jsx("p",{className:"text-xs text-gray-500",children:o!=null&&o.bankName?` ${o.bankName}`:"  "})]})]}),n.jsxs(de,{to:"/owner/packages",className:"flex items-center gap-3 bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl shadow p-4 border border-amber-200",children:[n.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-amber-500 to-orange-500 rounded-xl flex items-center justify-center",children:n.jsx(Vt,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-semibold text-amber-700",children:" "}),n.jsx("p",{className:"text-xs text-amber-600",children:"  "})]})]}),n.jsxs(de,{to:`/menu?restaurant=${t==null?void 0:t.uid}`,className:"flex items-center gap-3 bg-white rounded-2xl shadow p-4 border border-gray-100",children:[n.jsx("div",{className:"w-10 h-10 bg-sky-500 rounded-xl flex items-center justify-center",children:n.jsx(k6,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-semibold text-gray-900",children:" "}),n.jsx("p",{className:"text-xs text-gray-500",children:"    "})]})]})]})]}),(o==null?void 0:o.bankName)&&n.jsx("div",{className:"px-4",children:n.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-2xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(Pn,{className:"w-5 h-5 text-green-600"}),n.jsx("h3",{className:"font-bold text-green-800",children:"   "})]}),n.jsxs("div",{className:"bg-white rounded-xl p-3 space-y-2",children:[n.jsxs("p",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-semibold",children:":"})," ",o.bankName]}),n.jsxs("p",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-semibold",children:" :"})," ",o.bankAccountName]}),n.jsxs("p",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-semibold",children:" :"})," ",o.bankAccountNumber]})]}),n.jsx("p",{className:"text-xs text-green-600 mt-2",children:"      "})]})})]}):n.jsxs("div",{className:"space-y-6 pb-20",children:[n.jsxs("div",{className:"bg-gradient-to-br from-amber-500 via-orange-500 to-red-500 rounded-3xl shadow-2xl p-6 text-white relative overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 opacity-10",children:n.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white rounded-full -translate-y-1/2 translate-x-1/2"})}),n.jsxs("div",{className:"relative z-10 text-center py-6",children:[n.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Vt,{className:"w-10 h-10 text-yellow-300"})}),n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"    "}),n.jsx("p",{className:"text-white/80 mb-4",children:"         !"}),n.jsxs(de,{to:"/owner/packages",className:"inline-flex items-center gap-2 bg-white text-amber-600 font-bold px-6 py-3 rounded-xl hover:bg-yellow-50 transition shadow-lg",children:[n.jsx(Us,{className:"w-5 h-5"}),"  "]})]})]}),!(o!=null&&o.bankName)&&n.jsx(de,{to:"/owner/edit#bank",className:"block bg-gradient-to-r from-red-50 to-orange-50 border-2 border-red-200 rounded-2xl p-4 hover:shadow-lg transition",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-xl flex items-center justify-center flex-shrink-0",children:n.jsx(Pn,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-bold text-red-700",children:"   !"}),n.jsx("p",{className:"text-sm text-red-600",children:"     "})]})]})}),h.pendingOrders>0&&n.jsx(de,{to:"/owner/orders",className:"block bg-gradient-to-r from-yellow-50 to-amber-50 border-2 border-yellow-300 rounded-2xl p-4 hover:shadow-lg transition animate-pulse",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-yellow-500 rounded-xl flex items-center justify-center flex-shrink-0",children:n.jsx(jr,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("h3",{className:"font-bold text-yellow-700",children:["  ",h.pendingOrders,"   !"]}),n.jsx("p",{className:"text-sm text-yellow-600",children:"   "})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[n.jsxs(de,{to:"/owner/packages",className:"rounded-2xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-1 bg-gradient-to-br from-amber-50 via-yellow-50 to-orange-50 p-5 ring-2 ring-amber-300 relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-r from-amber-500 via-yellow-400 to-orange-500 py-1.5 text-center",children:n.jsxs("div",{className:"flex items-center justify-center gap-2 text-white text-sm font-bold",children:[n.jsx(Us,{className:"w-4 h-4"}),n.jsx("span",{children:" "}),n.jsx(Us,{className:"w-4 h-4"})]})}),n.jsx("div",{className:"h-6"}),n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx(Vt,{className:"w-8 h-8 text-amber-500"}),n.jsx("h3",{className:"text-lg font-extrabold text-gray-900",children:"  "})]}),n.jsx("p",{className:"text-sm text-gray-600",children:"      !"})]}),n.jsxs(de,{to:"/owner/menu",className:"rounded-2xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-1 bg-gradient-to-br from-yellow-50 to-white p-5",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx(xo,{className:"w-8 h-8 text-yellow-500"}),n.jsx("h3",{className:"text-lg font-extrabold text-gray-900",children:" "})]}),n.jsx("p",{className:"text-sm text-gray-600",children:"   ."})]}),n.jsxs(de,{to:"/owner/orders",className:"rounded-2xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-1 bg-gradient-to-br from-green-50 to-white p-5",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx(pc,{className:"w-8 h-8 text-green-500"}),n.jsx("h3",{className:"text-lg font-extrabold text-gray-900",children:" "})]}),n.jsx("p",{className:"text-sm text-gray-600",children:"   ."}),h.pendingOrders>0&&n.jsxs("span",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-xs font-bold mt-2 inline-block",children:[h.pendingOrders," !"]})]}),n.jsxs(de,{to:"/owner/edit",className:"rounded-2xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-1 bg-gradient-to-br from-blue-50 to-white p-5",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx(sh,{className:"w-8 h-8 text-blue-500"}),n.jsx("h3",{className:"text-lg font-extrabold text-gray-900",children:""})]}),n.jsx("p",{className:"text-sm text-gray-600",children:"  ."})]})]}),n.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-gray-800 rounded-2xl shadow-lg p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(Vt,{className:"w-6 h-6 text-amber-400"}),n.jsx("h3",{className:"text-lg font-bold",children:"   "})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-300 text-sm",children:[n.jsx(ou,{className:"w-4 h-4 text-green-400"}),n.jsx("span",{children:"  "})]}),n.jsxs("div",{className:"flex items-center gap-2 text-gray-300 text-sm",children:[n.jsx(go,{className:"w-4 h-4 text-yellow-400"}),n.jsx("span",{children:"  "})]}),n.jsxs("div",{className:"flex items-center gap-2 text-gray-300 text-sm",children:[n.jsx(hr,{className:"w-4 h-4 text-purple-400"}),n.jsx("span",{children:"  "})]}),n.jsxs("div",{className:"flex items-center gap-2 text-gray-300 text-sm",children:[n.jsx(ha,{className:"w-4 h-4 text-blue-400"}),n.jsx("span",{children:"  "})]})]}),n.jsx(de,{to:"/owner/packages",className:"block w-full text-center bg-gradient-to-r from-amber-500 to-orange-500 text-white font-bold py-3 rounded-xl hover:from-amber-600 hover:to-orange-600 transition",children:"  "})]})]})},wD=({kind:t,message:e,onClose:s})=>{const r=t==="success"?"bg-green-600":t==="error"?"bg-rose-600":t==="warning"?"bg-amber-500":"bg-slate-800";return _.useEffect(()=>{const i=setTimeout(s,2500);return()=>clearTimeout(i)},[s]),n.jsx("div",{className:`fixed bottom-4 right-4 z-50 rounded-xl px-4 py-3 text-white shadow-lg ${r}`,children:e})},Od=()=>({name:"",desc:"",price:0,available:!0,file:null,discountPercent:0,discountExpiresAt:""});async function uw(t,e=900,s=.8){try{const r=await createImageBitmap(t),i=Math.min(1,e/r.width),a=Math.round(r.width*i),o=Math.round(r.height*i),l=document.createElement("canvas");l.width=a,l.height=o,l.getContext("2d").drawImage(r,0,0,a,o);const u=t.type.includes("png")?"image/png":"image/jpeg";return await new Promise(p=>l.toBlob(g=>p(g),u,s))}catch{return t}}const bD=()=>{const{user:t}=Ue(),e=cn(),[s,r]=_.useState([]),[i,a]=_.useState(!0),[o,l]=_.useState(Od()),[d,u]=_.useState(!1),[h,p]=_.useState(null),[g,y]=_.useState(Od()),[w,C]=_.useState(!1),E=_.useRef(null),[N,v]=_.useState(null),k=(S,W)=>v({kind:S,message:W}),P=Yh(Ps),O=_.useRef(null),U=async()=>{if(!t)return;a(!0);const S=je(re(B,"menuItems"),Ne("ownerId","==",t.uid)),W=await ve(S);r(W.docs.map(F=>({id:F.id,...F.data()}))),a(!1)};_.useEffect(()=>{U()},[t]);const b=async S=>{if(S.preventDefault(),!t){k("warning","    ");return}const W=Number(o.price||0);if(!o.name.trim()){k("warning","   ");return}if(!Number.isFinite(W)||W<=0){k("warning","   ");return}u(!0);const F="temp_"+Date.now(),V=o.file?URL.createObjectURL(o.file):void 0,z={_tempId:F,_optimistic:!0,_progress:o.file?1:100,name:o.name,desc:o.desc||"",price:W,imageUrl:V,available:o.available??!0,ownerId:t.uid};r(L=>[z,...L]);try{let L;if(o.file){const G=await uw(o.file),Y=o.file.name.replace(/\s+/g,"_").slice(-60),ie=`menuImages/${t.uid}_${Date.now()}_${Y}`,le=Nr(P,ie),pe=Xu(le,G,{contentType:o.file.type||"image/jpeg"});await new Promise((Ae,De)=>{pe.on("state_changed",$e=>{const jt=Math.round($e.bytesTransferred/$e.totalBytes*100);r(Pt=>Pt.map(rt=>rt._tempId===F?{...rt,_progress:jt}:rt))},De,async()=>{const $e=await br(pe.snapshot.ref);L=`${$e}${$e.includes("?")?"&":"?"}v=${Date.now()}`,Ae()})})}const $={name:z.name,desc:z.desc,price:W,imageUrl:L||"",available:z.available,ownerId:t.uid,...z.categoryId?{categoryId:z.categoryId}:{},...o.discountPercent&&o.discountPercent>0?{discountPercent:o.discountPercent}:{},...o.discountExpiresAt?{discountExpiresAt:new Date(o.discountExpiresAt)}:{}},M=await tt(re(B,"menuItems"),$);r(G=>G.map(Y=>Y._tempId===F?{...Y,id:M.id,imageUrl:L||Y.imageUrl,_optimistic:!1,_progress:100}:Y)),k("success","    ")}catch(L){r($=>$.filter(M=>M._tempId!==F)),k("error",`   : ${(L==null?void 0:L.message)||L}`)}finally{u(!1),l(Od()),O.current&&(O.current.value=""),V&&URL.revokeObjectURL(V)}},m=async(S,W)=>{if(S){r(F=>F.map(V=>V.id===S?{...V,available:!W}:V));try{await fe(X(B,"menuItems",S),{available:!W}),k("success","  ")}catch{r(F=>F.map(V=>V.id===S?{...V,available:!!W}:V)),k("error","  .  .")}}},j=async S=>{if(!S||!await e.confirm("       ",{dangerous:!0,title:" "}))return;const F=s;r(V=>V.filter(z=>z.id!==S));try{await sn(X(B,"menuItems",S)),k("success"," ")}catch{r(F),k("error","  .  .")}},I=S=>{p(S.id||null),y({...S,file:null})},T=()=>{p(null),y(Od()),E.current&&(E.current.value="")},D=async S=>{if(S.preventDefault(),!t||!h)return;const W=Number(g.price||0);if(!g.name.trim()){k("warning","   ");return}if(!Number.isFinite(W)||W<=0){k("warning","   ");return}C(!0);const F=s;r(V=>V.map(z=>z.id===h?{...z,name:g.name,desc:g.desc,price:W,available:g.available}:z));try{let V=g.imageUrl;if(g.file){const z=await uw(g.file),L=g.file.name.replace(/\s+/g,"_").slice(-60),$=`menuImages/${t.uid}_${Date.now()}_${L}`,M=Nr(P,$),G=Xu(M,z,{contentType:g.file.type||"image/jpeg"});await new Promise((Y,ie)=>{G.on("state_changed",null,ie,async()=>{const le=await br(G.snapshot.ref);V=`${le}${le.includes("?")?"&":"?"}v=${Date.now()}`,Y()})})}await fe(X(B,"menuItems",h),{name:g.name,desc:g.desc||"",price:W,available:g.available,...V?{imageUrl:V}:{},discountPercent:g.discountPercent||0,...g.discountExpiresAt?{discountExpiresAt:new Date(g.discountExpiresAt)}:{discountExpiresAt:null}}),V&&r(z=>z.map(L=>L.id===h?{...L,imageUrl:V}:L)),k("success","    "),T()}catch(V){r(F),k("error",`  : ${(V==null?void 0:V.message)||V}`)}finally{C(!1)}};return i?n.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 space-y-3",children:[n.jsx("div",{className:"h-6 w-40 bg-gray-200 rounded animate-pulse"}),n.jsx("div",{className:"h-10 w-full bg-gray-200 rounded animate-pulse"}),n.jsx("div",{className:"h-24 w-full bg-gray-200 rounded animate-pulse"}),n.jsx("div",{className:"h-10 w-full bg-gray-200 rounded animate-pulse"}),n.jsx("div",{className:"h-10 w-32 bg-gray-200 rounded animate-pulse"})]}),n.jsx("div",{className:"space-y-3",children:[1,2,3].map(S=>n.jsxs("div",{className:"bg-white rounded-2xl shadow p-4 flex items-center gap-4",children:[n.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-xl animate-pulse"}),n.jsxs("div",{className:"flex-1 space-y-2",children:[n.jsx("div",{className:"h-4 w-48 bg-gray-200 rounded animate-pulse"}),n.jsx("div",{className:"h-3 w-64 bg-gray-200 rounded animate-pulse"}),n.jsx("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"})]})]},S))})]}):n.jsxs(n.Fragment,{children:[N&&n.jsx(wD,{kind:N.kind,message:N.message,onClose:()=>v(null)}),n.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[n.jsxs("form",{onSubmit:b,className:"bg-white rounded-2xl shadow p-6 space-y-3",children:[n.jsx("h2",{className:"text-lg font-bold",children:" "}),n.jsx("input",{className:"w-full border rounded-xl p-3",placeholder:" ",value:o.name,onChange:S=>l({...o,name:S.target.value})}),n.jsx("textarea",{className:"w-full border rounded-xl p-3",placeholder:" ()",value:o.desc,onChange:S=>l({...o,desc:S.target.value})}),n.jsx("input",{className:"w-full border rounded-xl p-3",placeholder:"",type:"number",min:0,step:.5,inputMode:"decimal",value:Number.isFinite(o.price)?o.price:0,onChange:S=>l({...o,price:Number(S.target.value)})}),n.jsxs("div",{className:"border border-dashed border-amber-300 rounded-xl p-4 bg-amber-50/50 space-y-3",children:[n.jsx("h3",{className:"text-sm font-bold text-amber-700 flex items-center gap-2",children:"   ()"}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"  %"}),n.jsx("input",{className:"w-full border rounded-xl p-3",placeholder:": 20",type:"number",min:0,max:100,value:o.discountPercent||"",onChange:S=>l({...o,discountPercent:Number(S.target.value)||0})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:" "}),n.jsx("input",{className:"w-full border rounded-xl p-3",type:"date",value:o.discountExpiresAt?typeof o.discountExpiresAt=="string"?o.discountExpiresAt:new Date(o.discountExpiresAt).toISOString().split("T")[0]:"",onChange:S=>l({...o,discountExpiresAt:S.target.value})})]})]}),o.discountPercent&&o.discountPercent>0&&n.jsxs("div",{className:"text-sm bg-green-100 text-green-700 p-2 rounded-lg",children:["  : ",n.jsxs("strong",{children:[(o.price-o.price*(o.discountPercent/100)).toFixed(2)," ."]}),n.jsxs("span",{className:"line-through text-gray-400 mr-2",children:[o.price.toFixed(2)," ."]})]})]}),n.jsx("input",{ref:O,className:"w-full border rounded-xl p-3",type:"file",accept:"image/*",onChange:S=>{var W;return l({...o,file:((W=S.target.files)==null?void 0:W[0])||null})}}),n.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[n.jsx("input",{type:"checkbox",checked:o.available,onChange:S=>l({...o,available:S.target.checked})}),""]}),n.jsx("button",{className:"px-4 py-2 rounded-xl bg-gray-900 text-white disabled:opacity-60",disabled:d,children:d?" ":""})]}),n.jsxs("div",{className:"space-y-3",children:[s.map(S=>n.jsx("div",{className:"bg-white rounded-2xl shadow p-4",children:h===S.id?n.jsxs("form",{onSubmit:D,className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("img",{src:g.file?URL.createObjectURL(g.file):g.imageUrl||"",className:"w-20 h-20 object-cover rounded-xl bg-gray-100",onError:W=>{W.currentTarget.style.display="none"}}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:" "}),n.jsx("input",{ref:E,type:"file",accept:"image/*",className:"w-full text-sm border rounded-lg p-2",onChange:W=>{var F;return y({...g,file:((F=W.target.files)==null?void 0:F[0])||null})}})]})]}),n.jsx("input",{className:"w-full border rounded-xl p-3",placeholder:" ",value:g.name,onChange:W=>y({...g,name:W.target.value})}),n.jsx("textarea",{className:"w-full border rounded-xl p-3",placeholder:" ()",value:g.desc||"",onChange:W=>y({...g,desc:W.target.value})}),n.jsx("input",{className:"w-full border rounded-xl p-3",placeholder:"",type:"number",min:0,step:.5,inputMode:"decimal",value:Number.isFinite(g.price)?g.price:0,onChange:W=>y({...g,price:Number(W.target.value)})}),n.jsxs("div",{className:"border border-dashed border-amber-300 rounded-xl p-4 bg-amber-50/50 space-y-3",children:[n.jsx("h3",{className:"text-sm font-bold text-amber-700 flex items-center gap-2",children:" "}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"  %"}),n.jsx("input",{className:"w-full border rounded-xl p-3",placeholder:": 20",type:"number",min:0,max:100,value:g.discountPercent||"",onChange:W=>y({...g,discountPercent:Number(W.target.value)||0})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:" "}),n.jsx("input",{className:"w-full border rounded-xl p-3",type:"date",value:g.discountExpiresAt?typeof g.discountExpiresAt=="string"?g.discountExpiresAt:new Date(g.discountExpiresAt).toISOString().split("T")[0]:"",onChange:W=>y({...g,discountExpiresAt:W.target.value})})]})]}),g.discountPercent&&g.discountPercent>0&&n.jsxs("div",{className:"text-sm bg-green-100 text-green-700 p-2 rounded-lg",children:["  : ",n.jsxs("strong",{children:[(g.price-g.price*(g.discountPercent/100)).toFixed(2)," ."]}),n.jsxs("span",{className:"line-through text-gray-400 mr-2",children:[g.price.toFixed(2)," ."]})]}),g.discountPercent&&g.discountPercent>0&&n.jsx("button",{type:"button",onClick:()=>y({...g,discountPercent:0,discountExpiresAt:""}),className:"text-xs text-red-500 hover:text-red-700",children:"  "})]}),n.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[n.jsx("input",{type:"checkbox",checked:g.available,onChange:W=>y({...g,available:W.target.checked})}),""]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{type:"submit",disabled:w,className:"flex-1 px-4 py-2 rounded-xl bg-green-600 text-white disabled:opacity-60",children:w?" ":"  "}),n.jsx("button",{type:"button",onClick:T,disabled:w,className:"px-4 py-2 rounded-xl bg-gray-400 text-white disabled:opacity-60",children:""})]})]}):n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:S.imageUrl||"",className:"w-20 h-20 object-cover rounded-xl bg-gray-100",onError:W=>{W.currentTarget.style.display="none"}}),S._optimistic&&n.jsx("div",{className:"absolute -bottom-2 left-0 right-0",children:n.jsx("div",{className:"h-1 w-20 rounded bg-gray-200 overflow-hidden",children:n.jsx("div",{className:"h-full bg-yellow-500 transition-[width]",style:{width:`${S._progress||1}%`}})})})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-bold",children:S.name}),S.desc&&n.jsx("div",{className:"text-sm text-gray-600",children:S.desc}),(()=>{var z,L,$,M,G,Y;const W=S.discountPercent&&S.discountPercent>0,F=((L=(z=S.discountExpiresAt)==null?void 0:z.toDate)==null?void 0:L.call(z))||(S.discountExpiresAt?new Date(S.discountExpiresAt):null),V=!F||F>new Date;return W&&V?n.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap",children:[n.jsxs("span",{className:"font-bold text-green-600",children:[(S.price-S.price*((S.discountPercent||0)/100)).toFixed(2)," ."]}),n.jsxs("span",{className:"text-sm text-gray-400 line-through",children:[(M=($=S.price)==null?void 0:$.toFixed)==null?void 0:M.call($,2)," ."]}),n.jsxs("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:[" ",S.discountPercent,"%"]})]}):n.jsxs("div",{className:"font-semibold mt-1",children:[(Y=(G=S.price)==null?void 0:G.toFixed)==null?void 0:Y.call(G,2)," ."]})})(),S._optimistic&&n.jsx("div",{className:"text-xs text-yellow-600 mt-1",children:" "})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsx("button",{onClick:()=>I(S),disabled:!!S._optimistic,className:"px-3 py-2 rounded-xl text-sm bg-amber-500 text-white disabled:opacity-50",children:" "}),n.jsx("button",{onClick:()=>m(S.id,S.available),disabled:!!S._optimistic,className:"px-3 py-2 rounded-xl text-sm bg-blue-600 text-white disabled:opacity-50",children:S.available?"":""}),n.jsx("button",{onClick:()=>j(S.id),disabled:!!S._optimistic,className:"px-3 py-2 rounded-xl text-sm bg-red-600 text-white disabled:opacity-50",children:""})]})]})},S.id||S._tempId)),s.length===0&&n.jsx("div",{className:"text-gray-600",children:"   ."})]})]})]})},hw=t=>({pending:"  ",accepted:"  ",preparing:"  ",ready:" ",out_for_delivery:"  ",delivered:"  ",cancelled:" "})[t]||t,ND=t=>{switch(t){case"pending":return"bg-gray-200 text-gray-800";case"accepted":return"bg-blue-200 text-blue-800";case"preparing":return"bg-yellow-200 text-yellow-800";case"ready":return"bg-purple-200 text-purple-800";case"out_for_delivery":return"bg-indigo-200 text-indigo-800";case"delivered":return"bg-green-200 text-green-800";case"cancelled":return"bg-red-200 text-red-800";default:return"bg-gray-100 text-gray-700"}},jD=()=>{const{user:t}=Ue(),e=ys(),[s,r]=_.useState([]),[i,a]=_.useState(null),[o,l]=_.useState({}),d=_.useMemo(()=>(t==null?void 0:t.uid)??null,[t]);_.useEffect(()=>{if(!d)return;a(null);const h=qn(re(B,"orders"),p=>{const y=p.docs.map(w=>({id:w.id,...w.data()})).filter(w=>{var N,v;const C=w.restaurantId===d,E=((v=(N=w==null?void 0:w.items)==null?void 0:N[0])==null?void 0:v.ownerId)===d;return C||E});y.sort((w,C)=>{var v,k,P,O;const E=((k=(v=w.createdAt)==null?void 0:v.toMillis)==null?void 0:k.call(v))??0;return(((O=(P=C.createdAt)==null?void 0:P.toMillis)==null?void 0:O.call(P))??0)-E}),r(y),a(null)},p=>{console.error("Firestore error:",p),a("    .")});return()=>h()},[d]);const u=async(h,p,g)=>{const y={status:p,updatedAt:se()};if(p==="accepted"&&(g==null?void 0:g.deliveryType)==="delivery"){const w=o[h]||0;y.deliveryFee=w,y.total=(g.subtotal||0)+w}await fe(X(B,"orders",h),y)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-2xl font-extrabold text-yellow-500",children:"  "}),i&&n.jsx("div",{className:"text-red-500 text-sm mb-2",children:i}),s.map(h=>{var p,g,y,w,C;return n.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-5 text-gray-900 space-y-4 transition hover:shadow-2xl",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[n.jsxs("div",{className:"font-bold text-lg",children:[" #",h.id.slice(-6),n.jsx("span",{className:"text-gray-500 text-sm ml-2",children:(p=h.items)==null?void 0:p.map(E=>`${E.name}${E.qty}`).join("  ")})]}),n.jsxs("div",{className:"font-extrabold text-xl text-green-600",children:[(y=(g=h.total)==null?void 0:g.toFixed)==null?void 0:y.call(g,2)," ."]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm font-semibold",children:":"}),n.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-bold ${ND(h.status)}`,children:hw(h.status||"pending")})]}),n.jsxs("div",{className:"text-sm text-gray-700",children:[n.jsx("span",{className:"font-semibold",children:":"})," ",h.address]}),h.location&&n.jsxs("div",{className:"mt-3",children:[n.jsx("h3",{className:"font-semibold text-sm text-gray-800 mb-2",children:"  :"}),n.jsx("iframe",{title:`map-${h.id}`,width:"100%",height:"250",style:{borderRadius:"12px"},loading:"lazy",allowFullScreen:!0,src:`https://www.google.com/maps?q=${h.location.lat},${h.location.lng}&hl=ar&z=15&output=embed`})]}),h.status==="pending"&&h.deliveryType==="delivery"&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:[n.jsx("label",{className:"block text-sm font-bold text-amber-800 mb-2",children:"     :"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"number",min:"0",step:"0.5",placeholder:": 10",value:o[h.id]||"",onChange:E=>l(N=>({...N,[h.id]:parseFloat(E.target.value)||0})),className:"flex-1 px-4 py-3 border-2 border-amber-300 rounded-xl focus:border-amber-500 focus:ring-2 focus:ring-amber-200 text-lg font-bold text-center"}),n.jsx("span",{className:"text-amber-700 font-bold",children:"."})]}),n.jsx("p",{className:"text-xs text-amber-600 mt-2",children:"     "})]}),h.deliveryFee!==void 0&&h.deliveryFee>0&&n.jsxs("div",{className:"text-sm text-gray-700",children:[n.jsx("span",{className:"font-semibold",children:" :"})," ",(C=(w=h.deliveryFee)==null?void 0:w.toFixed)==null?void 0:C.call(w,2)," ."]}),n.jsxs("div",{className:"mt-3 grid grid-cols-2 sm:flex sm:flex-wrap gap-2",children:[!h.courierId&&["pending","accepted","preparing","ready"].includes(h.status)&&n.jsxs("button",{onClick:()=>e(`/chat?orderId=${h.id}`),className:"px-4 py-2 rounded-xl text-sm font-semibold bg-gradient-to-r from-orange-500 to-amber-500 text-white hover:shadow-lg transition flex items-center gap-2",children:[n.jsx(Uc,{className:"w-4 h-4"}),"  "]}),["accepted","preparing","ready","out_for_delivery","delivered","cancelled"].map(E=>{const N=E==="accepted"&&h.status==="pending"&&h.deliveryType==="delivery",v=o[h.id]!==void 0&&o[h.id]>=0,k=N&&!v;return n.jsx("button",{onClick:()=>u(h.id,E,h),disabled:k,className:`px-4 py-2 rounded-xl text-sm font-semibold transition ${k?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gray-100 hover:bg-gray-200"}`,title:k?"   ":"",children:hw(E)},E)})]})]},h.id)}),s.length===0&&!i&&n.jsx("div",{className:"text-gray-400 text-center text-lg",children:"    ."})]})},_D=()=>{const{user:t}=Ue(),e=Jt(),[s,r]=_.useState({name:"",phone:"",city:"",location:"",logoUrl:"",isOpen:!0,allowDelivery:!0,allowPickup:!1,commercialLicenseUrl:"",licenseStatus:void 0,licenseNotes:"",bankName:"",bankAccountName:"",bankAccountNumber:"",isHiring:!1,hiringDescription:"",hiringContact:""}),[i,a]=_.useState(null),[o,l]=_.useState(""),[d,u]=_.useState(null),[h,p]=_.useState(!0),[g,y]=_.useState(!1),w=_.useMemo(()=>!g&&!!t,[g,t]);_.useEffect(()=>{t&&(async()=>{try{const P=await Ce(X(B,"restaurants",t.uid));if(P.exists()){const O=P.data();let U={bankName:"",bankAccountName:"",bankAccountNumber:""};try{const b=await Ce(X(B,"restaurants",t.uid,"private","bankInfo"));if(b.exists()){const m=b.data();U={bankName:m.bankName??"",bankAccountName:m.bankAccountName??"",bankAccountNumber:m.bankAccountNumber??""}}}catch{}r({name:O.name??"",phone:O.phone??"",city:O.city??"",location:O.location??"",logoUrl:O.logoUrl??"",isOpen:O.isOpen??!0,allowDelivery:O.allowDelivery??!0,allowPickup:O.allowPickup??!1,commercialLicenseUrl:O.commercialLicenseUrl??"",licenseStatus:O.licenseStatus,licenseNotes:O.licenseNotes??"",bankName:U.bankName,bankAccountName:U.bankAccountName,bankAccountNumber:U.bankAccountNumber,isHiring:O.isHiring??!1,hiringDescription:O.hiringDescription??"",hiringContact:O.hiringContact??""})}}catch{e.error("   ")}finally{p(!1)}})()},[t,e]),_.useEffect(()=>()=>{o&&URL.revokeObjectURL(o)},[o]);const C=P=>{const{name:O,value:U}=P.target;r(b=>({...b,[O]:U}))},E=P=>{var U;const O=((U=P.target.files)==null?void 0:U[0])||null;if(a(O),O){const b=URL.createObjectURL(O);l(b)}else l("")},N=async()=>{if(!t||!i)return;if(!/^image\//.test(i.type)){e.warning("   ");return}const O=3*1024*1024;if(i.size>O){e.warning("        3MB");return}const U=i.name.replace(/\s+/g,"_"),b=`restaurants/${t.uid}/logo_${Date.now()}_${U}`,m=Nr(Yu,b),j={contentType:i.type||"image/jpeg",cacheControl:"public,max-age=31536000,immutable"};await uc(m,i,j);const I=await br(m);return`${I}${I.includes("?")?"&":"?"}v=${Date.now()}`},v=async(P,O)=>{if(!t||!P)return;if(!/^(image\/|application\/pdf)/.test(P.type)){e.warning("      PDF");return}const b=5*1024*1024;if(P.size>b){e.warning("        5MB");return}const m=P.name.replace(/\s+/g,"_"),j=`restaurants/${t.uid}/licenses/${O}_${Date.now()}_${m}`,I=Nr(Yu,j),T={contentType:P.type,cacheControl:"public,max-age=31536000,immutable"};return await uc(I,P,T),await br(I)},k=async P=>{if(P.preventDefault(),!t){e.warning("    ");return}if(!s.name.trim()){e.warning("  ");return}y(!0);try{let O=s.logoUrl,U=s.commercialLicenseUrl,b=s.licenseStatus;if(i){e.info("    ");const T=await N();T&&(O=T)}if(d){e.info("     ");const T=await v(d,"commercial");T&&(U=T,b="pending")}const{bankAccountName:m,bankAccountNumber:j,...I}=s;await Ft(X(B,"restaurants",t.uid),{...I,logoUrl:O,commercialLicenseUrl:U,licenseStatus:b},{merge:!0}),(s.bankName||m||j)&&await Ft(X(B,"restaurants",t.uid,"private","bankInfo"),{bankName:s.bankName||"",bankAccountName:m||"",bankAccountNumber:j||""},{merge:!0}),o&&URL.revokeObjectURL(o),l(""),a(null),u(null),e.success("    ",{title:" "})}catch(O){e.error(` : ${(O==null?void 0:O.message)||"  "}`)}finally{y(!1)}};return h?n.jsx("div",{className:"p-6 text-center",children:" "}):n.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white rounded-2xl shadow-lg mt-8 text-gray-900",children:[n.jsx("h1",{className:"text-2xl font-bold text-center mb-6",children:"  "}),n.jsxs("form",{onSubmit:k,className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block font-semibold",children:" "}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-14 h-14 rounded-full overflow-hidden border bg-gray-100 shrink-0",children:o||s.logoUrl?n.jsx("img",{src:o||s.logoUrl,className:"w-full h-full object-cover",onError:P=>P.currentTarget.style.display="none",alt:"logo"}):null}),n.jsx("input",{type:"file",accept:"image/*",onChange:E})]}),i&&n.jsxs("div",{className:"text-xs text-gray-600",children:[" : ",n.jsx("span",{className:"font-semibold",children:i.name})]})]}),n.jsx("input",{name:"name",placeholder:" ",value:s.name,onChange:C,className:"w-full border p-3 rounded-xl"}),n.jsx("input",{name:"phone",placeholder:" ",value:s.phone,onChange:C,className:"w-full border p-3 rounded-xl"}),n.jsxs("div",{className:"relative",children:[n.jsx(Nt,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-sky-400 pointer-events-none"}),n.jsxs("select",{name:"city",value:s.city,onChange:P=>r(O=>({...O,city:P.target.value})),className:"w-full border p-3 pr-10 rounded-xl bg-white appearance-none cursor-pointer focus:border-sky-400 focus:ring-2 focus:ring-sky-100",children:[n.jsx("option",{value:"",children:" "}),Bx.map(P=>n.jsx("option",{value:P,children:P},P))]})]}),n.jsx("input",{name:"location",placeholder:"",value:s.location,onChange:C,className:"w-full border p-3 rounded-xl"}),n.jsxs("div",{className:"border-t pt-4 mt-4",children:[n.jsxs("h2",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[n.jsx(lt,{className:"w-5 h-5 text-green-500"})," "]}),n.jsxs("div",{className:`flex items-center justify-between p-4 rounded-xl mb-3 ${s.isOpen?"bg-green-50 border-2 border-green-200":"bg-red-50 border-2 border-red-200"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${s.isOpen?"bg-green-500":"bg-red-500"}`,children:s.isOpen?n.jsx(lt,{className:"w-5 h-5 text-white"}):n.jsx(po,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("p",{className:`font-semibold ${s.isOpen?"text-green-800":"text-red-800"}`,children:s.isOpen?"  ":"  "}),n.jsx("p",{className:"text-sm text-gray-500",children:s.isOpen?"   ":"  "})]})]}),n.jsx("button",{type:"button",onClick:()=>r(P=>({...P,isOpen:!P.isOpen})),className:`relative w-14 h-8 rounded-full transition-colors ${s.isOpen?"bg-green-500":"bg-red-400"}`,children:n.jsx("span",{className:`absolute top-1 w-6 h-6 bg-white rounded-full shadow transition-transform ${s.isOpen?"right-1":"left-1"}`})})]}),!s.isOpen&&n.jsx("p",{className:"mb-3 text-sm text-red-600 bg-red-50 p-2 rounded-lg",children:"   -       "}),n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl mb-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${s.allowDelivery?"bg-sky-500":"bg-gray-300"}`,children:n.jsx(Nt,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-semibold text-gray-800",children:" "}),n.jsx("p",{className:"text-sm text-gray-500",children:"   "})]})]}),n.jsx("button",{type:"button",onClick:()=>r(P=>({...P,allowDelivery:!P.allowDelivery})),className:`relative w-14 h-8 rounded-full transition-colors ${s.allowDelivery?"bg-sky-500":"bg-gray-300"}`,children:n.jsx("span",{className:`absolute top-1 w-6 h-6 bg-white rounded-full shadow transition-transform ${s.allowDelivery?"right-1":"left-1"}`})})]}),s.allowDelivery&&n.jsx("p",{className:"mb-3 text-sm text-sky-600 bg-sky-50 p-2 rounded-lg",children:'   -   ""   '}),n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${s.allowPickup?"bg-green-500":"bg-gray-300"}`,children:n.jsx(lt,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-semibold text-gray-800",children:"  "}),n.jsx("p",{className:"text-sm text-gray-500",children:"      "})]})]}),n.jsx("button",{type:"button",onClick:()=>r(P=>({...P,allowPickup:!P.allowPickup})),className:`relative w-14 h-8 rounded-full transition-colors ${s.allowPickup?"bg-green-500":"bg-gray-300"}`,children:n.jsx("span",{className:`absolute top-1 w-6 h-6 bg-white rounded-full shadow transition-transform ${s.allowPickup?"right-1":"left-1"}`})})]}),s.allowPickup&&n.jsx("p",{className:"mt-2 text-sm text-green-600 bg-green-50 p-2 rounded-lg",children:"         (  )"})]}),n.jsxs("div",{className:"border-t pt-4 mt-4",children:[n.jsxs("h2",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[n.jsx(Vx,{className:"w-5 h-5 text-sky-500"})," "]}),s.licenseStatus&&n.jsxs("div",{className:`mb-4 p-3 rounded-xl flex items-center gap-2 ${s.licenseStatus==="approved"?"bg-green-50 text-green-700":s.licenseStatus==="rejected"?"bg-red-50 text-red-700":"bg-yellow-50 text-yellow-700"}`,children:[s.licenseStatus==="approved"&&n.jsx(Xe,{className:"w-5 h-5"}),s.licenseStatus==="rejected"&&n.jsx(Dn,{className:"w-5 h-5"}),s.licenseStatus==="pending"&&n.jsx(Rt,{className:"w-5 h-5"}),n.jsxs("span",{className:"font-semibold",children:[s.licenseStatus==="approved"&&"   ",s.licenseStatus==="rejected"&&" ",s.licenseStatus==="pending"&&"  ..."]})]}),s.licenseNotes&&s.licenseStatus==="rejected"&&n.jsxs("div",{className:"mb-4 p-3 bg-red-50 rounded-xl text-red-600 text-sm",children:[n.jsx("strong",{children:":"})," ",s.licenseNotes]}),n.jsxs("div",{className:"space-y-2 mb-4",children:[n.jsxs("label",{className:"block font-semibold text-gray-700 flex items-center gap-2",children:[n.jsx(u3,{className:"w-4 h-4 text-orange-500"})," "]}),n.jsxs("div",{className:"flex items-center gap-3",children:[s.commercialLicenseUrl&&n.jsx("a",{href:s.commercialLicenseUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sky-500 hover:text-sky-700 text-sm underline",children:"  "}),n.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:P=>{var O;return u(((O=P.target.files)==null?void 0:O[0])||null)},className:"text-sm"})]}),d&&n.jsxs("div",{className:"text-xs text-gray-600",children:[" : ",n.jsx("span",{className:"font-semibold",children:d.name})]})]})]}),n.jsxs("div",{className:"border-t pt-4 mt-4",children:[n.jsxs("h2",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[n.jsx(Pn,{className:"w-5 h-5 text-green-500"}),"  "]}),n.jsx("p",{className:"text-sm text-gray-500 mb-4 bg-green-50 p-3 rounded-xl",children:"           "}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("div",{className:"relative",children:n.jsxs("select",{name:"bankName",value:s.bankName||"",onChange:P=>r(O=>({...O,bankName:P.target.value})),className:"w-full border p-3 rounded-xl bg-white appearance-none cursor-pointer focus:border-green-400 focus:ring-2 focus:ring-green-100",children:[n.jsx("option",{value:"",children:" "}),n.jsx("option",{value:"",children:" "}),n.jsx("option",{value:"",children:"  "}),n.jsx("option",{value:"",children:" "}),n.jsx("option",{value:"",children:" "}),n.jsx("option",{value:"",children:" "}),n.jsx("option",{value:"",children:" "}),n.jsx("option",{value:"",children:"  "}),n.jsx("option",{value:" ",children:"  "}),n.jsx("option",{value:"",children:" "}),n.jsx("option",{value:"stc pay",children:"STC Pay"}),n.jsx("option",{value:"",children:""})]})}),n.jsx("input",{name:"bankAccountName",placeholder:"  ",value:s.bankAccountName||"",onChange:C,className:"w-full border p-3 rounded-xl focus:border-green-400 focus:ring-2 focus:ring-green-100"}),n.jsx("input",{name:"bankAccountNumber",placeholder:"   ",value:s.bankAccountNumber||"",onChange:C,className:"w-full border p-3 rounded-xl focus:border-green-400 focus:ring-2 focus:ring-green-100 font-mono text-left",dir:"ltr"}),s.bankName&&s.bankAccountName&&s.bankAccountNumber&&n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 text-green-700 text-sm",children:"    -      "})]})]}),n.jsxs("div",{className:"border-t pt-4 mt-4",children:[n.jsxs("h2",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[n.jsx(mc,{className:"w-5 h-5 text-purple-500"}),"  "]}),n.jsx("p",{className:"text-sm text-gray-500 mb-4 bg-purple-50 p-3 rounded-xl",children:"           "}),n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl mb-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${s.isHiring?"bg-purple-500":"bg-gray-300"}`,children:n.jsx(mc,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-semibold text-gray-800",children:"  "}),n.jsx("p",{className:"text-sm text-gray-500",children:"    "})]})]}),n.jsx("button",{type:"button",onClick:()=>r(P=>({...P,isHiring:!P.isHiring})),className:`relative w-14 h-8 rounded-full transition-colors ${s.isHiring?"bg-purple-500":"bg-gray-300"}`,children:n.jsx("span",{className:`absolute top-1 w-6 h-6 bg-white rounded-full shadow transition-transform ${s.isHiring?"right-1":"left-1"}`})})]}),s.isHiring&&n.jsxs("div",{className:"space-y-3 bg-purple-50 p-4 rounded-xl",children:[n.jsx("textarea",{name:"hiringDescription",placeholder:"   (:       ...)",value:s.hiringDescription||"",onChange:P=>r(O=>({...O,hiringDescription:P.target.value})),className:"w-full border p-3 rounded-xl focus:border-purple-400 focus:ring-2 focus:ring-purple-100 min-h-[100px]",rows:3}),n.jsx("input",{name:"hiringContact",placeholder:"   ()",value:s.hiringContact||"",onChange:C,className:"w-full border p-3 rounded-xl focus:border-purple-400 focus:ring-2 focus:ring-purple-100"}),s.hiringDescription&&s.hiringContact&&n.jsx("div",{className:"bg-purple-100 border border-purple-200 rounded-xl p-3 text-purple-700 text-sm",children:"      "})]})]}),n.jsx("button",{type:"submit",disabled:!w,className:"w-full bg-gray-900 hover:bg-gray-800 text-white py-3 rounded-xl font-semibold transition disabled:opacity-60",children:g?" ":""})]})]})},kD=()=>{const{user:t}=Ue(),e=cn(),s=Jt(),[r,i]=_.useState([]),[a,o]=_.useState(!0);_.useEffect(()=>{t&&(async()=>{const E=je(re(B,"hiringRequests"),Ne("restaurantId","==",t.uid)),N=await ve(E);i(N.docs.map(v=>({id:v.id,...v.data()}))),o(!1)})()},[t]);const l=async(E,N)=>{await fe(X(B,"hiringRequests",E),{status:N}),i(v=>v.map(k=>k.id===E?{...k,status:N}:k)),s.success(N==="accepted"?"   ":"  ")},d=async E=>{await e.confirm(`    "${E.courierName}"`,{title:" ",confirmText:" ",cancelText:"",dangerous:!0})&&(await fe(X(B,"hiringRequests",E.id),{status:"terminated"}),i(v=>v.map(k=>k.id===E.id?{...k,status:"terminated"}:k)),s.success("  "))},u=async E=>{await e.confirm(`    "${E.courierName}" `,{title:" ",confirmText:" ",cancelText:"",dangerous:!0})&&(await sn(X(B,"hiringRequests",E.id)),i(v=>v.filter(k=>k.id!==E.id)),s.success("  "))},h=async E=>{await fe(X(B,"hiringRequests",E.id),{status:"accepted"}),i(N=>N.map(v=>v.id===E.id?{...v,status:"accepted"}:v)),s.success("    ")},p=E=>{switch(E){case"pending":return{text:" ",color:"bg-yellow-100 text-yellow-700",icon:Rt};case"accepted":return{text:" ",color:"bg-green-100 text-green-700",icon:Xe};case"rejected":return{text:"",color:"bg-red-100 text-red-700",icon:li};case"terminated":return{text:"",color:"bg-gray-100 text-gray-700",icon:aw};default:return{text:E,color:"bg-gray-100 text-gray-700",icon:Rt}}};if(a)return n.jsx("div",{className:"text-center py-10",children:"  ..."});const g=r.filter(E=>E.status==="accepted"),y=r.filter(E=>E.status==="pending"),w=r.filter(E=>E.status==="terminated"),C=r.filter(E=>E.status==="rejected");return n.jsxs("div",{className:"py-6 space-y-8",children:[n.jsx("h1",{className:"text-2xl font-bold text-primary text-center mb-6",children:"  "}),r.length===0?n.jsxs("div",{className:"text-center py-16",children:[n.jsx("div",{className:"text-6xl mb-4",children:""}),n.jsx("p",{className:"text-gray-500 text-lg",children:"   "}),n.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"     "})]}):n.jsxs(n.Fragment,{children:[g.length>0&&n.jsxs("div",{children:[n.jsxs("h2",{className:"text-lg font-bold text-green-600 mb-3 flex items-center gap-2",children:[n.jsx(rf,{className:"w-5 h-5"}),"  (",g.length,")"]}),n.jsx("div",{className:"space-y-3",children:g.map(E=>{const N=p(E.status);return n.jsx("div",{className:"bg-white rounded-2xl shadow-card p-4 border-r-4 border-green-500",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center text-2xl",children:""}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-gray-800",children:E.courierName}),n.jsxs("div",{className:`text-xs px-2 py-1 rounded-full inline-flex items-center gap-1 ${N.color}`,children:[n.jsx(N.icon,{className:"w-3 h-3"}),N.text]})]})]}),n.jsxs("button",{onClick:()=>d(E),className:`flex items-center gap-2 px-4 py-2 bg-red-50 text-red-600 rounded-xl 
                                     hover:bg-red-100 transition-all font-medium`,children:[n.jsx(D3,{className:"w-4 h-4"}),""]})]})},E.id)})})]}),y.length>0&&n.jsxs("div",{children:[n.jsxs("h2",{className:"text-lg font-bold text-yellow-600 mb-3 flex items-center gap-2",children:[n.jsx(Rt,{className:"w-5 h-5"}),"  (",y.length,")"]}),n.jsx("div",{className:"space-y-3",children:y.map(E=>n.jsx("div",{className:"bg-white rounded-2xl shadow-card p-4 border-r-4 border-yellow-500",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-yellow-100 flex items-center justify-center text-2xl",children:""}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-gray-800",children:E.courierName}),n.jsx("div",{className:"text-xs text-yellow-600",children:"  "})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>l(E.id,"accepted"),className:"flex items-center gap-1 px-4 py-2 rounded-xl bg-green-500 text-white hover:bg-green-600 transition-all font-medium",children:[n.jsx(rf,{className:"w-4 h-4"}),""]}),n.jsxs("button",{onClick:()=>l(E.id,"rejected"),className:"flex items-center gap-1 px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition-all font-medium",children:[n.jsx(li,{className:"w-4 h-4"}),""]})]})]})},E.id))})]}),w.length>0&&n.jsxs("div",{children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-500 mb-3 flex items-center gap-2",children:[n.jsx(aw,{className:"w-5 h-5"})," (",w.length,")"]}),n.jsx("div",{className:"space-y-3",children:w.map(E=>n.jsx("div",{className:"bg-gray-50 rounded-2xl shadow p-4 border-r-4 border-gray-400 opacity-75",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center text-2xl",children:""}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-gray-600",children:E.courierName}),n.jsx("div",{className:"text-xs text-gray-500",children:""})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>h(E),className:`flex items-center gap-1 px-3 py-2 bg-green-100 text-green-600 rounded-xl 
                                     hover:bg-green-200 transition-all text-sm font-medium`,children:[n.jsx(rf,{className:"w-4 h-4"})," "]}),n.jsxs("button",{onClick:()=>u(E),className:`flex items-center gap-1 px-3 py-2 bg-red-100 text-red-600 rounded-xl 
                                     hover:bg-red-200 transition-all text-sm font-medium`,children:[n.jsx(Ss,{className:"w-4 h-4"}),""]})]})]})},E.id))})]}),C.length>0&&n.jsxs("div",{children:[n.jsxs("h2",{className:"text-lg font-bold text-red-500 mb-3 flex items-center gap-2",children:[n.jsx(li,{className:"w-5 h-5"})," (",C.length,")"]}),n.jsx("div",{className:"space-y-3",children:C.map(E=>n.jsx("div",{className:"bg-red-50 rounded-2xl shadow p-4 border-r-4 border-red-400 opacity-75",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center text-2xl",children:""}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-gray-600",children:E.courierName}),n.jsx("div",{className:"text-xs text-red-500",children:""})]})]}),n.jsxs("button",{onClick:()=>u(E),className:`flex items-center gap-1 px-3 py-2 bg-red-100 text-red-600 rounded-xl 
                                   hover:bg-red-200 transition-all text-sm font-medium`,children:[n.jsx(Ss,{className:"w-4 h-4"}),""]})]})},E.id))})]})]})]})},Ld={premium:{displayName:" ",description:"     ",isEnabled:!0,originalPrice:99,currentPrice:99,durationDays:30},free:{displayName:" ",description:"  ",isEnabled:!0,originalPrice:0,currentPrice:0,durationDays:0},defaultPackage:"free"},L1=t=>{var i,a,o,l;if(!(t!=null&&t.isActive))return!1;const e=new Date,s=((a=(i=t.startDate)==null?void 0:i.toDate)==null?void 0:a.call(i))||(t.startDate?new Date(t.startDate):null),r=((l=(o=t.endDate)==null?void 0:o.toDate)==null?void 0:l.call(o))||(t.endDate?new Date(t.endDate):null);return!(s&&e<s||r&&e>r)},ED=t=>{if(!L1(t.discount))return t.originalPrice;const e=t.discount;return e.type==="percentage"?t.originalPrice-t.originalPrice*e.value/100:Math.max(0,t.originalPrice-e.value)},ID=()=>{var j;const{user:t}=Ue(),e=Jt(),s=cn(),[r,i]=_.useState("free"),[a,o]=_.useState(!0),[l,d]=_.useState(!1),[u,h]=_.useState(!1),[p,g]=_.useState(Ld),[y,w]=_.useState(null),[C,E]=_.useState(!1),[N,v]=_.useState(null),k=_.useRef(null),P=ED(p.premium),O=L1(p.premium.discount);_.useEffect(()=>{console.log("  :",{pkgSettings:p.premium,discount:p.premium.discount,hasDiscount:O,premiumPrice:P,originalPrice:p.premium.originalPrice})},[p,O,P]),_.useEffect(()=>{if(!t)return;(async()=>{var S;try{const W=await Ce(X(B,"settings","packages"));if(W.exists()){const L=W.data();console.log("    Firestore:",L),g({...Ld,...L,premium:{...Ld.premium,...L.premium,discount:(S=L.premium)!=null&&S.discount?{...L.premium.discount,isActive:L.premium.discount.isActive??!1}:void 0},free:{...Ld.free,...L.free}})}else console.log("      Firestore   ");const F=await Ce(X(B,"restaurants",t.uid));if(F.exists()){const L=F.data();i((L==null?void 0:L.packageType)||"free")}const V=je(re(B,"packageRequests"),Ne("restaurantId","==",t.uid)),z=await ve(V);if(!z.empty){const $=z.docs.map(M=>({id:M.id,...M.data()})).find(M=>!["approved","rejected","expired"].includes(M.status));$&&w($)}}catch(W){console.error("   :",W)}finally{o(!1)}})();const T=je(re(B,"packageRequests"),Ne("restaurantId","==",t.uid)),D=qn(T,S=>{if(!S.empty){const W=S.docs.map(z=>({id:z.id,...z.data()})),F=W.find(z=>!["approved","rejected","expired"].includes(z.status));w(F||null),W.find(z=>z.status==="approved")&&i("premium")}});return()=>D()},[t]);const U=async()=>{if(!t)return;if(r==="free"){e.info("     ");return}if(await s.confirm("         .",{title:"   ",confirmText:"  ",cancelText:""})){h(!0);try{await fe(X(B,"restaurants",t.uid),{packageType:"free",packageRequest:null,updatedAt:se()}),i("free"),e.success("   ")}catch(T){console.error(":",T),e.error("    ")}finally{h(!1)}}},b=async()=>{if(!t)return;if(y){e.info("    ");return}if(P===0){if(!await s.confirm("    !    ",{title:"   -  !",confirmText:"   ",cancelText:""}))return;d(!0);try{const D=new Date;D.setDate(D.getDate()+(p.premium.durationDays||30)),await fe(X(B,"restaurants",t.uid),{packageType:"premium",packageSubscribedAt:se(),packageExpiresAt:D,packageRequest:null,updatedAt:se()}),i("premium"),e.success(" !     !")}catch(D){console.error(":",D),e.error("    ")}finally{d(!1)}return}if(await s.confirm(`        ${P.toFixed(0)} .   `,{title:"    ",confirmText:"  ",cancelText:""})){d(!0);try{const D=(await Ce(X(B,"restaurants",t.uid))).data(),S=await tt(re(B,"packageRequests"),{restaurantId:t.uid,restaurantName:(D==null?void 0:D.name)||" ",ownerName:(D==null?void 0:D.ownerName)||"",ownerPhone:(D==null?void 0:D.phone)||"",status:"pending",subscriptionAmount:P,subscriptionDuration:p.premium.durationDays,requestedAt:se(),createdAt:se(),updatedAt:se()});await fe(X(B,"restaurants",t.uid),{packageRequest:"premium",packageRequestedAt:se(),updatedAt:se()});try{const W=je(re(B,"users"),Ne("role","==","developer")),F=await ve(W);if(F.empty){const V=je(re(B,"users"),Ne("role","==","admin")),z=await ve(V);for(const L of z.docs)await tt(re(B,"notifications"),{recipientId:L.id,title:"      ",message:`${(D==null?void 0:D.name)||" "}     `,type:"package_request",read:!1,data:{requestId:S.id,restaurantId:t.uid},createdAt:se()})}else for(const V of F.docs)await tt(re(B,"notifications"),{recipientId:V.id,title:"      ",message:`${(D==null?void 0:D.name)||" "}     `,type:"package_request",read:!1,data:{requestId:S.id,restaurantId:t.uid},createdAt:se()})}catch(W){console.warn("  :",W)}e.success("  !      ")}catch(T){console.error("   :",T),e.error("    ")}finally{d(!1)}}},m=async()=>{var I;if(!t||!y||!N){e.warning("    ");return}E(!0);try{const T=`paymentProofs/${t.uid}_${Date.now()}_${N.name}`,D=Nr(Yu,T);await uc(D,N);const S=await br(D);await fe(X(B,"packageRequests",y.id),{status:"payment_sent",paymentProofImageUrl:S,paymentSentAt:se(),updatedAt:se()});try{const F=((I=(await Ce(X(B,"restaurants",t.uid))).data())==null?void 0:I.name)||" ",V=je(re(B,"users"),Ne("role","==","developer")),z=await ve(V);if(z.empty){const L=je(re(B,"users"),Ne("role","==","admin")),$=await ve(L);for(const M of $.docs)await tt(re(B,"notifications"),{recipientId:M.id,title:"    ",message:`${F}     `,type:"payment_proof_sent",read:!1,data:{requestId:y.id,restaurantId:t.uid},createdAt:se()})}else for(const L of z.docs)await tt(re(B,"notifications"),{recipientId:L.id,title:"    ",message:`${F}     `,type:"payment_proof_sent",read:!1,data:{requestId:y.id,restaurantId:t.uid},createdAt:se()})}catch(W){console.warn("  :",W)}e.success("    !     "),v(null),k.current&&(k.current.value="")}catch(T){console.error("   :",T),e.error(` : ${T.message}`)}finally{E(!1)}};return a?n.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-amber-200 border-t-amber-500 rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-500",children:" ..."})]})}):n.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-amber-100 to-yellow-100 px-5 py-2.5 rounded-full mb-4 shadow-sm",children:[n.jsx("span",{className:"text-xl",children:""}),n.jsx("span",{className:"text-amber-700 font-bold text-lg",children:"  "})]}),n.jsx("h1",{className:"text-3xl md:text-4xl font-black text-gray-900 mb-3",children:"   "}),n.jsx("p",{className:"text-gray-600 max-w-lg mx-auto",children:"              "})]}),y&&n.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl p-6 border-2 border-amber-200 shadow-lg",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-amber-500 rounded-xl flex items-center justify-center",children:n.jsx(Zu,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-amber-800",children:"   "}),n.jsxs("p",{className:"text-amber-600 text-sm",children:[y.status==="pending"&&"    ",y.status==="payment_sent"&&"     -  "]})]})]}),y.status==="pending"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-white rounded-xl p-4",children:[n.jsxs("p",{className:"text-green-600 font-bold text-lg mb-2",children:["  : ",y.subscriptionAmount||P," "]}),n.jsx("p",{className:"text-gray-600 text-sm",children:"        "})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 space-y-3",children:[n.jsx("p",{className:"font-semibold text-gray-700",children:"    :"}),n.jsx("input",{ref:k,type:"file",accept:"image/*",onChange:I=>{var T;return v(((T=I.target.files)==null?void 0:T[0])||null)},className:"w-full border-2 border-dashed border-amber-300 rounded-xl p-4 bg-amber-50"}),N&&n.jsxs("p",{className:"text-sm text-green-600",children:["  : ",N.name]}),n.jsx("button",{onClick:m,disabled:C||!N,className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white py-3 rounded-xl font-bold disabled:opacity-50 transition flex items-center justify-center gap-2",children:C?n.jsxs(n.Fragment,{children:[n.jsx(Rt,{className:"w-5 h-5 animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Ux,{className:"w-5 h-5"}),"  "]})})]})]}),y.status==="payment_sent"&&n.jsxs("div",{className:"bg-purple-100 rounded-xl p-4 flex items-center gap-3",children:[n.jsx(Rt,{className:"w-8 h-8 text-purple-600 animate-pulse"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold text-purple-800",children:"     "}),n.jsx("p",{className:"text-purple-600 text-sm",children:"    ...   "})]})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:`relative rounded-3xl overflow-hidden transition-all duration-300 ${r==="free"?"ring-4 ring-green-400 shadow-2xl":"shadow-lg hover:shadow-xl"}`,children:[r==="free"&&n.jsxs("div",{className:"absolute top-4 right-4 bg-green-500 text-white px-3 py-1 rounded-full text-sm font-bold flex items-center gap-1 z-10",children:[n.jsx(_s,{className:"w-4 h-4"})," "]}),n.jsxs("div",{className:"bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50 p-6 md:p-8 h-full flex flex-col",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-400 to-emerald-500 rounded-2xl flex items-center justify-center shadow-lg",children:n.jsx(nf,{className:"w-8 h-8 text-white"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-black text-gray-900",children:" "}),n.jsx("p",{className:"text-green-600 font-semibold",children:"   "})]})]}),n.jsxs("div",{className:"bg-white/70 backdrop-blur rounded-2xl p-4 mb-6 text-center",children:[n.jsxs("div",{className:"flex items-baseline justify-center gap-1",children:[n.jsx("span",{className:"text-5xl font-black text-gray-900",children:"0"}),n.jsx("span",{className:"text-xl text-gray-600",children:"."})]}),n.jsx("p",{className:"text-green-600 font-medium mt-1",children:" "})]}),n.jsxs("div",{className:"space-y-4 flex-1",children:[n.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(go,{className:"w-5 h-5 text-amber-500"})," :"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(Ai,{icon:n.jsx(Rl,{className:"w-5 h-5"}),title:"  ",desc:"     ",included:!0}),n.jsx(Ai,{icon:n.jsx(jr,{className:"w-5 h-5"}),title:" ",desc:"    ",included:!0}),n.jsx(Ai,{icon:n.jsx(Vx,{className:"w-5 h-5"}),title:"  ",desc:"    ",included:!0})]})]}),n.jsx("div",{className:"mt-6",children:r==="free"?n.jsxs("div",{className:"bg-green-100 text-green-700 py-4 px-6 rounded-2xl text-center font-bold flex items-center justify-center gap-2",children:[n.jsx(_s,{className:"w-5 h-5"}),"    "]}):n.jsx("button",{onClick:U,disabled:u,className:"w-full py-4 px-6 rounded-2xl bg-gradient-to-r from-green-500 to-emerald-500 text-white font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3",children:u?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(nf,{className:"w-6 h-6"}),"  ",n.jsx(Ju,{className:"w-5 h-5"})]})})})]})]}),n.jsxs("div",{className:`relative rounded-3xl overflow-hidden transition-all duration-300 ${r==="premium"?"ring-4 ring-amber-400 shadow-2xl":"shadow-lg hover:shadow-xl hover:scale-[1.01]"}`,children:[n.jsx("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-r from-amber-500 via-yellow-400 to-amber-500 py-2 text-center z-10",children:n.jsxs("div",{className:"flex items-center justify-center gap-2 text-white font-bold",children:[n.jsx(Vt,{className:"w-5 h-5"}),n.jsx("span",{children:" "}),n.jsx(Vt,{className:"w-5 h-5"})]})}),r==="premium"&&n.jsxs("div",{className:"absolute top-12 right-4 bg-amber-500 text-white px-3 py-1 rounded-full text-sm font-bold flex items-center gap-1 z-10",children:[n.jsx(Vt,{className:"w-4 h-4"})," "]}),n.jsxs("div",{className:"bg-gradient-to-br from-amber-50 via-yellow-50 to-orange-50 p-6 md:p-8 pt-14 h-full flex flex-col",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsxs("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-400 via-yellow-400 to-orange-400 rounded-2xl flex items-center justify-center shadow-lg relative",children:[n.jsx(Vt,{className:"w-8 h-8 text-white"}),n.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-white rounded-full flex items-center justify-center shadow",children:n.jsx(Us,{className:"w-4 h-4 text-amber-500"})})]}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-black text-gray-900",children:" "}),n.jsx("p",{className:"text-amber-600 font-semibold",children:"  "})]})]}),n.jsxs("div",{className:"bg-white/70 backdrop-blur rounded-2xl p-4 mb-6 text-center relative overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400/10 via-yellow-400/10 to-orange-400/10"}),n.jsxs("div",{className:"relative",children:[O&&n.jsxs("div",{className:"mb-2",children:[n.jsx("span",{className:"bg-red-500 text-white text-sm px-3 py-1 rounded-full font-bold",children:((j=p.premium.discount)==null?void 0:j.label)||" !"}),p.premium.originalPrice>P&&n.jsxs("p",{className:"text-gray-400 line-through text-lg mt-1",children:[p.premium.originalPrice.toFixed(0)," ."]})]}),n.jsxs("div",{className:"flex items-baseline justify-center gap-1",children:[n.jsx("span",{className:"text-5xl font-black bg-gradient-to-r from-amber-600 to-orange-500 bg-clip-text text-transparent",children:P===0?"":P.toFixed(0)}),P>0&&n.jsx("span",{className:"text-xl text-gray-600",children:"."})]}),n.jsx("p",{className:"text-amber-600 font-medium mt-1",children:P===0?" !":` ${p.premium.durationDays} `})]})]}),n.jsxs("div",{className:"space-y-4 flex-1",children:[n.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Vt,{className:"w-5 h-5 text-amber-500"}),"     :"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(Ai,{icon:n.jsx(S3,{className:"w-5 h-5"}),title:"   ",desc:"      ",included:!0,premium:!0}),n.jsx(Ai,{icon:n.jsx(au,{className:"w-5 h-5"}),title:"  ",desc:"    ",included:!0,premium:!0}),n.jsx(Ai,{icon:n.jsx(th,{className:"w-5 h-5"}),title:"   ",desc:"     ",included:!0,premium:!0}),n.jsx(Ai,{icon:n.jsx(KP,{className:"w-5 h-5"}),title:" ",desc:"     ",included:!0,premium:!0})]})]}),n.jsx("div",{className:"mt-6",children:r==="premium"?n.jsxs("div",{className:"bg-amber-100 text-amber-700 py-4 px-6 rounded-2xl text-center font-bold flex items-center justify-center gap-2",children:[n.jsx(Vt,{className:"w-5 h-5"}),"    "]}):n.jsxs("button",{onClick:b,disabled:l,className:"w-full py-4 px-6 rounded-2xl bg-gradient-to-r from-amber-500 via-yellow-400 to-orange-500 text-white font-bold text-lg shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 relative overflow-hidden group",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/30 to-white/0 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"}),l?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Vt,{className:"w-6 h-6"}),"   ",n.jsx(Ju,{className:"w-5 h-5"})]})]})})]})]})]}),n.jsxs("div",{className:"bg-white rounded-3xl shadow-xl overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 px-6 py-4",children:n.jsxs("h3",{className:"text-white font-bold text-lg flex items-center gap-2",children:[n.jsx(Us,{className:"w-5 h-5 text-amber-400"}),"   "]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-4 text-right font-bold text-gray-700",children:""}),n.jsx("th",{className:"px-6 py-4 text-center font-bold text-green-600",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx(nf,{className:"w-5 h-5"}),""]})}),n.jsx("th",{className:"px-6 py-4 text-center font-bold text-amber-600",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx(Vt,{className:"w-5 h-5"}),""]})})]})}),n.jsxs("tbody",{className:"divide-y divide-gray-100",children:[n.jsx(Ri,{label:"  ",free:!0,premium:!0}),n.jsx(Ri,{label:" ",free:!0,premium:!0}),n.jsx(Ri,{label:"  ",free:!0,premium:!0}),n.jsx(Ri,{label:"   ",premium:!0}),n.jsx(Ri,{label:"  ",premium:!0}),n.jsx(Ri,{label:"   ",premium:!0}),n.jsx(Ri,{label:" ",premium:!0})]})]})})]}),n.jsx("div",{className:"bg-gradient-to-r from-sky-50 to-blue-50 rounded-2xl p-6 text-center",children:n.jsxs("p",{className:"text-gray-600",children:[n.jsx("span",{className:"font-bold text-sky-600",children:" :"})," ","       .     ."]})})]})},Ai=({icon:t,title:e,desc:s,included:r,premium:i})=>n.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-xl transition ${r?i?"bg-gradient-to-r from-amber-100/50 to-yellow-100/50":"bg-white/50":"opacity-50"}`,children:[n.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${r?i?"bg-gradient-to-br from-amber-400 to-orange-400 text-white":"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"}`,children:t}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h4",{className:`font-bold ${r?"text-gray-800":"text-gray-400"}`,children:e}),i&&n.jsx("span",{className:"bg-gradient-to-r from-amber-400 to-orange-400 text-white text-xs px-2 py-0.5 rounded-full font-bold",children:""})]}),n.jsx("p",{className:`text-sm ${r?"text-gray-500":"text-gray-400"}`,children:s})]}),r&&n.jsx(_s,{className:`w-5 h-5 flex-shrink-0 ${i?"text-amber-500":"text-green-500"}`})]}),Ri=({label:t,free:e,premium:s})=>n.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[n.jsx("td",{className:"px-6 py-4 text-gray-700 font-medium",children:t}),n.jsx("td",{className:"px-6 py-4 text-center",children:e?n.jsx("div",{className:"inline-flex items-center justify-center w-8 h-8 bg-green-100 rounded-full",children:n.jsx(_s,{className:"w-5 h-5 text-green-600"})}):n.jsx("div",{className:"inline-flex items-center justify-center w-8 h-8 bg-gray-100 rounded-full",children:n.jsx("span",{className:"text-gray-400",children:""})})}),n.jsx("td",{className:"px-6 py-4 text-center",children:s?n.jsx("div",{className:"inline-flex items-center justify-center w-8 h-8 bg-amber-100 rounded-full",children:n.jsx(_s,{className:"w-5 h-5 text-amber-600"})}):n.jsx("div",{className:"inline-flex items-center justify-center w-8 h-8 bg-gray-100 rounded-full",children:n.jsx("span",{className:"text-gray-400",children:""})})})]}),df=5,Md=24,SD=()=>{const{user:t}=Ue(),e=Jt(),s=cn(),[r,i]=_.useState([]),[a,o]=_.useState(!0),[l,d]=_.useState(!1),[u,h]=_.useState(!1),[p,g]=_.useState(0),y=_.useRef(null),[w,C]=_.useState({type:"text",title:"",description:"",mediaFile:null,mediaPreview:""});_.useEffect(()=>{t&&E()},[t]);const E=async()=>{if(t)try{const O=je(re(B,"promotions"),Ne("ownerId","==",t.uid)),b=(await ve(O)).docs.map(m=>{var j,I,T,D;return{id:m.id,...m.data(),expiresAt:(I=(j=m.data().expiresAt)==null?void 0:j.toDate)==null?void 0:I.call(j),createdAt:(D=(T=m.data().createdAt)==null?void 0:T.toDate)==null?void 0:D.call(T)}});b.sort((m,j)=>{var I,T;return(((I=j.createdAt)==null?void 0:I.getTime())||0)-(((T=m.createdAt)==null?void 0:T.getTime())||0)}),i(b)}catch(O){e.error("   "),console.error(O)}finally{o(!1)}},N=O=>O.expiresAt?new Date>new Date(O.expiresAt):!1,v=O=>{var I;const U=(I=O.target.files)==null?void 0:I[0];if(!U)return;const b=U.type.startsWith("image/"),m=U.type.startsWith("video/");if(!b&&!m){e.warning("    ");return}const j=m?50*1024*1024:10*1024*1024;if(U.size>j){e.warning(m?"       50 ":"       10 ");return}C({...w,type:m?"video":"image",mediaFile:U,mediaPreview:URL.createObjectURL(U)})},k=async O=>{if(O.preventDefault(),!!t){if(w.type!=="text"&&!w.mediaFile){e.warning("    ");return}if(!w.title.trim()&&!w.description.trim()&&!w.mediaFile){e.warning("   ");return}try{h(!0);let U="";if(w.mediaFile){const m=w.mediaFile.name.replace(/\s+/g,"_").slice(-60),j=`promotions/${t.uid}_${Date.now()}_${m}`,I=Nr(Yu,j),T=Xu(I,w.mediaFile);await new Promise((D,S)=>{T.on("state_changed",W=>{const F=Math.round(W.bytesTransferred/W.totalBytes*100);g(F)},S,async()=>{U=await br(T.snapshot.ref),D()})})}const b=new Date;b.setHours(b.getHours()+Md),await tt(re(B,"promotions"),{ownerId:t.uid,restaurantId:t.uid,type:w.type,title:w.title.trim(),description:w.description.trim(),mediaUrl:U,isActive:!0,isPaid:!0,price:df,duration:Md,viewsCount:0,expiresAt:bt.fromDate(b),createdAt:se(),updatedAt:se()}),e.success(`  !    ${Md} `),C({type:"text",title:"",description:"",mediaFile:null,mediaPreview:""}),d(!1),g(0),E()}catch(U){e.error("    "),console.error(U)}finally{h(!1)}}},P=async O=>{if(await s.confirm("    ",{dangerous:!0}))try{await sn(X(B,"promotions",O)),e.success("  "),E()}catch{e.error(" ")}};return a?n.jsxs("div",{className:"flex items-center justify-center h-96",children:[n.jsx(os,{className:"w-6 h-6 animate-spin ml-2"})," ..."]}):n.jsxs("div",{className:"max-w-2xl mx-auto py-8 px-4 space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:n.jsx(hr,{className:"w-8 h-8 text-white"})}),n.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:" "}),n.jsx("p",{className:"text-gray-500 mt-2",children:"      "})]}),n.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-2xl p-4 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-3",children:[n.jsx(Us,{className:"w-5 h-5 text-purple-500"}),n.jsxs("span",{className:"text-lg font-bold text-purple-700",children:[df," .   ",Md," "]}),n.jsx(Us,{className:"w-5 h-5 text-purple-500"})]}),n.jsx("p",{className:"text-sm text-purple-600 mt-1",children:"       "})]}),!l&&n.jsxs("button",{onClick:()=>d(!0),className:"w-full py-4 rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold shadow-lg hover:shadow-xl transition flex items-center justify-center gap-3",children:[n.jsx($c,{className:"w-6 h-6"}),"  "]}),l&&n.jsxs("form",{onSubmit:k,className:"bg-white rounded-2xl shadow-xl p-6 space-y-4",children:[n.jsx("h2",{className:"font-bold text-lg text-gray-800 mb-4",children:"  "}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:" "}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("button",{type:"button",onClick:()=>C({...w,type:"text",mediaFile:null,mediaPreview:""}),className:`p-3 rounded-xl border-2 transition flex flex-col items-center gap-1 ${w.type==="text"?"border-purple-500 bg-purple-50":"border-gray-200"}`,children:[n.jsx(Vx,{className:"w-5 h-5"}),n.jsx("span",{className:"text-sm",children:""})]}),n.jsxs("button",{type:"button",onClick:()=>{var O;C({...w,type:"image"}),(O=y.current)==null||O.click()},className:`p-3 rounded-xl border-2 transition flex flex-col items-center gap-1 ${w.type==="image"?"border-purple-500 bg-purple-50":"border-gray-200"}`,children:[n.jsx(C1,{className:"w-5 h-5"}),n.jsx("span",{className:"text-sm",children:""})]}),n.jsxs("button",{type:"button",onClick:()=>{var O;C({...w,type:"video"}),(O=y.current)==null||O.click()},className:`p-3 rounded-xl border-2 transition flex flex-col items-center gap-1 ${w.type==="video"?"border-purple-500 bg-purple-50":"border-gray-200"}`,children:[n.jsx(B3,{className:"w-5 h-5"}),n.jsx("span",{className:"text-sm",children:""})]})]})]}),n.jsx("input",{type:"file",ref:y,accept:"image/*,video/*",onChange:v,className:"hidden"}),w.mediaPreview&&n.jsxs("div",{className:"relative",children:[w.type==="video"?n.jsx("video",{src:w.mediaPreview,controls:!0,className:"w-full h-48 object-cover rounded-xl"}):n.jsx("img",{src:w.mediaPreview,alt:"",className:"w-full h-48 object-cover rounded-xl"}),n.jsx("button",{type:"button",onClick:()=>C({...w,mediaFile:null,mediaPreview:"",type:"text"}),className:"absolute top-2 left-2 p-2 bg-red-500 text-white rounded-full",children:n.jsx(li,{className:"w-4 h-4"})})]}),w.type!=="text"&&!w.mediaPreview&&n.jsxs("button",{type:"button",onClick:()=>{var O;return(O=y.current)==null?void 0:O.click()},className:"w-full py-4 border-2 border-dashed border-gray-300 rounded-xl text-gray-500 hover:border-purple-400 transition flex items-center justify-center gap-2",children:[n.jsx(Ux,{className:"w-5 h-5"})," ",w.type==="video"?"":""]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:" ()"}),n.jsx("input",{type:"text",value:w.title,onChange:O=>C({...w,title:O.target.value}),placeholder:":   !",className:"w-full border-2 border-gray-200 rounded-xl p-3 focus:border-purple-400 focus:outline-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"  "}),n.jsx("textarea",{value:w.description,onChange:O=>C({...w,description:O.target.value}),placeholder:"   ...",rows:3,className:"w-full border-2 border-gray-200 rounded-xl p-3 focus:border-purple-400 focus:outline-none"})]}),u&&p>0&&n.jsx("div",{className:"bg-gray-200 rounded-full h-2 overflow-hidden",children:n.jsx("div",{className:"bg-purple-500 h-full transition-all",style:{width:`${p}%`}})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"submit",disabled:u,className:"flex-1 py-3 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold disabled:opacity-50 flex items-center justify-center gap-2",children:u?n.jsxs(n.Fragment,{children:[n.jsx(os,{className:"w-5 h-5 animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(hr,{className:"w-5 h-5"}),"  (",df," .)"]})}),n.jsx("button",{type:"button",onClick:()=>{d(!1),C({type:"text",title:"",description:"",mediaFile:null,mediaPreview:""})},className:"px-4 py-3 rounded-xl border-2 border-gray-200 text-gray-600 font-medium",children:""})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h2",{className:"font-bold text-lg text-gray-800",children:""}),r.length===0?n.jsxs("div",{className:"text-center py-10 text-gray-400",children:[n.jsx(hr,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),n.jsx("p",{children:"    "})]}):r.map(O=>n.jsxs("div",{className:`bg-white rounded-2xl shadow-lg overflow-hidden ${N(O)?"opacity-60":""}`,children:[O.mediaUrl&&(O.type==="video"?n.jsx("video",{src:O.mediaUrl,controls:!0,className:"w-full h-48 object-cover"}):n.jsx("img",{src:O.mediaUrl,alt:O.title,className:"w-full h-48 object-cover"})),n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[N(O)?n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-500 text-xs font-medium rounded-full",children:[n.jsx(li,{className:"w-3 h-3"})," "]}):O.isActive?n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-600 text-xs font-medium rounded-full",children:[n.jsx(Xe,{className:"w-3 h-3"})," "]}):n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-600 text-xs font-medium rounded-full",children:[n.jsx(Rt,{className:"w-3 h-3"}),"  "]}),n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-600 text-xs font-medium rounded-full",children:[n.jsx(Rl,{className:"w-3 h-3"})," ",O.viewsCount," "]})]}),O.title&&n.jsx("h3",{className:"font-bold text-gray-800",children:O.title}),O.description&&n.jsx("p",{className:"text-gray-600 text-sm mt-1",children:O.description}),n.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t",children:[n.jsxs("span",{className:"text-xs text-gray-400",children:[O.expiresAt&&!N(O)&&n.jsxs(n.Fragment,{children:[": ",new Date(O.expiresAt).toLocaleString("ar-SA")]}),N(O)&&"  "]}),n.jsx("button",{onClick:()=>P(O.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition",children:n.jsx(Ss,{className:"w-4 h-4"})})]})]})]},O.id))]}),n.jsxs(de,{to:"/owner",className:"flex items-center justify-center gap-2 text-sky-600 hover:text-sky-700 py-4",children:[n.jsx($n,{className:"w-5 h-5"}),"  "]})]})},Vd=3.75,TD=()=>{const{user:t}=Ue(),e=ys(),s=Jt(),[r,i]=_.useState([]),[a,o]=_.useState([]),[l,d]=_.useState({}),[u,h]=_.useState(null);_.useEffect(()=>{if(!(t!=null&&t.uid))return;const y=je(re(B,"orders"),Ne("status","in",["ready"]),ln("createdAt","desc"),ia(20)),w=qn(y,N=>i(N.docs.map(v=>({id:v.id,...v.data()})))),C=je(re(B,"orders"),Ne("courierId","==",t.uid),ln("createdAt","desc"),ia(20)),E=qn(C,N=>o(N.docs.map(v=>({id:v.id,...v.data()}))));return()=>{w(),E()}},[t==null?void 0:t.uid]);const p=async(y,w)=>{if(t)if(w.deliveryFeeSetBy)await fe(X(B,"orders",y),{courierId:t.uid,status:"out_for_delivery",courierPlatformFee:Vd,updatedAt:se()}),s.success("  !");else{const C=l[y],E=parseFloat(C);if(isNaN(E)||E<0){s.error("   ");return}h(y);const N=w.subtotal+E;await fe(X(B,"orders",y),{courierId:t.uid,status:"out_for_delivery",deliveryFee:E,deliveryFeeSetBy:"courier",deliveryFeeSetAt:se(),total:N,courierPlatformFee:Vd,updatedAt:se()}),h(null),s.success(`  !  : ${E} . (- ${Vd}  )`)}},g=async y=>{await fe(X(B,"orders",y),{status:"delivered",updatedAt:se()})};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-gradient-to-br from-sky-500 to-blue-600 rounded-2xl p-4 text-white shadow-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(Bt,{className:"w-5 h-5"}),n.jsx("span",{className:"text-sm opacity-90",children:" "})]}),n.jsx("div",{className:"text-3xl font-bold",children:r.length})]}),n.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl p-4 text-white shadow-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(Ts,{className:"w-5 h-5"}),n.jsx("span",{className:"text-sm opacity-90",children:" "})]}),n.jsx("div",{className:"text-3xl font-bold",children:a.filter(y=>y.status!=="delivered").length})]})]}),n.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center",children:n.jsx(Bt,{className:"w-5 h-5 text-purple-600"})}),n.jsx("h2",{className:"font-bold text-lg",children:"   "})]}),n.jsxs("div",{className:"space-y-3",children:[r.map(y=>{var w,C,E;return n.jsxs("div",{className:"bg-white rounded-2xl shadow-card overflow-hidden hover:shadow-lg transition-all",children:[n.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 px-4 py-2 flex items-center justify-between",children:[n.jsxs("span",{className:"text-white font-bold",children:["#",y.id.slice(-6)]}),n.jsx("span",{className:"text-white/90 text-sm",children:y.restaurantName||""})]}),n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-600 text-sm mb-2",children:[n.jsx(Nt,{className:"w-4 h-4"}),n.jsx("span",{className:"truncate",children:y.address})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 mb-3 space-y-1",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:" "}),n.jsxs("span",{className:"font-semibold",children:[(w=y.subtotal)==null?void 0:w.toFixed(2)," ."]})]}),y.deliveryFeeSetBy?n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:" "}),n.jsxs("span",{className:"font-semibold text-green-600",children:[(C=y.deliveryFee)==null?void 0:C.toFixed(2)," ."]})]}):n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:" "}),n.jsx("span",{className:"text-amber-600 text-xs",children:" "})]}),n.jsx("div",{className:"h-px bg-gray-200 my-1"}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"font-bold text-gray-800",children:""}),n.jsxs("span",{className:"font-bold text-green-600",children:[(E=y.total)==null?void 0:E.toFixed(2)," ."]})]})]}),!y.deliveryFeeSetBy&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3 mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Dn,{className:"w-4 h-4 text-amber-600"}),n.jsx("span",{className:"font-semibold text-amber-800 text-sm",children:"  "})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"number",min:"0",step:"0.5",placeholder:": 10",value:l[y.id]||"",onChange:N=>d(v=>({...v,[y.id]:N.target.value})),className:"flex-1 px-3 py-2 rounded-lg border border-amber-200 focus:border-amber-400 focus:outline-none text-gray-800 text-sm"}),n.jsx("span",{className:"flex items-center text-gray-500 text-sm",children:"."})]}),n.jsxs("p",{className:"text-xs text-amber-700 mt-2",children:["  ",Vd," .    "]})]}),n.jsx("button",{onClick:()=>p(y.id,y),disabled:u===y.id,className:`w-full py-3 rounded-xl bg-gradient-to-r from-gray-800 to-gray-900 
                               text-white font-bold flex items-center justify-center gap-2
                               hover:from-gray-900 hover:to-black transition-all shadow-lg hover:shadow-xl disabled:opacity-50`,children:u===y.id?n.jsx("span",{children:" ..."}):n.jsxs(n.Fragment,{children:[n.jsx(Ts,{className:"w-5 h-5"}),n.jsx("span",{children:"  "})]})})]})]},y.id)}),r.length===0&&n.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-2xl",children:[n.jsx("div",{className:"text-5xl mb-3",children:""}),n.jsx("p",{className:"text-gray-500",children:"    "}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"    "})]})]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:n.jsx(Hi,{className:"w-5 h-5 text-green-600"})}),n.jsx("h2",{className:"font-bold text-lg",children:" "})]}),n.jsxs("div",{className:"space-y-3",children:[a.filter(y=>y.status!=="delivered").map(y=>{var w,C;return n.jsxs("div",{className:"bg-white rounded-2xl shadow-card overflow-hidden hover:shadow-lg transition-all",children:[n.jsxs("div",{className:"bg-gradient-to-r from-sky-500 to-blue-500 px-4 py-2 flex items-center justify-between",children:[n.jsxs("span",{className:"text-white font-bold",children:["#",y.id.slice(-6)]}),n.jsxs("div",{className:"flex items-center gap-1 text-white/90 text-sm",children:[n.jsx(Rt,{className:"w-3 h-3"}),n.jsx("span",{children:" "})]})]}),n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-600 text-sm mb-2",children:[n.jsx(Nt,{className:"w-4 h-4"}),n.jsx("span",{className:"truncate",children:y.address})]}),n.jsxs("div",{className:"flex items-center gap-2 text-green-600 font-bold text-lg mb-3",children:[n.jsx(p6,{className:"w-5 h-5"}),n.jsxs("span",{children:[(C=(w=y.total)==null?void 0:w.toFixed)==null?void 0:C.call(w,2)," ."]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>e(`/chat?orderId=${y.id}`),className:`flex-1 py-3 rounded-xl bg-gradient-to-r from-primary to-accent 
                                 text-white font-bold flex items-center justify-center gap-2
                                 hover:shadow-lg transition-all`,children:[n.jsx(Uc,{className:"w-5 h-5"}),n.jsx("span",{children:" "})]}),n.jsxs("button",{onClick:()=>g(y.id),className:`flex-1 py-3 rounded-xl bg-gradient-to-r from-green-500 to-emerald-500 
                                 text-white font-bold flex items-center justify-center gap-2
                                 hover:from-green-600 hover:to-emerald-600 transition-all shadow-lg hover:shadow-xl`,children:[n.jsx(Xe,{className:"w-5 h-5"}),n.jsx("span",{children:"  "})]})]})]})]},y.id)}),a.filter(y=>y.status!=="delivered").length===0&&n.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-2xl",children:[n.jsx("div",{className:"text-5xl mb-3",children:""}),n.jsx("p",{className:"text-gray-500",children:"    "}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"    "})]})]})]})]}),a.filter(y=>y.status==="delivered").length>0&&n.jsxs("div",{className:"mt-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(Us,{className:"w-5 h-5 text-yellow-500"}),n.jsx("h3",{className:"font-bold text-gray-700",children:"  "})]}),n.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-3",children:a.filter(y=>y.status==="delivered").slice(0,6).map(y=>{var w,C;return n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"font-bold text-green-700",children:["#",y.id.slice(-6)]}),n.jsxs("span",{className:"text-green-600 font-bold",children:[(C=(w=y.total)==null?void 0:w.toFixed)==null?void 0:C.call(w,2)," ."]})]})},y.id)})})]})]})},CD=()=>{const{user:t}=Ue(),e=cn(),[s,r]=_.useState([]),[i,a]=_.useState({}),[o,l]=_.useState(!0),[d,u]=_.useState(null);_.useEffect(()=>{if(!t)return;(async()=>{const y=(await ve(re(B,"restaurants"))).docs.map(N=>({id:N.id,...N.data()}));r(y);const w=je(re(B,"hiringRequests"),Ne("courierId","==",t.uid)),C=await ve(w),E={};C.docs.forEach(N=>{const v=N.data();E[v.restaurantId]={restaurantId:v.restaurantId,status:v.status}}),a(E),l(!1)})()},[t]);const h=async p=>{if(!t){e.warning("  ");return}u(p.id),await tt(re(B,"hiringRequests"),{courierId:t.uid,courierName:t.displayName||"",restaurantId:p.id,restaurantName:p.name,status:"pending",createdAt:se()}),a(g=>({...g,[p.id]:{restaurantId:p.id,status:"pending"}})),u(null)};return o?n.jsx("div",{className:"text-center py-10 text-sky-600",children:"  ..."}):n.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-sky-50 via-white to-sky-100 py-8 px-4",children:[n.jsxs("h1",{className:"text-2xl sm:text-3xl font-extrabold text-sky-600 text-center mb-8 flex items-center justify-center gap-2",children:[n.jsx(mc,{className:"w-7 h-7 text-sky-500"})," "]}),n.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6 max-w-5xl mx-auto",children:s.map(p=>{const g=i[p.id];return n.jsxs("div",{className:"glass-card rounded-2xl p-6 hover:shadow-xl transition transform hover:-translate-y-1 flex flex-col items-center",children:[p.logoUrl?n.jsx("img",{src:p.logoUrl,className:"w-24 h-24 rounded-full mb-4 object-cover border-4 border-sky-300 shadow"}):n.jsx("div",{className:"w-24 h-24 rounded-full bg-sky-100 flex items-center justify-center text-3xl mb-4",children:""}),n.jsx("h3",{className:"font-bold text-lg mb-2 text-sky-900",children:p.name}),g?n.jsxs("span",{className:`mt-3 px-4 py-2 rounded-xl text-sm font-semibold flex items-center gap-2 ${g.status==="pending"?"bg-amber-100 text-amber-700 border border-amber-200":g.status==="accepted"?"bg-green-100 text-green-700 border border-green-200":"bg-red-100 text-red-700 border border-red-200"}`,children:[g.status==="pending"&&n.jsx(Rt,{className:"w-4 h-4"}),g.status==="accepted"&&n.jsx(a6,{className:"w-4 h-4"}),g.status==="rejected"&&n.jsx(li,{className:"w-4 h-4"}),g.status==="pending"?" ":g.status==="accepted"?"  ":" "]}):n.jsx("button",{disabled:d===p.id,onClick:()=>h(p),className:"mt-4 w-full px-4 py-2 rounded-xl bg-gradient-to-r from-sky-500 to-sky-600 text-white font-bold shadow-lg shadow-sky-200/50 hover:shadow-xl hover:scale-105 transition disabled:opacity-50",children:d===p.id?"  ...":"  "})]},p.id)})})]})},AD=[{text:"  ",emoji:""},{text:" ! ",emoji:""},{text:"  ",emoji:""},{text:"  ",emoji:""},{text:" ",emoji:""},{text:"! ",emoji:""}],RD=[{text:"   ",emoji:""},{text:" ! ",emoji:""},{text:"   ",emoji:""},{text:"    ",emoji:""},{text:"! ",emoji:""},{text:" ",emoji:""}],PD=[{text:"  ! ",emoji:""},{text:"! ",emoji:""},{text:"  ",emoji:""},{text:"   ",emoji:""},{text:"  ",emoji:""},{text:" ! ",emoji:""}],DD=[{text:"   ",emoji:""},{text:" ! ",emoji:""},{text:"   ",emoji:""},{text:" ! ",emoji:""},{text:"   ",emoji:""},{text:"   ",emoji:""}],OD=["","","","","","","","","","","",""],LD=()=>{const[t]=Nh(),e=t.get("orderId"),s=ys(),{user:r,role:i}=Ue(),a=Jt(),[o,l]=_.useState(null),[d,u]=_.useState([]),[h,p]=_.useState(""),[g,y]=_.useState(!1),[w,C]=_.useState(!1),[E,N]=_.useState(""),v=_.useRef(null),k=i==="courier",P=i==="owner",O=i==="customer"||i==="admin",U=o&&!o.courierId&&o.restaurantId,m=k?PD:P?DD:O&&U?RD:AD;_.useEffect(()=>{if(!e)return;const V=qn(X(B,"orders",e),z=>{if(z.exists()){const L=z.data();l({id:z.id,status:L.status,address:L.address,total:L.total,customerId:L.customerId,courierId:L.courierId,restaurantId:L.restaurantId,restaurantName:L.restaurantName})}});return()=>V()},[e]),_.useEffect(()=>{if(!o)return;let V,z="customer";if(k||P?(V=o.customerId,z="customer"):O&&(o.courierId?(V=o.courierId,z="courier"):o.restaurantId&&(V=o.restaurantId,z="restaurant")),!V){N(U?o.restaurantName||"":" ");return}z==="restaurant"?Ce(X(B,"restaurants",V)).then(L=>{var $;L.exists()?N((($=L.data())==null?void 0:$.name)||""):N(o.restaurantName||"")}):Ce(X(B,"users",V)).then(L=>{var $;if(L.exists()){const M=z==="courier"?"":"";N((($=L.data())==null?void 0:$.name)||M)}})},[o,k,P,O,U]),_.useEffect(()=>{if(!e)return;const V=je(re(B,"orders",e,"messages"),ln("createdAt","asc")),z=qn(V,L=>{u(L.docs.map($=>({id:$.id,...$.data()})))});return()=>z()},[e]),_.useEffect(()=>{var V;(V=v.current)==null||V.scrollIntoView({behavior:"smooth"})},[d]);const j=async V=>{if(!(!V.trim()||!r||!e)){y(!0);try{let z="customer";k?z="courier":P&&(z="owner"),await tt(re(B,"orders",e,"messages"),{text:V.trim(),senderId:r.uid,senderRole:z,createdAt:se()}),p(""),C(!1)}catch{a.error("  ")}y(!1)}},I=V=>{p(z=>z+V)},T=V=>V?V.toDate().toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}):"",D=V=>({pending:{text:" ",color:"bg-yellow-500",emoji:""},accepted:{text:" ",color:"bg-blue-500",emoji:""},preparing:{text:" ",color:"bg-orange-500",emoji:""},ready:{text:"",color:"bg-purple-500",emoji:""},out_for_delivery:{text:" ",color:"bg-sky-500",emoji:""},delivered:{text:" ",color:"bg-green-500",emoji:""}})[V]||{text:V,color:"bg-gray-500",emoji:""},S=()=>k||P?"":U?"":"";if(!e)return n.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Uc,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),n.jsx("p",{className:"text-gray-500",children:"   "})]})});if(!o)return n.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-500",children:" ..."})]})});if(!((r==null?void 0:r.uid)===o.customerId||(r==null?void 0:r.uid)===o.courierId||(r==null?void 0:r.uid)===o.restaurantId))return n.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-6xl mb-4",children:""}),n.jsx("p",{className:"text-gray-500",children:"     "})]})});const F=D(o.status);return n.jsxs("div",{className:"flex flex-col h-[calc(100vh-200px)] max-w-2xl mx-auto",children:[n.jsxs("div",{className:`bg-gradient-to-r ${U?"from-orange-500 via-amber-500 to-yellow-500":"from-primary via-sky-500 to-accent"} rounded-t-3xl p-4 shadow-luxury`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{onClick:()=>s(-1),className:"w-10 h-10 rounded-full bg-white/20 backdrop-blur flex items-center justify-center hover:bg-white/30 transition-all",children:n.jsx($n,{className:"w-5 h-5 text-white"})}),n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 backdrop-blur flex items-center justify-center",children:n.jsx("span",{className:"text-2xl",children:S()})}),n.jsxs("div",{children:[n.jsx("h2",{className:"font-bold text-white text-lg",children:E||(U?"":k||P?"":"")}),n.jsxs("div",{className:"flex items-center gap-1 text-white/80 text-sm",children:[n.jsx("span",{className:`w-2 h-2 rounded-full ${o.status==="delivered"?"bg-green-400":"bg-yellow-400 animate-pulse"}`}),n.jsxs("span",{children:[F.emoji," ",F.text]})]})]})]})}),U?n.jsx(lt,{className:"w-6 h-6 text-white animate-pulse"}):n.jsx(Us,{className:"w-6 h-6 text-yellow-300 animate-pulse"})]}),n.jsxs("div",{className:"mt-3 flex items-center gap-4 text-white/90 text-sm",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Bt,{className:"w-4 h-4"}),n.jsxs("span",{children:["#",o.id.slice(-6)]})]}),o.restaurantName&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4"}),n.jsx("span",{children:o.restaurantName})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Nt,{className:"w-4 h-4"}),n.jsx("span",{className:"truncate max-w-[150px]",children:o.address})]})]})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto bg-gradient-to-b from-sky-50 to-white p-4 space-y-3",children:[d.length===0&&n.jsxs("div",{className:"text-center py-10",children:[n.jsx("div",{className:"text-6xl mb-4",children:""}),n.jsx("p",{className:"text-gray-500",children:"  !"}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"  "})]}),d.map((V,z)=>{const L=V.senderId===(r==null?void 0:r.uid);return n.jsx("div",{className:`flex ${L?"justify-start":"justify-end"}`,children:n.jsxs("div",{className:`
                  max-w-[80%] rounded-2xl px-4 py-3 shadow-md
                  ${L?"bg-gradient-to-br from-primary to-sky-600 text-white rounded-br-sm":"bg-white text-gray-800 rounded-bl-sm border border-gray-100"}
                  transform transition-all duration-300 hover:scale-[1.02]
                `,children:[n.jsx("p",{className:"text-base leading-relaxed",children:V.text}),n.jsxs("div",{className:`flex items-center gap-1 mt-1 text-xs ${L?"text-white/70":"text-gray-400"}`,children:[n.jsx(Rt,{className:"w-3 h-3"}),n.jsx("span",{children:T(V.createdAt)}),L&&n.jsx(ew,{className:"w-3 h-3 mr-1"})]})]})},V.id)}),n.jsx("div",{ref:v})]}),n.jsx("div",{className:"bg-white border-t border-gray-100 px-3 py-2",children:n.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:m.map((V,z)=>n.jsx("button",{onClick:()=>j(V.text),className:`flex-shrink-0 px-4 py-2 bg-gradient-to-r from-sky-50 to-blue-50 
                         rounded-full text-sm text-primary font-medium border border-sky-100
                         hover:from-sky-100 hover:to-blue-100 hover:shadow-md 
                         transition-all duration-200 active:scale-95`,children:V.text},z))})}),w&&n.jsx("div",{className:"bg-white border-t border-gray-100 px-4 py-3",children:n.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:OD.map((V,z)=>n.jsx("button",{onClick:()=>I(V),className:`w-10 h-10 text-2xl hover:bg-gray-100 rounded-full 
                           transition-all duration-200 hover:scale-125 active:scale-95`,children:V},z))})}),n.jsx("div",{className:"bg-white border-t border-gray-200 p-3",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>C(!w),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all
                       ${w?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:n.jsx(y3,{className:"w-5 h-5"})}),n.jsx("div",{className:"flex-1 relative",children:n.jsx("input",{type:"text",value:h,onChange:V=>p(V.target.value),onKeyPress:V=>V.key==="Enter"&&j(h),placeholder:" ...",className:`w-full px-5 py-3 bg-gray-100 rounded-full text-gray-800 
                         placeholder-gray-400 focus:outline-none focus:ring-2 
                         focus:ring-primary/50 focus:bg-white transition-all`})}),n.jsx("button",{onClick:()=>j(h),disabled:!h.trim()||g,className:`w-12 h-12 rounded-full flex items-center justify-center transition-all
                       ${h.trim()?"bg-gradient-to-r from-primary to-accent text-white shadow-lg hover:shadow-xl hover:scale-105":"bg-gray-200 text-gray-400"}
                       disabled:opacity-50 active:scale-95`,children:n.jsx(i3,{className:"w-5 h-5"})})]})}),o.status==="delivered"&&n.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 p-4 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-2 text-white",children:[n.jsx(ew,{className:"w-6 h-6"}),n.jsx("span",{className:"font-bold",children:"   ! "}),n.jsx(eh,{className:"w-5 h-5 text-red-300 animate-pulse"})]}),n.jsx("p",{className:"text-white/80 text-sm mt-1",children:"   "})]})]})},MD=()=>{const{user:t}=Ue(),e=Jt(),s=ys(),[r,i]=_.useState([]),[a,o]=_.useState(!0);_.useEffect(()=>{if(!t)return;const g=je(re(B,"notifications"),Ne("recipientId","==",t.uid),ln("createdAt","desc")),y=qn(g,w=>{const C=w.docs.map(E=>({id:E.id,...E.data()}));i(C),o(!1)},w=>{console.error("Error fetching notifications:",w),o(!1)});return()=>y()},[t]);const l=async g=>{try{await fe(X(B,"notifications",g),{read:!0})}catch(y){console.error("Error marking as read:",y)}},d=async()=>{const g=r.filter(y=>!y.read);try{await Promise.all(g.map(y=>fe(X(B,"notifications",y.id),{read:!0}))),e.success("   ")}catch{e.error("  ")}},u=async g=>{try{await sn(X(B,"notifications",g)),e.success("  ")}catch{e.error("  ")}},h=g=>{if(!g)return"";const y=g.toDate(),C=new Date().getTime()-y.getTime(),E=Math.floor(C/6e4),N=Math.floor(C/36e5),v=Math.floor(C/864e5);return E<1?"":E<60?` ${E} `:N<24?` ${N} `:v<7?` ${v} `:y.toLocaleDateString("ar-SA")},p=r.filter(g=>!g.read).length;return a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx(os,{className:"w-8 h-8 animate-spin text-sky-500"})}):n.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-white",children:[n.jsx("div",{className:"bg-white shadow-sm sticky top-0 z-10",children:n.jsx("div",{className:"max-w-2xl mx-auto px-4 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("button",{onClick:()=>s(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800",children:[n.jsx($n,{className:"w-5 h-5"}),""]}),n.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[n.jsx(hc,{className:"w-6 h-6 text-sky-500"}),"",p>0&&n.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:p})]}),p>0&&n.jsx("button",{onClick:d,className:"text-sm text-sky-600 hover:text-sky-800",children:" "})]})})}),n.jsx("div",{className:"max-w-2xl mx-auto px-4 py-6",children:r.length===0?n.jsxs("div",{className:"text-center py-16",children:[n.jsx(hc,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),n.jsx("p",{className:"text-gray-500",children:"  "})]}):n.jsx("div",{className:"space-y-3",children:r.map(g=>n.jsx("div",{className:`bg-white rounded-2xl p-4 shadow-sm border transition hover:shadow-md ${g.read?"border-gray-100":"border-sky-200 bg-sky-50/50"}`,onClick:()=>!g.read&&l(g.id),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`p-2 rounded-xl ${g.type==="license_reminder"?"bg-orange-100 text-orange-600":"bg-sky-100 text-sky-600"}`,children:n.jsx(Dn,{className:"w-5 h-5"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:g.title}),n.jsx("span",{className:"text-xs text-gray-400 whitespace-nowrap",children:h(g.createdAt)})]}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:g.message}),!g.read&&n.jsx("span",{className:"inline-block mt-2 text-xs bg-sky-100 text-sky-700 px-2 py-0.5 rounded-full",children:""})]}),n.jsxs("div",{className:"flex flex-col gap-1",children:[!g.read&&n.jsx("button",{onClick:y=>{y.stopPropagation(),l(g.id)},className:"p-1.5 text-gray-400 hover:text-green-500 transition",title:" ",children:n.jsx(_s,{className:"w-4 h-4"})}),n.jsx("button",{onClick:y=>{y.stopPropagation(),u(g.id)},className:"p-1.5 text-gray-400 hover:text-red-500 transition",title:"",children:n.jsx(Ss,{className:"w-4 h-4"})})]})]})},g.id))})})]})},VD=()=>{var U,b;const{user:t,role:e}=Ue(),s=Jt(),[r,i]=_.useState("dashboard"),[a,o]=_.useState({totalRestaurants:0,totalOrders:0,totalEarnings:0,pendingOrders:0}),[l,d]=_.useState(0),[u,h]=_.useState(!0),[p,g]=_.useState(null),[y,w]=_.useState([]),[C,E]=_.useState("all"),[N,v]=_.useState([]),[k,P]=_.useState(null);_.useEffect(()=>{t&&(async()=>{try{const m=je(re(B,"restaurants"),Ne("referredBy","==",t.uid)),I=(await ve(m)).docs.map(V=>({id:V.id,...V.data()}));v(I);const T=I.length,D=I.map(V=>V.id);let S=0,W=0,F=0;if(D.length>0){const V=je(re(B,"orders"),Ne("status","==","pending"),ia(100));S=(await ve(V)).docs.filter(M=>D.includes(M.data().restaurantId)).length;const $=(await ve(re(B,"orders"))).docs.filter(M=>D.includes(M.data().restaurantId));W=$.length,F=$.reduce((M,G)=>M+(G.data().deliveryFee||0),0)}try{const z=(await Ce(X(B,"wallets",t.uid))).data();d((z==null?void 0:z.balance)||0)}catch{d(0)}try{const V=je(re(B,"tasks"),Ne("assignedTo","==",t.uid)),L=(await ve(V)).docs.map($=>({id:$.id,...$.data()}));w(L.sort(($,M)=>{var G,Y;return(((G=M.createdAt)==null?void 0:G.seconds)||0)-(((Y=$.createdAt)==null?void 0:Y.seconds)||0)}))}catch(V){console.error("   :",V)}o({totalRestaurants:T,totalOrders:W,totalEarnings:F,pendingOrders:S})}catch(m){console.error("   :",m)}finally{h(!1)}})()},[t]);const O=async(m,j)=>{try{const I={status:j,updatedAt:se()};j==="completed"&&(I.completedAt=se()),await fe(X(B,"tasks",m),I),w(T=>T.map(D=>D.id===m?{...D,status:j}:D)),s.success(j==="in_progress"?"  ":j==="completed"?"   ! ":"  ")}catch{s.error("   ")}};return _.useEffect(()=>{t&&(async()=>{try{const m=await Ce(X(B,"users",t.uid));m.exists()&&g({uid:m.id,...m.data()})}catch(m){console.error("    :",m)}})()},[t]),u?n.jsx(We,{allow:["admin"],children:n.jsx("div",{className:"flex items-center justify-center h-96 text-lg",children:" ..."})}):n.jsx(We,{allow:["admin"],children:n.jsxs("div",{className:"space-y-8",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h1",{className:"text-4xl font-extrabold text-primary",children:"  "}),n.jsx("p",{className:"text-gray-600 mt-2",children:"   ! "})]}),n.jsxs("div",{className:"flex justify-center gap-4 mb-6 flex-wrap",children:[n.jsxs("button",{onClick:()=>i("dashboard"),className:`px-6 py-3 rounded-xl font-bold transition flex items-center gap-2 ${r==="dashboard"?"bg-primary text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(ou,{className:"w-5 h-5"})," "]}),n.jsxs("button",{onClick:()=>i("myRestaurants"),className:`px-6 py-3 rounded-xl font-bold transition flex items-center gap-2 relative ${r==="myRestaurants"?"bg-primary text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(lt,{className:"w-5 h-5"}),"",n.jsx("span",{className:"bg-white/20 text-xs px-2 py-0.5 rounded-full",children:N.length})]}),n.jsxs("button",{onClick:()=>i("profile"),className:`px-6 py-3 rounded-xl font-bold transition flex items-center gap-2 ${r==="profile"?"bg-primary text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(en,{className:"w-5 h-5"}),""]}),n.jsxs("button",{onClick:()=>i("tasks"),className:`px-6 py-3 rounded-xl font-bold transition flex items-center gap-2 relative ${r==="tasks"?"bg-primary text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(pc,{className:"w-5 h-5"}),"",y.filter(m=>m.status==="pending"||m.status==="in_progress").length>0&&n.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center",children:y.filter(m=>m.status==="pending"||m.status==="in_progress").length})]})]}),r==="myRestaurants"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-gradient-to-r from-primary to-sky-700 rounded-2xl shadow-lg p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm opacity-90",children:"  "}),n.jsx("h2",{className:"text-4xl font-bold",children:N.length}),n.jsx("p",{className:"text-sm opacity-75 mt-2",children:"        "})]}),n.jsx(lt,{className:"w-16 h-16 opacity-80"})]})}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-2xl font-bold text-primary mb-6 flex items-center gap-2",children:[n.jsx(lt,{className:"w-6 h-6"}),"  "]}),N.length===0?n.jsxs("div",{className:"text-center py-12 text-gray-500",children:[n.jsx("p",{className:"text-5xl mb-4",children:""}),n.jsx("p",{className:"text-lg font-semibold",children:"     "}),n.jsx("p",{className:"text-sm mt-2",children:'  "  "   '}),n.jsx(de,{to:"/admin/add-restaurant",className:"inline-block mt-4 bg-primary hover:bg-red-900 text-white px-6 py-3 rounded-xl font-semibold transition",children:"   "})]}):n.jsx("div",{className:"space-y-4",children:N.map(m=>{var j,I,T;return n.jsxs("div",{className:"border-2 rounded-2xl overflow-hidden hover:border-primary transition",children:[n.jsxs("div",{className:"p-4 cursor-pointer hover:bg-gray-50 flex items-center justify-between",onClick:()=>P(k===m.id?null:m.id),children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 rounded-xl bg-gray-100 overflow-hidden flex-shrink-0",children:m.logoUrl?n.jsx("img",{src:m.logoUrl,alt:m.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-2xl",children:""})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-lg text-gray-800",children:m.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:[m.city||" ","  ",m.phone||" "]}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[m.isVerified?n.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-100 text-green-700 text-xs font-semibold rounded-full",children:" "}):n.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs font-semibold rounded-full",children:"  "}),m.packageType==="premium"&&n.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-amber-100 text-amber-700 text-xs font-semibold rounded-full",children:" "})]})]})]}),n.jsx("div",{className:"flex items-center gap-2",children:k===m.id?n.jsx(S1,{className:"w-5 h-5 text-gray-400"}):n.jsx(Lx,{className:"w-5 h-5 text-gray-400"})})]}),k===m.id&&n.jsx("div",{className:"border-t bg-gray-50 p-4",children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-gray-500",children:""}),n.jsx("p",{className:"font-mono text-xs text-gray-700 truncate",children:m.id})]}),n.jsxs("div",{className:"bg-white rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-gray-500",children:""}),n.jsx("p",{className:"text-sm text-gray-700 truncate",children:m.email||"-"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-gray-500",children:""}),n.jsx("p",{className:"text-sm text-gray-700 truncate",children:m.location||"-"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-gray-500",children:" "}),n.jsx("p",{className:"text-sm text-gray-700",children:((T=(I=(j=m.createdAt)==null?void 0:j.toDate)==null?void 0:I.call(j))==null?void 0:T.toLocaleDateString("ar-SA"))||(m.createdAt instanceof Date?m.createdAt.toLocaleDateString("ar-SA"):"-")})]})]})})]},m.id)})}),N.length>0&&n.jsx(de,{to:"/admin/add-restaurant",className:"block mt-6 w-full bg-primary hover:bg-red-900 text-white rounded-xl p-3 text-center font-semibold transition",children:"   "})]})]}),r==="profile"&&n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-2xl font-bold text-primary mb-6 flex items-center gap-2",children:[n.jsx(en,{className:"w-6 h-6"}),""]}),p?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-gradient-to-r from-sky-50 to-blue-50 rounded-2xl p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx("div",{className:"w-20 h-20 bg-primary rounded-full flex items-center justify-center text-white text-3xl font-bold",children:((U=p.name)==null?void 0:U.charAt(0))||((b=p.email)==null?void 0:b.charAt(0))||""}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:p.name||" "}),n.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-bold bg-sky-100 text-sky-800 mt-2",children:" "})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:" "}),n.jsx("p",{className:"font-semibold text-gray-900 font-mono",children:p.email})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:""}),n.jsx("p",{className:"font-semibold text-gray-900",children:e==="admin"?"":e})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:" "}),n.jsx("p",{className:"font-semibold text-gray-600 text-xs font-mono break-all",children:p.uid})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"font-bold text-green-600 text-xl",children:[l.toFixed(2)," ."]})]})]})]}),n.jsx(de,{to:"/profile",className:"block w-full bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-xl p-4 text-center font-semibold transition",children:"   "})]}):n.jsx("div",{className:"text-center py-8 text-gray-600",children:" ..."})]}),r==="tasks"&&n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-2xl font-bold text-primary mb-6 flex items-center gap-2",children:[n.jsx(pc,{className:"w-6 h-6"})," "]}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:["all","pending","in_progress","completed"].map(m=>n.jsxs("button",{onClick:()=>E(m),className:`px-4 py-2 rounded-xl font-semibold transition ${C===m?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[m==="all"&&" ",m==="pending"&&"  ",m==="in_progress"&&"  ",m==="completed"&&" "]},m))}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-yellow-50 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:y.filter(m=>m.status==="pending").length}),n.jsx("p",{className:"text-sm text-yellow-700",children:" "})]}),n.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-blue-600",children:y.filter(m=>m.status==="in_progress").length}),n.jsx("p",{className:"text-sm text-blue-700",children:" "})]}),n.jsxs("div",{className:"bg-green-50 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:y.filter(m=>m.status==="completed").length}),n.jsx("p",{className:"text-sm text-green-700",children:""})]})]}),y.filter(m=>C==="all"||m.status===C).length===0?n.jsxs("div",{className:"text-center py-12 text-gray-500",children:[n.jsx("p",{className:"text-5xl mb-4",children:""}),n.jsxs("p",{className:"text-lg",children:["   ",C!=="all"&&"  "]}),n.jsx("p",{className:"text-sm mt-2",children:"      "})]}):n.jsx("div",{className:"space-y-4",children:y.filter(m=>C==="all"||m.status===C).map(m=>{var j,I,T;return n.jsx("div",{className:`border-2 rounded-2xl p-4 transition ${m.status==="completed"?"bg-green-50 border-green-200":m.status==="in_progress"?"bg-blue-50 border-blue-200":m.priority==="high"?"bg-red-50 border-red-200":"bg-white border-gray-200"}`,children:n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${m.priority==="high"?"bg-red-100 text-red-700":m.priority==="medium"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:m.priority==="high"?" ":m.priority==="medium"?" ":" "}),n.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${m.status==="pending"?"bg-yellow-100 text-yellow-700":m.status==="in_progress"?"bg-blue-100 text-blue-700":m.status==="completed"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[m.status==="pending"&&"  ",m.status==="in_progress"&&"  ",m.status==="completed"&&" ",m.status==="cancelled"&&" "]})]}),n.jsx("h3",{className:"font-bold text-lg text-gray-800",children:m.title}),m.description&&n.jsx("p",{className:"text-gray-600 mt-1",children:m.description}),n.jsxs("div",{className:"flex flex-wrap gap-3 mt-3 text-sm text-gray-500",children:[m.dueDate&&n.jsxs("span",{className:new Date(m.dueDate)<new Date&&m.status!=="completed"?"text-red-600 font-semibold":"",children:[" ",new Date(m.dueDate).toLocaleDateString("ar-SA"),new Date(m.dueDate)<new Date&&m.status!=="completed"&&" (!)"]}),n.jsxs("span",{children:[" ",((T=(I=(j=m.createdAt)==null?void 0:j.toDate)==null?void 0:I.call(j))==null?void 0:T.toLocaleDateString("ar-SA"))||" "]})]}),m.notes&&n.jsxs("p",{className:"text-sm text-gray-500 mt-2 bg-gray-100 p-2 rounded",children:[" ",m.notes]})]}),n.jsxs("div",{className:"flex flex-col gap-2",children:[m.status==="pending"&&n.jsx("button",{onClick:()=>O(m.id,"in_progress"),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl font-semibold transition",children:" "}),m.status==="in_progress"&&n.jsxs("button",{onClick:()=>O(m.id,"completed"),className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-xl font-semibold transition",children:[n.jsx(Xe,{className:"w-4 h-4"}),""]}),m.status==="completed"&&n.jsx("span",{className:"text-green-600 font-semibold text-center",children:"  "})]})]})},m.id)})})]})}),r==="dashboard"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"bg-gradient-to-r from-primary to-sky-700 rounded-2xl shadow-lg p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm opacity-90",children:" "}),n.jsxs("h2",{className:"text-3xl font-bold",children:[l.toFixed(2)," ."]}),n.jsx("p",{className:"text-sm opacity-75 mt-2",children:"   50       "})]}),n.jsx($x,{className:"w-16 h-16 opacity-80"})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsx("div",{className:"bg-white rounded-2xl shadow p-6 hover:shadow-lg transition",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600 text-sm",children:" "}),n.jsx("h3",{className:"text-3xl font-bold text-primary mt-2",children:a.totalRestaurants})]}),n.jsx(Pn,{className:"w-12 h-12 text-primary opacity-30"})]})}),n.jsx("div",{className:"bg-white rounded-2xl shadow p-6 hover:shadow-lg transition",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600 text-sm",children:" "}),n.jsx("h3",{className:"text-3xl font-bold text-blue-600 mt-2",children:a.totalOrders})]}),n.jsx(nh,{className:"w-12 h-12 text-blue-600 opacity-30"})]})}),n.jsx("div",{className:"bg-white rounded-2xl shadow p-6 hover:shadow-lg transition",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600 text-sm",children:" "}),n.jsx("h3",{className:"text-3xl font-bold text-yellow-600 mt-2",children:a.pendingOrders})]}),n.jsx(ou,{className:"w-12 h-12 text-yellow-600 opacity-30"})]})}),n.jsx("div",{className:"bg-white rounded-2xl shadow p-6 hover:shadow-lg transition",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600 text-sm",children:" "}),n.jsx("h3",{className:"text-3xl font-bold text-green-600 mt-2",children:a.totalEarnings.toFixed(2)})]}),n.jsx(ou,{className:"w-12 h-12 text-green-600 opacity-30"})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 hover:shadow-lg transition",children:[n.jsx("h3",{className:"text-xl font-bold text-primary mb-4",children:" "}),n.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"      "}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(de,{to:"/admin/add-restaurant",className:"block w-full bg-primary hover:bg-red-900 text-white rounded-xl p-3 text-center font-semibold transition",children:"   "}),n.jsx(de,{to:"/admin/restaurants",className:"block w-full bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-xl p-3 text-center font-semibold transition",children:"  "})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 hover:shadow-lg transition",children:[n.jsx("h3",{className:"text-xl font-bold text-primary mb-4",children:" "}),n.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"     "}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(de,{to:"/admin/orders",className:"block w-full bg-blue-600 hover:bg-blue-700 text-white rounded-xl p-3 text-center font-semibold transition",children:"  "}),n.jsx(de,{to:"/admin/orders?status=pending",className:"block w-full bg-yellow-500 hover:bg-yellow-600 text-white rounded-xl p-3 text-center font-semibold transition",children:"  "})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 hover:shadow-lg transition",children:[n.jsx("h3",{className:"text-xl font-bold text-primary mb-4",children:""}),n.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"       "}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(de,{to:"/menu",className:"block w-full bg-green-600 hover:bg-green-700 text-white rounded-xl p-3 text-center font-semibold transition",children:"  "}),n.jsx(de,{to:"/orders",className:"block w-full bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-xl p-3 text-center font-semibold transition",children:" "})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 hover:shadow-lg transition",children:[n.jsx("h3",{className:"text-xl font-bold text-primary mb-4",children:" "}),n.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"      "}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"block w-full bg-gradient-to-r from-primary to-sky-700 text-white rounded-xl p-3 text-center font-semibold",children:[" : ",l.toFixed(2)," ."]}),n.jsx(de,{to:"/admin/wallet",className:"block w-full bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-xl p-3 text-center font-semibold transition",children:"  "})]})]})]}),n.jsxs("div",{className:"bg-sky-50 border-l-4 border-sky-500 p-6 rounded-lg",children:[n.jsx("h4",{className:"font-bold text-sky-900 mb-2",children:"  :"}),n.jsxs("ul",{className:"text-sky-800 text-sm space-y-1",children:[n.jsxs("li",{children:[" ",n.jsx("strong",{children:"50 "}),"         "]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"1 "}),"     (     )"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"1.5 "}),"       "]}),n.jsx("li",{children:"        "})]})]})]})]})})},FD=()=>{const{user:t,role:e}=Ue(),s=Jt(),r=cn(),[i,a]=_.useState([]),[o,l]=_.useState(!0),[d,u]=_.useState(!1),[h,p]=_.useState(!1),[g,y]=_.useState(0),w=_.useRef(null),C=Yh(Ps),[E,N]=_.useState({name:"",phone:"",city:"",location:"",logoFile:null,logoPreview:""});_.useEffect(()=>{t&&v()},[t]);const v=async()=>{if(t)try{let m=[];if(e==="developer")m=(await ve(re(B,"restaurants"))).docs.map(I=>({id:I.id,...I.data()}));else{const j=je(re(B,"restaurants"),Ne("referredBy","==",t.uid));m=(await ve(j)).docs.map(T=>({id:T.id,...T.data()}))}a(m)}catch(m){s.error("   "),console.error(m)}finally{l(!1)}},k=async m=>{if(m.preventDefault(),!E.name.trim()){s.warning("  ");return}try{p(!0);let j="";if(E.logoFile){const D=E.logoFile.name.replace(/\s+/g,"_").slice(-60),S=`uploads/restaurant_${Date.now()}_${D}`,W=Nr(C,S),F=Xu(W,E.logoFile,{contentType:E.logoFile.type||"image/jpeg"});await new Promise((V,z)=>{F.on("state_changed",L=>{const $=Math.round(L.bytesTransferred/L.totalBytes*100);y($)},z,async()=>{j=await br(F.snapshot.ref),V()})})}const I=e==="admin",T=e==="developer";await tt(re(B,"restaurants"),{name:E.name,phone:E.phone,city:E.city,location:E.location,ownerId:"admin_"+Date.now(),email:(t==null?void 0:t.email)||"",logoUrl:j,createdAt:new Date,referredBy:I?t==null?void 0:t.uid:null,referrerType:I?"admin":T?"developer":null}),s.success("    "),I&&s.info("   75        "),N({name:"",phone:"",city:"",location:"",logoFile:null,logoPreview:""}),u(!1),y(0),v()}catch(j){s.error("   "),console.error(j)}finally{p(!1)}},P=async m=>{if(await r.confirm("      ",{dangerous:!0,title:" "}))try{await sn(X(B,"restaurants",m)),s.success("   "),v()}catch(I){s.error("   "),console.error(I)}},O=async m=>{const j=!m.isVerified;if(await r.confirm(j?`    "${m.name}"`:`     "${m.name}"`,{title:j?"  ":"  ",confirmText:j?" ":"  "}))try{await fe(X(B,"restaurants",m.id),{isVerified:j,verifiedAt:j?se():null,updatedAt:se()}),s.success(j?"   ":"  "),v()}catch(T){s.error(" "),console.error(T)}},U=async(m,j)=>{try{await fe(X(B,"restaurants",m.id),{sellerTier:j,tierUpdatedAt:se(),updatedAt:se()});const I={bronze:"",silver:"",gold:""};s.success(`    ${I[j]} `),v()}catch(I){s.error(" "),console.error(I)}},b=({tier:m})=>{switch(m){case"gold":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gradient-to-r from-amber-400 to-yellow-400 text-white text-xs font-bold rounded-full shadow",children:[n.jsx(Vt,{className:"w-3 h-3"})," Gold"]});case"silver":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gradient-to-r from-gray-300 to-gray-400 text-gray-800 text-xs font-bold rounded-full shadow",children:[n.jsx(Dp,{className:"w-3 h-3"})," Silver"]});default:return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gradient-to-r from-amber-600 to-orange-600 text-white text-xs font-bold rounded-full shadow",children:[n.jsx(au,{className:"w-3 h-3"})," Bronze"]})}};return o?n.jsx(We,{allow:["admin","developer"],children:n.jsx("div",{className:"flex items-center justify-center h-96",children:" ..."})}):n.jsx(We,{allow:["admin","developer"],children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-3xl font-bold text-primary",children:" "}),n.jsxs("button",{onClick:()=>u(!d),className:"flex items-center gap-2 bg-primary hover:bg-red-900 text-white px-6 py-3 rounded-xl font-semibold transition",children:[n.jsx($c,{className:"w-5 h-5"}),"  "]})]}),d&&n.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[n.jsx("h2",{className:"text-xl font-bold mb-4",children:"  "}),n.jsxs("form",{onSubmit:k,className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block font-semibold text-gray-700",children:" "}),n.jsxs("div",{className:"flex items-center gap-4",children:[E.logoPreview?n.jsx("img",{src:E.logoPreview,alt:" ",className:"w-20 h-20 rounded-xl object-cover border-2 border-sky-200"}):n.jsx("div",{className:"w-20 h-20 rounded-xl bg-gray-100 flex items-center justify-center border-2 border-dashed border-gray-300",children:n.jsx(C1,{className:"w-8 h-8 text-gray-400"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("input",{ref:w,type:"file",accept:"image/*",className:"hidden",onChange:m=>{var I;const j=(I=m.target.files)==null?void 0:I[0];j&&N({...E,logoFile:j,logoPreview:URL.createObjectURL(j)})}}),n.jsxs("button",{type:"button",onClick:()=>{var m;return(m=w.current)==null?void 0:m.click()},className:"flex items-center gap-2 px-4 py-2 bg-sky-100 hover:bg-sky-200 text-sky-700 rounded-xl font-semibold transition",children:[n.jsx(Ux,{className:"w-4 h-4"}),E.logoFile?" ":" "]}),E.logoFile&&n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:E.logoFile.name})]})]}),h&&g>0&&n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"bg-sky-500 h-2 rounded-full transition-all",style:{width:`${g}%`}})})]}),n.jsx("input",{type:"text",placeholder:" ",value:E.name,onChange:m=>N({...E,name:m.target.value}),className:"w-full border rounded-xl p-3 text-gray-900"}),n.jsx("input",{type:"text",placeholder:" ",value:E.phone,onChange:m=>N({...E,phone:m.target.value}),className:"w-full border rounded-xl p-3 text-gray-900"}),n.jsx("input",{type:"text",placeholder:"",value:E.city,onChange:m=>N({...E,city:m.target.value}),className:"w-full border rounded-xl p-3 text-gray-900"}),n.jsx("textarea",{placeholder:" / ",value:E.location,onChange:m=>N({...E,location:m.target.value}),className:"w-full border rounded-xl p-3 text-gray-900"}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"submit",disabled:h,className:"flex-1 bg-primary hover:bg-red-900 text-white rounded-xl p-3 font-semibold transition disabled:opacity-50",children:h?` ... ${g}%`:" "}),n.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-xl p-3 font-semibold transition",children:" "})]})]})]}),n.jsx("div",{className:"grid gap-4",children:i.length===0?n.jsx("div",{className:"text-center text-gray-500 py-12",children:"    "}):i.map(m=>n.jsx("div",{className:"bg-white rounded-2xl shadow p-6 hover:shadow-lg transition",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex gap-4",children:[m.logoUrl?n.jsx("img",{src:m.logoUrl,alt:m.name,className:"w-16 h-16 rounded-xl object-cover border-2 border-sky-100"}):n.jsx("div",{className:"w-16 h-16 rounded-xl bg-sky-100 flex items-center justify-center",children:n.jsx("span",{className:"text-2xl",children:""})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("h3",{className:"text-xl font-bold text-primary",children:m.name}),m.isVerified&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-100 text-green-700 text-xs font-bold rounded-full",children:[n.jsx(Xe,{className:"w-3 h-3"})," "]}),n.jsx(b,{tier:m.sellerTier})]}),m.city&&n.jsxs("p",{className:"text-gray-600 text-sm",children:[" ",m.city]}),m.phone&&n.jsxs("p",{className:"text-gray-600 text-sm",children:[" ",m.phone]}),m.location&&n.jsxs("p",{className:"text-gray-600 text-sm",children:[" ",m.location]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>O(m),className:`p-2.5 rounded-xl transition flex items-center gap-1 text-sm font-semibold ${m.isVerified?"bg-green-100 hover:bg-green-200 text-green-700":"bg-gray-100 hover:bg-gray-200 text-gray-600"}`,title:m.isVerified?" ":" ",children:[n.jsx(ha,{className:"w-4 h-4"}),m.isVerified?"":""]}),n.jsxs("div",{className:"relative group",children:[n.jsxs("button",{className:"p-2.5 rounded-xl bg-amber-100 hover:bg-amber-200 text-amber-700 transition flex items-center gap-1 text-sm font-semibold",children:[n.jsx(au,{className:"w-4 h-4"}),"",n.jsx(Lx,{className:"w-3 h-3"})]}),n.jsxs("div",{className:"absolute left-0 top-full mt-1 bg-white rounded-xl shadow-xl border opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-20 min-w-[140px]",children:[n.jsxs("button",{onClick:()=>U(m,"bronze"),className:`w-full px-4 py-2.5 text-right hover:bg-amber-50 transition flex items-center gap-2 first:rounded-t-xl ${m.sellerTier==="bronze"||!m.sellerTier?"bg-amber-50":""}`,children:[n.jsx(au,{className:"w-4 h-4 text-amber-600"}),n.jsx("span",{className:"font-semibold",children:"Bronze"})]}),n.jsxs("button",{onClick:()=>U(m,"silver"),className:`w-full px-4 py-2.5 text-right hover:bg-gray-50 transition flex items-center gap-2 ${m.sellerTier==="silver"?"bg-gray-100":""}`,children:[n.jsx(Dp,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"font-semibold",children:"Silver"})]}),n.jsxs("button",{onClick:()=>U(m,"gold"),className:`w-full px-4 py-2.5 text-right hover:bg-yellow-50 transition flex items-center gap-2 last:rounded-b-xl ${m.sellerTier==="gold"?"bg-yellow-50":""}`,children:[n.jsx(Vt,{className:"w-4 h-4 text-amber-500"}),n.jsx("span",{className:"font-semibold",children:"Gold"})]})]})]}),n.jsx("button",{onClick:()=>P(m.id),className:"p-2.5 bg-red-100 hover:bg-red-200 text-red-600 rounded-xl transition",title:" ",children:n.jsx(Ss,{className:"w-4 h-4"})})]})]})},m.id))})]})})},uf={pending:"  ",accepted:" ",preparing:"  ",ready:" ",out_for_delivery:"  ",delivered:"  ",cancelled:" "},UD=()=>{const{user:t,role:e}=Ue(),s=Jt(),[r,i]=_.useState([]),[a,o]=_.useState([]),[l,d]=_.useState(!0),[u,h]=_.useState("all"),[p,g]=_.useState([]);_.useEffect(()=>{if(!t)return;(async()=>{if(e==="developer")g([]);else{const C=je(re(B,"restaurants"),Ne("referredBy","==",t.uid)),N=(await ve(C)).docs.map(v=>v.id);g(N)}})()},[t,e]),_.useEffect(()=>{t&&y()},[u,t,e,p]);const y=async()=>{try{let w;u==="all"?w=je(re(B,"orders"),ln("createdAt","desc")):w=je(re(B,"orders"),Ne("status","==",u),ln("createdAt","desc"));let E=(await ve(w)).docs.map(N=>({id:N.id,...N.data()}));e!=="developer"&&p.length>0?E=E.filter(N=>p.includes(N.restaurantId||"")):e!=="developer"&&p.length===0&&(E=[]),o(E),i(E)}catch(w){s.error("   "),console.error(w)}finally{d(!1)}};return l?n.jsx(We,{allow:["admin","developer"],children:n.jsx("div",{className:"flex items-center justify-center h-96",children:" ..."})}):n.jsx(We,{allow:["admin","developer"],children:n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-3xl font-bold text-primary",children:" "}),n.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[n.jsxs("button",{onClick:()=>h("all"),className:`px-4 py-2 rounded-xl font-semibold transition whitespace-nowrap ${u==="all"?"bg-primary text-white":"bg-gray-200 text-gray-800 hover:bg-gray-300"}`,children:[" (",r.length,")"]}),["pending","accepted","preparing","ready","out_for_delivery","delivered"].map(w=>{const C=r.filter(E=>E.status===w).length;return n.jsxs("button",{onClick:()=>h(w),className:`px-4 py-2 rounded-xl font-semibold transition whitespace-nowrap ${u===w?"bg-primary text-white":"bg-gray-200 text-gray-800 hover:bg-gray-300"}`,children:[uf[w]," (",C,")"]},w)})]}),n.jsx("div",{className:"space-y-4",children:r.length===0?n.jsxs("div",{className:"text-center text-gray-500 py-12",children:["   ",u!=="all"&&` "${uf[u]}"`]}):r.map(w=>{var C,E;return n.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 hover:shadow-lg transition",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-bold",children:[" #",w.id.slice(-8)]}),n.jsx("p",{className:"text-gray-600 text-sm",children:w.createdAt?new Date(w.createdAt).toLocaleDateString("ar-SA"):""})]}),n.jsx("span",{className:`px-4 py-2 rounded-xl font-semibold text-white whitespace-nowrap ${w.status==="pending"?"bg-yellow-500":w.status==="delivered"?"bg-green-600":w.status==="cancelled"?"bg-red-600":"bg-blue-600"}`,children:uf[w.status]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600 text-sm",children:" ID"}),n.jsxs("p",{className:"font-mono text-sm text-gray-800",children:[w.customerId.slice(0,12),"..."]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600 text-sm",children:""}),n.jsx("p",{className:"font-semibold text-gray-800",children:w.restaurantName||""})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600 text-sm",children:""}),n.jsx("p",{className:"text-sm text-gray-800",children:w.address})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600 text-sm",children:""}),n.jsxs("p",{className:"text-lg font-bold text-primary",children:[((C=w.total)==null?void 0:C.toFixed(2))||0," ."]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 text-sm",children:[n.jsx("p",{className:"font-semibold mb-2",children:":"}),n.jsx("div",{className:"space-y-1",children:(E=w.items)==null?void 0:E.map((N,v)=>n.jsxs("div",{className:"flex justify-between text-gray-700",children:[n.jsxs("span",{children:[N.name,"  ",N.qty]}),n.jsxs("span",{children:[(N.price*N.qty).toFixed(2)," ."]})]},v))})]})]},w.id)})})]})})},Ys={projectId:Ps.options.projectId,authDomain:Ps.options.authDomain,storageBucket:Ps.options.storageBucket,messagingSenderId:Ps.options.messagingSenderId,appId:Ps.options.appId},$D=()=>{var Qs,Si,Ti,$o;const{user:t}=Ue(),e=Jt(),s=cn(),r=Yh(Ps),[i,a]=_.useState("overview"),[o,l]=_.useState(!0),[d,u]=_.useState(!1),[h,p]=_.useState({users:0,restaurants:0,menuItems:0,orders:0,pendingOrders:0,deliveredOrders:0,admins:0,couriers:0,customers:0,owners:0,totalAppEarnings:0}),[g,y]=_.useState({}),[w,C]=_.useState([]),[E,N]=_.useState([]),[v,k]=_.useState([]),[P,O]=_.useState([]),[U,b]=_.useState(!1),[m,j]=_.useState({}),[I,T]=_.useState(null),[D,S]=_.useState({}),[W,F]=_.useState(!1),[V,z]=_.useState(null),[L,$]=_.useState({}),[M,G]=_.useState("all"),[Y,ie]=_.useState("all"),[le,pe]=_.useState(null),[Ae,De]=_.useState(!1),[$e,jt]=_.useState(""),[Pt,rt]=_.useState(""),[qt,Hs]=_.useState(""),[kn,Er]=_.useState(""),[_i,ma]=_.useState(!1),[ki,Gn]=_.useState(!1),[Ws,Ir]=_.useState(""),[Sr,Qn]=_.useState(""),[Ks,Tr]=_.useState(""),[it,gt]=_.useState(""),[dn,ue]=_.useState(!1),[_e,Ke]=_.useState(!1),[Be,Ro]=_.useState(""),[fa,pa]=_.useState(""),[Bc,zc]=_.useState(""),[ga,Po]=_.useState(""),[En,Cr]=_.useState(""),[Ar,xa]=_.useState(""),[In,Do]=_.useState(!1),[un,qc]=_.useState([]),[Ei,ya]=_.useState(!1),[St,va]=_.useState(""),[Rr,Xn]=_.useState(""),[wa,Oo]=_.useState(""),[Yn,Lo]=_.useState("medium"),[Hc,Pr]=_.useState(""),[Mo,ba]=_.useState(!1),[hn,Sn]=_.useState("all"),[Gs,Wc]=_.useState([]),[Kc,Gc]=_.useState("all"),[Zh,em]=_.useState(null),[qx,Vo]=_.useState(null),[tm,Qc]=_.useState(99),[Na,Dr]=_.useState(30);t!=null&&t.email;const Fo=async()=>{if(!$e.trim()||!qt.trim()){e.warning("    ");return}if(qt.length<6){e.warning("     6   ");return}if(await s.confirm(`    :

 ${$e}
 ${Pt||" "}

:         .`,{title:"  "})){ma(!0);try{const Q=(await kl(Fs,$e.trim(),qt)).user.uid;await Ft(X(B,"users",Q),{email:$e.trim(),name:Pt.trim()||" ",phone:kn.trim()||"",role:"admin",createdAt:se()}),await Ft(X(B,"wallets",Q),{balance:0,totalEarnings:0,totalWithdrawn:0,transactions:[],updatedAt:se()}),e.success("     "),e.info("        "),jt(""),rt(""),Hs(""),Er(""),De(!1)}catch(J){console.error("   :",J),J.code==="auth/email-already-in-use"?e.error("   "):J.code==="auth/invalid-email"?e.error("   "):J.code==="auth/weak-password"?e.error("   "):e.error("  : "+(J.message||"  "))}finally{ma(!1)}}},sm=async()=>{if(!Ws.trim()||!Ks.trim()){e.warning("    ");return}if(Ks.length<6){e.warning("     6   ");return}if(await s.confirm(`    :

 ${Ws}
 ${Sr||" "}
 ${it||" "}`,{title:"  "})){ue(!0);try{const Q=(await kl(Fs,Ws.trim(),Ks)).user.uid;await Ft(X(B,"users",Q),{email:Ws.trim(),name:Sr.trim()||" ",phone:it.trim()||"",role:"courier",createdAt:se()}),e.success("     "),e.info("        "),Ir(""),Qn(""),Tr(""),gt(""),Gn(!1)}catch(J){console.error("   :",J),J.code==="auth/email-already-in-use"?e.error("   "):e.error("  : "+(J.message||"  "))}finally{ue(!1)}}},Xc=async()=>{if(!Be.trim()){e.warning("  ");return}if(!En.trim()||!Ar.trim()){e.warning("   ");return}if(await s.confirm(`   :

 ${Be}
 ${fa||" "}
  : ${En}`,{title:"  "})){Do(!0);try{const Q=(await kl(Fs,En.trim(),Ar)).user.uid;await Ft(X(B,"users",Q),{email:En.trim(),name:Be.trim()+" - ",role:"owner",createdAt:se()}),await Ft(X(B,"restaurants",Q),{name:Be.trim(),ownerId:Q,email:ga.trim()||En.trim(),phone:Bc.trim()||"",city:fa.trim()||"",referredBy:t==null?void 0:t.uid,referrerType:"developer",createdAt:se()}),e.success("      "),e.info("        "),Ro(""),pa(""),zc(""),Po(""),Cr(""),xa(""),Ke(!1)}catch(J){console.error("   :",J),J.code==="auth/email-already-in-use"?e.error("   "):e.error("  : "+(J.message||"  "))}finally{Do(!1)}}},Yc=()=>{const A=new Date,J=new Date(A.getFullYear(),A.getMonth(),A.getDate()),Q=new Date(J.getTime()-7*24*60*60*1e3),ge=new Date(J.getTime()-30*24*60*60*1e3),Re=v.filter(Se=>{var mt,Tt;return(((Tt=(mt=Se.createdAt)==null?void 0:mt.toDate)==null?void 0:Tt.call(mt))||new Date(0))>=J&&Se.status!=="cancelled"}),ze=v.filter(Se=>{var mt,Tt;return(((Tt=(mt=Se.createdAt)==null?void 0:mt.toDate)==null?void 0:Tt.call(mt))||new Date(0))>=Q&&Se.status!=="cancelled"}),Dt=v.filter(Se=>{var mt,Tt;return(((Tt=(mt=Se.createdAt)==null?void 0:mt.toDate)==null?void 0:Tt.call(mt))||new Date(0))>=ge&&Se.status!=="cancelled"}),ds=v.filter(Se=>Se.status==="delivered");return{todayRevenue:Re.reduce((Se,qe)=>Se+(qe.total||0),0),todayOrders:Re.length,todayPlatformFee:Re.reduce((Se,qe)=>Se+(qe.platformFee||0),0),weekRevenue:ze.reduce((Se,qe)=>Se+(qe.total||0),0),weekOrders:ze.length,weekPlatformFee:ze.reduce((Se,qe)=>Se+(qe.platformFee||0),0),monthRevenue:Dt.reduce((Se,qe)=>Se+(qe.total||0),0),monthOrders:Dt.length,monthPlatformFee:Dt.reduce((Se,qe)=>Se+(qe.platformFee||0),0),totalRevenue:ds.reduce((Se,qe)=>Se+(qe.total||0),0),totalPlatformFee:ds.reduce((Se,qe)=>Se+(qe.platformFee||0),0),totalAdminCommission:ds.reduce((Se,qe)=>Se+(qe.adminCommission||0),0)}},xt=async()=>{try{const[A,J,Q,ge,Re]=await Promise.all([ve(re(B,"users")),ve(re(B,"restaurants")),ve(re(B,"menuItems")),ve(re(B,"orders")),ve(re(B,"wallets"))]);let ze={docs:[]};try{ze=await ve(re(B,"tasks"))}catch{}let Dt={docs:[]};try{Dt=await ve(re(B,"packageRequests"))}catch{}const ds=A.docs.map(xe=>({uid:xe.id,...xe.data()}));C(ds);const Se=J.docs.map(xe=>({id:xe.id,...xe.data()}));N(Se);const qe=ge.docs.map(xe=>({id:xe.id,...xe.data()}));k(qe);const mt=ze.docs.map(xe=>({id:xe.id,...xe.data()}));qc(mt.sort((xe,Lr)=>{var Cs,Xs;return(((Cs=Lr.createdAt)==null?void 0:Cs.seconds)||0)-(((Xs=xe.createdAt)==null?void 0:Xs.seconds)||0)}));const Tt=Dt.docs.map(xe=>({id:xe.id,...xe.data()}));Wc(Tt.sort((xe,Lr)=>{var Cs,Xs;return(((Cs=Lr.createdAt)==null?void 0:Cs.seconds)||0)-(((Xs=xe.createdAt)==null?void 0:Xs.seconds)||0)}));const ja={};Re.docs.forEach(xe=>{ja[xe.id]=xe.data()});const sd=ja.app_earnings||{balance:0,totalEarnings:0},Bo=ds.filter(xe=>xe.role==="admin"),Or=ds.filter(xe=>xe.role==="courier"),am=ds.filter(xe=>xe.role==="customer"),om=ds.filter(xe=>xe.role==="owner"),lm=Bo.map(xe=>{const Lr=Se.filter(Xs=>Xs.referredBy===xe.uid),Cs=ja[xe.uid]||{balance:0,totalEarnings:0};return{uid:xe.uid,email:xe.email,name:xe.name,walletBalance:Cs.balance||0,totalEarnings:Cs.totalEarnings||0,restaurantsCount:Lr.length,restaurants:Lr}});O(lm),p({users:ds.length,restaurants:Se.length,menuItems:Q.size,orders:qe.length,pendingOrders:qe.filter(xe=>xe.status==="pending").length,deliveredOrders:qe.filter(xe=>xe.status==="delivered").length,admins:Bo.length,couriers:Or.length,customers:am.length,owners:om.length,totalAppEarnings:sd.totalEarnings||0});const mn=await Ce(X(B,"settings","general"));if(mn.exists()){const xe=mn.data();y(xe),j(xe)}else{const xe={deliveryFee:7,minOrderAmount:20,maxDeliveryDistance:15,workingHours:{open:"09:00",close:"23:00"},maintenanceMode:!1,appVersion:"1.0.0",platformFee:1,adminCommissionRate:.75};y(xe),j(xe)}}catch(A){console.error("   :",A),e.error("  ")}finally{l(!1),u(!1)}};_.useEffect(()=>{xt()},[]);const Ii=()=>{u(!0),xt(),e.info("  ...")},Uo=async()=>{try{await Ft(X(B,"settings","general"),m,{merge:!0}),y(m),b(!1),e.success("    ")}catch(A){console.error("   :",A),e.error("  ")}},Jc=async A=>{try{await fe(X(B,"restaurants",A),{...D,updatedAt:se()}),T(null),e.success("    "),xt()}catch(J){console.error("   :",J),e.error("  ")}},Zc=async(A,J)=>{try{if(!J.type.startsWith("image/")){e.warning("   ");return}if(J.size>5*1024*1024){e.warning("        5MB");return}F(!0);const Q=J.name.replace(/\s+/g,"_"),ge=`restaurants/${A}/logo_${Date.now()}_${Q}`,Re=Nr(r,ge),ze={contentType:J.type||"image/jpeg",cacheControl:"public,max-age=31536000,immutable"};await uc(Re,J,ze);const Dt=await br(Re);await fe(X(B,"restaurants",A),{logoUrl:Dt,updatedAt:se()}),e.success("    "),xt()}catch(Q){console.error("   :",Q),e.error("  ")}finally{F(!1)}},nm=async A=>{if(await s.confirm("         !",{title:" ",dangerous:!0}))try{await sn(X(B,"restaurants",A)),e.success("   "),xt()}catch(Q){console.error("   :",Q),e.error("  ")}},rm=async A=>{try{await fe(X(B,"users",A),{...L,updatedAt:se()}),z(null),e.success("    "),xt()}catch(J){console.error("   :",J),e.error("  ")}},ed=async A=>{if(await s.confirm("         !",{title:" ",dangerous:!0}))try{await sn(X(B,"users",A)),e.success("     "),e.warning(":      Firebase Auth"),xt()}catch(Q){console.error("   :",Q),e.error("  ")}},td=async(A,J)=>{try{await fe(X(B,"orders",A),{status:J,updatedAt:se()}),e.success("    "),xt()}catch(Q){console.error("   :",Q),e.error("  ")}},im=A=>{switch(A){case"customer":return" ";case"owner":return"  ";case"courier":return" ";case"admin":return" ";case"developer":return" ";default:return A}},Jn=A=>{switch(A){case"pending":return"  ";case"accepted":return" ";case"preparing":return"  ";case"ready":return" ";case"out_for_delivery":return"  ";case"delivered":return"  ";case"cancelled":return" ";default:return A}};return o?n.jsx(We,{allow:["developer"],children:n.jsx("div",{className:"flex items-center justify-center h-96",children:n.jsxs("div",{className:"text-center",children:[n.jsx(os,{className:"w-12 h-12 text-primary animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-lg text-gray-600",children:"   ..."})]})})}):n.jsx(We,{allow:["developer"],children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-extrabold text-primary",children:"   "}),n.jsx("p",{className:"text-gray-600 mt-1",children:"    "})]}),n.jsxs("button",{onClick:Ii,disabled:d,className:"flex items-center gap-2 bg-primary hover:bg-sky-600 text-white px-4 py-2 rounded-xl font-semibold transition disabled:opacity-50",children:[n.jsx(os,{className:`w-5 h-5 ${d?"animate-spin":""}`}),""]})]}),n.jsx("div",{className:"flex flex-wrap gap-2 border-b pb-4",children:[{id:"overview",label:"  "},{id:"finance",label:" "},{id:"restaurants",label:" "},{id:"storeAnalytics",label:"  "},{id:"packages",label:"  "},{id:"packageSettings",label:"  "},{id:"licenses",label:" "},{id:"orders",label:" "},{id:"users",label:" "},{id:"couriers",label:" "},{id:"admins",label:" "},{id:"tasks",label:" "},{id:"settings",label:" "},{id:"tools",label:" "}].map(A=>n.jsx("button",{onClick:()=>a(A.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl font-semibold transition ${i===A.id?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:A.label},A.id))}),i==="overview"&&n.jsxs("div",{className:"space-y-6",children:[Gs.filter(A=>["pending","payment_sent"].includes(A.status)).length>0&&n.jsx("div",{className:"bg-gradient-to-r from-amber-100 to-orange-100 border-2 border-amber-300 rounded-2xl p-5 shadow-lg",children:n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-amber-500 rounded-xl flex items-center justify-center animate-pulse",children:n.jsx(Bt,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-amber-800",children:"    "}),n.jsxs("p",{className:"text-amber-700",children:[Gs.filter(A=>A.status==="pending").length>0&&n.jsxs("span",{children:[" ",Gs.filter(A=>A.status==="pending").length,"  "]}),Gs.filter(A=>A.status==="pending").length>0&&Gs.filter(A=>A.status==="payment_sent").length>0&&"  ",Gs.filter(A=>A.status==="payment_sent").length>0&&n.jsxs("span",{children:[" ",Gs.filter(A=>A.status==="payment_sent").length,"  "]})]})]})]}),n.jsx("button",{onClick:()=>a("packages"),className:"bg-amber-500 hover:bg-amber-600 text-white px-6 py-3 rounded-xl font-bold shadow-lg transition transform hover:scale-105",children:"  "})]})}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[n.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-4 text-white text-center",children:[n.jsx("p",{className:"text-3xl font-bold",children:h.users}),n.jsx("p",{className:"text-sm opacity-90",children:" "})]}),n.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-2xl p-4 text-white text-center",children:[n.jsx("p",{className:"text-3xl font-bold",children:h.restaurants}),n.jsx("p",{className:"text-sm opacity-90",children:" "})]}),n.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl p-4 text-white text-center",children:[n.jsx("p",{className:"text-3xl font-bold",children:h.orders}),n.jsx("p",{className:"text-sm opacity-90",children:" "})]}),n.jsxs("div",{className:"bg-gradient-to-br from-amber-500 to-amber-600 rounded-2xl p-4 text-white text-center cursor-pointer hover:scale-105 transition",onClick:()=>a("packages"),children:[n.jsx("p",{className:"text-3xl font-bold",children:Gs.filter(A=>A.status==="pending").length}),n.jsx("p",{className:"text-sm opacity-90",children:"  "})]}),n.jsxs("div",{className:"bg-gradient-to-br from-cyan-500 to-cyan-600 rounded-2xl p-4 text-white text-center",children:[n.jsx("p",{className:"text-3xl font-bold",children:h.couriers}),n.jsx("p",{className:"text-sm opacity-90",children:" "})]}),n.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-2xl p-4 text-white text-center",children:[n.jsx("p",{className:"text-3xl font-bold",children:h.totalAppEarnings.toFixed(2)}),n.jsx("p",{className:"text-sm opacity-90",children:"  "})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx(o3,{className:"w-6 h-6 text-orange-500"}),n.jsx("h2",{className:"text-xl font-bold",children:" Firebase"})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[n.jsx("p",{className:"text-xs text-gray-500",children:"Project ID"}),n.jsx("p",{className:"font-mono text-sm",children:Ys.projectId})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[n.jsx("p",{className:"text-xs text-gray-500",children:"Storage Bucket"}),n.jsx("p",{className:"font-mono text-sm",children:Ys.storageBucket})]})]}),n.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[n.jsx("a",{href:`https://console.firebase.google.com/project/${Ys.projectId}/overview`,target:"_blank",rel:"noopener noreferrer",className:"text-sm bg-orange-100 hover:bg-orange-200 text-orange-700 px-3 py-1 rounded-lg",children:" Console"}),n.jsx("a",{href:`https://console.firebase.google.com/project/${Ys.projectId}/firestore`,target:"_blank",rel:"noopener noreferrer",className:"text-sm bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1 rounded-lg",children:" Firestore"}),n.jsx("a",{href:`https://console.firebase.google.com/project/${Ys.projectId}/authentication`,target:"_blank",rel:"noopener noreferrer",className:"text-sm bg-green-100 hover:bg-green-200 text-green-700 px-3 py-1 rounded-lg",children:" Auth"}),n.jsx("a",{href:`https://console.firebase.google.com/project/${Ys.projectId}/storage`,target:"_blank",rel:"noopener noreferrer",className:"text-sm bg-purple-100 hover:bg-purple-200 text-purple-700 px-3 py-1 rounded-lg",children:" Storage"})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h2",{className:"text-xl font-bold mb-4",children:"  "}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[n.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-xl",children:[n.jsx("p",{className:"text-2xl font-bold text-blue-600",children:h.customers}),n.jsx("p",{className:"text-sm text-gray-600",children:""})]}),n.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-xl",children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:h.owners}),n.jsx("p",{className:"text-sm text-gray-600",children:" "})]}),n.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-xl",children:[n.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:h.couriers}),n.jsx("p",{className:"text-sm text-gray-600",children:""})]}),n.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-xl",children:[n.jsx("p",{className:"text-2xl font-bold text-purple-600",children:h.admins}),n.jsx("p",{className:"text-sm text-gray-600",children:""})]}),n.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-xl",children:[n.jsx("p",{className:"text-2xl font-bold text-red-600",children:"1"}),n.jsx("p",{className:"text-sm text-gray-600",children:""})]})]})]})]}),i==="finance"&&n.jsx("div",{className:"space-y-6",children:(()=>{const A=Yc();return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-emerald-700 rounded-2xl shadow-lg p-6 text-white",children:[n.jsx("h2",{className:"text-2xl font-bold mb-4",children:"  "}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-white/20 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-3xl font-bold",children:A.totalRevenue.toFixed(0)}),n.jsx("p",{className:"text-sm opacity-90",children:"  (.)"})]}),n.jsxs("div",{className:"bg-white/20 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-3xl font-bold",children:A.totalPlatformFee.toFixed(2)}),n.jsx("p",{className:"text-sm opacity-90",children:"  (.)"})]}),n.jsxs("div",{className:"bg-white/20 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-3xl font-bold",children:A.totalAdminCommission.toFixed(2)}),n.jsx("p",{className:"text-sm opacity-90",children:"  (.)"})]}),n.jsxs("div",{className:"bg-white/20 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-3xl font-bold",children:(A.totalPlatformFee+A.totalAdminCommission).toFixed(2)}),n.jsx("p",{className:"text-sm opacity-90",children:"  (.)"})]})]})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-blue-600 mb-4",children:" "}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"font-bold",children:A.todayOrders})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsxs("span",{className:"font-bold",children:[A.todayRevenue.toFixed(2)," ."]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:" :"}),n.jsxs("span",{className:"font-bold text-green-600",children:[A.todayPlatformFee.toFixed(2)," ."]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-purple-600 mb-4",children:"  7 "}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"font-bold",children:A.weekOrders})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsxs("span",{className:"font-bold",children:[A.weekRevenue.toFixed(2)," ."]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:" :"}),n.jsxs("span",{className:"font-bold text-green-600",children:[A.weekPlatformFee.toFixed(2)," ."]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-orange-600 mb-4",children:"  30 "}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsx("span",{className:"font-bold",children:A.monthOrders})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:":"}),n.jsxs("span",{className:"font-bold",children:[A.monthRevenue.toFixed(2)," ."]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:" :"}),n.jsxs("span",{className:"font-bold text-green-600",children:[A.monthPlatformFee.toFixed(2)," ."]})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold mb-4",children:"   "}),n.jsx("div",{className:"space-y-3",children:E.map(J=>({...J,ordersCount:v.filter(Q=>Q.restaurantId===J.id&&Q.status==="delivered").length,revenue:v.filter(Q=>Q.restaurantId===J.id&&Q.status==="delivered").reduce((Q,ge)=>Q+(ge.total||0),0)})).sort((J,Q)=>Q.revenue-J.revenue).slice(0,5).map((J,Q)=>n.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-xl p-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-2xl",children:Q===0?"":Q===1?"":Q===2?"":`#${Q+1}`}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold",children:J.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:[J.ordersCount," "]})]})]}),n.jsxs("p",{className:"font-bold text-green-600",children:[J.revenue.toFixed(2)," ."]})]},J.id))})]})]})})()}),i==="restaurants"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("h2",{className:"text-xl font-bold",children:["   (",E.length,")"]}),n.jsx("button",{onClick:()=>Ke(!_e),className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-xl font-semibold",children:_e?" ":"  "})]}),_e&&n.jsxs("div",{className:"bg-green-50 rounded-2xl p-6 border-2 border-green-200",children:[n.jsx("h3",{className:"text-lg font-bold text-green-800 mb-4",children:"   "}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"  *"}),n.jsx("input",{type:"text",placeholder:":  ",value:Be,onChange:A=>Ro(A.target.value),className:"w-full border rounded-xl p-3"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:""}),n.jsx("input",{type:"text",placeholder:": ",value:fa,onChange:A=>pa(A.target.value),className:"w-full border rounded-xl p-3"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:" "}),n.jsx("input",{type:"tel",placeholder:"05xxxxxxxx",value:Bc,onChange:A=>zc(A.target.value),className:"w-full border rounded-xl p-3"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:" "}),n.jsx("input",{type:"email",placeholder:"restaurant@example.com",value:ga,onChange:A=>Po(A.target.value),className:"w-full border rounded-xl p-3"})]})]}),n.jsxs("div",{className:"border-t mt-4 pt-4",children:[n.jsx("h4",{className:"font-bold text-green-800 mb-3",children:"    ( )"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"   *"}),n.jsx("input",{type:"email",placeholder:"owner@example.com",value:En,onChange:A=>Cr(A.target.value),className:"w-full border rounded-xl p-3"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"  *"}),n.jsx("input",{type:"password",placeholder:"6   ",value:Ar,onChange:A=>xa(A.target.value),className:"w-full border rounded-xl p-3"})]})]})]}),n.jsx("button",{onClick:Xc,disabled:In||!Be.trim()||!En.trim()||!Ar.trim(),className:"mt-4 w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold disabled:opacity-50 flex items-center justify-center gap-2",children:In?n.jsxs(n.Fragment,{children:[n.jsx(os,{className:"w-5 h-5 animate-spin"})," ..."]}):"  "})]}),n.jsx("div",{className:"space-y-4",children:E.map(A=>{var J;return n.jsx("div",{className:"bg-white rounded-2xl shadow p-4",children:I===A.id?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600",children:" "}),n.jsx("input",{type:"text",value:D.name||"",onChange:Q=>S({...D,name:Q.target.value}),className:"w-full border rounded-xl p-2 mt-1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600",children:" "}),n.jsx("input",{type:"text",value:D.phone||"",onChange:Q=>S({...D,phone:Q.target.value}),className:"w-full border rounded-xl p-2 mt-1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600",children:" "}),n.jsx("input",{type:"email",value:D.email||"",onChange:Q=>S({...D,email:Q.target.value}),className:"w-full border rounded-xl p-2 mt-1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600",children:""}),n.jsx("input",{type:"text",value:D.city||"",onChange:Q=>S({...D,city:Q.target.value}),className:"w-full border rounded-xl p-2 mt-1"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"text-sm text-gray-600",children:""}),n.jsx("input",{type:"text",value:D.location||"",onChange:Q=>S({...D,location:Q.target.value}),className:"w-full border rounded-xl p-2 mt-1"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"text-sm text-gray-600",children:"  ()"}),n.jsxs("select",{value:D.referredBy||"",onChange:Q=>S({...D,referredBy:Q.target.value}),className:"w-full border rounded-xl p-2 mt-1",children:[n.jsx("option",{value:"",children:"--   ( ) --"}),w.filter(Q=>Q.role==="admin").map(Q=>n.jsxs("option",{value:Q.uid,children:[" ",Q.name||Q.email]},Q.uid))]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"        "})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600",children:" "}),n.jsx("input",{type:"file",accept:"image/*",onChange:Q=>{var Re;const ge=(Re=Q.target.files)==null?void 0:Re[0];ge&&Zc(A.id,ge)},className:"w-full border rounded-xl p-2 mt-1",disabled:W}),W&&n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:" ..."})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>Jc(A.id),className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-xl",children:[n.jsx(R1,{className:"w-4 h-4"})," "]}),n.jsxs("button",{onClick:()=>T(null),className:"flex items-center gap-2 bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-xl",children:[n.jsx(_r,{className:"w-4 h-4"})," "]})]})]}):n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 rounded-xl bg-gray-100 overflow-hidden flex-shrink-0",children:A.logoUrl?n.jsx("img",{src:A.logoUrl,alt:A.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-2xl",children:""})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h3",{className:"font-bold text-lg",children:A.name}),A.isVerified&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-100 text-green-700 text-xs font-bold rounded-full",children:[n.jsx(Xe,{className:"w-3 h-3"})," "]})]}),n.jsxs("div",{className:"text-sm text-gray-600 space-y-1 mt-1",children:[A.phone&&n.jsxs("p",{children:[" ",A.phone]}),A.email&&n.jsxs("p",{children:[" ",A.email]}),A.city&&n.jsxs("p",{children:[" ",A.city]}),A.referredBy&&n.jsxs("p",{className:"text-purple-600",children:["  : ",((J=P.find(Q=>Q.uid===A.referredBy))==null?void 0:J.name)||A.referredBy.slice(0,8)]})]})]}),n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:async()=>{const Q=!A.isVerified;if(await s.confirm(Q?`    "${A.name}"    .`:`     "${A.name}"`,{title:Q?"  ":"  ",confirmText:Q?" ":"  "}))try{await fe(X(B,"restaurants",A.id),{isVerified:Q,verifiedAt:Q?se():null,updatedAt:se()}),e.success(Q?"   ":"  "),xt()}catch(Re){e.error(" "),console.error(Re)}},className:`p-2 rounded-xl ${A.isVerified?"bg-green-100 hover:bg-green-200 text-green-600":"bg-gray-100 hover:bg-gray-200 text-gray-600"}`,title:A.isVerified?" ":" ",children:n.jsx(Xe,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{T(A.id),S(A)},className:"p-2 bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-xl",title:"",children:n.jsx(gc,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>nm(A.id),className:"p-2 bg-red-100 hover:bg-red-200 text-red-600 rounded-xl",title:"",children:n.jsx(Ss,{className:"w-5 h-5"})})]}),n.jsxs("select",{value:A.referredBy||"",onChange:async Q=>{const ge=Q.target.value;try{await fe(X(B,"restaurants",A.id),{referredBy:ge||null,updatedAt:se()}),e.success(ge?"   ":"   "),xt()}catch{e.error("   ")}},className:"text-xs border rounded-lg p-1",title:" ",children:[n.jsx("option",{value:"",children:"  "}),w.filter(Q=>Q.role==="admin").map(Q=>n.jsxs("option",{value:Q.uid,children:[" ",Q.name||Q.email]},Q.uid))]})]})]})},A.id)})})]}),i==="orders"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("h2",{className:"text-xl font-bold",children:["   (",v.length,")"]}),n.jsxs("select",{value:M,onChange:A=>G(A.target.value),className:"border rounded-xl p-2",children:[n.jsx("option",{value:"all",children:" "}),n.jsx("option",{value:"pending",children:" "}),n.jsx("option",{value:"accepted",children:""}),n.jsx("option",{value:"preparing",children:" "}),n.jsx("option",{value:"ready",children:""}),n.jsx("option",{value:"out_for_delivery",children:" "}),n.jsx("option",{value:"delivered",children:" "}),n.jsx("option",{value:"cancelled",children:""})]})]}),n.jsx("div",{className:"space-y-3",children:v.filter(A=>M==="all"||A.status===M).sort((A,J)=>{var Q,ge;return(((Q=J.createdAt)==null?void 0:Q.seconds)||0)-(((ge=A.createdAt)==null?void 0:ge.seconds)||0)}).map(A=>{var J,Q;return n.jsxs("div",{className:"bg-white rounded-2xl shadow p-4",children:[n.jsxs("div",{className:"flex items-start justify-between flex-wrap gap-4",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"font-bold",children:[" #",A.id.slice(-8)]}),n.jsxs("p",{className:"text-sm text-gray-600",children:[" ",A.restaurantName||""]}),n.jsxs("p",{className:"text-sm text-gray-600",children:[" ",A.address]}),n.jsxs("p",{className:"text-sm text-gray-600",children:[" ",(J=A.total)==null?void 0:J.toFixed(2)," ."]}),A.platformFee&&n.jsxs("p",{className:"text-xs text-green-600",children:[" : ",A.platformFee," .",A.adminCommission?` |  : ${A.adminCommission} .`:""]})]}),n.jsxs("div",{className:"text-left",children:[n.jsx("span",{className:`inline-block px-3 py-1 rounded-xl text-sm font-semibold ${A.status==="delivered"?"bg-green-100 text-green-700":A.status==="cancelled"?"bg-red-100 text-red-700":A.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-blue-100 text-blue-700"}`,children:Jn(A.status)}),n.jsxs("select",{value:A.status,onChange:ge=>td(A.id,ge.target.value),className:"mt-2 w-full border rounded-lg p-1 text-sm",children:[n.jsx("option",{value:"pending",children:" "}),n.jsx("option",{value:"accepted",children:""}),n.jsx("option",{value:"preparing",children:" "}),n.jsx("option",{value:"ready",children:""}),n.jsx("option",{value:"out_for_delivery",children:" "}),n.jsx("option",{value:"delivered",children:" "}),n.jsx("option",{value:"cancelled",children:""})]})]})]}),n.jsxs("div",{className:"mt-3 pt-3 border-t",children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:":"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:(Q=A.items)==null?void 0:Q.map((ge,Re)=>n.jsxs("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:[ge.name,"  ",ge.qty]},Re))})]})]},A.id)})})]}),i==="users"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("h2",{className:"text-xl font-bold",children:["   (",w.length,")"]}),n.jsxs("select",{value:Y,onChange:A=>ie(A.target.value),className:"border rounded-xl p-2",children:[n.jsx("option",{value:"all",children:" "}),n.jsx("option",{value:"customer",children:""}),n.jsx("option",{value:"owner",children:" "}),n.jsx("option",{value:"courier",children:""}),n.jsx("option",{value:"admin",children:""}),n.jsx("option",{value:"developer",children:""})]})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.filter(A=>Y==="all"||A.role===Y).map(A=>n.jsx("div",{className:"bg-white rounded-2xl shadow p-4",children:V===A.uid?n.jsxs("div",{className:"space-y-3",children:[n.jsx("input",{type:"text",placeholder:"",value:L.name||"",onChange:J=>$({...L,name:J.target.value}),className:"w-full border rounded-xl p-2"}),n.jsx("input",{type:"text",placeholder:"",value:L.phone||"",onChange:J=>$({...L,phone:J.target.value}),className:"w-full border rounded-xl p-2"}),n.jsxs("select",{value:L.role||"customer",onChange:J=>$({...L,role:J.target.value}),className:"w-full border rounded-xl p-2",children:[n.jsx("option",{value:"customer",children:""}),n.jsx("option",{value:"owner",children:" "}),n.jsx("option",{value:"courier",children:""}),n.jsx("option",{value:"admin",children:""}),n.jsx("option",{value:"developer",children:""})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>rm(A.uid),className:"flex-1 bg-green-600 text-white py-2 rounded-xl",children:""}),n.jsx("button",{onClick:()=>z(null),className:"flex-1 bg-gray-500 text-white py-2 rounded-xl",children:""})]})]}):n.jsx(n.Fragment,{children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold",children:A.name||" "}),n.jsx("p",{className:"text-sm text-gray-600",children:A.email}),n.jsx("p",{className:"text-xs mt-1",children:im(A.role)})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>{z(A.uid),$(A)},className:"p-1.5 bg-blue-100 text-blue-600 rounded-lg",children:n.jsx(gc,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>ed(A.uid),className:"p-1.5 bg-red-100 text-red-600 rounded-lg",children:n.jsx(Ss,{className:"w-4 h-4"})})]})]})})},A.uid))})]}),i==="couriers"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("h2",{className:"text-xl font-bold",children:["  (",h.couriers,")"]}),n.jsx("button",{onClick:()=>Gn(!ki),className:"flex items-center gap-2 bg-cyan-600 hover:bg-cyan-700 text-white px-4 py-2 rounded-xl font-semibold",children:ki?" ":"  "})]}),ki&&n.jsxs("div",{className:"bg-cyan-50 rounded-2xl p-6 border-2 border-cyan-200",children:[n.jsx("h3",{className:"text-lg font-bold text-cyan-800 mb-4",children:"   "}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"  *"}),n.jsx("input",{type:"email",placeholder:"courier@example.com",value:Ws,onChange:A=>Ir(A.target.value),className:"w-full border rounded-xl p-3"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"  *"}),n.jsx("input",{type:"password",placeholder:"6   ",value:Ks,onChange:A=>Tr(A.target.value),className:"w-full border rounded-xl p-3"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:""}),n.jsx("input",{type:"text",placeholder:" ",value:Sr,onChange:A=>Qn(A.target.value),className:"w-full border rounded-xl p-3"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:" "}),n.jsx("input",{type:"tel",placeholder:"05xxxxxxxx",value:it,onChange:A=>gt(A.target.value),className:"w-full border rounded-xl p-3"})]})]}),n.jsx("button",{onClick:sm,disabled:dn||!Ws.trim()||!Ks.trim(),className:"mt-4 w-full bg-cyan-600 hover:bg-cyan-700 text-white py-3 rounded-xl font-bold disabled:opacity-50 flex items-center justify-center gap-2",children:dn?n.jsxs(n.Fragment,{children:[n.jsx(os,{className:"w-5 h-5 animate-spin"})," ..."]}):"   "})]}),n.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[w.filter(A=>A.role==="courier").map(A=>n.jsxs("div",{className:"bg-white rounded-2xl shadow p-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-cyan-100 rounded-full flex items-center justify-center text-2xl",children:""}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold",children:A.name||" "}),n.jsx("p",{className:"text-sm text-gray-600",children:A.email}),A.phone&&n.jsxs("p",{className:"text-sm text-gray-600",children:[" ",A.phone]})]})]}),n.jsx("div",{className:"mt-4 pt-3 border-t",children:n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[n.jsxs("div",{className:"bg-green-50 rounded-lg p-2",children:[n.jsx("p",{className:"text-lg font-bold text-green-600",children:v.filter(J=>J.courierId===A.uid&&J.status==="delivered").length}),n.jsx("p",{className:"text-xs text-gray-600",children:" "})]}),n.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[n.jsx("p",{className:"text-lg font-bold text-blue-600",children:v.filter(J=>J.courierId===A.uid&&J.status==="out_for_delivery").length}),n.jsx("p",{className:"text-xs text-gray-600",children:" "})]})]})})]},A.uid)),h.couriers===0&&n.jsx("div",{className:"col-span-full text-center py-12 text-gray-500",children:"   "})]})]}),i==="admins"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("h2",{className:"text-xl font-bold",children:["   (",P.length,")"]}),n.jsxs("button",{onClick:()=>De(!Ae),className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-xl font-semibold transition",children:[n.jsx(xc,{className:"w-5 h-5"}),Ae?"":" "]})]}),Ae&&n.jsxs("div",{className:"bg-purple-50 rounded-2xl p-6 border-2 border-purple-200",children:[n.jsx("h3",{className:"text-lg font-bold text-purple-800 mb-4",children:"    "}),n.jsx("p",{className:"text-sm text-purple-600 mb-4",children:"           "}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"text-sm font-semibold text-gray-700 block mb-2",children:"  :"}),n.jsxs("div",{className:"grid gap-2 max-h-48 overflow-y-auto",children:[w.filter(A=>A.role==="customer").slice(0,10).map(A=>n.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-xl",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-semibold",children:A.name||" "}),n.jsx("p",{className:"text-sm text-gray-500",children:A.email})]}),n.jsx("button",{onClick:async()=>{if(await s.confirm(`   ${A.name||A.email}  `,{title:"  "}))try{await fe(X(B,"users",A.uid),{role:"admin"}),e.success("     "),De(!1),xt()}catch{e.error("  ")}},className:"bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded-lg text-sm",children:" "})]},A.uid)),w.filter(A=>A.role==="customer").length===0&&n.jsx("p",{className:"text-gray-500 text-center py-4",children:"    "})]})]}),n.jsxs("div",{className:"border-t pt-4 mt-4",children:[n.jsx("h4",{className:"text-md font-bold text-purple-800 mb-3",children:"     :"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"  *"}),n.jsx("input",{type:"email",placeholder:"admin@example.com",value:$e,onChange:A=>jt(A.target.value),className:"w-full border rounded-xl p-3 text-gray-900"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"  *"}),n.jsx("input",{type:"password",placeholder:"  (6   )",value:qt,onChange:A=>Hs(A.target.value),className:"w-full border rounded-xl p-3 text-gray-900"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:""}),n.jsx("input",{type:"text",placeholder:" ",value:Pt,onChange:A=>rt(A.target.value),className:"w-full border rounded-xl p-3 text-gray-900"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:" "}),n.jsx("input",{type:"tel",placeholder:"05xxxxxxxx",value:kn,onChange:A=>Er(A.target.value),className:"w-full border rounded-xl p-3 text-gray-900"})]})]}),n.jsx("button",{onClick:Fo,disabled:_i||!$e.trim()||!qt.trim(),className:"mt-4 w-full bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white py-3 rounded-xl font-bold transition disabled:opacity-50 flex items-center justify-center gap-2",children:_i?n.jsxs(n.Fragment,{children:[n.jsx(os,{className:"w-5 h-5 animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(xc,{className:"w-5 h-5"}),"  "]})}),n.jsx("p",{className:"text-xs text-orange-600 mt-2",children:" :        .     ."})]}),n.jsx("div",{className:"border-t pt-4 mt-4",children:n.jsx("p",{className:"text-xs text-gray-500",children:'         ""'})})]}),n.jsxs("div",{className:"space-y-4",children:[P.map(A=>n.jsxs("div",{className:"bg-white rounded-2xl shadow overflow-hidden",children:[n.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50",onClick:()=>pe(le===A.uid?null:A.uid),children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center text-2xl",children:""}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold",children:A.name||" "}),n.jsx("p",{className:"text-sm text-gray-600",children:A.email})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"text-left",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx($x,{className:"w-4 h-4 text-green-600"}),n.jsxs("span",{className:"font-bold text-green-600",children:[A.walletBalance.toFixed(2)," ."]})]}),n.jsxs("p",{className:"text-xs text-gray-500",children:[": ",A.totalEarnings.toFixed(2)," . | ",A.restaurantsCount," "]})]}),le===A.uid?n.jsx(S1,{className:"w-5 h-5 text-gray-400"}):n.jsx(Lx,{className:"w-5 h-5 text-gray-400"})]})]})}),le===A.uid&&n.jsxs("div",{className:"border-t bg-gray-50 p-4",children:[n.jsxs("h4",{className:"font-semibold text-sm text-gray-700 mb-3",children:["      (",A.restaurants.length,"):"]}),A.restaurants.length>0?n.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:A.restaurants.map(J=>n.jsxs("div",{className:"bg-white rounded-xl p-3 flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-100 overflow-hidden",children:J.logoUrl?n.jsx("img",{src:J.logoUrl,alt:J.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:""})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-semibold text-sm",children:J.name}),n.jsx("p",{className:"text-xs text-gray-500",children:J.city||" "})]})]},J.id))}):n.jsx("p",{className:"text-gray-500 text-sm",children:"    "}),n.jsx("div",{className:"mt-4 pt-3 border-t",children:n.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[n.jsxs("div",{className:"bg-green-100 rounded-lg p-2",children:[n.jsx("p",{className:"font-bold text-green-700",children:A.walletBalance.toFixed(2)}),n.jsx("p",{className:"text-xs text-gray-600",children:" "})]}),n.jsxs("div",{className:"bg-blue-100 rounded-lg p-2",children:[n.jsx("p",{className:"font-bold text-blue-700",children:A.totalEarnings.toFixed(2)}),n.jsx("p",{className:"text-xs text-gray-600",children:" "})]}),n.jsxs("div",{className:"bg-purple-100 rounded-lg p-2",children:[n.jsx("p",{className:"font-bold text-purple-700",children:v.filter(J=>J.referredBy===A.uid).length}),n.jsx("p",{className:"text-xs text-gray-600",children:"  "})]})]})})]})]},A.uid)),P.length===0&&n.jsx("div",{className:"text-center py-12 text-gray-500 bg-white rounded-2xl",children:"   "})]})]}),i==="settings"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-xl font-bold",children:"  "}),U?n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>{b(!1),j(g)},className:"bg-gray-500 text-white px-4 py-2 rounded-xl",children:""}),n.jsx("button",{onClick:Uo,className:"bg-green-600 text-white px-4 py-2 rounded-xl",children:" "})]}):n.jsx("button",{onClick:()=>b(!0),className:"bg-primary hover:bg-sky-600 text-white px-4 py-2 rounded-xl",children:" "})]}),n.jsx("div",{className:"bg-white rounded-2xl shadow p-6",children:n.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"   (.)"}),U?n.jsx("input",{type:"number",value:m.deliveryFee||0,onChange:A=>j({...m,deliveryFee:Number(A.target.value)}),className:"w-full border rounded-xl p-3"}):n.jsxs("p",{className:"text-2xl font-bold",children:[g.deliveryFee||7," ."]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"   /  (.)"}),U?n.jsx("input",{type:"number",step:"0.1",value:m.platformFee||1,onChange:A=>j({...m,platformFee:Number(A.target.value)}),className:"w-full border rounded-xl p-3"}):n.jsxs("p",{className:"text-2xl font-bold",children:[g.platformFee||1," ./"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"   /  (.)"}),U?n.jsx("input",{type:"number",step:"0.05",value:m.adminCommissionRate||.75,onChange:A=>j({...m,adminCommissionRate:Number(A.target.value)}),className:"w-full border rounded-xl p-3"}):n.jsxs("p",{className:"text-2xl font-bold",children:[g.adminCommissionRate||.75," ./"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"   "}),U?n.jsx("input",{type:"number",value:m.minOrderAmount||0,onChange:A=>j({...m,minOrderAmount:Number(A.target.value)}),className:"w-full border rounded-xl p-3"}):n.jsxs("p",{className:"text-2xl font-bold",children:[g.minOrderAmount||20," ."]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"  "}),U?n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"time",value:((Qs=m.workingHours)==null?void 0:Qs.open)||"09:00",onChange:A=>j({...m,workingHours:{...m.workingHours,open:A.target.value}}),className:"flex-1 border rounded-xl p-3"}),n.jsx("input",{type:"time",value:((Si=m.workingHours)==null?void 0:Si.close)||"23:00",onChange:A=>j({...m,workingHours:{...m.workingHours,close:A.target.value}}),className:"flex-1 border rounded-xl p-3"})]}):n.jsxs("p",{className:"text-2xl font-bold",children:[((Ti=g.workingHours)==null?void 0:Ti.open)||"09:00"," - ",(($o=g.workingHours)==null?void 0:$o.close)||"23:00"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"  "}),U?n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:m.maintenanceMode||!1,onChange:A=>j({...m,maintenanceMode:A.target.checked}),className:"w-6 h-6"}),n.jsx("span",{className:"text-lg",children:m.maintenanceMode?"":""})]}):n.jsx("p",{className:`text-2xl font-bold ${g.maintenanceMode?"text-red-600":"text-green-600"}`,children:g.maintenanceMode?" ":" "})]})]})}),n.jsxs("div",{className:"bg-sky-50 border-l-4 border-sky-500 rounded-lg p-6",children:[n.jsx("h3",{className:"font-bold text-sky-900 mb-3",children:"   (  = 1.75 .):"}),n.jsxs("div",{className:"text-sky-800 space-y-2",children:[n.jsxs("p",{children:[" ",n.jsx("strong",{children:" :"})," ",g.platformFee||1," .   "]}),n.jsxs("p",{children:[" ",n.jsx("strong",{children:" :"})," ",g.adminCommissionRate||.75," .   "]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 mt-3",children:[n.jsx("p",{className:"font-bold mb-2",children:" :   5 "}),n.jsxs("p",{children:[" ",n.jsx("strong",{children:"    :"})]}),n.jsxs("ul",{className:"mr-6 list-disc text-sm",children:[n.jsxs("li",{children:["  : 5  ",g.adminCommissionRate||.75," = ",n.jsxs("strong",{children:[(5*(g.adminCommissionRate||.75)).toFixed(2)," ."]})]}),n.jsxs("li",{children:["  : 5  ",g.platformFee||1," = ",n.jsxs("strong",{children:[(5*(g.platformFee||1)).toFixed(2)," ."]})]}),n.jsxs("li",{className:"text-green-700",children:[": ",n.jsxs("strong",{children:[(5*1.75).toFixed(2)," ."]})]})]}),n.jsxs("p",{className:"mt-2",children:[" ",n.jsx("strong",{children:"    :"})]}),n.jsx("ul",{className:"mr-6 list-disc text-sm",children:n.jsxs("li",{children:["    : 5  1.75 = ",n.jsxs("strong",{children:[(5*1.75).toFixed(2)," ."]})]})})]})]})]})]}),i==="tasks"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-xl font-bold",children:"   "}),n.jsxs("button",{onClick:()=>ya(!0),className:"flex items-center gap-2 bg-primary hover:bg-sky-600 text-white px-4 py-2 rounded-xl font-semibold transition",children:[n.jsx($c,{className:"w-5 h-5"})," "]})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:["all","pending","in_progress","completed","cancelled"].map(A=>n.jsxs("button",{onClick:()=>Sn(A),className:`px-4 py-2 rounded-xl font-semibold transition ${hn===A?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[A==="all"&&" ",A==="pending"&&"  ",A==="in_progress"&&"  ",A==="completed"&&" ",A==="cancelled"&&" "]},A))}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-yellow-50 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:un.filter(A=>A.status==="pending").length}),n.jsx("p",{className:"text-sm text-yellow-700",children:" "})]}),n.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-blue-600",children:un.filter(A=>A.status==="in_progress").length}),n.jsx("p",{className:"text-sm text-blue-700",children:" "})]}),n.jsxs("div",{className:"bg-green-50 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:un.filter(A=>A.status==="completed").length}),n.jsx("p",{className:"text-sm text-green-700",children:""})]}),n.jsxs("div",{className:"bg-red-50 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-red-600",children:un.filter(A=>A.status==="cancelled").length}),n.jsx("p",{className:"text-sm text-red-700",children:""})]})]}),n.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:un.filter(A=>hn==="all"||A.status===hn).length===0?n.jsxs("div",{className:"p-8 text-center text-gray-500",children:[n.jsx("p",{className:"text-4xl mb-2",children:""}),n.jsxs("p",{children:["   ",hn!=="all"&&"  "]})]}):n.jsx("div",{className:"divide-y",children:un.filter(A=>hn==="all"||A.status===hn).map(A=>{var Q,ge,Re;const J=w.find(ze=>ze.uid===A.assignedTo);return n.jsx("div",{className:"p-4 hover:bg-gray-50",children:n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${A.priority==="high"?"bg-red-100 text-red-700":A.priority==="medium"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:A.priority==="high"?" ":A.priority==="medium"?" ":" "}),n.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${A.status==="pending"?"bg-yellow-100 text-yellow-700":A.status==="in_progress"?"bg-blue-100 text-blue-700":A.status==="completed"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[A.status==="pending"&&"  ",A.status==="in_progress"&&"  ",A.status==="completed"&&" ",A.status==="cancelled"&&" "]})]}),n.jsx("h3",{className:"font-bold text-gray-800",children:A.title}),A.description&&n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:A.description}),n.jsxs("div",{className:"flex flex-wrap gap-3 mt-2 text-xs text-gray-500",children:[n.jsxs("span",{children:[" ",(J==null?void 0:J.name)||A.assignedToName||" "]}),A.dueDate&&n.jsxs("span",{children:[" ",new Date(A.dueDate).toLocaleDateString("ar-SA")]}),n.jsxs("span",{children:[" ",((Re=(ge=(Q=A.createdAt)==null?void 0:Q.toDate)==null?void 0:ge.call(Q))==null?void 0:Re.toLocaleDateString("ar-SA"))||" "]})]}),A.notes&&n.jsxs("p",{className:"text-sm text-gray-500 mt-2 bg-gray-50 p-2 rounded",children:[" ",A.notes]})]}),n.jsxs("div",{className:"flex flex-col gap-2",children:[A.status==="pending"&&n.jsx("button",{onClick:async()=>{try{await fe(X(B,"tasks",A.id),{status:"in_progress",updatedAt:se()}),e.success("  "),xt()}catch{e.error("   ")}},className:"text-blue-600 hover:bg-blue-50 p-2 rounded-lg transition",title:" ",children:""}),(A.status==="pending"||A.status==="in_progress")&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:async()=>{try{await fe(X(B,"tasks",A.id),{status:"completed",completedAt:se(),updatedAt:se()}),e.success("  "),xt()}catch{e.error("   ")}},className:"text-green-600 hover:bg-green-50 p-2 rounded-lg transition",title:" ",children:""}),n.jsx("button",{onClick:async()=>{if(await s.confirm("    ",{dangerous:!0}))try{await fe(X(B,"tasks",A.id),{status:"cancelled",updatedAt:se()}),e.success("  "),xt()}catch{e.error("   ")}},className:"text-red-600 hover:bg-red-50 p-2 rounded-lg transition",title:" ",children:""})]}),n.jsx("button",{onClick:async()=>{if(await s.confirm("     ",{dangerous:!0}))try{await sn(X(B,"tasks",A.id)),e.success("  "),xt()}catch{e.error("   ")}},className:"text-gray-400 hover:text-red-600 hover:bg-red-50 p-2 rounded-lg transition",title:" ",children:""})]})]})},A.id)})})}),Ei&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",children:"   "}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"  *"}),n.jsx("input",{type:"text",value:St,onChange:A=>va(A.target.value),className:"w-full border rounded-xl px-4 py-2",placeholder:":    "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:""}),n.jsx("textarea",{value:Rr,onChange:A=>Xn(A.target.value),className:"w-full border rounded-xl px-4 py-2 h-24",placeholder:" ..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"  *"}),n.jsxs("select",{value:wa,onChange:A=>Oo(A.target.value),className:"w-full border rounded-xl px-4 py-2",children:[n.jsx("option",{value:"",children:"--   --"}),w.filter(A=>A.role==="admin").map(A=>n.jsx("option",{value:A.uid,children:A.name||A.email},A.uid))]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:""}),n.jsxs("select",{value:Yn,onChange:A=>Lo(A.target.value),className:"w-full border rounded-xl px-4 py-2",children:[n.jsx("option",{value:"low",children:" "}),n.jsx("option",{value:"medium",children:" "}),n.jsx("option",{value:"high",children:" "})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:" "}),n.jsx("input",{type:"date",value:Hc,onChange:A=>Pr(A.target.value),className:"w-full border rounded-xl px-4 py-2"})]})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{onClick:()=>{ya(!1),va(""),Xn(""),Oo(""),Lo("medium"),Pr("")},className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-xl font-semibold transition",children:""}),n.jsx("button",{onClick:async()=>{if(!St.trim()||!wa){e.error("   ");return}ba(!0);try{const A=w.find(J=>J.uid===wa);await tt(re(B,"tasks"),{title:St.trim(),description:Rr.trim(),assignedTo:wa,assignedToName:(A==null?void 0:A.name)||(A==null?void 0:A.email)||"",status:"pending",priority:Yn,dueDate:Hc||null,createdBy:t==null?void 0:t.uid,createdAt:se(),updatedAt:se(),completedAt:null,notes:""}),e.success("   "),ya(!1),va(""),Xn(""),Oo(""),Lo("medium"),Pr(""),xt()}catch(A){console.error(A),e.error("   ")}finally{ba(!1)}},disabled:Mo,className:"flex-1 bg-primary hover:bg-sky-600 text-white py-2 rounded-xl font-semibold transition disabled:opacity-50",children:Mo?" ...":" "})]})]})})]}),i==="tools"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("h2",{className:"text-xl font-bold",children:"  "}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold mb-4",children:"  "}),n.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[n.jsxs("button",{onClick:()=>{const A={exportDate:new Date().toISOString(),users:w.length,restaurants:E.length,orders:v.length,admins:P.length,stats:h,settings:g},J=new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),Q=URL.createObjectURL(J),ge=document.createElement("a");ge.href=Q,ge.download=`app-data-${new Date().toISOString().split("T")[0]}.json`,ge.click(),e.success("   ")},className:"flex items-center gap-3 bg-blue-100 hover:bg-blue-200 text-blue-800 p-4 rounded-xl transition",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-bold",children:" "}),n.jsx("p",{className:"text-xs opacity-75",children:"  JSON"})]})]}),n.jsxs("button",{onClick:()=>{const A=[[" ","","","",""].join(","),...v.map(Re=>{var ze,Dt,ds;return[Re.id.slice(-8),Re.restaurantName||" ",Re.total,Re.status,((ds=(Dt=(ze=Re.createdAt)==null?void 0:ze.toDate)==null?void 0:Dt.call(ze))==null?void 0:ds.toLocaleDateString("ar-SA"))||""].join(",")})].join(`
`),J=new Blob(["\uFEFF"+A],{type:"text/csv;charset=utf-8"}),Q=URL.createObjectURL(J),ge=document.createElement("a");ge.href=Q,ge.download=`orders-${new Date().toISOString().split("T")[0]}.csv`,ge.click(),e.success("   ")},className:"flex items-center gap-3 bg-green-100 hover:bg-green-200 text-green-800 p-4 rounded-xl transition",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-bold",children:" "}),n.jsx("p",{className:"text-xs opacity-75",children:" CSV "})]})]}),n.jsxs("button",{onClick:()=>{const A=[["","","",""].join(","),...w.map(Re=>[Re.name||" ",Re.email,Re.role,Re.phone||""].join(","))].join(`
`),J=new Blob(["\uFEFF"+A],{type:"text/csv;charset=utf-8"}),Q=URL.createObjectURL(J),ge=document.createElement("a");ge.href=Q,ge.download=`users-${new Date().toISOString().split("T")[0]}.csv`,ge.click(),e.success("   ")},className:"flex items-center gap-3 bg-purple-100 hover:bg-purple-200 text-purple-800 p-4 rounded-xl transition",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-bold",children:" "}),n.jsx("p",{className:"text-xs opacity-75",children:" CSV "})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold mb-4",children:"  "}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("button",{onClick:async()=>{const A=v.filter(Q=>Q.status==="pending");if(A.length===0){e.info("   ");return}if(await s.confirm(`  ${A.length}  .   `,{title:"  ",dangerous:!0}))try{await Promise.all(A.map(Q=>fe(X(B,"orders",Q.id),{status:"cancelled",updatedAt:se()}))),e.success(`  ${A.length} `),xt()}catch{e.error("   ")}},className:"flex items-center gap-3 bg-yellow-100 hover:bg-yellow-200 text-yellow-800 p-4 rounded-xl transition",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-bold",children:"  "}),n.jsxs("p",{className:"text-xs opacity-75",children:[v.filter(A=>A.status==="pending").length,"  "]})]})]}),n.jsxs("button",{onClick:async()=>{const A=new Date;A.setMonth(A.getMonth()-3);const J=v.filter(ge=>{var ze,Dt;return(((Dt=(ze=ge.createdAt)==null?void 0:ze.toDate)==null?void 0:Dt.call(ze))||new Date)<A&&(ge.status==="delivered"||ge.status==="cancelled")});if(J.length===0){e.info("   ");return}if(await s.confirm(`  ${J.length}   (  3 ).   `,{title:"  ",dangerous:!0}))try{await Promise.all(J.map(ge=>sn(X(B,"orders",ge.id)))),e.success(`  ${J.length}  `),xt()}catch{e.error("   ")}},className:"flex items-center gap-3 bg-orange-100 hover:bg-orange-200 text-orange-800 p-4 rounded-xl transition",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-bold",children:"  "}),n.jsx("p",{className:"text-xs opacity-75",children:"   3 "})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold mb-4",children:"  "}),n.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsxs("a",{href:`https://console.firebase.google.com/project/${Ys.projectId}/firestore`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 bg-blue-50 hover:bg-blue-100 text-blue-800 p-4 rounded-xl transition",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsx("span",{className:"font-semibold",children:"Firestore"})]}),n.jsxs("a",{href:`https://console.firebase.google.com/project/${Ys.projectId}/authentication/users`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 bg-green-50 hover:bg-green-100 text-green-800 p-4 rounded-xl transition",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsx("span",{className:"font-semibold",children:"Authentication"})]}),n.jsxs("a",{href:`https://console.firebase.google.com/project/${Ys.projectId}/storage`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 bg-purple-50 hover:bg-purple-100 text-purple-800 p-4 rounded-xl transition",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsx("span",{className:"font-semibold",children:"Storage"})]}),n.jsxs("a",{href:`https://console.firebase.google.com/project/${Ys.projectId}/hosting`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 bg-orange-50 hover:bg-orange-100 text-orange-800 p-4 rounded-xl transition",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsx("span",{className:"font-semibold",children:"Hosting"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold mb-4",children:"  "}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500",children:"Project ID"}),n.jsx("p",{className:"font-mono",children:Ys.projectId})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500",children:"Storage Bucket"}),n.jsx("p",{className:"font-mono",children:Ys.storageBucket})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500",children:" "}),n.jsx("p",{className:"font-bold",children:g.appVersion||"1.0.0"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500",children:" "}),n.jsx("p",{className:`font-bold ${g.maintenanceMode?"text-red-600":"text-green-600"}`,children:g.maintenanceMode?" ":" "})]})]})]})]}),i==="licenses"&&n.jsx(BD,{restaurants:E,onUpdate:Ii,toast:e,dialog:s}),i==="packages"&&n.jsx(qD,{packageRequests:Gs,onUpdate:Ii,toast:e,dialog:s,storage:r}),i==="packageSettings"&&n.jsx(HD,{toast:e,dialog:s}),i==="storeAnalytics"&&n.jsx(zD,{restaurants:E,orders:v,toast:e}),n.jsx("div",{className:"bg-gray-100 rounded-2xl p-4 text-sm",children:n.jsxs("div",{className:"flex flex-wrap gap-4 text-gray-600",children:[n.jsxs("span",{children:[" ",t==null?void 0:t.email]}),n.jsxs("span",{children:[" ",t==null?void 0:t.uid.slice(0,12),"..."]}),n.jsxs("span",{children:[" ",new Date().toLocaleDateString("ar-SA")]})]})})]})})},BD=({restaurants:t,onUpdate:e,toast:s,dialog:r})=>{const[i,a]=_.useState("pending"),[o,l]=_.useState({}),[d,u]=_.useState(null),[h,p]=_.useState(""),[g,y]=_.useState(null),[w,C]=_.useState(new Set),[E,N]=_.useState(""),[v,k]=_.useState([]),[P,O]=_.useState(!1),[U,b]=_.useState(!1);_.useEffect(()=>{i==="sent_messages"&&v.length===0&&m()},[i]);const m=async()=>{O(!0);try{const M=je(re(B,"notifications"),Ne("type","==","license_reminder"),ln("createdAt","desc"),ia(100)),Y=(await ve(M)).docs.map(ie=>{var le,pe;return{id:ie.id,...ie.data(),createdAt:((pe=(le=ie.data().createdAt)==null?void 0:le.toDate)==null?void 0:pe.call(le))||null}});k(Y)}catch(M){console.error("   :",M),s.warning("     notifications (type + createdAt)")}finally{O(!1)}},j=t.filter(M=>M.commercialLicenseUrl),I=t.filter(M=>!M.commercialLicenseUrl),T=j.filter(M=>i==="all"?!0:i==="missing"||i==="sent_messages"?!1:M.licenseStatus===i||!M.licenseStatus&&i==="pending"),D={all:j.length,pending:j.filter(M=>!M.licenseStatus||M.licenseStatus==="pending").length,approved:j.filter(M=>M.licenseStatus==="approved").length,rejected:j.filter(M=>M.licenseStatus==="rejected").length,missing:I.length,sent_messages:v.length},S=async(M,G)=>{if(!G.trim()){s.warning("  ");return}y(M.id);try{await tt(re(B,"notifications"),{type:"license_reminder",recipientId:M.ownerId,recipientType:"owner",restaurantId:M.id,restaurantName:M.name,title:" :   ",message:G,read:!1,createdAt:se()}),s.success(`    ${M.name}`),p("")}catch(Y){s.error("  : "+(Y.message||"  "))}finally{y(null)}},W=async()=>{if(!E.trim()){s.warning("  ");return}const M=w.size>0?I.filter(Y=>w.has(Y.id)):I;if(M.length===0){s.warning("    ");return}if(await r.confirm(`       ${M.length} `,{title:"  "})){b(!0);try{const Y=M.map(ie=>tt(re(B,"notifications"),{type:"license_reminder",recipientId:ie.ownerId,recipientType:"owner",restaurantId:ie.id,restaurantName:ie.name,title:" :   ",message:E,read:!1,createdAt:se()}));await Promise.all(Y),s.success(`    ${M.length}   `),N(""),C(new Set)}catch(Y){s.error("   : "+(Y.message||"  "))}finally{b(!1)}}},F=()=>{w.size===I.length?C(new Set):C(new Set(I.map(M=>M.id)))},V=M=>{const G=new Set(w);G.has(M)?G.delete(M):G.add(M),C(G)},z=async(M,G)=>{const Y=o[M]||"";if(G==="rejected"&&!Y.trim()){s.warning("   ");return}const ie=G==="approved"?" ":"";if(await r.confirm(`    ${ie}   `,{title:`${ie} `})){u(M);try{await fe(X(B,"restaurants",M),{licenseStatus:G,licenseNotes:G==="rejected"?Y:"",updatedAt:se()}),s.success(G==="approved"?"    ":"  "),l(pe=>({...pe,[M]:""})),e()}catch(pe){s.error(" : "+(pe.message||"  "))}finally{u(null)}}},L=async(M,G)=>{const Y=" ";if(await r.confirm(`     ${Y}  "${M.name}"
      .`,{title:`  ${Y}`})){u(M.id);try{const le={licenseStatus:null,licenseNotes:"",updatedAt:se(),commercialLicenseUrl:null};await fe(X(B,"restaurants",M.id),le),await tt(re(B,"notifications"),{type:"license_deleted",recipientId:M.ownerId,recipientType:"owner",restaurantId:M.id,restaurantName:M.name,title:`   ${Y}`,message:`  ${Y}  .         .`,read:!1,createdAt:se()}),s.success(`  ${Y}    `),e()}catch(le){s.error("  : "+(le.message||"  "))}finally{u(null)}}},$=M=>{switch(M){case"approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-100 text-green-700 text-xs font-semibold",children:[n.jsx(Xe,{className:"w-3 h-3"})," "]});case"rejected":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-red-100 text-red-700 text-xs font-semibold",children:[n.jsx(Dn,{className:"w-3 h-3"})," "]});default:return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-yellow-100 text-yellow-700 text-xs font-semibold",children:[n.jsx(Rt,{className:"w-3 h-3"}),"  "]})}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[n.jsx(tw,{className:"w-6 h-6 text-sky-500"})," "]}),n.jsx("div",{className:"flex gap-2 flex-wrap",children:["pending","approved","rejected","all","missing","sent_messages"].map(M=>n.jsxs("button",{onClick:()=>a(M),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition ${i===M?M==="missing"?"bg-orange-500 text-white":M==="sent_messages"?"bg-purple-500 text-white":"bg-sky-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[M==="all"&&` (${D.all})`,M==="pending"&&`  (${D.pending})`,M==="approved"&&` (${D.approved})`,M==="rejected"&&` (${D.rejected})`,M==="missing"&&`   (${D.missing})`,M==="sent_messages"&&"  "]},M))})]}),i==="sent_messages"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"font-bold text-purple-700 flex items-center gap-2",children:"    "}),n.jsx("button",{onClick:m,disabled:P,className:"px-4 py-2 bg-purple-100 hover:bg-purple-200 text-purple-700 rounded-xl font-medium transition disabled:opacity-50",children:P?"  ...":" "})]}),P?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-10 h-10 border-4 border-purple-200 border-t-purple-500 rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-500",children:"  ..."})]}):v.length===0?n.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-2xl",children:[n.jsx("p",{className:"text-gray-500",children:"    "}),n.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"     "})]}):n.jsx("div",{className:"space-y-3",children:v.map(M=>n.jsx("div",{className:"bg-white rounded-xl shadow p-4 border-r-4 border-purple-500",children:n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"font-bold text-gray-800",children:M.restaurantName||""}),M.read?n.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full",children:" "}):n.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded-full",children:"  "})]}),n.jsx("p",{className:"text-sm text-gray-600 font-semibold mb-1",children:M.title}),n.jsx("p",{className:"text-gray-700 text-sm bg-gray-50 p-3 rounded-lg",children:M.message})]}),n.jsx("div",{className:"text-left text-xs text-gray-400 whitespace-nowrap",children:M.createdAt?new Date(M.createdAt).toLocaleDateString("ar-SA",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"})]})},M.id))})]}),i==="missing"&&n.jsx("div",{className:"space-y-4",children:I.length===0?n.jsxs("div",{className:"text-center py-12 text-gray-400",children:[n.jsx(Xe,{className:"w-16 h-16 mx-auto mb-4 text-green-400"}),n.jsx("p",{className:"text-green-600 font-semibold",children:"    "})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-2xl p-5",children:[n.jsx("h3",{className:"font-bold text-orange-800 mb-3 flex items-center gap-2",children:"   "}),n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:w.size===I.length,onChange:F,className:"w-5 h-5 rounded border-orange-300 text-orange-500 focus:ring-orange-500"}),n.jsxs("span",{className:"text-sm text-orange-700",children:["  (",I.length,")"]})]}),w.size>0&&n.jsxs("span",{className:"text-sm bg-orange-200 text-orange-800 px-2 py-1 rounded-full",children:[": ",w.size]})]}),n.jsx("textarea",{placeholder:"      (    )...",value:E,onChange:M=>N(M.target.value),className:"w-full border border-orange-200 rounded-xl p-3 text-sm resize-none h-24 focus:ring-2 focus:ring-orange-400 focus:border-transparent"}),n.jsx("button",{onClick:W,disabled:U||!E.trim(),className:"mt-3 w-full flex items-center justify-center gap-2 bg-orange-500 hover:bg-orange-600 text-white py-2.5 rounded-xl font-semibold transition disabled:opacity-50 disabled:cursor-not-allowed",children:U?n.jsxs(n.Fragment,{children:[n.jsx(os,{className:"w-5 h-5 animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:["   ",w.size>0?w.size:I.length," "]})})]}),n.jsx("div",{className:"grid gap-3",children:I.map(M=>n.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow-sm hover:shadow-md transition",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("input",{type:"checkbox",checked:w.has(M.id),onChange:()=>V(M.id),className:"w-5 h-5 mt-1 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:M.name}),n.jsx("p",{className:"text-sm text-gray-500",children:M.city||" "})]}),n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-orange-100 text-orange-700 text-xs font-semibold",children:[n.jsx(Dn,{className:"w-3 h-3"}),"  "]})]}),n.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-600 mb-3",children:[M.email&&n.jsxs("span",{children:[" ",M.email]}),M.phone&&n.jsxs("span",{children:[" ",M.phone]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",placeholder:" ...",value:g===M.id?h:"",onChange:G=>{y(M.id),p(G.target.value)},onFocus:()=>y(M.id),className:"flex-1 border rounded-lg px-3 py-2 text-sm"}),n.jsx("button",{onClick:()=>S(M,h),disabled:g===M.id&&!h.trim(),className:"px-4 py-2 bg-sky-500 hover:bg-sky-600 text-white rounded-lg text-sm font-medium transition disabled:opacity-50",children:""})]})]})]})},M.id))})]})}),i!=="missing"&&T.length===0?n.jsxs("div",{className:"text-center py-12 text-gray-400",children:[n.jsx(tw,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),n.jsxs("p",{children:["   ",i==="pending"?" ":i==="approved"?" ":i==="rejected"?"":""]})]}):i!=="missing"&&n.jsx("div",{className:"grid gap-4",children:T.map(M=>n.jsxs("div",{className:"bg-white border rounded-2xl p-5 shadow-sm",children:[n.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-lg",children:M.name}),n.jsxs("p",{className:"text-sm text-gray-500",children:[M.city||" ","  ",M.email||" "]})]}),$(M.licenseStatus)]}),n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:M.commercialLicenseUrl&&n.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"  "}),n.jsx("button",{onClick:()=>L(M),disabled:d===M.id,className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition",title:"  ",children:n.jsx(Ss,{className:"w-4 h-4"})})]}),n.jsxs("a",{href:M.commercialLicenseUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-sky-600 hover:text-sky-800 text-sm",children:[n.jsx(Pp,{className:"w-4 h-4"})," "]})]})}),M.commercialLicenseUrl&&n.jsxs("button",{onClick:()=>L(M),disabled:d===M.id,className:"w-full flex items-center justify-center gap-2 mb-4 py-2 px-4 border-2 border-dashed border-red-200 text-red-500 hover:bg-red-50 hover:border-red-300 rounded-xl text-sm font-medium transition",children:[n.jsx(Ss,{className:"w-4 h-4"}),"    "]}),M.licenseStatus==="rejected"&&M.licenseNotes&&n.jsxs("div",{className:"bg-red-50 text-red-700 rounded-xl p-3 mb-4 text-sm",children:[n.jsx("strong",{children:" :"})," ",M.licenseNotes]}),M.licenseStatus!=="approved"&&n.jsxs("div",{className:"space-y-3",children:[n.jsx("textarea",{placeholder:" ( )...",value:o[M.id]||"",onChange:G=>l(Y=>({...Y,[M.id]:G.target.value})),className:"w-full border rounded-xl p-3 text-sm resize-none h-20"}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("button",{onClick:()=>z(M.id,"approved"),disabled:d===M.id,className:"flex-1 flex items-center justify-center gap-2 bg-green-500 hover:bg-green-600 text-white py-2.5 rounded-xl font-semibold transition disabled:opacity-50",children:[n.jsx(Xe,{className:"w-5 h-5"}),""]}),n.jsxs("button",{onClick:()=>z(M.id,"rejected"),disabled:d===M.id,className:"flex-1 flex items-center justify-center gap-2 bg-red-500 hover:bg-red-600 text-white py-2.5 rounded-xl font-semibold transition disabled:opacity-50",children:[n.jsx(Dn,{className:"w-5 h-5"}),""]})]})]}),M.licenseStatus==="approved"&&n.jsxs("div",{className:"space-y-3",children:[n.jsx("textarea",{placeholder:"  ...",value:o[M.id]||"",onChange:G=>l(Y=>({...Y,[M.id]:G.target.value})),className:"w-full border border-yellow-200 rounded-xl p-3 text-sm resize-none h-20 focus:ring-2 focus:ring-yellow-400 focus:border-transparent"}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("button",{onClick:()=>z(M.id,"rejected"),disabled:d===M.id,className:"flex-1 flex items-center justify-center gap-2 bg-yellow-500 hover:bg-yellow-600 text-white py-2.5 rounded-xl font-semibold transition disabled:opacity-50",children:[n.jsx(Dn,{className:"w-5 h-5"})," "]}),n.jsxs("button",{onClick:()=>L(M),disabled:d===M.id,className:"flex-1 flex items-center justify-center gap-2 bg-red-500 hover:bg-red-600 text-white py-2.5 rounded-xl font-semibold transition disabled:opacity-50",children:[n.jsx(Ss,{className:"w-5 h-5"}),"  "]})]})]})]},M.id))})]})},zD=({restaurants:t,orders:e,toast:s})=>{var p,g,y,w;const[r,i]=_.useState(null),[a,o]=_.useState({}),[l,d]=_.useState(!1),u=async C=>{var E;d(!0);try{const N=await Ce(X(B,"restaurantStats",C)),v=N.exists()?N.data():null,k=e.filter(T=>T.restaurantId===C),P=k.filter(T=>T.status==="delivered"),O=je(re(B,"menuItems"),Ne("ownerId","==",C)),U=await ve(O);let b=0;try{const T=je(re(B,"customerRegistrations"),Ne("restaurantId","==",C));b=(await ve(T)).size}catch{}const m=P.reduce((T,D)=>T+(D.total||0),0),j=new Date().toISOString().split("T")[0],I=((E=v==null?void 0:v.dailyViews)==null?void 0:E[j])||0;o(T=>({...T,[C]:{totalOrders:k.length,deliveredOrders:P.length,totalRevenue:m,menuItemsCount:U.size,profileViews:(v==null?void 0:v.totalProfileViews)||0,menuViews:(v==null?void 0:v.totalMenuViews)||0,itemViews:(v==null?void 0:v.totalItemViews)||0,shareClicks:(v==null?void 0:v.totalShareClicks)||0,whatsappShares:(v==null?void 0:v.whatsappShareCount)||0,registeredCustomers:b,todayViews:I,dailyViews:(v==null?void 0:v.dailyViews)||{}}}))}catch(N){console.error("    :",N),s.error("   ")}finally{d(!1)}},h=C=>{i(C),a[C]||u(C)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-xl font-bold",children:"   "}),n.jsxs("span",{className:"text-gray-500",children:[t.length," "]})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(C=>{const E=a[C.id];return n.jsxs("div",{onClick:()=>h(C.id),className:`bg-white rounded-2xl shadow p-4 cursor-pointer transition hover:shadow-lg ${r===C.id?"ring-2 ring-sky-500":""}`,children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[C.logoUrl?n.jsx("img",{src:C.logoUrl,alt:C.name,className:"w-12 h-12 rounded-xl object-cover"}):n.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center",children:""}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-bold text-gray-900",children:C.name}),n.jsx("p",{className:"text-xs text-gray-500",children:C.city||" "})]})]}),E&&n.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center text-xs",children:[n.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[n.jsx("p",{className:"font-bold text-blue-700",children:E.profileViews}),n.jsx("p",{className:"text-blue-600",children:""})]}),n.jsxs("div",{className:"bg-green-50 rounded-lg p-2",children:[n.jsx("p",{className:"font-bold text-green-700",children:E.deliveredOrders}),n.jsx("p",{className:"text-green-600",children:""})]}),n.jsxs("div",{className:"bg-purple-50 rounded-lg p-2",children:[n.jsx("p",{className:"font-bold text-purple-700",children:E.whatsappShares}),n.jsx("p",{className:"text-purple-600",children:""})]})]})]},C.id)})}),r&&n.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:l?n.jsxs("div",{className:"text-center py-8",children:[n.jsx(os,{className:"w-8 h-8 animate-spin mx-auto text-sky-500"}),n.jsx("p",{className:"text-gray-500 mt-2",children:"  ..."})]}):a[r]?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between border-b pb-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[(p=t.find(C=>C.id===r))!=null&&p.logoUrl?n.jsx("img",{src:(g=t.find(C=>C.id===r))==null?void 0:g.logoUrl,alt:"",className:"w-16 h-16 rounded-xl object-cover"}):n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-xl flex items-center justify-center text-2xl",children:""}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold",children:(y=t.find(C=>C.id===r))==null?void 0:y.name}),n.jsx("p",{className:"text-gray-500",children:(w=t.find(C=>C.id===r))==null?void 0:w.city})]})]}),n.jsx("button",{onClick:()=>u(r),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-xl",children:n.jsx(os,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4",children:[n.jsx("p",{className:"text-3xl font-bold text-blue-700",children:a[r].profileViews}),n.jsx("p",{className:"text-sm text-blue-600",children:" "})]}),n.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4",children:[n.jsx("p",{className:"text-3xl font-bold text-green-700",children:a[r].todayViews}),n.jsx("p",{className:"text-sm text-green-600",children:" "})]}),n.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4",children:[n.jsx("p",{className:"text-3xl font-bold text-purple-700",children:a[r].whatsappShares}),n.jsx("p",{className:"text-sm text-purple-600",children:" "})]}),n.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 rounded-xl p-4",children:[n.jsx("p",{className:"text-3xl font-bold text-amber-700",children:a[r].shareClicks}),n.jsx("p",{className:"text-sm text-amber-600",children:" "})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-4",children:[n.jsx("p",{className:"text-2xl font-bold",children:a[r].totalOrders}),n.jsx("p",{className:"text-sm text-gray-600",children:" "})]}),n.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-4",children:[n.jsx("p",{className:"text-2xl font-bold",children:a[r].deliveredOrders}),n.jsx("p",{className:"text-sm text-gray-600",children:" "})]}),n.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-4",children:[n.jsx("p",{className:"text-2xl font-bold text-green-600",children:a[r].totalRevenue.toFixed(0)}),n.jsx("p",{className:"text-sm text-gray-600",children:" (.)"})]}),n.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-4",children:[n.jsx("p",{className:"text-2xl font-bold",children:a[r].menuItemsCount}),n.jsx("p",{className:"text-sm text-gray-600",children:" "})]})]}),n.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-4",children:[n.jsx("h4",{className:"font-bold text-indigo-800 mb-2",children:"    "}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-lg p-3 text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:a[r].registeredCustomers}),n.jsx("p",{className:"text-xs text-indigo-500",children:"   "})]}),n.jsxs("div",{className:"bg-white rounded-lg p-3 text-center",children:[n.jsx("p",{className:"text-2xl font-bold text-purple-600",children:a[r].itemViews}),n.jsx("p",{className:"text-xs text-purple-500",children:" "})]})]})]}),Object.keys(a[r].dailyViews||{}).length>0&&n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h4",{className:"font-bold text-gray-800 mb-3",children:"   ( 7 )"}),n.jsx("div",{className:"flex items-end gap-2 h-32",children:(()=>{const C=a[r].dailyViews||{},E=[];for(let v=6;v>=0;v--){const k=new Date;k.setDate(k.getDate()-v);const P=k.toISOString().split("T")[0];E.push({date:P,views:C[P]||0})}const N=Math.max(...E.map(v=>v.views),1);return E.map((v,k)=>n.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[n.jsx("div",{className:"w-full bg-sky-500 rounded-t",style:{height:`${v.views/N*100}%`,minHeight:v.views>0?"4px":"0"}}),n.jsx("span",{className:"text-xs text-gray-500",children:new Date(v.date).toLocaleDateString("ar-SA",{weekday:"short"})}),n.jsx("span",{className:"text-xs font-bold",children:v.views})]},v.date))})()})]})]}):n.jsx("p",{className:"text-center text-gray-500 py-8",children:"    "})})]})},qD=({packageRequests:t,onUpdate:e,toast:s,dialog:r,storage:i})=>{const[a,o]=_.useState("all"),[l,d]=_.useState(null),[u,h]=_.useState(null),[p,g]=_.useState(99),[y,w]=_.useState(null),[C,E]=_.useState(null),[N,v]=_.useState(""),[k,P]=_.useState(null),O=async(F,V)=>{if(!V.trim()){s.warning("  ");return}E(F.id);try{await tt(re(B,"notifications"),{recipientId:F.restaurantId,title:"   ",message:V.trim(),type:"admin_message",read:!1,data:{requestId:F.id},createdAt:se()}),s.success("   ! "),P(null),v("")}catch(z){s.error(` : ${z.message}`)}finally{E(null)}},U=t.filter(F=>a==="all"?!0:F.status===a),b=t.filter(F=>F.status==="pending").length,m=t.filter(F=>F.status==="bank_sent").length,j=t.filter(F=>F.status==="payment_sent").length,I=t.filter(F=>F.status==="approved").length,T=F=>{switch(F){case"pending":return{label:" ",color:"bg-yellow-100 text-yellow-700",icon:""};case"bank_sent":return{label:" ",color:"bg-blue-100 text-blue-700",icon:""};case"payment_sent":return{label:" ",color:"bg-purple-100 text-purple-700",icon:""};case"approved":return{label:"",color:"bg-green-100 text-green-700",icon:""};case"rejected":return{label:"",color:"bg-red-100 text-red-700",icon:""};case"expired":return{label:"",color:"bg-gray-100 text-gray-700",icon:""};default:return{label:F,color:"bg-gray-100",icon:""}}},D=async F=>{if(!u){s.warning("    ");return}d(F);try{const V=`bankAccounts/${Date.now()}_${u.name}`,z=Nr(i,V);await uc(z,u);const L=await br(z);await fe(X(B,"packageRequests",F),{status:"bank_sent",bankAccountImageUrl:L,subscriptionAmount:p,bankSentAt:se(),updatedAt:se()});const $=t.find(M=>M.id===F);$&&await tt(re(B,"notifications"),{recipientId:$.restaurantId,title:"     ",message:`   ${p}      `,type:"package_bank_sent",read:!1,data:{requestId:F,amount:p},createdAt:se()}),s.success("     "),h(null),w(null),e()}catch(V){s.error(` : ${V.message}`)}finally{d(null)}},S=async F=>{if(await r.confirm(`     ${F.subscriptionAmount}      "${F.restaurantName}"`,{title:"    ",confirmText:"  "})){d(F.id);try{const z=new Date;z.setDate(z.getDate()+(F.subscriptionDuration||30)),await fe(X(B,"packageRequests",F.id),{status:"approved",approvedAt:se(),expiresAt:z,updatedAt:se()}),await fe(X(B,"restaurants",F.restaurantId),{packageType:"premium",packageSubscribedAt:se(),packageExpiresAt:z,packageRequest:null,updatedAt:se()}),await tt(re(B,"notifications"),{recipientId:F.restaurantId,title:"    !",message:`!      ${z.toLocaleDateString("ar-SA")}`,type:"package_approved",read:!1,data:{requestId:F.id},createdAt:se()}),s.success("   ! "),e()}catch(z){s.error(` : ${z.message}`)}finally{d(null)}}},W=async F=>{if(await r.confirm(`    "${F.restaurantName}"`,{title:"  ",confirmText:" ",dangerous:!0})){d(F.id);try{await fe(X(B,"packageRequests",F.id),{status:"rejected",rejectedAt:se(),updatedAt:se()}),await tt(re(B,"notifications"),{recipientId:F.restaurantId,title:"    ",message:"       .     .",type:"package_rejected",read:!1,createdAt:se()}),s.success("  "),e()}catch(z){s.error(` : ${z.message}`)}finally{d(null)}}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex items-center justify-between flex-wrap gap-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Bt,{className:"w-8 h-8 text-amber-500"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold",children:"   "}),n.jsx("p",{className:"text-gray-600",children:"       "})]})]})}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-yellow-50 rounded-xl p-4 text-center border border-yellow-200",children:[n.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:b}),n.jsx("p",{className:"text-sm text-yellow-700",children:"  "})]}),n.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 text-center border border-blue-200",children:[n.jsx("p",{className:"text-3xl font-bold text-blue-600",children:m}),n.jsx("p",{className:"text-sm text-blue-700",children:"  "})]}),n.jsxs("div",{className:"bg-purple-50 rounded-xl p-4 text-center border border-purple-200",children:[n.jsx("p",{className:"text-3xl font-bold text-purple-600",children:j}),n.jsx("p",{className:"text-sm text-purple-700",children:"  "})]}),n.jsxs("div",{className:"bg-green-50 rounded-xl p-4 text-center border border-green-200",children:[n.jsx("p",{className:"text-3xl font-bold text-green-600",children:I}),n.jsx("p",{className:"text-sm text-green-700",children:" "})]})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:[{id:"all",label:""},{id:"pending",label:"  "},{id:"bank_sent",label:"  "},{id:"payment_sent",label:"  "},{id:"approved",label:" "},{id:"rejected",label:" "}].map(F=>n.jsx("button",{onClick:()=>o(F.id),className:`px-4 py-2 rounded-xl font-semibold transition ${a===F.id?"bg-amber-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:F.label},F.id))}),U.length===0?n.jsxs("div",{className:"text-center py-16 bg-gray-50 rounded-2xl",children:[n.jsx(Bt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),n.jsxs("p",{className:"text-gray-500 text-lg",children:["   ",a!=="all"&&" "]})]}):n.jsx("div",{className:"space-y-4",children:U.map(F=>{var z,L,$,M,G,Y,ie,le,pe,Ae,De,$e;const V=T(F.status);return n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-amber-500 to-orange-500 p-4 text-white",children:n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center text-2xl",children:""}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-lg",children:F.restaurantName}),n.jsxs("p",{className:"text-white/80 text-sm",children:[F.ownerName||" ","  ",F.ownerPhone||" "]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[F.ownerPhone&&n.jsx("a",{href:`https://wa.me/${F.ownerPhone.replace(/[^0-9]/g,"").replace(/^0/,"966")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-xl text-sm font-semibold transition",children:" "}),n.jsxs("div",{className:`px-4 py-2 rounded-full text-sm font-bold ${V.color}`,children:[V.icon," ",V.label]})]})]})}),n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500",children:" "}),n.jsx("p",{className:"font-semibold",children:(($=(L=(z=F.requestedAt)==null?void 0:z.toDate)==null?void 0:L.call(z))==null?void 0:$.toLocaleDateString("ar-SA"))||((Y=(G=(M=F.createdAt)==null?void 0:M.toDate)==null?void 0:G.call(M))==null?void 0:Y.toLocaleDateString("ar-SA"))||"-"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500",children:""}),n.jsxs("p",{className:"font-semibold text-green-600",children:[F.subscriptionAmount||99," ."]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500",children:""}),n.jsxs("p",{className:"font-semibold",children:[F.subscriptionDuration||30," "]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500",children:" "}),n.jsxs("p",{className:"font-mono text-xs",children:[F.restaurantId.slice(0,12),"..."]})]})]}),n.jsx("div",{className:"border-t pt-4",children:k===F.id?n.jsxs("div",{className:"space-y-3 bg-sky-50 p-4 rounded-xl",children:[n.jsx("h4",{className:"font-bold text-sky-600",children:"   "}),n.jsx("textarea",{value:N,onChange:jt=>v(jt.target.value),placeholder:"  ...",className:"w-full border rounded-lg p-3 resize-none",rows:3}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>O(F,N),disabled:C===F.id||!N.trim(),className:"flex-1 bg-sky-500 hover:bg-sky-600 text-white py-2 rounded-xl font-semibold disabled:opacity-50",children:C===F.id?" ...":"  "}),n.jsx("button",{onClick:()=>{P(null),v("")},className:"px-4 bg-gray-200 hover:bg-gray-300 rounded-xl",children:""})]})]}):n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{onClick:()=>P(F.id),className:"flex items-center gap-2 bg-sky-100 hover:bg-sky-200 text-sky-700 px-4 py-2 rounded-xl font-semibold transition",children:"  "}),F.ownerPhone&&n.jsx("a",{href:`https://wa.me/${F.ownerPhone.replace(/[^0-9]/g,"").replace(/^0/,"966")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 bg-green-100 hover:bg-green-200 text-green-700 px-4 py-2 rounded-xl font-semibold transition",children:" "}),!F.ownerPhone&&n.jsx("span",{className:"text-gray-400 text-sm self-center",children:"    "})]})}),F.status==="pending"&&n.jsxs("div",{className:"border-t pt-4 space-y-3",children:[n.jsx("h4",{className:"font-bold text-amber-600",children:"    "}),y===F.id?n.jsxs("div",{className:"space-y-3 bg-amber-50 p-4 rounded-xl",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"   (IBAN)"}),n.jsx("input",{type:"file",accept:"image/*",onChange:jt=>{var Pt;return h(((Pt=jt.target.files)==null?void 0:Pt[0])||null)},className:"w-full border rounded-lg p-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"  ()"}),n.jsx("input",{type:"number",value:p,onChange:jt=>g(Number(jt.target.value)),className:"w-full border rounded-lg p-2",min:1})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>D(F.id),disabled:l===F.id||!u,className:"flex-1 bg-amber-500 hover:bg-amber-600 text-white py-2 rounded-xl font-semibold disabled:opacity-50",children:l===F.id?" ...":"  "}),n.jsx("button",{onClick:()=>{w(null),h(null)},className:"px-4 bg-gray-200 hover:bg-gray-300 rounded-xl",children:""})]})]}):n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>w(F.id),className:"flex-1 bg-amber-500 hover:bg-amber-600 text-white py-3 rounded-xl font-semibold",children:"   "}),n.jsx("button",{onClick:()=>W(F),disabled:l===F.id,className:"px-6 bg-red-100 hover:bg-red-200 text-red-700 rounded-xl font-semibold",children:" "})]})]}),F.status==="bank_sent"&&n.jsx("div",{className:"border-t pt-4",children:n.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl",children:[n.jsx("p",{className:"text-blue-700 font-semibold mb-2",children:"     "}),n.jsxs("p",{className:"text-blue-600 text-sm",children:["   ",F.subscriptionAmount,"   "]}),F.bankAccountImageUrl&&n.jsxs("a",{href:F.bankAccountImageUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 hover:underline mt-2 text-sm",children:[n.jsx(Pp,{className:"w-4 h-4"}),"   "]})]})}),F.status==="payment_sent"&&n.jsxs("div",{className:"border-t pt-4 space-y-3",children:[n.jsxs("div",{className:"bg-purple-50 p-4 rounded-xl",children:[n.jsx("p",{className:"text-purple-700 font-semibold mb-2",children:"    "}),F.paymentProofImageUrl&&n.jsxs("a",{href:F.paymentProofImageUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 bg-white px-4 py-2 rounded-lg text-purple-600 hover:bg-purple-100 transition",children:[n.jsx(Pp,{className:"w-5 h-5"}),"   "]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>S(F),disabled:l===F.id,className:"flex-1 bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-bold disabled:opacity-50",children:l===F.id?" ...":"    "}),n.jsx("button",{onClick:()=>W(F),disabled:l===F.id,className:"px-6 bg-red-100 hover:bg-red-200 text-red-700 rounded-xl font-semibold",children:" "})]})]}),F.status==="approved"&&n.jsx("div",{className:"border-t pt-4",children:n.jsxs("div",{className:"bg-green-50 p-4 rounded-xl flex items-center gap-3",children:[n.jsx(Xe,{className:"w-8 h-8 text-green-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-green-700 font-semibold",children:"  "}),n.jsxs("p",{className:"text-green-600 text-sm",children:[" : ",((pe=(le=(ie=F.expiresAt)==null?void 0:ie.toDate)==null?void 0:le.call(ie))==null?void 0:pe.toLocaleDateString("ar-SA"))||"-"]})]})]})}),F.status==="rejected"&&n.jsx("div",{className:"border-t pt-4",children:n.jsxs("div",{className:"bg-red-50 p-4 rounded-xl",children:[n.jsx("p",{className:"text-red-700 font-semibold",children:"   "}),n.jsxs("p",{className:"text-red-600 text-sm",children:[": ",(($e=(De=(Ae=F.rejectedAt)==null?void 0:Ae.toDate)==null?void 0:De.call(Ae))==null?void 0:$e.toLocaleDateString("ar-SA"))||"-"]})]})})]})]},F.id)})})]})},Fd={premium:{displayName:" ",description:"     ",isEnabled:!0,originalPrice:99,currentPrice:99,durationDays:30,discount:{isActive:!1,type:"percentage",value:0}},free:{displayName:" ",description:"  ",isEnabled:!0,originalPrice:0,currentPrice:0,durationDays:0,discount:{isActive:!1,type:"percentage",value:0}},defaultPackage:"free"},HD=({toast:t,dialog:e})=>{var N,v,k,P,O,U,b,m,j,I,T,D,S,W,F,V,z;const[s,r]=_.useState(!0),[i,a]=_.useState(!1),[o,l]=_.useState(Fd),[d,u]=_.useState(null);_.useEffect(()=>{h()},[]);const h=async()=>{r(!0);try{const L=await Ce(X(B,"settings","packages"));if(L.exists()){const $=L.data();l({...Fd,...$,premium:{...Fd.premium,...$.premium},free:{...Fd.free,...$.free}})}}catch(L){console.error("    :",L),t.error("   ")}finally{r(!1)}},p=async()=>{var L;a(!0);try{const $={...o};if((L=$.premium.discount)!=null&&L.isActive&&$.premium.discount.value>0){const M=$.premium.discount;M.type==="percentage"?$.premium.currentPrice=$.premium.originalPrice-$.premium.originalPrice*M.value/100:$.premium.currentPrice=Math.max(0,$.premium.originalPrice-M.value)}else $.premium.currentPrice=$.premium.originalPrice;await Ft(X(B,"settings","packages"),{...$,updatedAt:se()}),l($),t.success("     ")}catch($){console.error("   :",$),t.error(` : ${$.message}`)}finally{a(!1)}},g=(L,$,M)=>{l(G=>({...G,[L]:{...G[L],[$]:M}}))},y=(L,$,M)=>{l(G=>({...G,[L]:{...G[L],discount:{...G[L].discount,[$]:M}}}))},w=async()=>{await e.confirm("     (0 ).   ",{title:"   "})&&(l($=>({...$,premium:{...$.premium,originalPrice:0,currentPrice:0,discount:{isActive:!1,type:"percentage",value:0}}})),t.success("    0 .    ."))},C=L=>{var Y,ie,le,pe;if(!(L!=null&&L.isActive))return!1;const $=new Date,M=((ie=(Y=L.startDate)==null?void 0:Y.toDate)==null?void 0:ie.call(Y))||(L.startDate?new Date(L.startDate):null),G=((pe=(le=L.endDate)==null?void 0:le.toDate)==null?void 0:pe.call(le))||(L.endDate?new Date(L.endDate):null);return!(M&&$<M||G&&$>G)},E=L=>{if(!C(L.discount))return L.originalPrice;const $=L.discount;return $.type==="percentage"?L.originalPrice-L.originalPrice*$.value/100:Math.max(0,L.originalPrice-$.value)};return s?n.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-amber-200 border-t-amber-500 rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-500",children:"   ..."})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-500 to-orange-500 rounded-2xl flex items-center justify-center",children:n.jsx(sh,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold",children:"  "}),n.jsx("p",{className:"text-gray-600",children:"      "})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:w,className:"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white px-5 py-3 rounded-xl font-bold shadow-lg transition flex items-center gap-2",children:"  "}),n.jsx("button",{onClick:p,disabled:i,className:"bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white px-6 py-3 rounded-xl font-bold shadow-lg transition disabled:opacity-50 flex items-center gap-2",children:i?"  ...":"  "})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-amber-500 via-orange-500 to-amber-500 p-5 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Bt,{className:"w-8 h-8"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold",children:"   (Premium)"}),n.jsx("p",{className:"text-white/80 text-sm",children:"    "})]})]}),n.jsxs("label",{className:"flex items-center gap-2 bg-white/20 px-4 py-2 rounded-xl cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:o.premium.isEnabled,onChange:L=>g("premium","isEnabled",L.target.checked),className:"w-5 h-5 rounded"}),n.jsx("span",{className:"font-semibold",children:o.premium.isEnabled?" ":" "})]})]})}),n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"   ()"}),n.jsx("input",{type:"number",min:"0",step:"1",value:o.premium.originalPrice,onChange:L=>g("premium","originalPrice",Number(L.target.value)),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-amber-500 focus:ring-2 focus:ring-amber-200 text-xl font-bold text-center"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"   ()"}),n.jsx("input",{type:"number",min:"1",value:o.premium.durationDays,onChange:L=>g("premium","durationDays",Number(L.target.value)),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-amber-500 focus:ring-2 focus:ring-amber-200 text-xl font-bold text-center"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"  "}),n.jsxs("div",{className:"w-full px-4 py-3 bg-green-50 border-2 border-green-300 rounded-xl text-xl font-bold text-center text-green-700",children:[E(o.premium).toFixed(0)," ",C(o.premium.discount)&&n.jsx("span",{className:"text-sm text-green-600 block",children:" "})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"  "}),n.jsx("textarea",{value:o.premium.description||"",onChange:L=>g("premium","description",L.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-amber-500 focus:ring-2 focus:ring-amber-200",rows:2,placeholder:"  ..."})]}),n.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 border-2 border-red-200 rounded-2xl p-5",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsx("h4",{className:"text-lg font-bold text-red-700",children:" "})]}),n.jsxs("label",{className:"flex items-center gap-2 bg-white px-4 py-2 rounded-xl cursor-pointer shadow",children:[n.jsx("input",{type:"checkbox",checked:((N=o.premium.discount)==null?void 0:N.isActive)||!1,onChange:L=>y("premium","isActive",L.target.checked),className:"w-5 h-5 rounded accent-red-500"}),n.jsx("span",{className:"font-semibold text-red-700",children:(v=o.premium.discount)!=null&&v.isActive?"  ":"  "})]})]}),((k=o.premium.discount)==null?void 0:k.isActive)&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:" "}),n.jsxs("select",{value:((P=o.premium.discount)==null?void 0:P.type)||"percentage",onChange:L=>y("premium","type",L.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-red-500",children:[n.jsx("option",{value:"percentage",children:"  (%)"}),n.jsx("option",{value:"fixed",children:"  ()"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["  ",((O=o.premium.discount)==null?void 0:O.type)==="percentage"?"(%)":"()"]}),n.jsx("input",{type:"number",min:"0",max:((U=o.premium.discount)==null?void 0:U.type)==="percentage"?100:o.premium.originalPrice,value:((b=o.premium.discount)==null?void 0:b.value)||0,onChange:L=>y("premium","value",Number(L.target.value)),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-red-500 text-lg font-bold text-center"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"   "}),n.jsx("input",{type:"date",value:(m=o.premium.discount)!=null&&m.startDate?typeof o.premium.discount.startDate=="string"?o.premium.discount.startDate:((T=(I=(j=o.premium.discount.startDate).toDate)==null?void 0:I.call(j))==null?void 0:T.toISOString().split("T")[0])||"":"",onChange:L=>y("premium","startDate",L.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-red-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"   "}),n.jsx("input",{type:"date",value:(D=o.premium.discount)!=null&&D.endDate?typeof o.premium.discount.endDate=="string"?o.premium.discount.endDate:((F=(W=(S=o.premium.discount.endDate).toDate)==null?void 0:W.call(S))==null?void 0:F.toISOString().split("T")[0])||"":"",onChange:L=>y("premium","endDate",L.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-red-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:" /  ()"}),n.jsx("input",{type:"text",value:((V=o.premium.discount)==null?void 0:V.label)||"",onChange:L=>y("premium","label",L.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-red-500",placeholder:":    ..."})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-dashed border-red-300",children:[n.jsxs("p",{className:"text-center text-lg",children:[n.jsxs("span",{className:"text-gray-500 line-through",children:[o.premium.originalPrice," "]}),n.jsx("span",{className:"mx-3",children:""}),n.jsxs("span",{className:"text-2xl font-bold text-green-600",children:[E(o.premium).toFixed(0)," "]}),((z=o.premium.discount)==null?void 0:z.label)&&n.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full mr-2",children:o.premium.discount.label})]}),n.jsx("p",{className:"text-center text-sm text-gray-500 mt-2",children:C(o.premium.discount)?"   ":"    (  )"})]})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-gray-600 to-gray-700 p-5 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Bt,{className:"w-8 h-8"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold",children:"   (Free)"}),n.jsx("p",{className:"text-white/80 text-sm",children:"   "})]})]}),n.jsxs("label",{className:"flex items-center gap-2 bg-white/20 px-4 py-2 rounded-xl cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:o.free.isEnabled,onChange:L=>g("free","isEnabled",L.target.checked),className:"w-5 h-5 rounded"}),n.jsx("span",{className:"font-semibold",children:o.free.isEnabled?" ":" "})]})]})}),n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-xl p-4 text-center",children:[n.jsx("p",{className:"text-green-700 font-bold text-lg",children:"    "}),n.jsx("p",{className:"text-green-600 text-sm",children:"    "})]})})]}),n.jsxs("div",{className:"bg-gradient-to-r from-sky-50 to-blue-50 rounded-2xl p-6 border-2 border-sky-200",children:[n.jsxs("h3",{className:"text-lg font-bold text-sky-800 mb-4 flex items-center gap-2",children:[n.jsx(ha,{className:"w-5 h-5"}),"  "]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"font-semibold",children:"  "}),n.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-bold ${o.premium.isEnabled?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:o.premium.isEnabled?"":""})]}),n.jsxs("p",{className:"text-3xl font-bold text-amber-600 mt-2",children:[E(o.premium).toFixed(0)," ",C(o.premium.discount)&&n.jsx("span",{className:"text-sm text-red-500 mr-2 bg-red-50 px-2 py-1 rounded-full",children:"!"})]}),n.jsxs("p",{className:"text-gray-500 text-sm",children:[" ",o.premium.durationDays," "]})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"font-semibold",children:"  "}),n.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-bold ${o.free.isEnabled?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:o.free.isEnabled?"":""})]}),n.jsx("p",{className:"text-3xl font-bold text-green-600 mt-2",children:""}),n.jsx("p",{className:"text-gray-500 text-sm",children:" "})]})]})]})]})},WD="afrtalbyt2026@gmail.com",KD=()=>{const t=ys(),[e,s]=_.useState(""),[r,i]=_.useState(""),[a,o]=_.useState(!1),[l,d]=_.useState(""),[u,h]=_.useState(!1),p=async g=>{if(g.preventDefault(),d(""),e.trim().toLowerCase()!==WD){d("        ");return}if(r.length<6){d("     6   ");return}o(!0);try{const w=(await kl(Fs,e.trim(),r)).user.uid;await Ft(X(B,"users",w),{email:e.trim(),name:" ",role:"developer",createdAt:se()}),h(!0),setTimeout(()=>{t("/developer")},2e3)}catch(y){console.error("Setup error:",y),y.code==="auth/email-already-in-use"?d("      "):y.code==="auth/invalid-email"?d("   "):y.code==="auth/weak-password"?d("   "):d(" : "+(y.message||" "))}finally{o(!1)}};return u?n.jsx("div",{className:"min-h-[70vh] flex items-center justify-center",children:n.jsxs("div",{className:"text-center bg-gradient-to-br from-green-500 to-emerald-600 text-white p-10 rounded-3xl shadow-2xl",children:[n.jsx(Xe,{className:"w-20 h-20 mx-auto mb-4"}),n.jsx("h1",{className:"text-2xl font-bold mb-2",children:"    !"}),n.jsx("p",{children:"   ..."})]})}):n.jsx("div",{className:"min-h-[70vh] flex items-center justify-center",children:n.jsx("div",{className:"w-full max-w-md",children:n.jsxs("div",{className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-3xl shadow-2xl overflow-hidden",children:[n.jsxs("div",{className:"bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 p-6 text-center",children:[n.jsx("div",{className:"w-20 h-20 bg-white/20 backdrop-blur rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ha,{className:"w-10 h-10 text-white"})}),n.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center justify-center gap-2",children:[n.jsx(Us,{className:"w-6 h-6"}),"  ",n.jsx(Us,{className:"w-6 h-6"})]}),n.jsx("p",{className:"text-white/80 text-sm mt-2",children:"   "})]}),n.jsxs("form",{onSubmit:p,className:"p-6 space-y-5",children:[l&&n.jsx("div",{className:"bg-red-500/20 border border-red-500/50 text-red-400 rounded-xl p-3 text-sm text-center",children:l}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-gray-400 text-sm mb-2 flex items-center gap-2",children:[n.jsx(Pl,{className:"w-4 h-4"})," "]}),n.jsx("input",{type:"email",value:e,onChange:g=>s(g.target.value),placeholder:"  ",className:"w-full px-4 py-3 bg-gray-700/50 border border-gray-600 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-gray-400 text-sm mb-2 flex items-center gap-2",children:[n.jsx(R6,{className:"w-4 h-4"})," "]}),n.jsx("input",{type:"password",value:r,onChange:g=>i(g.target.value),placeholder:"  ",className:"w-full px-4 py-3 bg-gray-700/50 border border-gray-600 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),n.jsx("button",{type:"submit",disabled:a,className:"w-full py-4 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 text-white font-bold rounded-xl hover:opacity-90 transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:a?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(po,{className:"w-5 h-5"}),"  "]})}),n.jsx("p",{className:"text-gray-500 text-xs text-center",children:"      "})]})]})})})},Ot=({children:t})=>{const{user:e,loading:s}=Ue();return s?n.jsx("div",{className:"p-8 text-center",children:" ..."}):e?n.jsx(n.Fragment,{children:t}):n.jsx(bh,{to:"/login",replace:!0})},GD=()=>{var u;const{role:t,loading:e}=Ue(),[s,r]=_.useState([]),[i,a]=_.useState(!0),[o,l]=_.useState(null);if(_.useEffect(()=>{e||t!=="developer"||(async()=>{try{l(null);const h=je(re(B,"orders"),ln("createdAt","desc"),ia(10)),g=(await ve(h)).docs.map(y=>{var C,E,N,v,k,P;const w=y.data();return{id:y.id,restaurantId:w.restaurantId??null,firstItemOwnerId:((E=(C=w==null?void 0:w.items)==null?void 0:C[0])==null?void 0:E.ownerId)??null,customerId:w.customerId??null,createdAtISO:((P=(k=(v=(N=w.createdAt)==null?void 0:N.toDate)==null?void 0:v.call(N))==null?void 0:k.toISOString)==null?void 0:P.call(k))??null}});r(g)}catch(h){if(String((h==null?void 0:h.message)||"").includes("index"))try{const g=(await ve(re(B,"orders"))).docs.map(y=>{var C,E,N,v,k,P;const w=y.data();return{id:y.id,restaurantId:w.restaurantId??null,firstItemOwnerId:((E=(C=w==null?void 0:w.items)==null?void 0:C[0])==null?void 0:E.ownerId)??null,customerId:w.customerId??null,createdAtISO:((P=(k=(v=(N=w.createdAt)==null?void 0:N.toDate)==null?void 0:v.call(N))==null?void 0:k.toISOString)==null?void 0:P.call(k))??null}});r(g),l("     createdAt     .")}catch(p){l("     : "+((p==null?void 0:p.message)||p))}else l("  : "+((h==null?void 0:h.message)||h))}finally{a(!1)}})()},[e,t]),e)return n.jsx("div",{className:"p-8 text-center",children:" ..."});if(t!=="developer")return n.jsx(bh,{to:"/",replace:!0});const d=(u=Ps.options)==null?void 0:u.projectId;return n.jsxs("div",{className:"p-4 space-y-3",children:[n.jsx("h1",{className:"text-xl font-bold",children:" DEBUG: Orders Snapshot ( )"}),n.jsxs("div",{className:"text-sm",children:["ProjectId: ",n.jsx("b",{children:String(d)})]}),o&&n.jsx("div",{className:"text-red-600 text-sm",children:o}),i&&n.jsx("div",{children:" Loading"}),!i&&s.length===0&&n.jsxs("div",{className:"text-gray-600",children:["     collection: ",n.jsx("code",{children:"orders"}),"   ."]}),s.map(h=>n.jsxs("div",{className:"bg-white rounded-xl shadow p-3 text-sm",children:[n.jsxs("div",{className:"font-mono text-xs text-gray-500",children:["#",h.id]}),n.jsxs("div",{children:["restaurantId: ",n.jsx("b",{children:String(h.restaurantId)})]}),n.jsxs("div",{children:["items[0].ownerId: ",n.jsx("b",{children:String(h.firstItemOwnerId)})]}),n.jsxs("div",{children:["customerId: ",n.jsx("b",{children:String(h.customerId)})]}),n.jsxs("div",{children:["createdAt: ",n.jsx("b",{children:h.createdAtISO||""})]})]},h.id))]})};function QD(){const{locationRequired:t,refreshUserData:e,loading:s}=Ue();return!s&&t?n.jsx(Y3,{onLocationSaved:e}):n.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-b from-sky-50 via-white to-sky-50 text-sky-900",children:[n.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50",children:[n.jsx(X3,{}),n.jsx(Q3,{}),n.jsx(H3,{})]}),n.jsx("div",{className:"h-[130px] sm:h-[150px]"}),n.jsx("main",{className:"flex-1 max-w-6xl mx-auto w-full px-4 py-8",children:n.jsxs(aI,{children:[n.jsx(Me,{path:"/",element:n.jsx(J3,{})}),n.jsx(Me,{path:"/restaurants",element:n.jsx(eD,{})}),n.jsx(Me,{path:"/menu",element:n.jsx(aD,{})}),n.jsx(Me,{path:"/cart",element:n.jsx(oD,{})}),n.jsx(Me,{path:"/login",element:n.jsx(lD,{})}),n.jsx(Me,{path:"/customer-login",element:n.jsx(dD,{})}),n.jsx(Me,{path:"/register",element:n.jsx(cD,{})}),n.jsx(Me,{path:"/privacy-policy",element:n.jsx(uD,{})}),n.jsx(Me,{path:"/account-deleted",element:n.jsx(hD,{})}),n.jsx(Me,{path:"/setup-dev",element:n.jsx(KD,{})}),n.jsx(Me,{path:"/chat",element:n.jsx(Ot,{children:n.jsx(We,{allow:["customer","courier","owner","admin","developer"],children:n.jsx(LD,{})})})}),n.jsx(Me,{path:"/notifications",element:n.jsx(Ot,{children:n.jsx(We,{allow:["customer","courier","owner","admin","developer"],children:n.jsx(MD,{})})})}),n.jsx(Me,{path:"/checkout",element:n.jsx(Ot,{children:n.jsx(We,{allow:["customer","admin","developer"],children:n.jsx(gD,{})})})}),n.jsx(Me,{path:"/orders",element:n.jsx(Ot,{children:n.jsx(We,{allow:["customer","admin","developer"],children:n.jsx(xD,{})})})}),n.jsx(Me,{path:"/profile",element:n.jsx(Ot,{children:n.jsx(We,{allow:["customer","courier","owner","admin","developer"],children:n.jsx(yD,{})})})}),n.jsx(Me,{path:"/owner",element:n.jsx(Ot,{children:n.jsx(We,{allow:["owner","developer"],children:n.jsx(vD,{})})})}),n.jsx(Me,{path:"/owner/menu",element:n.jsx(Ot,{children:n.jsx(We,{allow:["owner","developer"],children:n.jsx(bD,{})})})}),n.jsx(Me,{path:"/owner/orders",element:n.jsx(Ot,{children:n.jsx(We,{allow:["owner","developer"],children:n.jsx(jD,{})})})}),n.jsx(Me,{path:"/owner/edit",element:n.jsx(Ot,{children:n.jsx(We,{allow:["owner","developer"],children:n.jsx(_D,{})})})}),n.jsx(Me,{path:"/owner/courier-requests",element:n.jsx(Ot,{children:n.jsx(We,{allow:["owner","developer"],children:n.jsx(kD,{})})})}),n.jsx(Me,{path:"/owner/packages",element:n.jsx(Ot,{children:n.jsx(We,{allow:["owner","developer"],children:n.jsx(ID,{})})})}),n.jsx(Me,{path:"/owner/promotion",element:n.jsx(Ot,{children:n.jsx(We,{allow:["owner","developer"],children:n.jsx(SD,{})})})}),n.jsx(Me,{path:"/courier",element:n.jsx(Ot,{children:n.jsx(We,{allow:["courier","developer"],children:n.jsx(TD,{})})})}),n.jsx(Me,{path:"/courier/hiring",element:n.jsx(Ot,{children:n.jsx(We,{allow:["courier","developer"],children:n.jsx(CD,{})})})}),n.jsx(Me,{path:"/admin",element:n.jsx(Ot,{children:n.jsx(We,{allow:["admin","developer"],children:n.jsx(VD,{})})})}),n.jsx(Me,{path:"/admin/restaurants",element:n.jsx(Ot,{children:n.jsx(We,{allow:["admin","developer"],children:n.jsx(FD,{})})})}),n.jsx(Me,{path:"/admin/orders",element:n.jsx(Ot,{children:n.jsx(We,{allow:["admin","developer"],children:n.jsx(UD,{})})})}),n.jsx(Me,{path:"/developer",element:n.jsx(Ot,{children:n.jsx(We,{allow:["developer","admin"],children:n.jsx($D,{})})})}),n.jsx(Me,{path:"/__debug_orders",element:n.jsx(GD,{})}),n.jsx(Me,{path:"*",element:n.jsx(bh,{to:"/",replace:!0})})]})}),n.jsx(G3,{})]})}_.createContext(void 0);const XD=({children:t})=>n.jsx(n.Fragment,{children:t});hf.createRoot(document.getElementById("root")).render(n.jsx(jw.StrictMode,{children:n.jsx(fI,{children:n.jsx(tD,{children:n.jsx(W3,{children:n.jsx(PP,{children:n.jsxs(XD,{children:["   ",n.jsx(QD,{})]})})})})})}));

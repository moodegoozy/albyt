import{a as ve,u as Pe,c as ke,b as Ae,j as e,R as Ee,d as h}from"./index-FuU3jBZc.js";import{b as Se,r as f}from"./vendor-react-C_wfuX_s.js";import{j as S,k as N,q as _e,m as H,w as oe,t as Ie,u as C,z as p,v as Ce,x as A,y as xe,s as R}from"./vendor-firebase-Co4MdP0H.js";import{P as me,g as Fe,L as Te}from"./paypal-BnpsEAs5.js";import{P as $e,a as Oe}from"./vendor-paypal-CbTd4Kqs.js";import{k as pe,G as J,x as Re,y as Be,a9 as B,T as K,S as ue,j as X,t as Me,ad as ye,ae as We,ac as Le}from"./vendor-icons-Dyg7S3Xx.js";const $=1,F=.75,he=3.75,qe=.0157,De=5,M=!0,He=()=>{const{items:x,subtotal:w,clear:Z}=ve(),{user:_}=Pe(),ee=Se(),v=ke(),W=Ae(),[O,fe]=f.useState(""),[U,L]=f.useState(!1),[t,se]=f.useState(null),[E,ge]=f.useState(null),[be,q]=f.useState(!1),[d,te]=f.useState("pickup"),[j,V]=f.useState("cod"),[I,ae]=f.useState(0),[re,ne]=f.useState(!1),[D,G]=f.useState([]),[r,Q]=f.useState(null),[le,ie]=f.useState(!1);x.reduce((s,a)=>s+a.qty,0);const Y=f.useMemo(()=>x.reduce((s,a)=>a.price>=De?s+qe*a.qty:s,0),[x]),T=f.useMemo(()=>{if(!r)return 0;switch(r.offerType){case"percent_discount":const s=w*(r.discountPercent||0)/100;return Math.min(s,w);case"fixed_discount":return Math.min(r.discountAmount||0,w);case"bundle_meal":return r.bundleOriginalPrice&&r.bundlePrice?r.bundleOriginalPrice-r.bundlePrice:0;case"buy_x_get_y":return 0;default:return 0}},[r,w]),u=w+Y-T;f.useEffect(()=>{(async()=>{var b,y,P;if(!_)return;try{const o=await S(N(h,"wallets",_.uid));o.exists()&&ae(((b=o.data())==null?void 0:b.balance)||0)}catch(o){console.warn("Error loading wallet:",o)}if(x.length===0)return;let a=(y=x[0])==null?void 0:y.ownerId;if(!a&&((P=x[0])!=null&&P.id))try{const o=await S(N(h,"menuItems",x[0].id)),m=o.exists()?o.data():null;a=(m==null?void 0:m.ownerId)||null}catch(o){console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙ†Ù:",o)}if(!a){se(null);return}const i=await S(N(h,"restaurants",a)),l=i.exists()?i.data():null;se({id:a,name:(l==null?void 0:l.name)||"Ù…Ø·Ø¹Ù…",referredBy:l==null?void 0:l.referredBy,referrerType:l==null?void 0:l.referrerType})})()},[x,_]),f.useEffect(()=>{(async()=>{if(!(t!=null&&t.id)){G([]);return}ie(!0);try{const a=_e(H(h,"offers"),oe("ownerId","==",t.id),oe("isActive","==",!0)),i=await Ie(a),l=new Date,b=i.docs.map(y=>{var P,o,m,g;return{id:y.id,...y.data(),expiresAt:(o=(P=y.data().expiresAt)==null?void 0:P.toDate)==null?void 0:o.call(P),startsAt:(g=(m=y.data().startsAt)==null?void 0:m.toDate)==null?void 0:g.call(m)}}).filter(y=>!(y.expiresAt&&new Date(y.expiresAt)<l||y.startsAt&&new Date(y.startsAt)>l||y.minOrderAmount&&w<y.minOrderAmount));G(b),b.length===1&&Q(b[0])}catch(a){console.warn("Error loading offers:",a),G([])}finally{ie(!1)}})()},[t==null?void 0:t.id,w]);const we=(s,a)=>{ge(s),fe(a),q(!1),W.success("ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ Ø¨Ù†Ø¬Ø§Ø­! ğŸ“")},je=async()=>{var a;if(!_)return;if(x.length===0){v.warning("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©");return}if(d==="delivery"&&M){if(!O){v.warning("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†");return}if(!E){v.warning("Ø­Ø¯Ù‘Ø¯ Ù…ÙˆÙ‚Ø¹Ùƒ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©");return}}let s=t==null?void 0:t.id;if(!s&&((a=x[0])!=null&&a.id)){const i=await S(N(h,"menuItems",x[0].id)),l=i.exists()?i.data():null;s=(l==null?void 0:l.ownerId)||null}if(!s){v.error("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø·Ø¹Ù… Ù„Ù„Ø·Ù„Ø¨. Ø£Ø¹Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.");return}L(!0);try{const i=(t==null?void 0:t.referrerType)==="admin"&&(t==null?void 0:t.referredBy),l=x.reduce((n,k)=>n+k.qty,0),b=$+F,P=w-b*l,o=$*l,m=i?F*l:0,g=o+(i?0:F*l),ce=await xe(H(h,"orders"),{customerId:_.uid,restaurantId:s,restaurantName:(t==null?void 0:t.name)||"Ù…Ø·Ø¹Ù…",items:x.map(n=>({id:n.id,name:n.name,price:n.price,qty:n.qty,ownerId:n.ownerId??s})),subtotal:w,deliveryFee:0,deliveryFeeSetBy:null,deliveryFeeSetAt:null,total:u,status:"pending",deliveryType:d,address:d==="pickup"?"Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø·Ø¹Ù…":O,location:d==="pickup"?null:E,createdAt:p(),updatedAt:p(),paymentMethod:"cod",appliedOffer:r?{id:r.id,title:r.title,offerType:r.offerType,discountPercent:r.discountPercent||null,discountAmount:r.discountAmount||null}:null,discountAmount:T,restaurantEarnings:P,platformFee:o,platformFeePerItem:$,adminCommission:m,adminCommissionPerItem:F,appEarnings:g,totalItemsCount:l,referredBy:(t==null?void 0:t.referredBy)||null,courierPlatformFee:d==="delivery"?he:0});try{const n=N(h,"wallets",s);(await S(n)).exists()?await C(n,{pendingBalance:A(P),updatedAt:p()}):await R(n,{balance:0,pendingBalance:P,totalSales:0,totalWithdrawn:0,ownerType:"restaurant",updatedAt:p()})}catch(n){console.warn("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø·Ø¹Ù…:",n)}if(i&&(t!=null&&t.referredBy)&&m>0)try{const n=N(h,"wallets",t.referredBy);(await S(n)).exists()?await C(n,{balance:A(m),totalEarnings:A(m),updatedAt:p()}):await R(n,{balance:m,totalEarnings:m,totalWithdrawn:0,transactions:[],updatedAt:p()})}catch(n){console.warn("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø´Ø±Ù:",n)}try{const n=N(h,"wallets","app_earnings");(await S(n)).exists()?await C(n,{balance:A(g),totalEarnings:A(g),updatedAt:p()}):await R(n,{balance:g,totalEarnings:g,totalWithdrawn:0,transactions:[],updatedAt:p()})}catch(n){console.warn("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ù…Ø­ÙØ¸Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:",n)}if(r)try{await C(N(h,"offers",r.id),{usedCount:A(1),updatedAt:p()})}catch(n){console.warn("Error updating offer usage count:",n)}Z(),ee("/orders")}catch(i){console.error("Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨:",i),v.error("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.")}finally{L(!1)}},de=async(s,a)=>{var n;if(!_)return;if(x.length===0){v.warning("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©");return}if(d==="delivery"&&M){if(!O){v.warning("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†");return}if(!E){v.warning("Ø­Ø¯Ù‘Ø¯ Ù…ÙˆÙ‚Ø¹Ùƒ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©");return}}if(s==="wallet"&&I<u){v.warning("Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ØºÙŠØ± ÙƒØ§ÙÙŠ");return}let i=t==null?void 0:t.id;if(!i&&((n=x[0])!=null&&n.id)){const k=await S(N(h,"menuItems",x[0].id)),c=k.exists()?k.data():null;i=(c==null?void 0:c.ownerId)||null}if(!i){v.error("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø·Ø¹Ù… Ù„Ù„Ø·Ù„Ø¨. Ø£Ø¹Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.");return}L(!0);const l=(t==null?void 0:t.referrerType)==="admin"&&(t==null?void 0:t.referredBy),b=x.reduce((k,c)=>k+c.qty,0),y=$+F,o=w-y*b,m=$*b,g=l?F*b:0,ce=m+(l?0:F*b);try{if(s==="wallet"){const c=N(h,"wallets",_.uid),z={id:`order_${Date.now()}`,type:"debit",amount:u,description:`Ø¯ÙØ¹ Ø·Ù„Ø¨ Ù…Ù† ${t==null?void 0:t.name}`,createdAt:new Date};await C(c,{balance:A(-u),transactions:Ce(z),updatedAt:p()}),ae(Ne=>Ne-u)}const k=await xe(H(h,"orders"),{customerId:_.uid,restaurantId:i,restaurantName:(t==null?void 0:t.name)||"Ù…Ø·Ø¹Ù…",items:x.map(c=>({id:c.id,name:c.name,price:c.price,qty:c.qty,ownerId:c.ownerId??i})),subtotal:w,deliveryFee:0,deliveryFeeSetBy:null,deliveryFeeSetAt:null,total:u,status:"pending",deliveryType:d,address:d==="pickup"?"Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø·Ø¹Ù…":O,location:d==="pickup"?null:E,createdAt:p(),updatedAt:p(),paymentMethod:s,paymentStatus:"paid",paypalOrderId:a||null,paidAt:p(),appliedOffer:r?{id:r.id,title:r.title,offerType:r.offerType,discountPercent:r.discountPercent||null,discountAmount:r.discountAmount||null}:null,discountAmount:T,restaurantEarnings:o,platformFee:m,platformFeePerItem:$,adminCommission:g,adminCommissionPerItem:F,appEarnings:ce,totalItemsCount:b,referredBy:(t==null?void 0:t.referredBy)||null,courierPlatformFee:d==="delivery"?he:0});try{const c=N(h,"wallets",i);(await S(c)).exists()?await C(c,{pendingBalance:A(o),totalEarnings:A(o),updatedAt:p()}):await R(c,{pendingBalance:o,totalEarnings:o,balance:0,totalWithdrawn:0,transactions:[],updatedAt:p()})}catch(c){console.warn("Error updating restaurant wallet:",c)}if(l&&(t!=null&&t.referredBy)&&g>0)try{const c=N(h,"wallets",t.referredBy);(await S(c)).exists()?await C(c,{balance:A(g),totalEarnings:A(g),updatedAt:p()}):await R(c,{balance:g,totalEarnings:g,totalWithdrawn:0,transactions:[],updatedAt:p()})}catch(c){console.warn("Error updating admin wallet:",c)}if(r)try{await C(N(h,"offers",r.id),{usedCount:A(1),updatedAt:p()})}catch(c){console.warn("Error updating offer usage count:",c)}Z(),v.success(s==="paypal"?`ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! âœ…
ØªÙ… Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± PayPal`:`ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! âœ…
ØªÙ… Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©`),ee("/orders")}catch(k){console.error("Error placing order:",k),v.error("ÙØ´Ù„ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨")}finally{L(!1)}};return e.jsx(Ee,{allow:["customer","admin","developer"],children:e.jsxs("div",{className:"max-w-xl mx-auto space-y-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-sky-500 to-sky-600 rounded-2xl p-5 text-white shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:e.jsx(pe,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨"}),e.jsx("p",{className:"text-sm text-white/80",children:(t==null?void 0:t.name)||"Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„..."})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-sky-500"}),e.jsx("span",{className:"font-bold text-gray-800",children:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨"}),e.jsxs("span",{className:"text-xs bg-sky-100 text-sky-600 px-2 py-0.5 rounded-full mr-auto",children:[x.length," ØµÙ†Ù"]})]}),e.jsx("div",{className:"p-4 space-y-2",children:x.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"w-8 h-8 bg-sky-100 rounded-lg flex items-center justify-center text-sm",children:[s.qty,"Ã—"]}),e.jsx("span",{className:"text-gray-800 font-medium",children:s.name})]}),e.jsxs("span",{className:"font-bold text-sky-600",children:[(s.price*s.qty).toFixed(2)," Ø±.Ø³"]})]},s.id))})]}),(D.length>0||le)&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 px-4 py-3 border-b flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-orange-500"}),e.jsx("span",{className:"font-bold text-gray-800",children:"Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ø©"}),D.length>0&&e.jsxs("span",{className:"text-xs bg-orange-100 text-orange-600 px-2 py-0.5 rounded-full mr-auto",children:[D.length," Ø¹Ø±Ø¶"]})]}),e.jsx("div",{className:"p-4 space-y-3",children:le?e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-orange-300 border-t-orange-600 rounded-full animate-spin"}),e.jsx("span",{className:"mr-2 text-gray-500",children:"Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø±ÙˆØ¶..."})]}):e.jsxs(e.Fragment,{children:[D.map(s=>{const a=(r==null?void 0:r.id)===s.id,i=s.offerType==="percent_discount"?e.jsx(Re,{className:"w-5 h-5"}):s.offerType==="fixed_discount"?e.jsx(Be,{className:"w-5 h-5"}):e.jsx(J,{className:"w-5 h-5"}),l=s.offerType==="percent_discount"?`${s.discountPercent}%`:s.offerType==="fixed_discount"?`${s.discountAmount} Ø±.Ø³`:s.offerType==="bundle_meal"&&s.bundlePrice?`${s.bundlePrice} Ø±.Ø³`:"";return e.jsxs("button",{onClick:()=>Q(a?null:s),className:`w-full p-4 rounded-xl border-2 transition flex items-center gap-3 ${a?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-orange-300"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${a?"bg-orange-500 text-white":"bg-orange-100 text-orange-600"}`,children:i}),e.jsxs("div",{className:"flex-1 text-right",children:[e.jsx("p",{className:`font-bold ${a?"text-orange-700":"text-gray-800"}`,children:s.title}),e.jsx("p",{className:"text-sm text-gray-500",children:s.description||(s.offerType==="percent_discount"?`Ø®ØµÙ… ${s.discountPercent}% Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ùƒ`:s.offerType==="fixed_discount"?`Ø®ØµÙ… ${s.discountAmount} Ø±.Ø³ Ù…Ù† Ø·Ù„Ø¨Ùƒ`:s.offerType==="bundle_meal"?`ÙˆØ¬Ø¨Ø© Ù…Ø¬Ù…Ù‘Ø¹Ø© Ø¨Ø³Ø¹Ø± ${s.bundlePrice} Ø±.Ø³`:s.offerType==="buy_x_get_y"?`Ø§Ø´ØªØ±Ù ${s.buyQuantity} ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ ${s.getQuantity} Ù…Ø¬Ø§Ù†Ø§Ù‹`:"Ø¹Ø±Ø¶ Ø®Ø§Øµ")}),s.minOrderAmount&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø·Ù„Ø¨: ",s.minOrderAmount," Ø±.Ø³"]})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[l&&e.jsx("span",{className:`text-lg font-black ${a?"text-orange-600":"text-gray-700"}`,children:l}),a&&e.jsx(B,{className:"w-5 h-5 text-orange-500 mt-1"})]})]},s.id)}),r&&e.jsx("button",{onClick:()=>Q(null),className:"w-full text-center text-sm text-gray-500 hover:text-red-500 py-2",children:"Ø¥Ù„ØºØ§Ø¡ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ø±Ø¶"})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5 text-sky-500"}),e.jsx("span",{className:"font-bold text-gray-800",children:"Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…"})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("button",{onClick:()=>te("pickup"),className:`w-full p-4 rounded-xl border-2 transition flex items-center gap-4 ${d==="pickup"?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${d==="pickup"?"bg-green-500":"bg-gray-100"}`,children:e.jsx(ue,{className:`w-6 h-6 ${d==="pickup"?"text-white":"text-gray-500"}`})}),e.jsxs("div",{className:"flex-1 text-right",children:[e.jsx("p",{className:`font-bold ${d==="pickup"?"text-green-700":"text-gray-800"}`,children:"Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø·Ø¹Ù…"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Ù…Ø¬Ø§Ù†Ø§Ù‹ - Ø¨Ø¯ÙˆÙ† Ø±Ø³ÙˆÙ… ØªÙˆØµÙŠÙ„"})]}),d==="pickup"&&e.jsx(B,{className:"w-6 h-6 text-green-500"})]}),e.jsxs("button",{onClick:()=>te("delivery"),className:`w-full p-4 rounded-xl border-2 transition flex items-center gap-4 ${d==="delivery"?"border-sky-500 bg-sky-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${d==="delivery"?"bg-sky-500":"bg-gray-100"}`,children:e.jsx(K,{className:`w-6 h-6 ${d==="delivery"?"text-white":"text-gray-500"}`})}),e.jsxs("div",{className:"flex-1 text-right",children:[e.jsx("p",{className:`font-bold ${d==="delivery"?"text-sky-700":"text-gray-800"}`,children:"ØªÙˆØµÙŠÙ„ Ù„Ù„Ù…Ù†Ø²Ù„"}),e.jsx("p",{className:"text-sm text-amber-600",children:"Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ ÙŠØ­Ø¯Ø¯Ù‡Ø§ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨/Ø§Ù„Ø£Ø³Ø±Ø©"})]}),d==="delivery"&&e.jsx(B,{className:"w-6 h-6 text-sky-500"})]})]})]}),d==="delivery"&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"font-bold text-gray-800",children:"Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªÙˆØµÙŠÙ„"})]}),e.jsx("div",{className:"p-4",children:E?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-green-50 border-2 border-green-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(B,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-green-700 mb-1",children:"ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ âœ“"}),e.jsx("p",{className:"text-sm text-gray-600 break-words",children:O}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1 font-mono",children:[E.lat.toFixed(5),", ",E.lng.toFixed(5)]})]})]})}),e.jsxs("button",{onClick:()=>q(!0),className:"w-full py-3 px-4 rounded-xl border-2 border-sky-200 text-sky-600 font-semibold hover:bg-sky-50 transition flex items-center justify-center gap-2",children:[e.jsx(X,{className:"w-5 h-5"}),"ØªØºÙŠÙŠØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹"]})]}):e.jsxs("button",{onClick:()=>q(!0),className:"w-full py-4 rounded-xl bg-gradient-to-r from-sky-500 to-sky-600 text-white font-bold shadow-lg hover:shadow-xl transition flex items-center justify-center gap-3",children:[e.jsx(X,{className:"w-6 h-6"}),e.jsx("span",{children:"ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªÙˆØµÙŠÙ„"}),e.jsx(Me,{className:"w-5 h-5"})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-amber-500"}),e.jsx("span",{className:"font-bold text-gray-800",children:"Ù…Ù„Ø®Øµ Ø§Ù„ÙØ§ØªÙˆØ±Ø©"})]}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-gray-600",children:[e.jsx("span",{children:"Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ"}),e.jsxs("span",{className:"font-semibold",children:[w.toFixed(2)," Ø±.Ø³"]})]}),Y>0&&e.jsxs("div",{className:"flex items-center justify-between text-gray-500",children:[e.jsx("span",{className:"text-sm",children:"Ø±Ø³ÙˆÙ… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚"}),e.jsxs("span",{className:"font-semibold text-sm",children:[Y.toFixed(2)," Ø±.Ø³"]})]}),r&&T>0&&e.jsxs("div",{className:"flex items-center justify-between text-green-600 bg-green-50 -mx-4 px-4 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:["Ø®ØµÙ…: ",r.title]})]}),e.jsxs("span",{className:"font-bold",children:["- ",T.toFixed(2)," Ø±.Ø³"]})]}),d==="delivery"&&e.jsxs("div",{className:"flex items-center justify-between text-amber-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„"})]}),e.jsx("span",{className:"font-semibold text-sm",children:"ØªÙØ­Ø¯Ø¯ Ù„Ø§Ø­Ù‚Ø§Ù‹"})]}),d==="pickup"&&e.jsxs("div",{className:"flex items-center justify-between text-green-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsx("span",{children:"Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø·Ø¹Ù…"})]}),e.jsx("span",{className:"font-semibold",children:"Ù…Ø¬Ø§Ù†Ø§Ù‹"})]}),e.jsx("div",{className:"h-px bg-gray-200 my-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-bold text-lg text-gray-800",children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"}),e.jsxs("div",{className:"text-left",children:[T>0&&e.jsx("span",{className:"text-sm text-gray-400 line-through ml-2",children:w.toFixed(2)}),e.jsxs("span",{className:"font-black text-xl text-sky-600",children:[u.toFixed(2)," Ø±.Ø³"]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"font-bold text-gray-800",children:"Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹"})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("button",{onClick:()=>V("cod"),className:`w-full p-4 rounded-xl border-2 transition flex items-center gap-3 ${j==="cod"?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${j==="cod"?"border-green-500":"border-gray-300"}`,children:j==="cod"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}),e.jsxs("div",{className:"flex-1 text-right",children:[e.jsx("p",{className:"font-bold text-gray-800",children:"ğŸ’µ Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ø§Ø¯ÙØ¹ Ù†Ù‚Ø¯Ø§Ù‹ Ø¹Ù†Ø¯ Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ"})]})]}),e.jsxs("button",{onClick:()=>V("paypal"),className:`w-full p-4 rounded-xl border-2 transition flex items-center gap-3 ${j==="paypal"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${j==="paypal"?"border-blue-500":"border-gray-300"}`,children:j==="paypal"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})}),e.jsxs("div",{className:"flex-1 text-right",children:[e.jsx("p",{className:"font-bold text-gray-800",children:"ğŸ’³ PayPal"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ø§Ø¯ÙØ¹ Ø¨Ù€ Visa/Mastercard Ø£Ùˆ Ø­Ø³Ø§Ø¨ PayPal"})]})]}),e.jsxs("button",{onClick:()=>V("wallet"),disabled:I<u,className:`w-full p-4 rounded-xl border-2 transition flex items-center gap-3 ${j==="wallet"?"border-sky-500 bg-sky-50":I<u?"border-gray-200 bg-gray-50 opacity-60":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${j==="wallet"?"border-sky-500":"border-gray-300"}`,children:j==="wallet"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-sky-500"})}),e.jsxs("div",{className:"flex-1 text-right",children:[e.jsxs("p",{className:"font-bold text-gray-800",children:[e.jsx(We,{className:"w-4 h-4 inline ml-1"}),"Ø§Ù„Ù…Ø­ÙØ¸Ø©",e.jsxs("span",{className:`text-sm mr-2 ${I>=u?"text-green-600":"text-red-500"}`,children:["(",I.toFixed(2)," Ø±.Ø³)"]})]}),I<u?e.jsxs("p",{className:"text-xs text-red-500",children:["Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ - ØªØ­ØªØ§Ø¬ ",(u-I).toFixed(2)," Ø±.Ø³"]}):e.jsx("p",{className:"text-xs text-gray-500",children:"Ø§Ø¯ÙØ¹ Ù…Ù† Ø±ØµÙŠØ¯ Ù…Ø­ÙØ¸ØªÙƒ"})]})]})]})]}),j==="paypal"?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-center text-sm text-gray-600",children:["Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± PayPal Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙØ¹ Ø¨Ù…Ø¨Ù„Øº ",e.jsxs("span",{className:"font-bold text-sky-600",children:[u.toFixed(2)," Ø±.Ø³"]}),e.jsxs("span",{className:"text-gray-400 text-xs mr-1",children:["(â‰ˆ $",me.sarToUsd(u),")"]})]}),e.jsx($e,{options:Fe(),children:e.jsx(Oe,{style:{layout:"vertical",shape:"pill",color:"blue",label:"pay",height:50},disabled:U||re||d==="delivery"&&M&&!E,createOrder:(s,a)=>{const i=me.sarToUsd(u);return a.order.create({intent:"CAPTURE",purchase_units:[{amount:{currency_code:"USD",value:i.toString()},description:`Ø·Ù„Ø¨ Ù…Ù† ${(t==null?void 0:t.name)||"Ø³ÙØ±Ø© Ø§Ù„Ø¨ÙŠØª"}`}]})},onApprove:async(s,a)=>{if(a.order){ne(!0);try{const i=await a.order.capture();await de("paypal",i.id)}catch(i){console.error("PayPal capture error:",i),W.error("ÙØ´Ù„ ÙÙŠ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙØ¹")}finally{ne(!1)}}},onError:s=>{console.error("PayPal Error:",s),W.error("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹")},onCancel:()=>{W.info("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹")}})}),re&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sky-600",children:[e.jsx(Le,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Ø¬Ø§Ø±Ù Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ùƒ..."})]})]}):e.jsx("button",{disabled:U||d==="delivery"&&M&&!E||j==="wallet"&&I<u,onClick:()=>{j==="wallet"?de("wallet"):je()},className:"w-full py-4 rounded-2xl bg-gradient-to-r from-green-500 to-green-600 text-white font-bold text-lg shadow-xl hover:shadow-2xl disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center gap-3",children:U?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Ø¬Ø§Ø±Ù Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-6 h-6"}),j==="wallet"?`ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ (Ø®ØµÙ… ${u.toFixed(2)} Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©)`:d==="pickup"?"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ (Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø·Ø¹Ù…)":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ (Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…)"]})}),d==="delivery"&&M&&!E&&e.jsx("p",{className:"text-center text-sm text-amber-600 bg-amber-50 rounded-xl p-3",children:"âš ï¸ ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªÙˆØµÙŠÙ„ Ù‚Ø¨Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨"}),e.jsx(Te,{isOpen:be,onClose:()=>q(!1),onConfirm:we,initialLocation:E})]})})};export{He as CheckoutPage};

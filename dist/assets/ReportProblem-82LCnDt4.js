import{u as f,b as p,j as e,d as j}from"./index-FuU3jBZc.js";import{b as N,r as o}from"./vendor-react-C_wfuX_s.js";import{y as v,m as k,z as w}from"./vendor-firebase-Co4MdP0H.js";import{f as S,d as C,P as T,T as E,ad as L,U as P,b4 as R,L as $,aN as A}from"./vendor-icons-Dyg7S3Xx.js";const D=[{value:"orders",label:"مشكلة في الطلبات",icon:T,color:"blue"},{value:"delivery",label:"مشكلة في التوصيل",icon:E,color:"orange"},{value:"payment",label:"مشكلة في الدفع",icon:L,color:"green"},{value:"account",label:"مشكلة في الحساب",icon:P,color:"purple"},{value:"suggestion",label:"اقتراح للتحسين",icon:R,color:"amber"}],U=()=>{const h=N(),{user:r,role:b}=f(),a=p(),[l,d]=o.useState(null),[t,m]=o.useState(""),[n,x]=o.useState(!1),[g,u]=o.useState(!1),y=async s=>{if(s.preventDefault(),!l){a.error("الرجاء اختيار نوع المشكلة");return}if(!t.trim()){a.error("الرجاء كتابة وصف للمشكلة");return}if(t.trim().length<10){a.error("الرجاء كتابة وصف أكثر تفصيلاً (10 أحرف على الأقل)");return}if(!(r!=null&&r.uid)){a.error("يرجى تسجيل الدخول أولاً");return}x(!0);try{await v(k(j,"problemReports"),{userId:r.uid,userName:r.displayName||"",userEmail:r.email||"",userRole:b,problemType:l,description:t.trim(),status:"pending",createdAt:w()}),u(!0),a.success("تم إرسال البلاغ بنجاح"),d(null),m("")}catch(i){console.error("Error submitting report:",i),a.error("حدث خطأ أثناء إرسال البلاغ")}finally{x(!1)}};return g?e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(S,{className:"w-10 h-10 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-sky-900 mb-3",children:"تم إرسال البلاغ"}),e.jsx("p",{className:"text-sky-600 mb-6",children:"شكراً لك! سيتم مراجعة بلاغك من قبل فريق الدعم"}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:()=>u(!1),className:"px-6 py-3 bg-sky-100 text-sky-700 rounded-xl font-medium hover:bg-sky-200 transition-colors",children:"إرسال بلاغ آخر"}),e.jsx("button",{onClick:()=>h("/"),className:"px-6 py-3 bg-sky-600 text-white rounded-xl font-medium hover:bg-sky-700 transition-colors",children:"العودة للرئيسية"})]})]})}):e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-sky-100 rounded-2xl flex items-center justify-center",children:e.jsx(C,{className:"w-8 h-8 text-sky-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-sky-900 mb-2",children:"الإبلاغ عن مشكلة"}),e.jsx("p",{className:"text-sky-600",children:"أخبرنا عن أي مشكلة تواجهك أو شاركنا اقتراحاتك لتحسين التطبيق"})]}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:[e.jsxs("h3",{className:"font-semibold text-sky-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-sky-600 text-white rounded-full flex items-center justify-center text-sm",children:"1"}),"اختر نوع المشكلة"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:D.map(s=>{const i=s.icon,c=l===s.value;return e.jsxs("button",{type:"button",onClick:()=>d(s.value),className:`p-4 rounded-xl border-2 transition-all text-right flex items-center gap-3 ${c?"border-sky-500 bg-sky-50":"border-gray-200 hover:border-sky-300 hover:bg-sky-50/50"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${c?"bg-sky-500 text-white":"bg-gray-100 text-gray-500"}`,children:e.jsx(i,{className:"w-5 h-5"})}),e.jsx("span",{className:`font-medium ${c?"text-sky-700":"text-gray-700"}`,children:s.label})]},s.value)})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:[e.jsxs("h3",{className:"font-semibold text-sky-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-sky-600 text-white rounded-full flex items-center justify-center text-sm",children:"2"}),"اشرح المشكلة"]}),e.jsx("textarea",{value:t,onChange:s=>m(s.target.value),placeholder:"اكتب تفاصيل المشكلة أو الاقتراح هنا...",rows:5,maxLength:500,className:"w-full p-4 border-2 border-gray-200 rounded-xl resize-none focus:outline-none focus:border-sky-500 transition-colors",disabled:n}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[t.length,"/500 حرف"]})]}),e.jsx("button",{type:"submit",disabled:n||!l||!t.trim(),className:`w-full py-4 rounded-xl font-bold text-lg flex items-center justify-center gap-2 transition-all ${n||!l||!t.trim()?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-sky-600 text-white hover:bg-sky-700 shadow-lg hover:shadow-xl"}`,children:n?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-5 h-5 animate-spin"}),"جاري الإرسال..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-5 h-5"}),"إرسال البلاغ"]})}),e.jsx("p",{className:"text-center text-sm text-gray-500 mt-4",children:"سيتم مراجعة بلاغك من قبل فريق الدعم لتحسين تجربتك"})]})]})};export{U as ReportProblem,U as default};
